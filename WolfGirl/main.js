!function(){"use strict";var e,t={};e=t,function(){const t="1.2.0";function o(e){alert("Mod ERROR:\n"+e);const t=new Error(e);throw console.error(t),t}const n=new TextEncoder;function i(e){return!!e&&"object"==typeof e&&!Array.isArray(e)}function s(e){const t=new Set;return e.filter((e=>!t.has(e)&&t.add(e)))}const a=new Map,r=new Set;function c(e){r.has(e)||(r.add(e),console.warn(e))}function l(e){const t=[],o=new Map,n=new Set;for(const i of u.values()){const s=i.patching.get(e.name);if(s){t.push(...s.hooks);for(const[t,a]of s.patches.entries())o.has(t)&&o.get(t)!==a&&c(`ModSDK: Mod '${i.name}' is patching function ${e.name} with same pattern that is already applied by different mod, but with different pattern:\nPattern:\n${t}\nPatch1:\n${o.get(t)||""}\nPatch2:\n${a}`),o.set(t,a),n.add(i.name)}}t.sort(((e,t)=>t.priority-e.priority));const i=function(e,t){if(0===t.size)return e;let o=e.toString().replaceAll("\r\n","\n");for(const[n,i]of t.entries())o.includes(n)||c(`ModSDK: Patching ${e.name}: Patch ${n} not applied`),o=o.replaceAll(n,i);return(0,eval)(`(${o})`)}(e.original,o);let s=function(t){var o,s;const a=null===(s=(o=y.errorReporterHooks).hookChainExit)||void 0===s?void 0:s.call(o,e.name,n),r=i.apply(this,t);return null==a||a(),r};for(let o=t.length-1;o>=0;o--){const n=t[o],i=s;s=function(t){var o,s;const a=null===(s=(o=y.errorReporterHooks).hookEnter)||void 0===s?void 0:s.call(o,e.name,n.mod),r=n.hook.apply(this,[t,e=>{if(1!==arguments.length||!Array.isArray(t))throw new Error(`Mod ${n.mod} failed to call next hook: Expected args to be array, got ${typeof e}`);return i.call(this,e)}]);return null==a||a(),r}}return{hooks:t,patches:o,patchesSources:n,enter:s,final:i}}function h(e,t=!1){let o=a.get(e);if(o)t&&(o.precomputed=l(o));else{let t=window;const s=e.split(".");for(let o=0;o<s.length-1;o++)if(t=t[s[o]],!i(t))throw new Error(`ModSDK: Function ${e} to be patched not found; ${s.slice(0,o+1).join(".")} is not object`);const r=t[s[s.length-1]];if("function"!=typeof r)throw new Error(`ModSDK: Function ${e} to be patched not found`);const c=function(e){let t=-1;for(const o of n.encode(e)){let e=255&(t^o);for(let t=0;t<8;t++)e=1&e?-306674912^e>>>1:e>>>1;t=t>>>8^e}return(~t>>>0).toString(16).padStart(8,"0").toUpperCase()}(r.toString().replaceAll("\r\n","\n")),h={name:e,original:r,originalHash:c};o=Object.assign(Object.assign({},h),{precomputed:l(h),router:()=>{},context:t,contextProperty:s[s.length-1]}),o.router=function(e){return function(...t){return e.precomputed.enter.apply(this,[t])}}(o),a.set(e,o),t[o.contextProperty]=o.router}return o}function m(){for(const e of a.values())e.precomputed=l(e)}function d(){const e=new Map;for(const[t,o]of a)e.set(t,{name:t,original:o.original,originalHash:o.originalHash,sdkEntrypoint:o.router,currentEntrypoint:o.context[o.contextProperty],hookedByMods:s(o.precomputed.hooks.map((e=>e.mod))),patchedByMods:Array.from(o.precomputed.patchesSources)});return e}const u=new Map;function p(e){u.get(e.name)!==e&&o(`Failed to unload mod '${e.name}': Not registered`),u.delete(e.name),e.loaded=!1,m()}function g(e,t){e&&"object"==typeof e||o("Failed to register mod: Expected info object, got "+typeof e),"string"==typeof e.name&&e.name||o("Failed to register mod: Expected name to be non-empty string, got "+typeof e.name);let n=`'${e.name}'`;"string"==typeof e.fullName&&e.fullName||o(`Failed to register mod ${n}: Expected fullName to be non-empty string, got ${typeof e.fullName}`),n=`'${e.fullName} (${e.name})'`,"string"!=typeof e.version&&o(`Failed to register mod ${n}: Expected version to be string, got ${typeof e.version}`),e.repository||(e.repository=void 0),void 0!==e.repository&&"string"!=typeof e.repository&&o(`Failed to register mod ${n}: Expected repository to be undefined or string, got ${typeof e.version}`),null==t&&(t={}),t&&"object"==typeof t||o(`Failed to register mod ${n}: Expected options to be undefined or object, got ${typeof t}`);const s=!0===t.allowReplace,a=u.get(e.name);a&&(a.allowReplace&&s||o(`Refusing to load mod ${n}: it is already loaded and doesn't allow being replaced.\nWas the mod loaded multiple times?`),p(a));const r=e=>{let t=d.patching.get(e.name);return t||(t={hooks:[],patches:new Map},d.patching.set(e.name,t)),t},c=(e,t)=>(...i)=>{var s,a;const r=null===(a=(s=y.errorReporterHooks).apiEndpointEnter)||void 0===a?void 0:a.call(s,e,d.name);d.loaded||o(`Mod ${n} attempted to call SDK function after being unloaded`);const c=t(...i);return null==r||r(),c},l={unload:c("unload",(()=>p(d))),hookFunction:c("hookFunction",((e,t,i)=>{"string"==typeof e&&e||o(`Mod ${n} failed to patch a function: Expected function name string, got ${typeof e}`);const s=h(e),a=r(s);"number"!=typeof t&&o(`Mod ${n} failed to hook function '${e}': Expected priority number, got ${typeof t}`),"function"!=typeof i&&o(`Mod ${n} failed to hook function '${e}': Expected hook function, got ${typeof i}`);const c={mod:d.name,priority:t,hook:i};return a.hooks.push(c),m(),()=>{const e=a.hooks.indexOf(c);e>=0&&(a.hooks.splice(e,1),m())}})),patchFunction:c("patchFunction",((e,t)=>{"string"==typeof e&&e||o(`Mod ${n} failed to patch a function: Expected function name string, got ${typeof e}`);const s=h(e),a=r(s);i(t)||o(`Mod ${n} failed to patch function '${e}': Expected patches object, got ${typeof t}`);for(const[i,s]of Object.entries(t))"string"==typeof s?a.patches.set(i,s):null===s?a.patches.delete(i):o(`Mod ${n} failed to patch function '${e}': Invalid format of patch '${i}'`);m()})),removePatches:c("removePatches",(e=>{"string"==typeof e&&e||o(`Mod ${n} failed to patch a function: Expected function name string, got ${typeof e}`);const t=h(e);r(t).patches.clear(),m()})),callOriginal:c("callOriginal",((e,t,i)=>{"string"==typeof e&&e||o(`Mod ${n} failed to call a function: Expected function name string, got ${typeof e}`);const s=h(e);return Array.isArray(t)||o(`Mod ${n} failed to call a function: Expected args array, got ${typeof t}`),s.original.apply(null!=i?i:globalThis,t)})),getOriginalHash:c("getOriginalHash",(e=>("string"==typeof e&&e||o(`Mod ${n} failed to get hash: Expected function name string, got ${typeof e}`),h(e).originalHash)))},d={name:e.name,fullName:e.fullName,version:e.version,repository:e.repository,allowReplace:s,api:l,loaded:!0,patching:new Map};return u.set(e.name,d),Object.freeze(l)}function f(){const e=[];for(const t of u.values())e.push({name:t.name,fullName:t.fullName,version:t.version,repository:t.repository});return e}let y;const w=void 0===window.bcModSdk?window.bcModSdk=function(){const e={version:t,apiVersion:1,registerMod:g,getModsInfo:f,getPatchingInfo:d,errorReporterHooks:Object.seal({apiEndpointEnter:null,hookEnter:null,hookChainExit:null})};return y=e,Object.freeze(e)}():(i(window.bcModSdk)||o("Failed to init Mod SDK: Name already in use"),1!==window.bcModSdk.apiVersion&&o(`Failed to init Mod SDK: Different version already loaded ('1.2.0' vs '${window.bcModSdk.version}')`),window.bcModSdk.version!==t&&alert(`Mod SDK warning: Loading different but compatible versions ('1.2.0' vs '${window.bcModSdk.version}')\nOne of mods you are using is using an old version of SDK. It will work for now but please inform author to update`),window.bcModSdk);Object.defineProperty(e,"__esModule",{value:!0}),e.default=w}();var o,n=(o=t)&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o;const i="0.7.15",s="BC Wolf Girl",a="BCWolfGirlFrequentData",r="BCWolfGirlData",c="SSCustomAction";class l{hook(e,t){}}function h(e,t){const o=u(e);return o?function(e,t){return!(e.length>t.length)&&e.every(((e,o)=>Object.keys(e).every((n=>e[n]===t[o][n]))))}(t,o)?m("unchanged"):d():m("itemprop")}const m=e=>({rejected:e}),d=()=>({});function u(e){if(!e.some((e=>void 0===e.Property?.TypeRecord)))return e.map((e=>e.Property?.TypeRecord))}function p(e,t,o){t.forEach(((t,n)=>o[n]&&t&&ExtendedItemSetOptionByRecord(e,t,o[n])))}function g(e){return"off"===e?{o:0}:"edge"===e?{o:1}:"deny"===e?{o:2}:{o:0}}function f(e){return"off"===e?[{typed:0},{typed:0}]:"base"===e?[{typed:2},{typed:2}]:"total"===e?[{typed:1},{typed:1}]:[]}function y(e){return"off"===e?[{typed:1},{typed:0}]:"base"===e?[{typed:0},{typed:1}]:"total"===e?[{typed:0},{typed:3}]:[{typed:1},{typed:0}]}const w="BCUtilities";function b(e,t){return new Promise((o=>{window[w]||(window[w]={});const n=window[w],i=n[e];if(i&&"function"==typeof i){const e=i();if(e)return void o(e)}const s=t();n[e]=()=>s,o(s)}))}class v{constructor(e){this.events={Orgasm:[],Resist:[],Ruined:[]},e.hookFunction("ActivityOrgasmStop",9,((e,t)=>{const o=e[0],n=e[1];o.IsPlayer()&&(ActivityOrgasmRuined?this.events.Ruined.forEach((e=>e(o))):n>=60&&this.events.Resist.forEach((e=>e(o)))),t(e)})),e.hookFunction("ActivityOrgasmStart",9,((e,t)=>{const o=e[0];o.IsPlayer()&&!ActivityOrgasmRuined&&this.events.Orgasm.forEach((e=>e(o))),t(e)}))}onOrgasm(e){this.events.Orgasm.push(e)}onResist(e){this.events.Resist.push(e)}onRuined(e){this.events.Ruined.push(e)}on(e,t){this.events[e]?.push(t)}static init(e){return b("OrgasmMonitor",(()=>new v(e)))}}function _(e){const t=e.reduce(((e,t)=>("number"==typeof t.TargetCharacter?e.TargetCharacter=t.TargetCharacter:!function(e){return"number"==typeof e.SourceCharacter}(t)?!function(e){return"string"==typeof e.ActivityName}(t)?!function(e){return"string"==typeof e.FocusGroupName}(t)?function(e){return"ActivityAsset"===e.Tag}(t)&&(e.Asset={AssetName:t.AssetName,GroupName:t.GroupName,CraftName:t.CraftName||""}):e.ActivityGroup=t.FocusGroupName:e.ActivityName=t.ActivityName:e.SourceCharacter=t.SourceCharacter,e)),{BCDictionary:e});return[t.TargetCharacter,t.SourceCharacter,t.ActivityName,t.ActivityGroup].some((e=>void 0===e))?void 0:t}class k{static get instance(){return k._instance}static init(e){k._instance||(k._instance=new k(e))}constructor(e){this.CUSTOM_ACTION_TAG=e;const t=t=>({Tag:`MISSING TEXT IN "Interface.csv": ${e}`,Text:t});this.SendAction=o=>{o&&Player&&Player.MemberNumber&&ServerSend("ChatRoomChat",{Content:e,Type:"Action",Dictionary:[t(o)]})},this.SendChat=e=>{e&&Player&&Player.MemberNumber&&ServerSend("ChatRoomChat",{Content:e,Type:"Chat"})},this.LocalAction=o=>{o&&Player&&Player.MemberNumber&&ChatRoomMessage({Sender:Player.MemberNumber,Content:e,Type:"Action",Dictionary:[t(o)]})},this.LocalInfo=e=>{e&&Player&&Player.MemberNumber&&ChatRoomMessage({Sender:Player.MemberNumber,Content:e,Type:"LocalMessage"})},this.SendWhisper=(e,t)=>{t&&Player&&Player.MemberNumber&&ServerSend("ChatRoomChat",{Content:t,Type:"Whisper",Target:e})},this.SendBeep=(e,t)=>{t&&Player&&Player.MemberNumber&&ServerSend("AccountBeep",{MemberNumber:e,Message:t,BeepType:"",IsSecret:!1})}}}function C(e){return e instanceof Function?e():e}function A(e){return Array.isArray(e)&&e.every((e=>"string"==typeof e))}function I(e){return new Map(e.Appearance.map((e=>[e.Asset.Group.Name,e])))}function N(e){return new Map(e.Appearance.filter((e=>"Item"===e.Asset.Group.Category)).map((e=>[e.Asset.Group.Name,e])))}function T(e,t,o){if(!e||!t)return!1;if(e.Asset.Name!==t.Asset.Name)return!1;if(e.Asset.AllowLock){if(!e.Property)return!1;if(!0===o?.lock&&!e.Property?.LockedBy)return!1;if("string"==typeof o?.lock&&e.Property?.LockedBy!==o.lock)return!1}if(o?.group&&e.Asset.Group.Name!==t.Asset.Group)return!1;if(o?.craft)if("boolean"==typeof o.craft){if(!e.Craft||e.Craft.Name!==t.Craft.Name||e.Craft.Description!==t.Craft.Description)return!1}else if(!e.Craft||e.Craft.Name!==t.Craft.Name||e.Craft.Description!==t.Craft.Description||e.Craft.MemberNumber!==o.craft.MemberNumber||e.Craft.MemberName!==o.craft.MemberName)return!1;return!0}function S(e,...t){ChatRoomData?(CharacterRefresh(e,!1),t.length>0?t.forEach((t=>{ChatRoomCharacterItemUpdate(e,t)})):ChatRoomCharacterUpdate(e)):CharacterRefresh(e,!0)}k._instance=void 0;class M{adjustDict(e,t){return t}init(e){}constructor(e,t,o,n){this.mode=e,this.onBodyparts=t,this.activity=o,this.image=n}}class P{adjustDict(e,t){return t}init(e){}constructor(e,t,o){this.mode=e,this.onBodyparts=t,this.activity=o}}class x{}class R{constructor(e){this.mod=e,this.prereqMap=new Map,this.customActMap=new Map,this.actHandlers=new Map,e.hookFunction("ActivityCheckPrerequisite",1,((e,t)=>{const[o,n,i,s]=e,a=this.prereqMap.get(o);return a?a.test(n,i,s):t(e)})),e.hookFunction("DrawGetImage",1,((e,t)=>{const o=e[0].split("/");if("Activity"===o[2]){const e=this.customActMap.get(o[3].split(".")[0]);if(e)return t([e.image])}return t(e)})),e.hookFunction("ActivityDictionaryText",1,((e,t)=>{const o=e[0].split("-"),n=o[o.length-1];return this.customActMap.get(n)?.text(e[0])??t(e)})),e.hookFunction("ServerSend",1,((e,t)=>{if("ChatRoomChat"!==e[0]||"Activity"!==e[1]?.Type)return t(e);const o=e[1].Dictionary;if(!o)return t(e);const n=_(o);if(!n)return t(e);const i=this.actHandlers.get(n.ActivityName);return i?(e[1].Dictionary=i.reduce(((t,o)=>o.adjustDict(e[1].Content,t)),o),t(e)):t(e)}))}run(e,t,o){this.actHandlers.get(o.ActivityName)?.forEach((n=>{(void 0===n.onBodyparts||n.onBodyparts.includes(o.ActivityGroup))&&("onself"===n.mode&&o.TargetCharacter!==e.MemberNumber||("selfonother"!==n.mode||o.TargetCharacter!==e.MemberNumber&&o.SourceCharacter===e.MemberNumber)&&n.on(e,t,o))}))}addPrerequisite(e){this.prereqMap.set(e.name,e)}addActivity(e){this.customActMap.set(e.activity.Name,e),ActivityFemale3DCG?.push(e.activity),ActivityFemale3DCGOrdering?.push(e.activity.Name);const t=this.actHandlers.get(e.activity.Name);t?t.push(e):this.actHandlers.set(e.activity.Name,[e]),e.init(this.mod)}addActivityExtension(e){const t=this.actHandlers.get(e.activity);t?t.push(e):this.actHandlers.set(e.activity,[e]),e.init(this.mod)}}class G{constructor(e){this.playerJoin=[],this.playerLeave=[],this.receiveChatOrWhisper=[],this.receiveActivity=[],e.hookFunction("ChatRoomSync",1,((e,t)=>{if(Player&&(!ChatRoomData||!Player.LastChatRoom||ChatRoomData.Name!==Player.LastChatRoom.Name)){const e=Player;this.playerJoin.forEach((t=>t(e)))}return t(e)})),e.hookFunction("ServerSend",1,((e,t)=>{if("ChatRoomLeave"===e[0]&&Player){const e=Player;this.playerLeave.forEach((t=>t(e)))}return t(e)})),e.callOriginal("ChatRoomRegisterMessageHandler",[this.ChatRoomMsgHandler(e)])}onAfterPlayerJoin(e){this.playerJoin.push(e)}onBeforePlayerLeave(e){this.playerLeave.push(e)}onReceiveChatWhisperEmote(e){this.receiveChatOrWhisper.push(e)}onReceiveActivity(e){this.receiveActivity.push(e)}ChatRoomMsgHandler(e){return{Description:"BC-utilities Message Hook",Priority:90,Callback:(t,o,n,i)=>{if(Player&&Player.MemberNumber){const i=Player;if("Chat"===t.Type||"Whisper"===t.Type||"Emote"===t.Type){const s=t.Type;(e.callOriginal("ChatRoomCharacterViewIsActive",[])||e.callOriginal("ChatRoomMapViewCharacterIsHearable",[o]))&&this.receiveChatOrWhisper.forEach((e=>e(i,o,n,s)))}if("Activity"===t.Type&&t.Dictionary){const e=_(t.Dictionary);e&&this.receiveActivity.forEach((t=>t(i,o,e)))}}return!1}}}static init(e){return b("ChatRoomHandler",(()=>new G(e)))}}const E=[{Asset:{Name:"ElectronicTag",Group:"ItemNeckAccessories"},Color:["#595959","Default","#FFFFFF"],Craft:{Name:"Wolf Girl Tag Mk.II",Description:"An exquisite electronic display board, originally used as an operating panel and display screen in the Wolf Girl and Cat Girl suits, but after the successful miniaturization of holographic projection technology, the interactive function of the device was abandoned. Now it is just a simple electronic tag, used to display the wearer's identity and affiliation, and also as a pass and payment method when going out alone. The low-power screen only needs body temperature to operate continuously, and does not require power supply and maintenance. Although the original interactive function has been abandoned, the wiring and pads on the internal circuit board have not been cancelled. After a certain modification, many functions can be expanded.",Property:"Comfy"},Property:{OverridePriority:41}},{Asset:{Name:"VibeHeartPiercings",Group:"ItemNipplesPiercings"},Color:["#6C6C6C","Default"],Craft:{Name:"Wolf Girl Nipple Pleasure Module Mk.II",Description:"The pleasure stimulation module that is clamped on the nipple is also used as a backup positioning beacon to monitor and record every sexual excitement of the wolf girl. It can be linked to the pleasure controller to provide greater pleasure or punishment. Because of its simple and reliable structure and the use of body temperature to provide working energy, it almost does not need to be disassembled for maintenance. It is the cheapest module in the set. There are even frequent activities by second-level agents to buy other wolf girl kits and give away this component. The development engineer of this module suffered a huge blow and had serious psychological barriers for a time. In the end, she stuffed herself into the wolf girl training assembly line and became a wolf girl. It was really a pity.",Property:"Arousing"},Property:{OverridePriority:13}},{Asset:{Name:"VibeNippleClamp",Group:"ItemNipples"},Color:["#787878"],Craft:{Name:"Wolf Girl Multifunctional Nipple Clamp Mk.II",Property:"Arousing",Description:"A pair of small nipple clamps, which clamp the nipples to bring a sense of tightness that cannot be ignored and can vibrate to provide pleasure. However, its power is not high, and the weak pleasure it provides is difficult for the wearer to reach orgasm using only the nipples. Instead, it reminds the wearer of their identity and certain facts of lust at all times. The built-in electric shock module is naturally indispensable, but this generation of electric shock module cancels the defibrillator mode function, because the research found that a large number of reckless owners used this function to punish wolf girls, causing the wolf girls to be in danger of life. We oppose such rude and arrogant behavior, and will blacklist customers who abuse this function."},Property:{OverridePriority:22}},{Asset:{Name:"LockingVibePlug",Group:"ItemButt"},Color:["Default"],Craft:{Name:"Wolf Girl Anal Control Module Mk.II",Property:"Arousing",Description:"The module inserted into the anus, the new generation of products has added the option of releasing protein glue for permanent bonding in the expansion and locking function. The relevant structure has been proven to be reliable and non-rejecting, and can safely replace the sphincter to control excretion. The installed vibration and thrusting module has upgraded the power and strengthened the structure, avoiding the serious problem of the previous generation of products breaking and damaging in certain extreme use situations, causing physical trauma. The electric shock module limits the maximum power limit to improve battery life. In addition, a converter is installed in the tail compartment, which can slowly convert excrement into energy to provide its own operation, and can also provide energy for other modules in the form of wireless transmission."}},{Asset:{Name:"VibeHeartClitPiercing",Group:"ItemVulvaPiercings"},Color:["#595959","Default"],Craft:{Name:"Wolf Girl Clitoris Pleasure Module Mk.II",Property:"Arousing",Description:"The pleasure stimulation module uses a metal clamp at the base of the clitoris, which is also a backup positioning beacon. It integrates a new generation of sensors to monitor and record the sexual excitement data of the wolf girl every time and links the pleasure control system to perform data analysis to provide greater pleasure rewards or repeated orgasm destruction as punishment. Because of its simple and reliable structure and the use of body temperature to provide working energy, it almost does not need to be disassembled and maintained. However, in the high-power working mode, the anal control module needs to provide additional energy for normal operation. Please do not keep it in full-load operation for a long time, because the heat dissipation problem caused by its small size is very serious and may even burn the circuit."},Property:{OverridePriority:13}},{Asset:{Name:"FuturisticMuzzle",Group:"ItemMouth3"},Color:["Default","Default","Default","#FF0000"],Craft:{Name:"Wolf Girl Muzzle Outer Layer Additional Module Mk.II",Property:"Comfy",Description:"The muzzle's outer protective system is replaced with a new generation of composite materials. Although the thickness is slightly increased compared to the first generation of wolf girl outer muzzle, there is no need to worry about the extra weight. The built-in air detection and filtration system effectively prevents the wolf girl from inhaling toxic and harmful substances in the air. If necessary, the external air path can be completely closed and the internal compressed air tank can be used for safe breathing for fifteen minutes. The built-in metal mesh and Kevlar lining protect the fragile face. The optional flexible LCD screen can display specific patterns or text on the wolf girl's face to facilitate communication when necessary. The police model can be equipped with a pheromone analysis system to track specific targets."}},{Asset:{Name:"FuturisticMuzzle",Group:"ItemMouth2"},Color:["Default"],Craft:{Name:"Wolf Girl Muzzle Mk.II",Property:"Comfy",Description:"The muzzle is used to prevent the wolf girl from uncontrollably spitting saliva everywhere when wearing a ball gag. It has a built-in waterproof layer and water guide belt to prevent saliva accumulation, and a new converter with the same anal control module is added to convert the flowing saliva into energy supply components to ensure that the face is always breathable and dry. The full coverage design of the mouth can prevent the wolf girl from eating privately or accidentally eating outside, but there is no need to worry about feeding problems after wearing it. The mouth is equipped with an eating auxiliary module. After the owner authorizes the unlocking, the mouth can be replenished with water and fed liquid food without removing the mouth gag. However, please do not feed food other than the recommended types, otherwise it may cause damage to the module and possible suffocation."}},{Asset:{Name:"FuturisticHarnessBallGag",Group:"ItemMouth"},Color:["#5E5E5E","#242424","Default","Default","Default"],Craft:{Name:"Wolf girl training ball Mk.II",Property:"Small",Description:"The gag is made of high-strength rubber to prevent the wolf girl from hurting innocent people during the initial training. Most of the time, it will not hinder communication, but it has a built-in sensor to detect what the wolf girl said or tried to say. It can be expanded into a spherical or phallic shape according to the corresponding settings to penetrate deep into the throat to punish and restrict communication. It is also connected to the feeding auxiliary module of the inner layer of the gag. When used with the phallic mode, it can quickly train the wolf girl's oral sex ability. The new generation of products has added a directional sound wave generator to restrict and replace the wolf girl's external communication. The fixed rigging is a metal composite braided cable, which cannot be violently removed without hurting the wolf girl."},Property:{OverridePriority:35}},{Asset:{Name:"FuturisticHarness",Group:"ItemTorso"},Color:["#666666","#7A7A7A","#393939","#FFFFFF"],Craft:{Name:"Wolf Girl Training Harness Mk.II",Property:"Comfy",Description:"The harness on the wolf girl can be used as a data bus to provide wired data communication connections between modules and to be used as an external signal transmission antenna. Although each module already has the ability to form a wireless network, the existence of the physical link of the harness increases throughput and saves a lot of energy consumption, which is still very necessary. The main body is made of metal composite braided cables, and the interface is also waterproof. It does not need to be removed before entering the water like the previous generation of products. Thanks to its reliable structural strength, it can even be used as a climbing rope and traction rope when necessary, but please note that the original communication function cannot be restored after being disassembled into a climbing rope or traction rope."}},{Asset:{Name:"HighSecurityHarness",Group:"ItemTorso2"},Color:["#444444","Default"],Craft:{Name:"Wolf Girl Harness Outer Frame Mk.II",Property:"Comfy",Description:"The extra frame on the outer layer of the harness is attached to the training harness in most cases, but it can also be used independently. It stores nutrient solution and various medicines, which are prepared and injected into the body in real time according to the control core instructions to ensure that the body is in the best condition at all times. It also has a quick replenishment interface, which makes maintenance simple and convenient. The waist node stores several emergency injections, which can be used to rescue others when necessary. Although this device is a component of the Wolf Girl Training Set, a large number of users purchase this component separately to use medicines. Please note that this product is only a special equipment, not a medical device. EIL is not responsible for possible accidents caused by the use of this component."},Property:{OverridePriority:1}},{Asset:{Name:"SciFiPleasurePanties",Group:"ItemPelvis"},Color:["#454545","#202020","#878787","#202020","#878787","#878787","Default"],Craft:{Name:"Wolf girl training underwear Mk.II",Property:"Arousing",Description:"The new generation of training underwear has been adapted and connected to the central control component, avoiding the embarrassment of the previous generation of products requiring secondary configuration. The embedded position of the built-in vibrator has been modified to be more reasonable and will not cause bruises to the skin after long-term work, while the electric shock device also limits high-power electric shocks. Although it is acceptable as a punishment, we despise the wanton venting of emotions without regard for the health of the wolf girl. It has a pleasure detection and orgasm control module, which can make the wolf girl stay on the edge of orgasm or destroy the orgasm so that she has no satisfaction, which helps to tame the wolf girl. And the opening is thoughtfully designed, which will not affect excretion and masturbation when the owner allows it."},Property:{TypeRecord:{c:0,i:0,o:2,s:0}}},{Asset:{Name:"FuturisticCuffs",Group:"ItemArms"},Color:["#4F4F4F","#353535","#FFFFFF"],Craft:{Name:"Wolf Girl Bracelet Mk.II",Property:"Comfy",Description:"The restraint control system installed on the arm is a very beautiful decorative ring when not activated. The new generation of products has upgraded the electrical stimulation system, which can maintain the muscle state to avoid atrophy under long-term restraint, and can enhance explosive power to deal with certain emergencies when necessary. The extensive use of composite materials makes the weight lighter than the previous generation while still having ultra-high strength. Even the lowest configuration of this generation of products is equipped with a tactile simulation system, which can provide the wearer with a realistic hug warmth at any time. Whether it is a human or a god, it is never shameful to require the body temperature of another individual. EIL will never lose its focus on emotional and psychological needs."}},{Asset:{Name:"FuturisticMittens",Group:"ItemHands"},Color:["#777777","#6E6E6E","#3D3D3D","Default"],Craft:{Name:"Wolf Girl Gloves Mk.II",Property:"Comfy",Description:"The Wolf Girl gloves, which use NMRB technology, abandon the complex and high-power ERMR, are more reliable, lightweight and energy-efficient. The speed of switching between fingerless gloves and normal gloves is nearly three times faster, and anomalies caused by insufficient power supply during failure or mode conversion are avoided. The internal padding has also been upgraded to enhance temperature management and reduce the impact of high temperatures in summer and low temperatures in winter, while the tactile obstruction module has been moved to the wrist locking ring to avoid repeated impacts that cause the module to fail. The optional adsorption climbing module has also become standard, which can also make the Wolf Girl's hands almost completely lose friction and unable to grasp objects."},Property:{TypeRecord:{typed:1}}},{Asset:{Name:"FuturisticAnkleCuffs",Group:"ItemFeet"},Color:["#000000","#494949","#303030","#FFFFFF"],Craft:{Name:"Wolf Girl Smart Leg Ring Mk.II",Property:"Comfy",Description:"The new ankle restraint control system cancels the automatic connection and locking function of the aggressive sensor, saving more space for installing the limb action controller. After linking the step controller component, the lower limbs' mobility can be fully controlled. The additional action posture stabilization system can prevent the body from losing stability and even falling in almost all extreme situations. Although it helps to provide additional safety in some special scenarios, EIL does not recommend such use, let alone private modification, otherwise the warranty terms will be invalidated, and EIL will not compensate for accidents caused by such application scenarios of the prop."}},{Asset:{Name:"FuturisticHeels2",Group:"ItemBoots"},Color:["#212121","#4A4A4A","#383838","#3D3D3D","#404040","#3D3D3D","Default"],Craft:{Name:"Wolf Girl Foot Training System Mk.II",Property:"Comfy",Description:"The high-heeled shoes have metal wires woven into the lining, and the built-in electric structure in the heel can change the height of the heel according to the training progress or reward and punishment rules. The bottom is embedded with a heavy metal plate as a counterweight to increase stability and passively train the leg muscles to prevent muscle atrophy caused by long-term restraint. It is also equipped with a motion sensor to count the amount of exercise, and cooperates with other components to collect data to assist the central controller in making decisions to modify the training plan and modify the nutritional meal formula accordingly to add trace elements to better maintain physical health. The additional neural interference module can be used as a reward to greatly reduce the pain caused by walking in high heels, and can also be linked to the pace controller to take over the movement of the wolf girl."},Property:{TypeRecord:{typed:1}}},{Asset:{Name:"FuturisticLegCuffs",Group:"ItemLegs"},Color:["#000000","#4A4A4A","#383838","#FFFFFF"],Craft:{Name:"Wolf Girl Step Stance Controller Mk.II",Property:"Comfy",Description:"The pace controller for training elegant walking posture can be connected and completely fixed as part of the control system, which can minimize the ability to struggle and escape. The built-in electrical stimulation module has been upgraded to a version with tactile simulation, which can massage the thigh muscles to give rewards and also provide arousal and teasing. The muscle strength limiter has been replaced with a model that can finely adjust the output. Combined with other leg components, it completely takes over the mobility, so that the owner can play more. Although the second-generation wolf girl suit uses composite materials to reduce weight, this module is still made of alloy as an additional weight to assist stability and prevent muscle and blood vessel problems caused by long-term restraint."}},{Asset:{Name:"FuturisticVibrator",Group:"ItemVulva"},Color:["#454545","#555555","Default"],Craft:{Name:"Wolf Girl Central Pleasure Controller Mk.II",Property:"Arousing",Description:"The new generation of central pleasure controller is equipped with an advanced computing unit and can be used as a backup central controller. The vibration and thrusting module has a new mechanical expansion function in this version, which can adjust the diameter to a certain extent, fill the vagina to give stronger stimulation, or shrink to a level that can be felt but cannot get pleasure during the climax. The electric shock device also limits the maximum power and trigger conditions, deletes the setting that any sound can trigger the electric shock, and deletes the part of the urination control module in the custom interface so that it can only use a few preset modes, and has a mechanical emergency unlocking to avoid setting errors or some special circumstances that may cause physical damage."}},{Asset:{Name:"FuturisticEarphones",Group:"ItemEars"},Color:["#898989","#2A2A2A","Default"],Craft:{Name:"Wolf Girl Multi-Purpose Auxiliary Earphones Mk.II",Property:"Comfy",Description:"The microphone array upgrade combined with the new neural interference module can even calculate the launch position of every bullet that passes by in a short time when running at full power. The active noise reduction system also benefits from the module upgrade and has stronger performance. It can accurately locate the faint cry for help in a battlefield full of bullets and spells, and naturally make it so that the wolf girl can only hear the master's words in a busy city. However, the neural interference module will not be open source in the official release, because in the initial testing, we found some situations that distorted the use of the module, and such behavior crossed the bottom line of EIL."}},{Asset:{Name:"InteractiveVisor",Group:"ItemHead"},Color:["#5D5D5D"],Craft:{Name:"Wolf Girl Enhanced Auxiliary Goggles Mk.II",Property:"Comfy",Description:"The transparent circuit and battery are integrated into the thin and reliable polymer shell, and the sensor matrix is ​​placed in the temples on both sides. The effective recognition range has been increased to 220 degrees, and the recognition distance and accuracy have been significantly improved, while the old The visual control module has been replaced with a neural interference module, which avoids the shortcomings of poor battery life caused by excessive power consumption and the disadvantages caused by large amounts of heat. With the headphone module, it can perform absolute interference between vision and hearing, and continuously adjust vision. Or you can directly play the training and brainwashing video, but the remote scheduling function of this module has been locked by the hardware to prevent hackers from hijacking the master's instructions."}},{Asset:{Name:"FuturisticBra",Group:"ItemBreast"},Color:["#4A4A4A","#FFFFFF","#FFFFFF","#4B4B4B","#363636"],Craft:{Name:"Wolf Girl Composite Sports Bra Mk.II",Property:"Comfy",Description:"The bra is made of electric muscle and equipped with a motion sensor to adjust the posture in real time. It is thin and soft to avoid the overly tight feeling of the previous generation, while providing sufficient support for the breasts to avoid the unstable center of gravity caused by the shaking of the breasts during high-speed movement. When it detects an attempt to masturbate through the breasts, it will tighten and harden to prevent the wolf girl from getting any pleasure. It can also massage and electrically stimulate the breasts to keep them healthy, and can also provide pleasure as a reward. It has a built-in vital sign monitor and sends physiological data to the terminal in real time, so that the owner can check the wolf girl's physical condition at any time. Although a certain breast enhancement effect was observed during the test, it is not universal. Please do not flash firmware not recommended by EIL at will."},Property:{TypeRecord:{typed:2}}},{Asset:{Name:"FuturisticCollar",Group:"ItemNeck"},Color:["#606060","Default","Default","Default"],Craft:{Name:"Wolf Girl System Main Control Core Mk.II",Property:"Comfy",Description:"The appearance of the central controller has not changed much, but the computing power and battery life have been upgraded. It can calculate the body parameters and the posture parameters of each component more quickly and accurately for timely adjustment. Although the computing power is strong enough, its ability to parse the virtual currency algorithm has been limited by both software and hardware to avoid being used for other purposes. After installing the expensive communication module, the multiple wolf girls owned by the owner can form a network connection similar to the Misaka network proposed by Academy City at close range, sharing information and processing power among the wolf girls. And it is equipped with additional visual sensors to avoid abnormal environmental perception caused by damaged goggles."}}],D=new Map(E.map((e=>[e.Asset.Group,e])));const F={Asset:{Name:"FuturisticCrate",Group:"ItemDevices"},Color:["#222222","Default","#444444","Default","Default","#FF1199","Default","#444444","#555555","#3B7F2C","Default","Default","#BBBBFF","Default"],Craft:{Name:"Wolf Girl Training Facility Maintenance Cabin Mk.II",Property:"Comfy",Description:"The basic wolf girl transport storage cabin has been newly equipped with surgical modules and component maintenance modules, and sufficient materials are stored to quickly make restraints on site. The addition of a new generation of robotic arms and scanning matrices makes the operation more precise, and the restraints are more comfortable and close-fitting. The installation of the surgical module means that the wolf girl does not have to worry about life danger even if she suffers serious trauma. However, due to the fact that the production and yield of the injection-type nano-surgical robot are not ideal, the huge purchase price and high maintenance cost have caused the price of the maintenance cabin to rise sharply on the black market, and even attacked the EIL team. The component will now be remotely dropped by EIL."}},j={Asset:{Name:"InteractiveVisor",Group:"ItemHead"},Color:["#3A3A3A"],Craft:{Name:"Wolf Girl Trainer Multi-purpose Auxiliary Terminal Mk.II",Property:"Thin",Description:"Standard auxiliary goggles, connected to the EIL database to view the wolf girl's physiological status, identity information and other data. The sensor in one of the temples was removed and replaced with an auxiliary positioning system to remotely deploy the training facility maintenance cabin, which is convenient for trainers to perform component maintenance and additional training props on the wolf girl at any time, and naturally also convenient for trainers to hunt new targets. It has a built-in biometric lock and self-destruct system. It will automatically lock when the auxiliary terminal is removed, and will self-destruct when used by non-EIL registered personnel to avoid leakage of authority and information, effectively improving the security of the EIL internal network."}},L={Asset:{Name:"MedicalInjector",Group:"ItemHandheld"},Color:["#8F8F8F"],Craft:{Name:"Wolf Girl Trainer Multi-Purpose Injection Gun Mk.II",Property:"Comfy",Description:"Multi-purpose injection gun, most of the time filled with a disposable identity chip for the initial installation and information registration of the training kit for the new wolf girl, but it can be replaced with various medicines, or even the injection-type nano-surgical robot used in the maintenance cabin, to perform first aid when necessary. The advanced injection gun will not leave needle holes on the skin, and can even be injected through clothing, and the extremely high injection speed does not worry about accidents when the target struggles."}},$=[F,j,L,{Asset:{Name:"GlassFilled",Group:"ItemHandheld"},Color:"Default",Craft:{Name:"Water of Desire",Description:"A glass of water? Maybe.",Property:"Normal"}},{Asset:{Name:"GlassFilled",Group:"ItemHandheld"},Color:"Default",Craft:{Name:"Special Redbull",Description:"A mixture of Red Bull, alcohol, caffeine, steroids, gorilla testicle extract, etc., Power!",Property:"Normal"}}];function O(e){return new Map(e.Appearance.map((e=>[e.Asset.Group.Name,e])))}var W,q;!function(e){e[e.running=0]="running",e[e.finished=1]="finished",e[e.interrupted=2]="interrupted"}(W||(W={}));class B{}class H{constructor(e){this.time_reso=e,this.work_suites=[],this._state="working",this._timer=setInterval((()=>{for(;;){if(Player&&this.work_suites.length>0&&"working"===this._state){const e=this.work_suites[0];if(0===e.works.length){this.work_suites.shift();continue}const t=e.works[0].run(Player);t===W.finished?e.works.shift():t===W.interrupted&&this.work_suites.shift()}break}}),e)}skip_until(e){for(;;){if(0===this.work_suites.length)return;const t=this.work_suites[0];if(0===t.works.length&&this.work_suites.shift(),!e(t))return;t.works.shift()}}pause(){this._state="paused"}resume(){this._state="working"}push_front(e){this.work_suites.unshift(e)}push(e){this.work_suites.push(e)}insert_after_first(e){0!==this.work_suites.length?this.work_suites.splice(1,0,e):this.work_suites.push(e)}get cur_description(){if(0!==this.work_suites.length)return this.work_suites[0].description}static init(e){H._global||(H._global=new H(e))}static get global(){return H._global}}class V{constructor(e){this.Time=0,this._data=e,this.Time=Date.now()}isEIL(e){return this._data.uids.includes(e)}get craft(){return this._data.craft}get room(){return this._data.room}static get Access(){return V._Access()}static async fetch(e){return fetch(e+`EIL.json?t=${Date.now()}`).then((e=>{if(!e.ok)throw new Error("EIL.json not found.");return e.json()})).then((e=>V.last_fetched=new V(e)))}static init(e){return this.fetch(e).then((t=>{V._Access=()=>(V.last_fetched&&Date.now()-V.last_fetched.Time>6e4&&V.fetch(e),V.last_fetched),V.force_fetch=()=>V.fetch(e)}))}}function z(e){return"number"==typeof e?e:e.MemberNumber}function U(e,t,o){const n=z(e),i=Q(n,t),s=V.Access.craft;return function(e,t,o){const n=AssetGet(e.AssetFamily,t.Asset.Group,t.Asset.Name);if(!n)return;const i=C(t.Color),s=o?.craft&&t.Craft&&{...t.Craft,MemberNumber:o.craft.MemberNumber,MemberName:o.craft.MemberName,Item:t.Asset.Name,ItemProperty:null,Color:"string"==typeof i?i:i.join(","),Lock:t.Craft?.Lock?t.Craft.Lock:"",Private:!0};let a={Asset:n,Color:i,Craft:s};ExtendedItemInit(e,a,!1,!1),a.Difficulty=o?.difficulty??n.Difficulty;const r=t.Property&&C(t.Property);if(r){r.TypeRecord&&ExtendedItemSetOptionByRecord(e,a,r.TypeRecord,{push:!1}),a.Property||(a.Property={});const t=a.Property;for(const e in r){const o=e;"TypeRecord"!==e&&("Effect"===e?A(r.Effect)&&(A(t.Effect)?r.Effect.forEach((e=>{t.Effect&&!t.Effect.includes(e)&&t.Effect.push(e)})):t.Effect=Array.from(r.Effect)):"ExcludeEffect"===e?A(r.ExcludeEffect)&&A(t.Effect)&&(t.Effect=t.Effect.filter((e=>!r.ExcludeEffect?.includes(e)))):void 0!==t[o]&&typeof t[o]!=typeof r[o]||Object.assign(t,{[o]:r[o]}))}}if(o?.lock){const t=AssetGet(e.AssetFamily,"ItemMisc",o.lock.Lock);t&&InventoryLock(e,a,{Asset:t},o.lock.MemberNumber,!1)}else if(t.Craft?.Lock){const o=AssetGet(e.AssetFamily,"ItemMisc",t.Craft.Lock);o&&InventoryLock(e,a,{Asset:o},null,!1)}return a}(t,o,{craft:{MemberName:s.name,MemberNumber:s.uid},lock:{Lock:i,MemberNumber:n},difficulty:42})}function K(e,t,o){const n=V.Access.craft;return T(e,t,{craft:{MemberName:n.name,MemberNumber:n.uid},lock:o??!0})}function J(e,t,o){if(!t)return!1;const n=e.Appearance.find((e=>e.Asset.Group.Name===t.Asset.Group));return!!n&&K(n,t,o)}function Y(e,t,o){const n=D.get(t);return!!n&&J(e,n,o)}function Z(e,t){const o=I(e),n=V.Access.craft,i={craft:{MemberName:n.name,MemberNumber:n.uid},lock:t},s=new Set;return E.forEach((e=>{const t=o.get(e.Asset.Group);t&&T(t,e,i)||s.add(e.Asset.Group)})),s}function Q(e,t){const o=z(e);return t.Ownership&&t.Ownership.MemberNumber===o?"OwnerPadlock":t.Lovership&&t.Lovership.some((e=>e.MemberNumber===o))?"LoversPadlock":"ExclusivePadlock"}V._Access=()=>{throw new Error("EILNetwork is not ready.")},V.last_fetched=void 0;class X{get on(){return this._state}set on(e){this._state=e}static init(e,t){X.instance=new X(e)}constructor(e){this._state=!1,e.hookFunction("InventoryItemFuturisticValidate",2,((e,t)=>this._state?"":t(e))),e.hookFunction("ExtendedItemValidate",2,((e,t)=>e[2].Asset.Name.startsWith("Futuristic")&&this._state?"":t(e)))}}!function(e){e[e.TARGET_ACTING=0]="TARGET_ACTING",e[e.TARGET_ACTED=1]="TARGET_ACTED"}(q||(q={}));class ee extends B{constructor(e,t,o=q.TARGET_ACTED){super(),this.items=e,this.target=t,this.mode=o,0===e.length?this._items=[]:"string"==typeof e[0]?this._items=e.map((e=>D.get(e))):this._items=e,this.target_num=z(t)}static ItemWearSingle(e,t,o){const n=U(t,o,e);if(!n)return;const i=o.Appearance.findIndex((e=>e.Asset.Group===n.Asset.Group));i>=0?o.Appearance[i]=n:o.Appearance.push(n)}run(e){const t=e.MemberNumber;if(!t)return W.interrupted;if(this.mode===q.TARGET_ACTING)this._items.forEach((t=>ee.ItemWearSingle(t,this.target_num,e))),S(e);else{const e=ChatRoomCharacter.find((e=>e.MemberNumber===this.target_num));if(!e)return W.interrupted;this._items.forEach((o=>ee.ItemWearSingle(o,t,e))),S(e)}return W.finished}}ee.TARGET_ACTING=q.TARGET_ACTING,ee.TARGET_ACTED=q.TARGET_ACTED;class te extends B{constructor(e,t){super(),this._target=z(e),this._options=t}static ItemOptionSingleI(e,t){ExtendedItemSetOptionByRecord(e,t.target,t.option)}static ItemOptionSingleS(e,t){const o=e.Appearance.find((e=>e.Asset.Group.Name===t.target));o&&ExtendedItemSetOptionByRecord(e,o,t.option)}run(e){const t=ChatRoomCharacter.find((e=>e.MemberNumber===this._target));if(!t)return W.interrupted;X.instance.on=!0;const o=O(t);return this._options.map((e=>({target:"string"==typeof e.target?o.get(e.target):e.target,option:e.option}))).filter((e=>e.target)).forEach((e=>te.ItemOptionSingleI(t,e))),this._options.length>0&&S(t),X.instance.on=!1,W.finished}}class oe extends B{constructor(e,t){super(),this.items=t,this._items=t,this._target=z(e)}run(e){const t=ChatRoomCharacter.find((e=>e.MemberNumber===this._target));if(!t)return W.interrupted;const o=[];return t.Appearance.forEach((e=>{this._items.some((t=>"string"==typeof t?e.Asset.Name===t:e.Asset.Group.Name===t.Asset.Group&&e.Asset.Name===t.Asset.Name))||o.push(e)})),t.Appearance=o,S(t),W.finished}}class ne extends B{constructor(e,t){super(),this.stash=t,this._stash=t,this._target=z(e)}run(e){const t=ChatRoomCharacter.find((e=>e.MemberNumber===this._target));if(!t)return W.interrupted;const o=[];return t.Appearance.forEach((e=>{e.Asset.Group.Clothing?this._stash.push(e):o.push(e)})),t.Appearance=o,S(t),W.finished}}class ie extends B{constructor(e,t){super(),this.stash=t,this._stash=t,this._target=z(e)}run(e){const t=ChatRoomCharacter.find((e=>e.MemberNumber===this._target));return t?(t.Appearance=t.Appearance.concat(this._stash),S(t),W.finished):W.interrupted}}class se extends B{constructor(e,t,o){super(),this.group=e,this._group=e,this._target=z(t),this._lock=o}run(e){const t=ChatRoomCharacter.find((e=>e.MemberNumber===this._target));if(!t)return W.interrupted;const o=Q(e,t);return this._group.forEach((n=>{const i=t.Appearance.find((e=>e.Asset.Group.Name===n));i&&InventoryLock(t,i,o,e.MemberNumber,!1)})),S(t),W.finished}}class ae extends B{constructor(e,t){super(),this._target=z(e),this._items=t}run(e){const t=ChatRoomCharacter.find((e=>e.MemberNumber===this._target));return t?(this._items.forEach((e=>{const o=t.Appearance.find((t=>t.Asset.Group.Name===e.group));o&&(o.Property||(o.Property={}),Object.assign(o.Property,e.property))})),S(t),W.finished):W.interrupted}}function re(e){const t=new Map(e.Appearance.map((e=>[e.Asset.Group.Name,e])));return E.every((e=>{const o=t.get(e.Asset.Group);return!(!o||!T(o,e,{craft:!0,lock:!0}))}))}function ce(e,t){let o=e.Appearance.filter((e=>t.includes(e.Asset.Group.Name)));return o.length===t.length&&o.every((e=>!!T(e,D.get(e.Asset.Group.Name),{craft:!0,lock:!0})))}function le(e){return ce(e,["ItemNeck"])||ce(e,["ItemVulva"])}function he(e,t){if("Chat"===e.Type||"Whisper"===e.Type){const o=ChatRoomCharacter.find((t=>t.MemberNumber===e.Sender));if(o&&Player&&Player.MemberNumber&&le(Player)){const e=Player.Appearance.find((e=>"ItemEars"===e.Asset.Group.Name)),n=e?.Property?.TypeRecord?.typed;void 0!==n&&n>0&&t(Player,o)}}}function me(e){return"off"===e?[{typed:0}]:"base"===e?[{typed:1}]:"total"===e?[{typed:3}]:[{typed:0}]}function de(e){return"off"===e?0:"open"===e?2:"max"===e?4:"random"===e?5:0}function ue(e){return"off"===e?[{typed:0}]:"base"===e?[{typed:1}]:"total"===e?[{typed:3}]:[]}function pe(e){return"off"===e?[{g:0,p:0,t:0}]:"base"===e?[{g:0,p:3,t:0}]:"total"===e?[{g:2,p:3,t:4}]:[]}const ge={open:{OpenPermission:!0,OpenPermissionChastity:!0,OpenPermissionArm:!0,OpenPermissionLeg:!0},close:{OpenPermission:!1,OpenPermissionChastity:!1,OpenPermissionArm:!1,OpenPermissionLeg:!1}};const fe=[class extends l{constructor(){super(...arguments),this.type="HearingCtrl",this.target_item=["ItemEars"],this.available_ctrls=["off","base","total"]}set(e,t,o){p(e,t,me(o))}test(e,t,o){return h(t,me(o))}hook(e,t){e.hookFunction("ChatRoomMessage",1,((t,o)=>{const[n]=t;return he(n,((t,o)=>{n[c]=e.callOriginal("SpeechGarble",[o,n.Content])})),o(t)})),e.hookFunction("ChatRoomMessageDisplay",1,((e,t)=>{const o=e;return he(o[0],(()=>{o[1]=o[0][c]??o[1]})),t(o)}))}},class extends l{constructor(){super(...arguments),this.type="ArousalCtrl",this.target_item=["ItemPelvis"],this.available_ctrls=["off","edge","deny"]}set(e,t,o){const[n]=t;if(!n)return;const i=n.Property?.LockedBy,s=n.Property?.LockMemberNumber;ExtendedItemSetOptionByRecord(e,n,g(o)),ExtendedItemInit(e,n),i&&s&&InventoryLock(e,n,i,s)}test(e,t,o){return function(e,t){const o=u(e);return o?t(o):m("itemprop")}(t,(e=>{const[t]=e;return void 0!==t.o?t.o===g(o).o?m("unchanged"):d():m("itemprop")}))}},class extends l{constructor(){super(...arguments),this.type="FeetCtrl",this.target_item=["ItemFeet","ItemLegs","ItemBoots"],this.available_ctrls=["off","base","total"]}set(e,t,o){p(e,t,f(o))}test(e,t,o){return h(t,f(o))}},class extends l{constructor(){super(...arguments),this.type="HandsCtrl",this.target_item=["ItemHands","ItemArms"],this.available_ctrls=["off","base","total"]}set(e,t,o){p(e,t,y(o))}test(e,t,o){return h(t,y(o))}},class extends l{constructor(){super(...arguments),this.type="ToysCtrl",this.target_item=["ItemVulva","ItemPelvis","ItemVulvaPiercings","ItemButt","ItemNipples","ItemNipplesPiercings"],this.available_ctrls=["open","max","off","random"]}set(e,t,o){const n=de(o);t.forEach((t=>{if(t)if("vibrating"===t.Asset.Archetype)ExtendedItemSetOptionByRecord(e,t,{vibrating:n});else if("modular"===t.Asset.Archetype){if(void 0===t.Property?.TypeRecord?.i)return;"random"===o?ExtendedItemSetOptionByRecord(e,t,{i:0}):ExtendedItemSetOptionByRecord(e,t,{i:n})}}))}test(e,t,o){if("random"===o)return d();const n=de(o);return t.every((e=>{if("vibrating"===e.Asset.Archetype){if(e.Property?.TypeRecord?.vibrating===n)return!0}else if("modular"===e.Asset.Archetype&&e.Property?.TypeRecord?.i===n)return!0;return!1}))?m("unchanged"):d()}},class extends l{constructor(){super(...arguments),this.type="VisionCtrl",this.target_item=["ItemHead"],this.available_ctrls=["off","base","total"]}set(e,t,o){p(e,t,ue(o))}test(e,t,o){return h(t,ue(o))}},class extends l{constructor(){super(...arguments),this.type="VoiceCtrl",this.target_item=["ItemMouth"],this.available_ctrls=["off","base","total"]}set(e,t,o){const n=pe(o),[i]=t,s=i?.Property?.TypeRecord?.g;p(e,t,n),n[0].g!==s&&void 0!==i?.Property?.AutoPunishUndoTime&&(i.Property.AutoPunishUndoTime=0)}test(e,t,o){return h(t,pe(o))}},class extends l{constructor(){super(...arguments),this.type="FuturisticPublicCtrl",this.target_item=["ItemNeck"],this.available_ctrls=["open","close"]}set(e,t,o){const[n]=t;n&&(n.Property||(n.Property={}),"open"===o?Object.assign(n.Property,ge.open):"close"===o&&Object.assign(n.Property,ge.close))}test(e,t,o){const[n]=t,i=n.Property;if(!i)return m("itemprop");const s="open"===o?ge.open:ge.close;return Object.keys(s).map((e=>i[e]===s[e])).every((e=>e))?m("unchanged"):d()}}].map((e=>new e)),ye=new Map(fe.map((e=>[e.type,e])));function we(e,t,o){const n=ye.get(t);if(!n)return!1;const i=new Map(e.Appearance.map((e=>[e.Asset.Group.Name,e])));return X.instance.on=!0,n.set(e,n.target_item.map((e=>i.get(e))),o),X.instance.on=!1,!0}function be(e){return`wolf girl ${e.MemberNumber??""}`}const ve={mode:"chat-action",msg:"The command was received, but the command execution was abnormal. The component {missing_formated} was not online, so the command could not be completed."},_e={mode:"chat-action",msg:"The command was received but executed abnormally. The component {missing_formated} is not online. The corresponding functional module group is incomplete. The command cannot be completed."},ke={mode:"chat-action",msg:"The command was received but executed abnormally. The component {missing_formated} is not online. The corresponding functional module group is incomplete. The command cannot be fully completed."},Ce={mode:"action",msg:"{player_wg}'s central control core makes a small error beep, but other than that nothing happens"},Ae={notify:ve,action:Ce};function Ie(e,t,o){return t||(t={}),e.replace(/{([\w\d_]+)}/g,((e,n)=>{if(t?.target){if("target"===n)return CharacterNickname(t.target);if("target_id"===n)return t.target.MemberNumber?.toString()??"";if("target_wg"===n)return be(t.target)}if(t?.player){if("player"===n)return CharacterNickname(t.player);if("player_id"===n)return t.player.MemberNumber?.toString()??"";if("player_wg"===n)return be(t.player)}return o&&o[n]?o[n].toString():e}))}function Ne(e,t,o){const n=Ie(e.msg,t,o);"action"===e.mode?k.instance.SendAction(n):"chat-action"===e.mode?k.instance.SendAction('"'+n+'"'):"local"===e.mode?k.instance.LocalAction(n):"chat"===e.mode?k.instance.SendChat(n):"local-status"===e.mode&&k.instance.LocalInfo(n)}function Te(e,t){const o=["�","�2�","□��","??","????","??????","烫烫","烫烫烫","烫烫烫烫","烫烫烫烫烫","ììð","ñâââ","îýîú","ýýýÿÿÿ"];return e.split("").map(((n,i)=>{const s=i/e.length*t*.5+.5*t;return Math.random()<s?o[Math.floor(Math.random()*o.length)]:n})).join("")}function Se(e,t,o,n,i){const s=Ie(n,{player:t},i),a=z(o);"Chat"===e?k.instance.SendAction(s):"Whisper"===e?k.instance.SendWhisper(a,s):"Beep"===e&&k.instance.SendBeep(a,s)}class Me extends B{constructor(e){super(),this.first_run=!0,this._timeout=e}run(e){return this.first_run&&(this.first_run=!1,this._timeout=Date.now()+this._timeout),Date.now()<this._timeout?W.running:W.finished}}class Pe extends B{constructor(e,t){super(),this._check=e,this.message=t}run(e){const t=this._check(e);if(this.message){const o=(()=>"function"==typeof this.message?this.message(e,t):t.passed?{mode:this.message.mode,msg:this.message.passed}:{mode:this.message.mode,msg:this.message.failed})();o&&Ne(o,{player:e})}return t.state}}Pe.Accepted={state:W.finished,passed:!0},Pe.Continue={state:W.finished,passed:!1},Pe.Rejected={state:W.interrupted,passed:!1},Pe.Stop={state:W.interrupted,passed:!0};class xe{constructor(e){this._callback=e}run(e){const t=this._callback(e);return void 0===t?W.finished:t}}class Re extends B{constructor(e,t,o){super(),this.callback=t,this.checkLock=o,this._target=e.map((e=>"string"==typeof e?D.get(e):e)).filter((e=>void 0!==e))}run(e){const t=N(e),o=this._target.filter((e=>!K(t.get(e.Asset.Group),e,this.checkLock))),n=this.callback(e,{missing:o});return void 0===n?W.finished:n}}class Ge extends B{constructor(e,t,o){super(),this.type=e,this.mode=t,this.call=o}run(e){const t=function(e,t,o){const n=ye.get(t);if(!n)return m("type");if(!n.available_ctrls.includes(o))return m("mode");const i=N(e),s=n.target_item.filter((e=>!K(i.get(e),D.get(e))));return s.length>0?{missing:s}:n.test(e,n.target_item.map((e=>i.get(e))),o)}(e,this.type,this.mode);return this.call(t)||W.finished}}function Ee(e,t,o,n){return i=>(i.missing?o(i,t):"unchanged"!==i.rejected?i.rejected?(Ne({mode:"chat-action",msg:`[DEBUG] error message: WGException.${t.type}.Rejected.${i.rejected}`},{player:e}),W.interrupted):n(t):(Ne({mode:"chat-action",msg:"Received a command, but the command execution was abnormal. Staying in current working mode"},{player:e}),void(t.xMessage=Ae.action)))??W.finished}function De(e,t,o,n){let i={type:t,mode:o};const s=[new Ge(t,i.mode,Ee(e,i,((t,o)=>{const i=t.missing.map((e=>D.get(e)?.Craft.Name)).join(", ");Ne(n.missing.notify,{player:e},{missing_formated:i}),o.xMessage=n.missing.action}),(t=>{const o=n.modes[t.mode];if(!o)return Ne({mode:"chat-action",msg:`[DEBUG] error message: WGException.${t.type}.MissingDialog.${t.mode}`},{player:e}),W.interrupted;Ne(o.notify,{player:e}),t.xMessage=o.action,t.do_work=!0}))),new xe((()=>{i.do_work&&(we(e,t,i.mode),S(e))})),new xe((()=>{i.xMessage&&Ne(i.xMessage,{player:e})}))];H.global.push({description:`SetItemSequence${t}`,works:s})}function Fe(e,t){De(e,"ArousalCtrl",t,{missing:Ae,modes:{off:{notify:{mode:"chat-action",msg:"Received the instruction, the orgasm lock has been disabled"},action:{mode:"action",msg:"{player_wg}'s orgasm lock icon goes out as the command was spoken. Although her body did not feel any changes, a strange sense of freedom might be washing over her heart. Perhaps the only orgasm she wanted was the one allowed by command."}},edge:{notify:{mode:"chat-action",msg:"Received the command, the orgasm lock has been turned on, the current mode is: edge"},action:{mode:"action",msg:"An icon slowly begins to flash in {player_wg}'s field of vision. Even without the manual, one could roughly guess the meaning of the small lock icon embedded in the flashing light red heart. Perhaps, in the next second, the next touch, {player_wg} will reach the other end of the corridor. However, it seems that the end was only a short distance away."}},deny:{notify:{mode:"chat-action",msg:"Received command, orgasm lock has been turned on, current mode: deny orgasm"},action:{mode:"action",msg:"An icon slowly begins to flash in {player_wg}'s field of vision, and the heart with a small lock embedded in it splits into two halves, while the lock was still the most conspicuous. Endless pleasure does not bring endless satisfaction. Even if the belt is open and {player_wg} is allowed to masturbate or have sex, she will never be satisfied. Or is this another kind of satisfaction for her?"}}}})}function je(e,t){De(e,"HearingCtrl",t,{missing:Ae,modes:{off:{notify:{mode:"chat-action",msg:"Received command, hearing restriction has been turned off"},action:{mode:"action",msg:"The red light on {player_wg}'s headset gradually fades, leaving only a barely detectable light blue. The sounds of the world passed through the machine and hazily entered {player_wg}'s ears. Without the dead silence just now, there is no need to concentrate on reading lips, so she is able to relax a lot now, right?"}},base:{notify:{mode:"chat-action",msg:"Received command, hearing restriction has been turned on"},action:{mode:"action",msg:"The sound in {player_wg}'s ears suddenly becomes fainter and more blurred and hazy. The indicator light on her earphones lights up as a small red light. Although it is covered by {player_wg}'s hair, it could still be vaguely detected."}},total:{notify:{mode:"chat-action",msg:"Received command, hearing limit has been set to high power operation"},action:{mode:"action",msg:"{player_wg}'s headphones seem to tighten slightly, and the outside world seems to have been paused at this moment and fallen into silence. The faint light just now is now a striking red flash, as if trying to announce something, but so what? The hustle and bustle of the world is already too noisy and disturbing, maybe this can help calm down"}}}})}function Le(e,t){De(e,"VisionCtrl",t,{missing:Ae,modes:{off:{notify:{mode:"chat-action",msg:"Received command, visual restriction has been disabled"},action:{mode:"action",msg:"{player_wg}'s goggles gradually return to their original appearance, and the neural interference module becomes softer as the color changes. A little light breaks into {player_wg}'s dark world. Although it is not clear enough, it is enough to prevent her from falling to the ground and hitting obstacles. In this situation, it might be fun to play some chasing games."}},base:{notify:{mode:"chat-action",msg:"Received command, visual restriction is enabled"},action:{mode:"action",msg:"{player_wg}'s goggles flicker slightly and dim slightly. The work of the neural interference module combined with the change of the lens make {player_wg}'s vision more and more blurred."}},total:{notify:{mode:"chat-action",msg:"Received command, visual restriction set to high power operation"},action:{mode:"action",msg:"{player_wg}'s goggles are completely dark, and the power of the neural interference module increase significantly. {player_wg} is almost completely unable to see, but without vision, in the dark world, wouldn't the sense of security brought by the embrace and breath of a trusted person be more intoxicating? No longer need to see other people, and will never see other people again, maybe just a trace of residual fragrance is enough to guide the direction"}}}})}class $e extends B{constructor(e,t){super(),this.message=e,this.config=t}run(e){const t=(()=>{if(!this.config?.target)return;const e=this.config.target;return"number"==typeof e?ChatRoomCharacter.find((t=>t.MemberNumber===e)):e})();return Ne(this.message,{player:e,target:t},this.config?.args),W.finished}}class Oe extends B{constructor(e,t,o,n){super(),this.first_run=!0,this._target=z(e),this._options=t,this._last_query=0,this._timeout=o,this._then=n}run(e){this.first_run&&(this.first_run=!1,this._timeout=Date.now()+this._timeout,this._last_query=Date.now());const t=ChatRoomCharacter.find((e=>e.MemberNumber===this._target));if(!t)return W.interrupted;if(null==ChatRoomChatLog)return W.interrupted;let o="default";for(const e of ChatRoomChatLog.filter((e=>e.SenderMemberNumber===this._target&&e.Time>this._last_query))){if(this._options.accept.test(e.Original)){o="accept";break}if(this._options.reject.test(e.Original)){o="reject";break}this._last_query=Math.max(this._last_query,e.Time)}return"default"===o&&Date.now()>this._timeout&&(o="timeout"),"accept"===o&&this._options.accept_msg?(Ne(this._options.accept_msg),W.finished):"reject"===o&&this._options.reject_msg?(Ne(this._options.reject_msg),W.finished):"timeout"===o?(this._then(e,t),W.finished):W.running}}function We(e,t){null!==CurrentCharacter&&(CurrentCharacter.FocusGroup=null),CurrentCharacter=null,"Preference"===CurrentScreen&&CommonSetScreen("Character","InformationSheet"),"ChatAdmin"===CurrentScreen&&CommonSetScreen("Online","ChatRoom"),"InformationSheet"===CurrentScreen&&InformationSheetPreviousModule&&CommonSetScreen(InformationSheetPreviousModule,InformationSheetPreviousScreen);let o=ElementValue("InputChat");(function(e){return e.trim().length>0&&!e.startsWith("/")&&!e.startsWith("(")&&!e.startsWith("*")})(o)&&function(e,t){e&&(ElementValue("InputChat",e+"... "+t),ChatRoomSendChat())}(o,"");const n=e.MemberNumber;if(!n)return;const i=[{Tag:"DestinationCharacterName",Text:CharacterNickname(e),MemberNumber:n},{Tag:"AssetName",AssetName:t?.Asset.Name,GroupName:t?.Asset.Group.Name},{ShockIntensity:3},{FocusGroupName:t?.Asset.Group.Name},{Automatic:!0}];"ChatRoom"==CurrentScreen&&ChatRoomMessage({Content:"TriggerShock2",Type:"Action",Sender:n,Dictionary:i}),InventoryShockExpression(e)}class qe extends B{constructor(e){super(),this.first_run=!1,this._timer=e}run(e){if(this.first_run||(this.first_run=!0,this._timer=Date.now()+this._timer),!qe.punish_flag)return W.finished;const t=InventoryGet(e,"ItemNeck");return t?(We(e,t),Date.now()>this._timer?W.finished:W.running):W.interrupted}}qe.punish_flag=!1;class Be extends B{run(e){const t=e.Appearance.filter((e=>e.Asset.Group.Name.startsWith("Item"))),o=t[Math.floor(Math.random()*t.length)];return D.get(o.Asset.Group.Name)&&We(e,o),W.finished}}function He(e,t){const o={modes:{off:{notify:{mode:"chat-action",msg:"Received command, arm restraints are disabled"},action:{mode:"action",msg:"The energy beams between the cuffs on {player_wg}'s arms gradually extinguish, and the neural interference module also shuts down the control of the arm. The nanomachines on the gloves return to their original positions with a slight vibration, releasing {player_wg}'s arms and hands. Is it really freedom, or is it just a momentary illusion?"}},base:{notify:{mode:"chat-action",msg:"Received command, arm restraints have been enabled"},action:{mode:"action",msg:"The handcuffs on {player_wg}'s arms begin to attract each other, and the coordination between the electrical stimulation system and the neural interference module made the force of the handcuffs tightening. {player_wg} was always slightly greater than her thoughts of struggling and resisting, so she can only watch her arms and fingers being gradually gathered and connected."}},total:{notify:{mode:"chat-action",msg:"Received command, arm restraints have been set to the strongest mode"},action:{mode:"action",msg:"The cuffs on {player_wg}'s arms suddenly tighten, and the unquestionable force even makes {player_wg} feel a little pain. She even ignored the nanomachines on the gloves that tighten and press her fists a little bit. The tight closure of her arms and the squeezing of her fingers and palms, or perhaps for {player_wg}'s heart, was this a better situation?"}}}},n="HandsCtrl";let i={type:n,mode:t};const s=t=>{Ne(ve,{player:e},{missing_formated:t.missing.map((e=>D.get(e)?.Craft.Name)).join(", ")}),i.xMessage=Ae.action},a=t=>{Ne(ke,{player:e},{missing_formated:t.missing.map((e=>D.get(e)?.Craft.Name)).join(", ")}),i.xMessage={mode:"action",msg:"{player_wg}'s central control core beeps a little, and then the fingers of the glove slowly deform and tighten, causing her hands to curl into two balls of flesh that could not be grasped."},i.mode="total",i.do_work=!0},r=t=>{Ne(ke,{player:e},{missing_formated:t.missing.map((e=>D.get(e)?.Craft.Name)).join(", ")}),i.xMessage={mode:"action",msg:"The cuffs on {player_wg}'s arms are quickly tightened with a punishing force, tightening {player_wg}'s arms, which would obviously cause sufficient and lasting pain."},i.mode="total",i.do_work=!0},c=t=>{Ne(_e,{player:e},{missing_formated:t.missing.map((e=>D.get(e)?.Craft.Name)).join(", ")}),i.xMessage=Ae.action},l=o=>{const s=o.missing.map((e=>D.get(e)?.Craft.Name)).join(", ");if(Y(e,"ItemVulva"))return Ne(_e,{player:e},{missing_formated:s}),void(i.xMessage=Ae.action);if(Z(e).size>=5){const t=[new $e({mode:"chat-action",msg:"Received command, arm restraints are disabled"}),new xe((()=>Ne(ke,{player:e},{missing_formated:s}))),new $e({mode:"chat-action",msg:"Received the instruction, arms limit limit limit limit limit limit limit....."}),new $e({mode:"action",msg:"{player_wg}'s central control core emits a sharp and continuous beeping sound, but soon returns to silence."}),new $e({mode:"action",msg:Te(ve.msg,.5)}),new Be,new $e({mode:"action",msg:Te(ve.msg,.9)}),new Be,new Me(1e3),new Be,new Me(1e3),new Be,new $e({mode:"action",msg:"{player_wg}'s central control core once again emits a sharp sound, but soon returns to silence again."}),new $e({mode:"chat-action",msg:"An error in the execution of a command was detected, and the execution of the command has been terminated and retried."})];return H.global.insert_after_first({description:`SetItemSequence${n}`,works:t}),W.interrupted}Ne({mode:"chat-action",msg:"Received command, arm restraints are disabled"},{player:e}),t="off",i.do_work=!0},h=[new Ge(n,t,Ee(e,i,((e,o)=>2===e.missing.length?s(e):"off"===t?l(e):Math.random()<.5?c(e):e.missing.includes("ItemArms")?a(e):e.missing.includes("ItemHands")?r(e):void 0),(n=>{const i=o.modes[t];if(!i)return Ne({mode:"chat-action",msg:`[DEBUG] error message: WGException.${n.type}.MissingDialog.${n.mode}`},{player:e}),W.interrupted;Ne(i.notify,{player:e}),n.xMessage=i.action,n.do_work=!0}))),new xe((()=>{i.do_work&&(we(e,n,i.mode),S(e))})),new xe((()=>{i.xMessage&&Ne(i.xMessage,{player:e})}))];H.global.push({description:`SetItemSequence${n}`,works:h})}function Ve(e,t){const o={modes:{off:{notify:{mode:"chat-action",msg:"Received instruction, walking restriction has been turned off"},action:{mode:"action",msg:"The indicator lights on the limb action controllers on {player_wg}'s legs slowly turn off. Her legs, now free of any movement restrictions, might be able to stretch out for the first time in a long time. But don't worry, she won't be able to run away."}},base:{notify:{mode:"chat-action",msg:"Received instruction, walking restriction has been enabled"},action:{mode:"action",msg:"{player_wg}'s leg motion controller is activated again, making {player_wg} feel the familiar weakness of the leg muscles and the slowness and restriction of the stiff joints. The energy beams between the cuffs announc that {player_wg} is currently in a restricted state, but it seems that she has difficulty taking a step without the energy beam connection."}},total:{notify:{mode:"chat-action",msg:"Received the instruction, the walking restriction has been set to the strongest restriction mode"},action:{mode:"action",msg:"{player_wg}'s leg rings are suddenly tightened, without much time to react. Fortunately, the motion posture stabilization system interves in time to prevent {player_wg} from falling to the ground in pain and distress. However, it is only a matter of time before she is pushed down after losing the ability to walk. Who would have thought that {player_wg}, who was standing quietly and with a dignified posture, could not even take the simplest step?"}}}},n="FeetCtrl";let i={type:n,mode:t};const s=[new Ge(n,t,Ee(e,i,((o,i)=>3===o.missing.length?((t,o)=>{const n=t.missing.map((e=>D.get(e)?.Craft.Name)).join(", ");Ne(ve,{player:e},{missing_formated:n}),o.xMessage=Ae.action})(o,i):"off"===t?((t,o)=>{const i=t.missing.map((e=>D.get(e)?.Craft.Name)).join(", ");if(Y(e,"ItemVulva"))return Ne(_e,{player:e},{missing_formated:i}),void(o.xMessage=Ae.action);if(Z(e).size>=5){const t=[new $e({mode:"chat-action",msg:"Received instruction, walking restriction has been disabled"}),new xe((()=>Ne(ke,{player:e},{missing_formated:i}))),new $e({mode:"chat-action",msg:"Received the instruction, walking limit limit limit limit limit limit limit limit....."}),new $e({mode:"action",msg:"{player_wg}'s central control core emits a sharp and continuous beeping sound, but soon returns to silence."}),new $e({mode:"action",msg:Te(ve.msg,.5)}),new Be,new $e({mode:"action",msg:Te(ve.msg,.9)}),new Be,new Me(1e3),new Be,new Me(1e3),new Be,new $e({mode:"action",msg:"{player_wg}'s central control core once again emits a sharp sound, but soon returns to silence."}),new $e({mode:"chat-action",msg:"An error in the execution of a command was detected, and the execution of the command has been terminated and retried."})];return H.global.insert_after_first({description:`SetItemSequence${n}`,works:t}),W.interrupted}Ne({mode:"chat-action",msg:"Received instruction, walking restriction has been disabled"},{player:e}),o.mode="off",o.do_work=!0})(o,i):Math.random()<.5?((t,o)=>{const n=t.missing.map((e=>D.get(e)?.Craft.Name)).join(", ");Ne(_e,{player:e},{missing_formated:n}),o.xMessage=Ae.action})(o,i):1===o.missing.length?((t,o)=>{const n=t.missing.map((e=>D.get(e)?.Craft.Name)).join(", ");Ne(ke,{player:e},{missing_formated:n}),o.xMessage={mode:"action",msg:"{player_wg}'s limb motion controller starts up with a small error beep from the central control core. She closes her legs and tries to maintain her position and balance as much as possible. However, due to the abnormal configuration parameters of the motion controller, she can only move slowly."},o.mode="base",o.do_work=!0})(o,i):2===o.missing.length?((t,o)=>{const n=t.missing.map((e=>D.get(e)?.Craft.Name)).join(", ");Ne(_e,{player:e},{missing_formated:n}),o.xMessage={mode:"action",msg:"{player_wg}'s body movement controller flashes a few times in rhythm with the central control core's error beep. Apart from that, nothing happens."}})(o,i):void 0),(n=>{const i=o.modes[t];if(!i)return Ne({mode:"chat-action",msg:`[DEBUG] error message: WGException.${n.type}.MissingDialog.${n.mode}`},{player:e}),W.interrupted;Ne(i.notify,{player:e}),n.xMessage=i.action,n.do_work=!0}))),new xe((()=>{i.do_work&&(we(e,n,i.mode),S(e))})),new xe((()=>{i.xMessage&&Ne(i.xMessage,{player:e})}))];H.global.push({description:`SetItemSequence${n}`,works:s})}function ze(e,t){De(e,"VoiceCtrl",t,{missing:Ae,modes:{off:{notify:{mode:"chat-action",msg:"Received instruction, language restriction has been disabled"},action:{mode:"action",msg:"{player_wg}'s smart gag makes a small hissing sound and slowly shrinks while the original built-in grooves reappear. Although it slightly reduces the sound of the words, at least one can clearly hear what {player_wg} wants to say. Shouldn't she say thank you?"}},base:{notify:{mode:"chat-action",msg:"Received instruction, language restriction is enabled"},action:{mode:"action",msg:"{player_wg}'s gag vibrates slightly, and a small light on the gag's strap lights up, then slowly begins to expand. Although it slightly hinderes the pronunciation of the lips and tongue, she is still able to roughly express her wishes."}},total:{notify:{mode:"chat-action",msg:"Received instruction, language restriction has been set to the strongest restriction mode"},action:{mode:"action",msg:"{player_wg}'s gag continues to swell, and all the indicator lights on the straps light up. The expanded latex not only presses down her tender tongue, but also penetrates into her throat little by little, filling her mouth. The neural interference module suppresses the reflexive retching and coughing at the right time. Well, making a whining sound through the nose is indeed what wolves do when their mouths are restrained. Isn't this perfect?"}}}})}class Ue{constructor(e){this.parent=e,this.moderators=new Set(this.parent.data.permission.moderators)}save(){this.parent.save("permission")}setLoverMode(e){this.parent.data.permission.loverModerators=e,this.save()}setModerator(e,t){t?this.moderators.has(e)||(this.moderators.add(e),this.parent.data.permission.moderators.push(e),this.save()):this.moderators.has(e)&&(this.moderators.delete(e),this.parent.data.permission.moderators=Array.from(this.moderators),this.save())}get data(){return this.parent.data.permission}isCommandAuthorized(e,t){const o=z(t);return!!this.isEILNet(t)||(!!this.isOwner(t,e)||(!!this.isAdditionModerator(o)||!(!this.parent.data.permission.loverModerators||!this.isLover(t,e))))}isEILNet(e){const t=z(e);return V.Access.isEIL(t)}isLover(e,t){const o=z(e);return!(!t.Lovership||!t.Lovership.some((e=>e.MemberNumber===o)))}isOwner(e,t){const o=z(e);return!(!t.Ownership||t.Ownership.MemberNumber!==o)}isAdditionModerator(e){const t=z(e);return this.moderators.has(t)}}class Ke{constructor(e){this.parent=e,this._items=new Map(e.data.outfit.items.map((e=>[e.asset.group,e]))),this._color_store=new Map(e.data.outfit.color_store.map((e=>[e.group,e])))}save(){this.parent.save("outfit")}get data(){return this.parent.data.outfit}get lite_mode(){return this.data.lite_mode}set lite_mode(e){this.data.lite_mode=e,this.save()}add(e){Array.isArray(e)?e.forEach((e=>this._items.set(e.asset.group,e))):this._items.set(e.asset.group,e),this.data.items=[...this._items.values()],this.save()}get items(){return this._items}set items(e){Array.isArray(e)?(this.data.items=e,this._items=new Map(e.map((e=>[e.asset.group,e])))):(this.data.items=[...e.values()],this._items=e),this.save()}get color_store(){return this._color_store}set color_store(e){Array.isArray(e)?(this.data.color_store=e,this._color_store=new Map(e.map((e=>[e.group,e])))):(this.data.color_store=[...e.values()],this._color_store=e),this.save()}}function Je(e){return!!Array.isArray(e)&&e.every((e=>"string"==typeof e))}function Ye(e){const t={outfit:{lite_mode:!1,items:[],color_store:[]},permission:{moderators:[],loverModerators:!0},settings:{orgasmPunishMode:0},stat:{script_run_time:0,wolfgirl_time:0,stash_time:0,last_fix_time:0,task:{finished:0,failed:0,counter:{}}},points:{current:0,punish_time:3e5,task_time:9e5,orgasm_punish_time:3e5},arousal:{orgasm:0,ruined:0,resist:0,edge_time:0}},o=e,n={};return n.outfit=(e=>{const o=t.outfit;if(void 0===e)return o;if("boolean"==typeof e.lite_mode&&(o.lite_mode=e.lite_mode),Array.isArray(e.items)){let t=[];for(const o of e.items){if("object"!=typeof o)continue;const e=o;"object"==typeof e.asset&&("string"==typeof e.asset.name&&"string"==typeof e.asset.group&&("string"==typeof e.color||Je(e.color))&&"object"==typeof e.property&&t.push(e))}o.items=t}if(Array.isArray(e.color_store)){let t=[];for(const o of e.color_store){if("object"!=typeof o)continue;const e=o;"string"==typeof e.asset&&("string"==typeof e.group&&("string"==typeof e.color||Je(e.color))&&t.push(e))}o.color_store=t}return o})(o.outfit),n.permission=(e=>{const o=t.permission;return void 0===e||(function(e){return!!Array.isArray(e)&&e.every((e=>"number"==typeof e))}(e.moderators)&&(o.moderators=e.moderators),"boolean"==typeof e.loverModerators&&(o.loverModerators=e.loverModerators)),o})(o.permission),n.settings=(e=>{const o=t.settings;return void 0===e||"number"==typeof e.orgasmPunishMode&&(o.orgasmPunishMode=e.orgasmPunishMode),o})(o.settings),n.stat=(e=>{const o=t.stat;if(void 0===e)return o;if("number"==typeof e.script_run_time&&(o.script_run_time=e.script_run_time),"number"==typeof e.wolfgirl_time&&(o.wolfgirl_time=e.wolfgirl_time),"number"==typeof e.stash_time&&(o.stash_time=e.stash_time),"number"==typeof e.last_fix_time&&(o.last_fix_time=e.last_fix_time),"object"==typeof e.task){const o=t.stat.task;if("number"==typeof e.task.finished&&(o.finished=e.task.finished),"number"==typeof e.task.failed&&(o.failed=e.task.failed),"object"==typeof e.task.counter){const o=t.stat.task.counter;for(const t in e.task.counter)"number"==typeof e.task.counter[t]&&(o[t]=e.task.counter[t])}}return o})(o.stat),n.points=(e=>{const o=t.points;return void 0===e||("number"==typeof e.current&&(o.current=e.current),"number"==typeof e.punish_time&&(o.punish_time=e.punish_time),"number"==typeof e.task_time&&(o.task_time=e.task_time),"number"==typeof e.orgasm_punish_time&&(o.orgasm_punish_time=e.orgasm_punish_time)),o})(o.points),n.arousal=(e=>{const o=t.arousal;return void 0===e||("number"==typeof e.orgasm&&(o.orgasm=e.orgasm),"number"==typeof e.ruined&&(o.ruined=e.ruined),"number"==typeof e.resist&&(o.resist=e.resist),"number"==typeof e.edge_time&&(o.edge_time=e.edge_time)),o})(o.arousal),n}class Ze{constructor(e){this.parent=e}save(){this.parent.save("points")}get data(){return this.parent.data.points}get points(){return this.parent.data.points.current}set points(e){this.parent.data.points.current=e,this.save()}get punish_time(){return this.parent.data.points.punish_time}set punish_time(e){this.parent.data.points.punish_time=e,this.save()}get orgasm_punish_time(){return this.parent.data.points.orgasm_punish_time}set orgasm_punish_time(e){this.parent.data.points.orgasm_punish_time=e,this.save()}get task_time(){return this.parent.data.points.task_time}set task_time(e){this.parent.data.points.task_time=e,this.save()}use_points(e){return{then:(t,o)=>{this.points<e?o&&o(this.points):(this.points-=e,t(this.points))}}}}class Qe{constructor(e){this.parent=e}save(){this.parent.save("arousal")}get data(){return this.parent.data.arousal}get ruined(){return this.data.ruined}set ruined(e){this.data.ruined=e,this.save()}get orgasm(){return this.data.orgasm}set orgasm(e){this.data.orgasm=e,this.save()}get resist(){return this.data.resist}set resist(e){this.data.resist=e,this.save()}setMonitor(e,t){const o=(t,o)=>{e(t)&&o()};t.onOrgasm((e=>o(e,(()=>this.orgasm+=1)))),t.onResist((e=>o(e,(()=>this.resist+=1)))),t.onRuined((e=>o(e,(()=>this.ruined+=1))))}}class Xe{constructor(e){this.parent=e,this.add_time_counter=0}save(){this.parent.save("stat")}add_counter(e,t){const o=this.parent.data.stat.task.counter;void 0===o[e]?o[e]=t:o[e]+=t,this.save()}task_finished(e){e?this.parent.data.stat.task.finished++:this.parent.data.stat.task.failed++,this.save()}add_time(e,t,o){this.parent.data.stat.script_run_time+=o,e&&(this.parent.data.stat.wolfgirl_time+=o),t&&(this.parent.data.stat.stash_time+=o),this.add_time_counter++>10&&(this.save(),this.add_time_counter=0)}set_last_fix_time(e){this.parent.data.stat.last_fix_time=e,this.save()}}const et={outfit:"Default",permission:"Default",stat:"Frequent",settings:"Default",points:"Default",arousal:"Frequent"};function tt(e){return"Frequent"===et[e]}function ot(e){return"Default"===et[e]}function nt(e){return Ye(e.reduce(((e,t)=>{if(!t)return e;let o=LZString.decompressFromBase64(t);if(!o)return e;try{let t=JSON.parse(o);return Object.assign(e,t)}catch{return e}}),{}))}function it(e){return LZString.compressToBase64(JSON.stringify(e))}class st{constructor(e){this._data=e}query(e){return this._data.data.settings[e]}update(e,t){this._data.data.settings[e]=t,this._data.save("settings")}}const at="BCWolfGrilData",rt="BCWolfGrilFrequentData";function ct(e,t){Player&&Player.ExtensionSettings&&((void 0===t||ot(t))&&(Player.ExtensionSettings[r]=it(function(e){return Object.keys(et).reduce(((t,o)=>(ot(o)&&Object.assign(t,{[o]:e[o]}),t)),{})}(e)),ServerPlayerExtensionSettingsSync(r)),(void 0===t||tt(t))&&(Player.ExtensionSettings[a]=it(function(e){return Object.keys(et).reduce(((t,o)=>(tt(o)&&Object.assign(t,{[o]:e[o]}),t)),{})}(e)),ServerPlayerExtensionSettingsSync(a)))}class lt{constructor(e){this.data=e,this._permission=new Ue(this),this._outfit=new Ke(this),this._points=new Ze(this),this._arousal=new Qe(this),this._stat=new Xe(this),this._setting=new st(this)}save(e){ct(this.data,e)}static get instance(){return this._instance}static get permission(){return this.instance._permission}static get outfit(){return this.instance._outfit}static get points(){return this.instance._points}static get arousal(){return this.instance._arousal}static get statistics(){return this.instance._stat}static get settings(){return this.instance._setting}static init(e,t){return new Promise((o=>{const n=n=>{if(!this._instance&&n){const i=function(e,t){const o=e.ExtensionSettings[at],n=e.ExtensionSettings[rt];if(o||n){const i=nt([o,n]);return delete e.ExtensionSettings[at],delete e.ExtensionSettings[rt],e.ExtensionSettings[r]=o,e.ExtensionSettings[a]=n,t.callOriginal("ServerSend",["AccountUpdate",{ExtensionSettings:e.ExtensionSettings}]),i}return nt([e.ExtensionSettings[r],e.ExtensionSettings[a]])}(n,e);this._instance=new lt(i),t&&console.log(t),o(this._instance)}};e.hookFunction("LoginResponse",1,((e,t)=>{t(e),n(Player)})),Player&&Player.MemberNumber&&n(Player)}))}}lt._instance=void 0;const ht=(e,t)=>("number"!=typeof t?t.MemberNumber:t)===e.MemberNumber,mt=(e,t)=>!!lt.permission.isCommandAuthorized(e,t),dt=(...e)=>(t,o)=>e.every((e=>e(t,o))),ut=e=>(t,o)=>!e(t,o),pt=dt(ut(ht),le,mt),gt=dt(ut(ht),mt),ft=dt(ht,le),yt=dt(((...e)=>(t,o)=>e.some((e=>e(t,o))))(ht,mt),le),wt=[{match:/^((关闭|基础|完全)听觉限制)|(hearing limitation (off|basic|full))/i,prerequisite:pt,run(e,t,o){je(e,"关闭"===o[2]||"off"===o[4].toLowerCase()?"off":"基础"===o[2]||"basic"===o[4].toLowerCase()?"base":("完全"===o[2]||o[4].toLowerCase(),"total"))}},{match:/^((关闭|基础|完全)视觉限制)|(visual restrictions (off|basic|full))/i,prerequisite:pt,run(e,t,o){Le(e,"关闭"===o[2]||"off"===o[4].toLowerCase()?"off":"基础"===o[2]||"basic"===o[4].toLowerCase()?"base":("完全"===o[2]||o[4].toLowerCase(),"total"))}},{match:/^((关闭|基础|完全)语言限制)|(language restrictions (off|basic|full))/i,prerequisite:pt,run(e,t,o){ze(e,"关闭"===o[2]||"off"===o[4].toLowerCase()?"off":"基础"===o[2]||"basic"===o[4].toLowerCase()?"base":("完全"===o[2]||o[4].toLowerCase(),"total"))}},{match:/^((关闭|基础|完全)手臂限制)|(arm restraint (off|basic|full))/i,prerequisite:pt,run(e,t,o){He(e,"关闭"===o[2]||"off"===o[4].toLowerCase()?"off":"基础"===o[2]||"basic"===o[4].toLowerCase()?"base":("完全"===o[2]||o[4].toLowerCase(),"total"))}},{match:/^((关闭|基础|完全)行走限制)|(leg restraint (off|basic|full))/i,prerequisite:pt,run(e,t,o){Ve(e,"关闭"===o[2]||"off"===o[4].toLowerCase()?"off":"基础"===o[2]||"basic"===o[4].toLowerCase()?"base":("完全"===o[2]||o[4].toLowerCase(),"total"))}},{match:/^((关闭|寸止|拒绝)高潮锁)|(orgasm lock (off|edge|deny))/i,prerequisite:pt,run(e,t,o){Fe(e,"关闭"===o[2]||"off"===o[4].toLowerCase()?"off":"寸止"===o[2]||"edge"===o[4].toLowerCase()?"edge":"拒绝"===o[2]||"deny"===o[4].toLowerCase()?"deny":"off")}},{match:/^((关闭|打开|最大)振动器)|(vibrator (off|on|max))/i,prerequisite:pt,run(e,t,o){!function(e,t){const o={missing:Ae,modes:{off:{notify:{mode:"chat-action",msg:"Received command, vibrator turned off"},action:{mode:"action",msg:"All the vibrators on {player_wg}'s body suddenly stop. Maybe she has a little chance to relax. Is she tired? One wonders if {player_wg} is dissatisfied with the current silence after the previous waves of pleasure?"}},open:{notify:{mode:"chat-action",msg:"Received command, vibrator turned on"},action:{mode:"action",msg:"{player_wg}'s vibrators begin to vibrate slightly. Although it is not strong enough, it is enough to slowly push her towards orgasm. There is not much buzzing sound at this power, so there is no need to worry about being discovered. Of course, if she can orgasm is hard to say."}},max:{notify:{mode:"chat-action",msg:"Received command, the vibrator has been set to maximum power mode"},action:{mode:"action",msg:"The vibrators on {player_wg}'s body suddenly emit a clear buzzing sound. Even with the barrier of body and clothes, it is clearly audible if one gets a little closer. However, {player_wg} obviously doesn't have much energy to pay attention to this. After all, wave after wave of pleasure wash over her brain, erasing her reason and thoughts bit by bit."}}}},n="ToysCtrl";let i={type:n,mode:t};const s=[new Ge(n,t,Ee(e,i,((t,n)=>{const i=t.missing.map((e=>D.get(e)?.Craft.Name)).join(", ");t.missing.includes("ItemVulva")?(Ne(o.missing.notify,{player:e},{missing_formated:i}),n.xMessage=o.missing.action):(Ne(o.missing.notify,{player:e},{missing_formated:i}),n.xMessage={mode:"action",msg:"Although {player_wg}'s vibrator indicates that it had been set up successfully, judging by the sound, something has clearly gone wrong. The humming sound of the vibrations is like the ups and downs of the sea in a storm, as if it is toying with {player_wg}, as if this mistake has been made intentionally and carelessly."},n.mode="random",n.do_work=!0)}),(n=>{const i=o.modes[t];if(!i)return Ne({mode:"chat-action",msg:`[DEBUG] error message: WGException.${n.type}.MissingDialog.${n.mode}`},{player:e}),W.interrupted;Ne(i.notify,{player:e}),n.xMessage=i.action,n.do_work=!0}))),new xe((()=>{i.do_work&&(we(e,n,i.mode),S(e))})),new xe((()=>{i.xMessage&&Ne(i.xMessage,{player:e})}))];H.global.push({description:`SetItemSequence${n}`,works:s})}(e,"关闭"===o[2]||"off"===o[4].toLowerCase()?"off":"打开"===o[2]||"on"===o[4].toLowerCase()?"open":("最大"===o[2]||o[4].toLowerCase(),"max"))}},{match:/^((关闭|打开)公开操作权限)|(public operation permissions (close|open))/i,prerequisite:pt,run(e,t,o){!function(e,t){De(e,"FuturisticPublicCtrl",t,{missing:Ae,modes:{close:{notify:{mode:"chat-action",msg:"Received instruction, public operation permission has been disabled"},action:{mode:"action",msg:"The public operation panel on the collar gradually goes out. It was a pity that it can't be played with by others anymore. If {player_wg} wants something, maybe it would be better to ask her master and lovers now..."}},open:{notify:{mode:"chat-action",msg:"Received instructions, public operation permissions have been enabled"},action:{mode:"action",msg:"The public operation panel on {player_wg}'s collar lights up immediately, projecting small operation panels all over her body so that anyone can play with her body at any time. Perhaps if she serves well, a kind-hearted person would allow {player_wg} to gain a brief freedom?"}}}})}(e,"关闭"===o[2]||"close"===o[4].toLowerCase()?"close":("打开"===o[2]||o[4].toLowerCase(),"open"))}}];function bt(e){return void 0!==e.target}class vt extends B{constructor(e,t,o){super(),this.acting=e,this.message=o,this._target=t.map((e=>{return"string"==typeof e?{target:D.get(e)}:bt(t=e)&&"string"!=typeof t.target?e:function(e){return bt(e)&&"string"==typeof e.target}(e)?{...e,target:D.get(e.target)}:{target:e};var t}))}run(e){const t=O(e);V.Access.craft;let o=this._target.reduce(((e,o)=>{const n=t.get(o.target.Asset.Group);return n?K(n,o.target)||(n.Property&&n.Property.Effect?.includes("Lock")?e.blocked.push(o):e.canRepair.push(o)):e.canRepair.push(o),e}),{canRepair:[],blocked:[]});const n=o.blocked.map((e=>e.target.Asset.Group)).map((e=>t.get(e).Asset.Description)).join(", "),i=t=>{return o=this.message?.(t),o&&Ne(o,{player:e},{locked_items:n});var o};if(o.blocked.length>0)return i({ret:"blocked",blocked:o.blocked.map((e=>e.target.Asset.Group))}),W.interrupted;if(0===o.canRepair.length)return i({ret:"passed"}),W.finished;const s=lt.outfit.color_store,a=Q(this.acting,e);return X.instance.on=!0,e.Appearance=e.Appearance.concat(o.canRepair.map((o=>{const n=t.get(o.target.Asset.Group),i=U(this.acting,e,o.target);if(!i)return;const r=s.get(o.target.Asset.Group);if(r&&r.asset===i.Asset.Name&&(i.Color=r.color),o.option&&ExtendedItemSetOptionByRecord(e,i,o.option),void 0===i?.Property?.LockedBy&&InventoryLock(e,i,a,e.MemberNumber),i.Property||(i.Property={}),o.property&&Object.assign(i.Property,o.property),!n)return i;Object.assign(n,i)})).filter((e=>void 0!==e))),X.instance.on=!1,S(e),i({ret:"canfix",counter:o.canRepair.length}),W.finished}}function _t(e,t){k.instance.LocalInfo(">> Connecting to Wolf Girl network..."),V.force_fetch().then((o=>{const n=[new $e({mode:"local-status",msg:"   ...connected to the Wolf Girl network"}),new $e({mode:"local-status",msg:">> Permission check starts"}),new $e({mode:"local-status",msg:"   EIL Network Administrator: "+(lt.permission.isEILNet(e)?"passed":"Failed")}),new $e({mode:"local-status",msg:"   Lover permissions: "+(lt.permission.isLover(e,t)?"passed":"Failed")}),new $e({mode:"local-status",msg:"   Owner permissions: "+(lt.permission.isOwner(e,t)?"passed":"Failed")}),new Pe((e=>[lt.permission.isEILNet(e),lt.permission.isLover(e,t),lt.permission.isOwner(e,t)].some((e=>e))?Pe.Accepted:Pe.Rejected),((e,t)=>t.passed?{mode:"local-status",msg:"   The permission check passes and the installation process starts"}:{mode:"local-status",msg:"   The command has been rejected, aborting the installation process"})),new xe((()=>{!function(e,t,o){const n=[];e.craft;const i=[new Pe((e=>re(o)?Pe.Stop:Pe.Continue),((e,t)=>{if(t.passed)return Ce})),new $e({mode:"chat-action",msg:"Target selected, wolf girl identity chip detected, remote device connection opening"}),new Me(5e3),new $e({mode:"chat-action",msg:"Remote connection activated, deploying portable wolf girl training facility maintenance pod"}),new $e({mode:"action",msg:"{player} openes a small partition on the side of her glasses, and an auxiliary positioning beacon floats out and soon hovers behind {target}"},{target:o}),new Me(5e3),new $e({mode:"action",msg:"There seems to be some small ripples in the space, and with a small cyclone, a complex maintenance cabin filled with exquisite equipment appears behind {target}, and several mechanical arms stretch out from it and pull her into the maintenance cabin."},{target:o}),new ee([F],o),new Me(5e3),new $e({mode:"chat-action",msg:"Target detected, maintenance bay secured and locked. Scanning size and collecting data"}),new te(o,[{target:F.Asset.Group,option:{w:1,l:2,a:1,d:0,t:0,h:4}}]),new Me(5e3),new $e({mode:"action",msg:"Confirmed trainer is {player}, confirmed training kit installation target is {target}"},{target:o}),new $e({mode:"chat-action",msg:"After collecting the body information, start installing the training components"}),new $e({mode:"chat-action",msg:"Clothes are being removed. Please close your eyes and hold your breath."}),new Me(5e3),new $e({mode:"action",msg:"A mechanical arm extends from the top of the equipment compartment, surrounding {target}'s body and spraying solvent. Soon, {target}'s clothes melt bit by bit, and the dissolved clothes flow down along the body to the bottom of the maintenance compartment and are discharged."},{target:o}),new ne(o,n),new Me(5e3),new $e({mode:"chat-action",msg:"Confirmed that the clothes have been cleaned"}),new $e({mode:"action",msg:"Several mechanical arms extend from the upper and lower parts of the maintenance cabin, take the limbs of {target} from the cabin's fixing system, and stretch them out forcefully."},{target:o}),new te(o,[{target:F.Asset.Group,option:{w:1,l:3,a:3,d:0,t:0,h:4}}]),new Me(5e3),new $e({mode:"chat-action",msg:"{target}, are you willing to be trained to be a wolf girl? Please answer with yes or no. If yes, does it mean that you will lose enough but still retain a little autonomy, or does it mean gaining and owning for you?"},{target:o}),new $e({mode:"chat-action",msg:"Please answer yes or no. Of course, remaining silent and refusing to answer is also an option."}),new Oe(o,{accept:/^(?!.*no).*/g,accept_msg:{mode:"chat-action",msg:"Willingness confirmed, installation process continuing"},reject:/No/g,reject_msg:{mode:"action",msg:"Regardless of the answer, the maintenance cabin is still faithfully executing the program and continuing the installation process."}},15e3,((e,t)=>{Ne({mode:"action",msg:"The reply waiting time has timed out, it is considered as default and the next installation process is in progress"},{player:e,target:t})})),new Me(5e3),new $e({mode:"action",msg:"With the help of the mechanical arm, several delicate cuffs are installed on {target}. The small mechanical locking sound is faint but clearly audible."},{target:o}),...["ItemArms","ItemFeet","ItemLegs"].map((e=>new ee([e],o))),new Me(5e3),new $e({mode:"chat-action",msg:"Restrain self-examination"}),new Me(5e3),new $e({mode:"action",msg:"The cuffs on {target} vibrate slightly, and a small lock icon lights up."},{target:o}),new se(["ItemArms","ItemFeet","ItemLegs"],o),new $e({mode:"chat-action",msg:"Confirmed to be installed in place and locked"}),new Me(5e3),new $e({mode:"action",msg:"Two more sophisticated robotic arms extend from both sides and gently pinch {target}'s nipples."},{target:o}),new $e({mode:"action",msg:"It seems to be just a cold touch, followed by a tight feeling and pulling force that makes {target} realize that a prop has been installed on her nipple."},{target:o}),new ee(["ItemNipplesPiercings","ItemNipples"],o),new $e({mode:"chat-action",msg:"Confirmed that the components are installed properly"}),new Me(5e3),new $e({mode:"action",msg:"The robot arm lets go of {target}'s nipple, move down little by little, and stop at {target}'s lower abdomen. The robot arm gently separates the labia and foreskin, exposing the tender clitoris"},{target:o}),new $e({mode:"action",msg:"The pleasure brought by the tightness on the clitoris is obviously more obvious, and at the same time, the pleasure brought by the sudden fullness in the vagina and the back hole is in contrast, making {target}'s body unconsciously twist slightly in the restraint of the maintenance cabin"},{target:o}),new ee(["ItemVulvaPiercings","ItemVulva","ItemButt"],o),new $e({mode:"chat-action",msg:"Restrain self-examination"}),new Me(5e3),new $e({mode:"action",msg:"A small vibration brings {target} some insignificant pleasure, and then a beeping sound indicates that the locking is completed sounds. What does this mean?"},{target:o}),new se(["ItemVulvaPiercings","ItemVulva","ItemButt","ItemNipplesPiercings"],o),new $e({mode:"chat-action",msg:"Confirmed to be installed in place and locked"}),new $e({mode:"action",msg:"Just like the automated maintenance corridor outside Tony Stark's building in New York, the robotic arms lifts up several armor-like equipments. The equipments have been preheated long ago, so hopefully they will not bring chill to {target}, maybe?"},{target:o}),new $e({mode:"action",msg:"The chest, torso, and hips are covered with warmth, accompanied by the subtle vibrations of the mechanical combination. It seems that it was just a set of extremely close-fitting and comfortable underwear that was put on the body in this way."},{target:o}),new ee(["ItemBreast","ItemPelvis","ItemTorso","ItemTorso2"],o),new Me(5e3),new $e({mode:"chat-action",msg:"Restrain self-examination"}),new Me(5e3),new $e({mode:"action",msg:"The beeping sound rings out again, and the number of lock icons displayed on {target} increase. Is it announcing loss or possession?"},{target:o}),new se(["ItemBreast","ItemPelvis","ItemTorso","ItemTorso2"],o),new $e({mode:"chat-action",msg:"Confirmed to be installed in place and locked"}),new Me(5e3),new $e({mode:"action",msg:"A barrel-shaped structure connected to several sophisticated devices slowly decend and cover {target}'s head. The brief bright light and loud noise make {target} close her eyes."},{target:o}),new ee(["ItemEars","ItemHead"],o),new $e({mode:"action",msg:"After the brief trance and dizziness ends, {target} does not have much time to notice the new equipment in front of her eyes and ears, because the mechanical claws gently pinch her nose, forcing her to open her mouth to breathe."},{target:o}),new $e({mode:"action",msg:"But it is obviously a conspiracy of the maintenance cabin, because soon a ball gag is stuffed into her mouth, and the mouthpiece and accessories follow."},{target:o}),new ee(["ItemMouth","ItemMouth2","ItemMouth3"],o),new Me(5e3),new ae(o,[{group:"ItemMouth2",property:{OverridePriority:1}},{group:"ItemMouth3",property:{OverridePriority:1}}]),new $e({mode:"action",msg:"The muzzle's camouflage is quickly activated, completely exposing {target}'s face and the ball gag in her mouth."},{target:o}),new Me(5e3),new $e({mode:"chat-action",msg:"Restrain self-examination"}),new Me(5e3),new se(["ItemEars","ItemHead","ItemMouth","ItemMouth2","ItemMouth3"],o),new $e({mode:"action",msg:"A lock icon lights up in the air in front of the ball, but unfortunately it is a holographic projection that cannot be blocked."},{target:o}),new ae(o,[{group:"ItemMouth3",property:{OverridePriority:{Straps:1,Nose:1,Mask:1,IconLock:42,IconMute:1,IconX:1}}}]),new te(o,[{target:"ItemMouth3",option:{n:0,h:0,s:1}}]),new $e({mode:"chat-action",msg:"Confirmed to be installed in place and locked"}),new Me(5e3),new $e({mode:"action",msg:"The mechanical arms holding {target}'s limbs lift her body slightly. The previously installed cuffs seem to have activated some kind of working mode, causing {target}'s hands and feet to lose strength temporarily."},{target:o}),new ee(["ItemHands","ItemBoots"],o),new $e({mode:"action",msg:"While {target}'s hands and feet are naturally stretched, several robotic arms deftly put gloves and high heels on her body, carefully adjusting the position to ensure comfort."},{target:o}),new Me(5e3),new $e({mode:"chat-action",msg:"Restrain self-examination"}),new Me(5e3),new $e({mode:"action",msg:"With a slight tightening feeling coming from the wrists and ankles, {target} seems to have successfully controlled her hands and feet. She will get used to the warm wrapping feeling and hazy touch eventually, right?"},{target:o}),new se(["ItemHands","ItemBoots"],o),new $e({mode:"chat-action",msg:"Confirmed to be installed in place and locked"}),new Me(5e3),new $e({mode:"chat-action",msg:"The control core and brand name will be installed soon. I wish {target} to become an excellent wolf girl in advance."},{target:o}),new Me(5e3),new $e({mode:"action",msg:"The delicate collar is quickly placed around {target}'s neck, and then slowly begins to tighten until the collar is slightly embedded in the neck. Even so, the tightening of the collar does not affect the smooth breathing and blood flow at all."},{target:o}),new ee(["ItemNeck"],o),new Me(5e3),new $e({mode:"action",msg:"The last robotic arm approaches {target} little by little. The name tag on it indicating {target}'s name with a string of numbers. Perhaps this will be the last time she is called by this name."},{target:o}),new ee(["ItemNeckAccessories"],o),new ae(o,[{group:"ItemNeckAccessories",property:{Text:o.MemberNumber?.toString()??""}}]),new $e({mode:"chat-action",msg:"Control core self-checking"}),new Me(5e3),new se(["ItemNeck","ItemNeckAccessories"],o),new $e({mode:"chat-action",msg:"Confirmed that it is installed in place and locked, and that connections are successfully established with all components"}),new Me(5e3),new $e({mode:"chat-action",msg:"Rebuilding {target_wg}'s clothing according to settings"},{target:o}),new ie(o,n),new Me(5e3),new $e({mode:"chat-action",msg:"Trainer {player}, {target_wg} has installed the training kit and the kit has been initialized. I wish you a happy game."},{target:o}),new te(o,[{target:F.Asset.Group,option:{w:1,l:0,a:0,d:0,t:0,h:0}}]),new te(o,[{target:"ItemArms",option:{typed:1}},{target:"ItemFeet",option:{typed:2}},{target:"ItemLegs",option:{typed:2}},{target:"ItemHands",option:{typed:0}}]),new Me(5e3),new $e({mode:"action",msg:"The maintenance hatch opens, and the mechanical arm pushes {target_wg} out. Then it begins to gradually become distorted and transparent, and the small auxiliary positioning beacon behind {target_wg} automatically returns to the trainer {player}'s wolf trainer multi-purpose auxiliary glasses."},{target:o}),new oe(o,[F])];H.global.push({description:"Dress Sequence",works:i})}(V.Access,0,t)}))];H.global.push({description:"Init Dress Sequence",works:n})})).catch((e=>{k.instance.LocalInfo("...Wolf Girl Network disconnected, aborting process.")}))}function kt(e,t){const o={mode:"chat-action",msg:"Found item {locked_items} replaced by locked item, cannot be automatically repaired, stopping the repair process."};V.Access.craft;let n=0;const i=e=>t=>"canfix"===t.ret&&t.counter?(n+=t.counter,e):"blocked"===t.ret?o:void 0,s=[new Pe((()=>function(e){const t="ItemNeck",o=e.Appearance.find((e=>e.Asset.Group.Name===t)),n=D.get(t);return!(!o||!n||!T(o,n,{craft:!0,lock:!0}))}(t)?Pe.Accepted:Pe.Rejected),((e,t)=>{if(!t.passed)return{mode:"chat-action",msg:"Warning, the central control core is lost, please go to EIL or find EIL personnel to handle it"}})),new $e({mode:"chat-action",msg:"Instructions received, maintenance mode enabled"}),new $e({mode:"chat-action",msg:"Remote connection activated, deploying portable wolf girl training facility maintenance pod"}),new Me(5e3),new $e({mode:"chat-action",msg:"There seems to be some small ripples in the space, and with a small cyclone, a complex maintenance cabin filled with exquisite equipment appears behind {player_wg}, and several mechanical arms stretch out from it and pull her into the maintenance cabin."}),new ee([F],e,ee.TARGET_ACTING),new Me(5e3),new $e({mode:"chat-action",msg:"Target detected, maintenance bay secured and locked. Scanning"}),new te(t,[{target:F.Asset.Group,option:{w:1,l:2,a:2,d:0,t:0,h:4}}]),new Pe((()=>re(t)?Pe.Stop:Pe.Continue),((e,t)=>t.passed?{mode:"chat-action",msg:"Component scan completed, all online and functioning normally, energy core fully charged, maintenance mode ended, please exit maintenance mode"}:{mode:"chat-action",msg:"Component scan completed, found some components missing or offline, entered repair mode"})),new $e({mode:"chat-action",msg:"Several mechanical arms quickly extend from the maintenance cabin and scan up and down in front of {player_wg}. A light blue beam shines on her, seeming able to see through everything."}),new vt(e,[{target:"ItemEars"},{target:"ItemHead"},{target:"ItemMouth"},{target:"ItemMouth2",property:{OverridePriority:1}},{target:"ItemMouth3",option:{n:0,h:0,s:1},property:{OverridePriority:{Straps:1,Nose:1,Mask:1,IconLock:42,IconMute:1,IconX:1}}}],i({mode:"chat-action",msg:"Maybe {player_wg} wants to satisfy some cravings. Simple audio-visual experience can make her imagine that nothing has happened, and eating human food can give her brain an illusion? Or maybe she want to use her tongue and mouth to satisfy some obscene things because of the blockage of her body? Is fate unchangeable, or has she long forgotten when she made the choice for herself?"})),new vt(e,["ItemBreast","ItemNipplesPiercings","ItemNipples"],i({mode:"action",msg:"The plump breasts are indeed eye-catching, but is it a bit presumptuous to expose this asset that no longer belongs to you, no? The maintenance cabin uses a small electric shocker to shock {player_wg}'s nipples on both sides, and then resumes the installation of components."})),new vt(e,["ItemHands",{target:"ItemArms",option:{typed:1}}],i({mode:"action",msg:"It seems that {player_wg} has lost her bracelet and gloves. She seems to want to do something drastic. Was she trying some lewd actions? Or maybe she just wanted to feel the touch? However, the maintenance cabin doesn't care what her purpose was. It just faithfully follows the instructions and installs a new set of equipment back on {player_wg}."})),new vt(e,[{target:"ItemTorso"},{target:"ItemTorso2"},{target:"ItemNeckAccessories",property:{Text:t.MemberNumber?.toString()??""}}],i({mode:"chat-action",msg:"The external communication belt module, the drug injection module or the identity tag are abnormal. It is true that these modules are very easy to be damaged or lost. They are being repaired, but please note that there will be no discount on the repair cost."})),new vt(e,["ItemVulva","ItemPelvis","ItemButt","ItemVulvaPiercings"],i({mode:"chat-action",msg:"Your body, your breath, even your thoughts and your soul all belong to your master. Naturally, the right to orgasm does not belong to you. The pleasure you are allowed to obtain is to remind you of your identity, and the joy of orgasm is a reward from the master. Eating the forbidden fruit will naturally be severely punished."})),new vt(e,["ItemBoots",{target:"ItemFeet",option:{typed:2}},{target:"ItemLegs",option:{typed:2}}],i({mode:"action",msg:"It looks like {player_wg}'s walking controller is missing. It's really difficult to remove it. Is she trying to escape? But since she became a wolf girl, isn't the freedom she has enough? Unfortunately, unless the master allows it, she can't escape anyway. Well, maybe I should tell the master about this. The maintenance cabin gives {player_wg} a slight electric shock, and then installs a new controller for her."})),new $e({mode:"chat-action",msg:"The component has been repaired. The corresponding reward points have been deducted according to the component loss situation. Rescanning and self-checking"}),new xe((e=>{lt.points.points-=n,Ne({mode:"local",msg:`${n} points have been deducted, current points are ${lt.points.points}`})})),new Me(5e3),new Re(E,((e,t)=>{if(lt.statistics.set_last_fix_time(Date.now()),lt.outfit.items=[],0===t.missing.length)Ne({mode:"chat-action",msg:"Component scan completed, all online and functioning normally, energy core fully charged, maintenance mode ended, please exit maintenance mode"},{player:e});else{Ne({mode:"chat-action",msg:"Error: Component repair failed, there are still unworn components: {missing_formated}"},{player:e},{missing_formated:t.missing.map((e=>e.Craft.Name)).join(", ")})}}))];H.global.push({description:"DressFixSequence",works:s})}var Ct;function At(e){H.global.insert_after_first({description:"StopSequence",works:[new $e(_e,{args:{missing_formated:e}}),new $e(Ce)]})}function It(e){const t=[new Re(["ItemNeck","ItemPelvis"],((e,t)=>{if(t.missing.length>0)return At(t.missing.map((e=>e.Craft.Name)).join(", ")),W.interrupted;Ne({mode:"chat-action",msg:"Activating the Nano-bee Swarm Storage Restraint Device to enter hidden mode"})})),new Me(5e3),new $e({mode:"action",msg:"{player_wg}'s restraints seem to be dissolving bit by bit, turning into a small stream of metallic silver water flowing along her skin to the main control core and training underwear. As the water flow disappears, the original restraints disappear as if they had never existed. However, the collar on her neck and the training underwear on her body obviously disagreed with this idea."}),new xe((e=>{!function(e){const t=["ItemNeck","ItemPelvis"];let o=[];e.Appearance=e.Appearance.map((e=>{if(t.includes(e.Asset.Group.Name))return e;const n=D.get(e.Asset.Group.Name);if(!n||!K(e,n))return e;o.push({asset:{group:e.Asset.Group.Name,name:e.Asset.Name},color:e.Color??"Default",property:e.Property})})).filter((e=>void 0!==e)),lt.outfit.items=o,S(e)}(e),lt.outfit.lite_mode=!0,Ne({mode:"chat-action",msg:"Switched to lightweight item mode."})}))];H.global.push({description:"StartStashSequence",works:t})}function Nt(e){const t=[new Re(["ItemNeck","ItemPelvis"],((e,t)=>{if(t.missing.length>0)return At(t.missing.map((e=>e.Craft.Name)).join(", ")),W.interrupted;Ne({mode:"chat-action",msg:"Exiting restraint hiding mode, nanobee swarm at work"})})),new Me(5e3),new $e({mode:"action",msg:"The main control core and training underwear vibrate slightly. If someone else were to look, they would see some small streams of metallic silver flowing out of them, flowing to all parts of {player_wg}'s body, slowly forming the original restraints and reconnecting the various components."}),new xe((e=>{(function(e){const t=[...lt.outfit.items.values()],o=O(e);return V.Access.craft,t.some((e=>{const t=o.get(e.asset.group);return!!t&&!K(t,D.get(e.asset.group))&&!!(t.Property?.Effect?.includes("Lock")??1)}))?Ct.Locked:(t.forEach((t=>{const n=o.get(t.asset.group),i=D.get(t.asset.group);if(!i)return;if(i.Asset.Name!==t.asset.name)return;const s=U(e,e,i);s&&(Object.assign(s,{Color:t.color,Property:t.property}),n?Object.assign(n,s):e.Appearance.push(s))})),lt.outfit.items=[],S(e),Ct.Success)})(e)===Ct.Locked?Ne({mode:"chat-action",msg:"There is a locked item, unable to switch modes."}):(lt.outfit.lite_mode=!1,Ne({mode:"chat-action",msg:"Switched to full item mode."}))}))];H.global.push({description:"StartStashPopSequence",works:t})}function Tt(e,t){const o=[new $e({mode:"chat-action",msg:"Received command, scanning for changes in package appearance"}),new $e({mode:"action",msg:"Several small streams of metallic silver water flow out of {player_wg}'s collar, slowly flowing along {player_wg}'s body to the restraints on various parts of her body. After a short stay, they return to the collar along the same path."}),new Me(5e3),new xe((e=>{lt.outfit.color_store=function(e){let t=[];return e.Appearance.forEach((e=>{const o=D.get(e.Asset.Group.Name);o&&K(e,o)&&t.push({asset:e.Asset.Name,group:e.Asset.Group.Name,color:e.Color??"Default"})})),t}(e);const t=e.Appearance.find((e=>"ItemNeck"===e.Asset.Group.Name));Ne({mode:"chat-action",msg:`The color scheme has been scanned and stored in the core, the current color scheme is marked as (${(t?.Color??["#000000"])[0]})`})}))];H.global.push({description:"ColorSaveSequence",works:o})}!function(e){e[e.Success=0]="Success",e[e.Locked=1]="Locked"}(Ct||(Ct={}));const St=[{match:/^(存储色彩方案)|(Save color scheme)/i,prerequisite:pt,run(e){Tt()}},{match:/^((进入|退出)维护模式)|((enter|exit) Maintainance Mode)/i,prerequisite:gt,run(e,t,o){"进入"!==o[2]&&"Enter"!==o[4].toLowerCase()||kt(t,e),"退出"!==o[2]&&"Exit"!==o[4].toLowerCase()||function(e){const t=[new Pe((()=>J(e,F)?Pe.Accepted:Pe.Rejected),((e,t)=>{if(!t.passed)return{mode:"chat-action",msg:"Error: Not in maintenance mode."}})),new $e({mode:"chat-action",msg:"Received instruction to exit maintenance mode"}),new Me(5e3),new $e({mode:"action",msg:"The maintenance cabin door opens, and the robotic arm pushes {player_wg} out. Then it gradually becomes distorted and transparent, and finally only a small cyclone was left."}),new oe(e,[F])];H.global.push({description:"ExitFixSequence",works:t})}(e)}},{match:/^(切换狼女物品模式)|(Toggle-Wolf-Girl-Item-Mode)/i,prerequisite:pt,run(e,t){lt.outfit.items.size>0?Nt():It()}}],Mt=[{match:/((打开|关闭)恋人语音权限)|(((Open)|(Close)) Lover voice permission)/i,prerequisite:pt,run(e,t,o,n){lt.permission.setLoverMode("打开"===o[2]||"open"==o[4].toLowerCase());const i="Current voice permissions:\n  Lover voice permission: "+(lt.permission.data.loverModerators?"Open":"Closed");Se(n.type,e,t,i)}},{match:/((设置(添加|移除)|((add )|(remove )))(\d{1,10})(语音权限)|( voice permission))/i,prerequisite:pt,run(e,t,o,n){const i="添加"===o[3]||"add"===o[4].toLowerCase(),s=parseInt(o[7]);lt.permission.setModerator(s,i);const a="Current voice permissions:\n  Additional permissions list: "+(lt.permission.isAdditionModerator(s)?"+":"-")+" "+s;Se(n.type,e,t,a)}},{match:/(查询语音权限)|(get voice permissions)/i,prerequisite:pt,run(e,t,o,n){z(t);const i=lt.permission.data,s="Current voice permissions:\n  Lover voice permission: "+(i.loverModerators?"Open":"Closed")+"\n  Additional permissions list:\n"+i.moderators.map(((e,t,o)=>`    ${e}`)).join("\n");Se(n.type,e,t,s)}}];class Pt extends B{constructor(e,t,o){super(),this.room=e,this.onfailed=t,this.onfinished=o,this._state=W.running,this._first_run=!0}run(e){if(!this._first_run)return this._state;if(this._first_run=!1,void 0===this.room){ChatRoomPlayerCanJoin=!0;const t={once_after_ChatSearchResultResponse:()=>{this.onfinished?.(e,void 0),this._state=W.finished}};Pt.chatRoomWorkSearchResultTasks.push(t),CommonSetScreen("Online","ChatSearch")}else{const t=this.room;ChatRoomPlayerCanJoin=!1;const o={once_before_ChatSearchQuery:()=>{ChatRoomSpace=t.space,ElementValue("InputSearch",t.name)},once_after_ChatSearchResultResponse:()=>{const o=ChatSearchResult.find((e=>e.Name===t.name));this._state=W.interrupted,o?o.MemberCount>=o.MemberLimit?this.onfailed?.(e,"full"):(ServerSend("ChatRoomJoin",{Name:t.name}),this._state=W.running):this.onfailed?.(e,"notfound")},once_after_ChatRoomSync:()=>{ChatRoomData&&ChatRoomData.Name===t.name?(this.onfinished?.(e,t.name),this._state=W.finished):(this.onfailed?.(e,"not_target"),this._state=W.interrupted)}};Pt.chatRoomWorkSearchQueryTasks.push(o),Pt.chatRoomWorkSearchResultTasks.push(o),Pt.chatRoomWorkRoomSyncTasks.push(o)}return ChatRoomLeave(),CommonSetScreen("Online","ChatSearch"),this._state}static init(e,t){e.hookFunction("ChatSearchQuery",1,((e,t)=>{for(;this.chatRoomWorkSearchQueryTasks.length>0;)this.chatRoomWorkSearchQueryTasks.shift()?.once_before_ChatSearchQuery?.();t(e)})),e.hookFunction("ChatSearchResultResponse",1,((e,t)=>{for(t(e),ChatRoomPlayerCanJoin=!0;this.chatRoomWorkSearchResultTasks.length>0;)this.chatRoomWorkSearchResultTasks.shift()?.once_after_ChatSearchResultResponse()})),e.hookFunction("ChatRoomSync",1,((e,t)=>{for(t(e);this.chatRoomWorkRoomSyncTasks.length>0;)this.chatRoomWorkRoomSyncTasks.shift()?.once_after_ChatRoomSync?.()}))}}Pt.chatRoomWorkSearchQueryTasks=[],Pt.chatRoomWorkSearchResultTasks=[],Pt.chatRoomWorkRoomSyncTasks=[];const xt=[{match:/^((离开这个房间)|(Leave this room))/i,prerequisite:pt,run(e,t,o,n){!function(e,t){const o=[new $e({mode:"action",msg:"Received the command to leave the room and started the kinematic check"}),new Re(["ItemLegs","ItemFeet","ItemBoots"],((o,n)=>{const i=n.missing.map((e=>e.Craft.Name)).join(", ");if(3===n.missing.length)return Se(t.type,e,t.sender,_e.msg,{missing_formated:i}),Ne(Ce,{player:e}),W.interrupted;Se(t.type,e,t.sender,"Received the command, planning the path and executing it")})),new Pe((e=>e.Appearance.some((e=>!D.has(e.Asset.Group.Name)&&(e.Property&&e.Property.Effect?e.Property.Effect.some((e=>["Tethered","Mounted","Leash","Freeze"].includes(e))):void 0)))?Pe.Rejected:Pe.Accepted),((o,n)=>{n.passed?Ne({mode:"action",msg:"The walking posture controller on {player_wg} lights up, controlling {player_wg} to slowly walk out of the room."},{player:e}):(Se(t.type,e,t.sender,"Action path planning failed, please remove obstacles or use forced exit command"),Ne(Ce,{player:e}))})),new Me(5e3),new Pt(void 0)];H.global.push({description:"Room Leave Sequence",works:o})}(e,{sender:t,type:n.type})}},{match:/^((强行离开这个房间)|(Force-leave this room))/i,prerequisite:pt,run(e,t,o,n){!function(e,t){const o=(o,n)=>Se(t.type,e,t.sender,o,n),n=[new Re(["ItemVulvaPiercings","ItemNipplesPiercings"],((t,n)=>{if(2===n.missing.length){const t=n.missing.map((e=>e.Craft.Name)).join(", ");return o(_e.msg,{missing_formated:t}),Ne(Ce,{player:e}),W.interrupted}o("Forced departure procedure activated, beacon deployed, ready to be transmitted to EIL facility")})),new Me(5e3),new $e({mode:"action",msg:"The space behind {player_wg} ripples slightly, and after a nearly instant of blinding white light, her figure completely disappears, leaving only a small cyclone behind."}),new Pt(V.Access.room,((e,t)=>{o("No access to EIL facilities, rooms are full or locked")}),((t,o)=>{Ne({mode:"action",msg:"{player_wg}A blinding white light suddenly appears in the teleporter, slightly disturbing the comfortable temperature in the facility."},{player:e})})),new $e({mode:"chat-action",msg:"Welcome to the EIL facility. Please do your own maintenance. Please find a cat maid for storage services. Please find a trainer for new wolf girls. Have fun."})];H.global.push({description:"Room Force Leave Sequence",works:n})}(e,{sender:t,type:n.type})}},{type:"Beep",match:/^((到我这里来)|(Come to me))/i,prerequisite:pt,run(e,t,o,n){!function(e,t){let o={};const n=(o,n)=>Se(t.type,e,t.sender,o,n),i=[new Re(["ItemLegs","ItemFeet","ItemBoots"],((t,o)=>{if(3===o.missing.length){const t=o.missing.map((e=>e.Craft.Name)).join(", ");return n(_e.msg,{missing_formated:t}),Ne(Ce,{player:e}),W.interrupted}n("Received the command, planning the path and executing it"),Ne({mode:"chat-action",msg:"Received the command, planning the path and executing it"},{player:e})})),new Pe((e=>e.Appearance.some((e=>{const t=D.get(e.Asset.Group.Name);return(!t||!K(e,t))&&!!Array.isArray(e.Property?.Effect)&&e.Property.Effect.some((e=>["Tethered","Mounted","Freeze"].includes(e)))}))?Pe.Rejected:Pe.Accepted),((t,o)=>{o.passed||(n("Action path planning failed, there are obstacles"),Ne(Ce,{player:e}))})),new Re(["ItemNeckAccessories"],((e,i)=>{1===i.missing.length||void 0===t.room?o.work="leave-only":(o.work="leave-join",n("Heading to"))})),new $e({mode:"action",msg:"{player_wg}'s walking posture controller lights up, controlling {player_wg} to slowly walk out of the door."}),new Pt(t.room,((e,o)=>{n("Left the previous room, but cannot enter the room where {sender_num} is located, the room is full or locked",{sender_num:t.sender})}),((e,i)=>{void 0===i?n("The command does not contain room information, so the room entry operation cannot be performed.。",{sender_num:t.sender}):"leave-only"===o.work&&n("The identity beacon is lost, the pass is abnormal, and the previous room has been left, but the room where {sender_num} is located cannot be entered",{sender_num:t.sender})})),new xe((o=>{const n=z(t.sender),i=ChatRoomCharacter.find((e=>e.MemberNumber===n)),s=(()=>{if(i)return CharacterNickname(i);{const e=o.FriendNames?.get(n);return void 0===e?n.toString():e}})();Ne({mode:"action",msg:"{player_wg}'s walking posture controller controlls {player_wg} to enter the room, walk to {target_name}, and obediently rub {target_name} with her body."},{player:e},{target_name:s})}))];H.global.push({description:"Room Come Here Sequence",works:i})}(e,{sender:t,type:n.type,room:n.BeepRoom})}}];function Rt(e){const t=lt.points.punish_time,o=[{target:"ItemEars",option:{typed:3}},{target:"ItemEyes",option:{typed:3}},{target:"ItemArms",option:{typed:3}},{target:"ItemHands",option:{typed:0}},{target:"ItemFeet",option:{typed:1}},{target:"ItemLegs",option:{typed:1}}],n=new Map(o.map((e=>[e.target,null]))),i=[new $e({mode:"chat-action",msg:"Received the instruction, the penalty mode has been turned on"}),new $e({mode:"action",msg:"It seemed that {player_wg} has done something wrong, which led to her current situation. All the restraints on her body are tightly binding her flesh, and the electric shocks make her struggle and twist like a fish, shaking her body and making her struggle to maintain her sanity and balance."}),new xe((e=>{e.Appearance.forEach((e=>{n.has(e.Asset.Group.Name)&&e.Property?.TypeRecord&&n.set(e.Asset.Group.Name,{...e.Property.TypeRecord})})),X.instance.on=!0,o.forEach((t=>te.ItemOptionSingleS(e,t))),X.instance.on=!1,qe.punish_flag=!0})),new te(e,o),new $e({mode:"local-status",msg:`>> Penalty mode is activated, estimated duration ${(t/60/1e3).toFixed(2)} minutes`}),new qe(t),new $e({mode:"local-status",msg:">> Punishment mode has ended"}),new xe((e=>{qe.punish_flag=!1,X.instance.on=!0,e.Appearance.forEach((t=>{const o=n.get(t.Asset.Group.Name);o&&ExtendedItemSetOptionByRecord(e,t,o)})),X.instance.on=!1,S(e)})),new $e({mode:"chat-action",msg:"{player_wg}'s restraints return to their previous mode, and the stun gun returns to standby mode, leaving only {player_wg}'s stiff muscles and the lingering pain from the electric shocks to tell her what had just happened. Although this was not the most severe form of punishment, I hope she has realized her mistake."})];H.global.push({description:"punish work",works:i})}var Gt;!function(e){e[e.Running=0]="Running",e[e.Success=1]="Success",e[e.Failed=2]="Failed"}(Gt||(Gt={}));class Et{onChat(e,t,o,n){}onActivity(e,t,o){}onOrgasm(e){}onResist(e){}}class Dt extends Et{constructor(e,t,o){super(),this.time_limit_rate=e,this.expected=t,this.bonus=o,this.time_out=lt.points.task_time*e+Date.now(),this.cur=0}run(e){return Date.now()>this.time_out?Gt.Failed:this.cur>=this.expected?Gt.Success:Gt.Running}finalize(e,t){t===Gt.Success?function(e,t){lt.points.points+=t,Ne({mode:"chat-action",msg:`{player_wg}'s bonus points increased by ${t} points.`},{player:e})}(e,this.bonus):Rt(e),lt.statistics.task_finished(t===Gt.Success)}}class Ft extends Dt{summary(){return`Before ${new Date(this.time_out).toLocaleTimeString()} (${this.time_limit_rate}x task base time), beg ${this.expected} people for an orgasm, and if successful, receive ${this.bonus} points as a reward`}constructor(e,t,o){super(e,t,o),this.time_limit=e,this.counter=t,this.bonus=o,this.last_interact_num=0,this.interact_list=new Set}onActivity(e,t,o){o.SourceCharacter!==e.MemberNumber&&o.TargetCharacter===e.MemberNumber&&(this.last_interact_num=t.MemberNumber??-1)}onOrgasm(e){this.interact_list.add(this.last_interact_num),this.cur=this.interact_list.size,lt.statistics.add_counter("Orgasmed",1)}}class jt extends Dt{summary(){const e=`Before ${new Date(this.time_out).toLocaleTimeString()} (${this.time_limit_rate}xtask base time)`,t=this._check_groups?`at ${[...this._check_groups.values()].map((e=>AssetGroupGet("Female3DCG",e)?.Description)).filter((e=>void 0!==e)).join(", ")} `:"",o=this._check_act?`of ${[...this._check_act.values()].map((e=>ActivityDictionaryText(`Activity${e}`))).join(", ")} Interaction`:"Interaction";return`${e}, accept ${this.expected} individual ${t}${o}, and get ${this.bonus} points reward after success`}constructor(e,t,o,n,i){super(e,t,o),this.time_limit_rate=e,this.counter=t,this.bonus=o,this._interact_list=new Set,this._check_act=n?new Set(n):void 0,this._check_groups=i?new Set(i):void 0}onActivity(e,t,o){o.SourceCharacter!==e.MemberNumber&&o.TargetCharacter===e.MemberNumber&&(this._check_act&&!this._check_act.has(o.ActivityName)||this._check_groups&&!this._check_groups.has(o.ActivityGroup)||(this._interact_list.add(o.SourceCharacter),this.cur=this._interact_list.size,this._check_groups?.has("ItemBreast")?lt.statistics.add_counter("BreastPlayed",1):this._check_groups?.has("ItemVulva")?lt.statistics.add_counter("VulvaPlayed",1):this._check_act?.has("Slap")&&lt.statistics.add_counter("Spanked",1)))}}class Lt extends Dt{summary(){return`Before ${new Date(this.time_out).toLocaleTimeString()} (${this.time_limit_rate}x task base time), endure ${this.expected} climaxes, and get ${this.bonus} points of reward if successful`}constructor(e,t,o){super(e,t,o),this.time_limit_rate=e,this.counter=t,this.bonus=o}onResist(e){this.cur++,lt.statistics.add_counter("Resisted",1)}}class $t{constructor(e,t){setInterval((()=>{if(Player&&Player.MemberNumber&&le(Player)){if(this._active_task){const e=this._active_task.run(Player);e!==Gt.Running&&(this._active_task.finalize(Player,e),this._active_task=void 0)}}else this._active_task=void 0}),e),t.onOrgasm((e=>this.onOrgasm(e))),t.onResist((e=>this.onResist(e)))}push_task(e,t){this._active_task?t&&t(this._active_task):this._active_task=e}has_task(){return void 0!==this._active_task}onChat(e,t,o,n){this._active_task?.onChat(e,t,o,n)}onActivity(e,t,o){this._active_task?.onActivity(e,t,o)}onOrgasm(e){this._active_task?.onOrgasm(e)}onResist(e){this._active_task?.onResist(e)}static get instance(){return $t._instance}static init(e,t){this._instance||(this._instance=new $t(e,t))}}$t._instance=void 0;const Ot=(e,t)=>{Ne({mode:"action",msg:`${be(e)} received Tasks：\n${t.summary()}`}),$t.instance.push_task(t,(()=>{Ne({mode:"action",msg:"Failed to accept task: There is a task running."})}))},Wt=[{match:/^((忍耐)|(endure ))([1-9]\d{0,2})((次高潮)|( orgasms))/i,prerequisite:pt,run(e,t,o){we(e,"ToysCtrl","max"),we(e,"ArousalCtrl","off"),Ot(e,new Lt(1,parseInt(o[4]),2))}},{match:/^((向)|(Beg for an orgasm from ))([1-9]\d{0,2})((人乞求高潮)|( people))/i,prerequisite:pt,run(e,t,o){te.ItemOptionSingleS(e,{target:"ItemPelvis",option:{c:0}}),we(e,"ArousalCtrl","off"),Ot(e,new Ft(2,parseInt(o[4]),2))}},{match:/^(让|(let ))([1-9]\d{0,2})(( people play with your breasts)|(人玩弄你的胸部))/i,prerequisite:pt,run(e,t,o){Ot(e,new jt(1,parseInt(o[3]),2,void 0,["ItemBreast","ItemNipplesPiercings","ItemNipples"]))}},{match:/^(让|(let ))([1-9]\d{0,2})(( people play with your pussy)|(人玩弄你的阴部))/i,prerequisite:pt,run(e,t,o){te.ItemOptionSingleS(e,{target:"ItemPelvis",option:{c:0}}),we(e,"ArousalCtrl","off"),Ot(e,new jt(1,parseInt(o[3]),2,void 0,["ItemVulva","ItemPelvis","ItemVulvaPiercings"]))}},{match:/^(向|(Beg for whipping from ))([1-9]\d{0,2})((人乞求鞭打)|( people))/i,prerequisite:pt,run(e,t,o){Ot(e,new jt(1,parseInt(o[3]),2,["Slap","Spank","Kick","SpankItem"],void 0))}},{match:/^((设置惩罚时间为)|(Set the penalty time to ))([1-9]\d{0,2})((分钟)|( minutes))/i,prerequisite:pt,run(e,t,o,n){const i=parseInt(o[4]);lt.points.punish_time=60*i*1e3,Ne({mode:"chat-action",msg:`Received the instruction, the penalty time of {player_wg} is ${lt.points.punish_time/60/1e3} minutes`},{player:e}),Ne({mode:"local",msg:"The cold voice of the mechanical broadcast repeated the consequences of {player_wg}'s mission failure. It seemed to be completely emotionless, but a hint of amusement could be heard."},{player:e})}},{match:/^((设置任务时间为)|(Set the task time to ))([1-9]\d{0,2})((分钟)|( minutes))/i,prerequisite:pt,run(e,t,o,n){const i=parseInt(o[4]);lt.points.task_time=60*i*1e3,Ne({mode:"chat-action",msg:`Received the instruction, the time to finish {player_wg}'s task is ${lt.points.task_time/60/1e3} minutes`},{player:e}),Ne({mode:"action",msg:"The cold voice of the mechanical broadcast repeated {player_wg}'s mission time. Tick, tick, is there still time to be dazed? The precise technology will not miss even a second, right?"},{player:e})}},{match:/^((进入|关闭)惩罚模式)|((Enter|Exit) punishment mode)/i,prerequisite:pt,run(e,t,o){"进入"===o[2]||"enter"===o[4].toLowerCase()?Rt(e):qe.punish_flag=!1}},{match:/^(((打开|Turn on )((严厉)|(harsh ))?)|((Turn off )|(关闭)))((高潮惩罚模式)|(Orgasm Punishment mode))/i,prerequisite:pt,run(e,t,o){o[1].startsWith("打开")||o[1].toLowerCase().startsWith("Turn on")?H.global.push({description:"OrgasmPunishMode",works:[new $e({mode:"action",msg:"Received the instruction, the orgasm punishment mode has been turned on"}),new xe((()=>lt.settings.update("orgasmPunishMode",o[4]?2:1))),new $e({mode:"chat-action",msg:"The display on {player_wg}'s training underwear lights up with a small icon, a pink heart with a small lightning bolt imposed on it. What does it mean? Why not give it a try? Maybe {player_wg} will like the feeling."})]}):H.global.push({description:"OrgasmPunishMode",works:[new $e({mode:"action",msg:"Received the instruction, the orgasm punishment mode has been turned off"}),new xe((()=>lt.settings.update("orgasmPunishMode",0))),new $e({mode:"chat-action",msg:"The small punishment icon on the display of {player_wg}'s training underwear gradually goes out.  {player_wg} can now climax freely... right? Is it that {player_wg} wants to be tightly tied up and usher in waves of pleasure?"})]})}},{match:/^((设置高潮惩罚时间为)|(Set the penalty time to ))([1-9]\d{0,2})((分钟)|( Minutes))/i,prerequisite:pt,run(e,t,o,n){const i=parseInt(o[4]);lt.points.orgasm_punish_time=60*i*1e3,Ne({mode:"chat-action",msg:`Received the command, {player_wg}'s orgasm penalty time is ${lt.points.orgasm_punish_time/60/1e3} minutes`},{player:e}),Ne({mode:"action",msg:"The cold voice of the mechanical broadcast repeats the price {player_wg} has to pay after reaching orgasm at will. Perhaps with enough desire and hunger, {player_wg} will choose to indulge her body and sink into desire?"},{player:e})}},{match:/^(((扣除)|(奖励))|((Reward )|(Deduct )))([1-9]\d{0,2})((积分)|( Points?))/i,prerequisite:pt,run(e,t,o,n){const i=parseInt(o[8]);console.log(o);const s="奖励"===o[2]||"reward "===o[5].toLowerCase();console.log("reward "===o[5].toLowerCase()),console.log(s);const a=s?"rewarded":"deducted";console.log(a),lt.points.points+=s?i:-i;const r=lt.points.points;Se(n.type,e,t,"{player_wg} is {oper} {v} points, current points: {points}",{oper:a,v:i,points:r})}},{match:/^((查询奖励积分)|(Get reward points))/i,prerequisite:pt,run(e,t,o,n){const i=lt.points.points;Se(n.type,e,t,"{player_wg} Current reward points: {points}",{points:i}),lt.points.points>20?Ne({mode:"local",msg:"{player_wg} did a great job, but there is no interest for accumulating points, or maybe you just want a good number? Be careful when you open the query next time, there may be a surprise."},{player:e}):lt.points.points<0&&Ne({mode:"local",msg:"Negative points are not what a good wolf girl should have. Keep working hard, but don't trigger the punishment task. Be careful that after multiple punishments, you will be abandoned and recycled into a living toy. However, with {player_wg}'s figure, maybe living furniture is not bad..."},{player:e})}}],qt=[{match:/^((允许高潮)|(Allow orgasm))/i,prerequisite:ft,run(e,t,o){lt.points.use_points(1).then((()=>{Fe(e,"off")}),(e=>{Ne({mode:"local",msg:`You do not have enough reward points. Current points: ${e}`})}))}},{match:/^((关闭语言限制)|(Turn off language restrictions))/,prerequisite:ft,run(e,t,o){lt.points.use_points(1).then((()=>{ze(e,"off")}),(e=>{Ne({mode:"local",msg:`You do not have enough reward points. Current points: ${e}`})}))}},{match:/^((关闭手臂限制)|(Turn off arm restraints))/i,prerequisite:ft,run(e,t,o){lt.points.use_points(1).then((()=>{He(e,"off")}),(e=>{Ne({mode:"local",msg:`You do not have enough reward points. Current points: ${e}`})}))}},{match:/^((关闭行走限制)|(Turn off leg restraints))/i,prerequisite:ft,run(e,t,o){lt.points.use_points(1).then((()=>{Ve(e,"off")}),(e=>{Ne({mode:"local",msg:`You do not have enough reward points. Current points: ${e}`})}))}},{match:/^((关闭视觉限制)|(Turn off visual restrictions))/i,prerequisite:ft,run(e,t,o){lt.points.use_points(1).then((()=>{Le(e,"off")}),(e=>{Ne({mode:"local",msg:`You do not have enough reward points. Current points: ${e}`})}))}},{match:/^((关闭听觉限制)|(Turn off auditory restrictions))/i,prerequisite:ft,run(e,t,o){lt.points.use_points(1).then((()=>{je(e,"off")}),(e=>{Ne({mode:"local",msg:`You do not have enough reward points. Current points: ${e}`})}))}}],Bt=[{match:/^((查询高潮统计)|(Get orgasm statistics))/i,prerequisite:yt,run(e,t,o){const{orgasm:n,resist:i,ruined:s}=lt.arousal;Ne({mode:"chat-action",msg:be(e)+"The climax statistics are as follows: \n"+`  Number of orgasms: ${n}\n`+`  Number of resisted orgasms: ${i}\n`+`  Number of ruined orgasms: ${s}\n`+`  Orgasm Rate: ${(n/(n+i+s)*100).toFixed(2)}%`})}},{match:/^((查询狼女训练统计)|(Get wolf girl training statistics))/i,prerequisite:pt,run(e,t,o){const{script_run_time:n,wolfgirl_time:i,stash_time:s,last_fix_time:a,task:r}=lt.instance.data.stat,{finished:c,failed:l,counter:h}=r,m=lt.instance.data.points.current,d=e=>{const t=Math.floor(e/1e3),o=Math.floor(t/86400),n=o>0?`${o}days`:"",i=Math.floor(t%86400/3600);return`${n}${o>0||i>0?`${i}hours`:""}${Math.floor(t%3600/60)}minutes${t%60}seconds`};var u;Ne({mode:"chat-action",msg:be(e)+"The training statistics are as follows: \n"+`  Total running time of training assistance system: ${d(n)}\n`+`  Training module effective working time: ${d(i)}\n`+`  Number of tasks completed: ${c}\n`+`  Number of tasks failed: ${l}\n`+`  Current task points: ${m}\n  Task Count: \n`+`    climax: ${h.Orgasmed??0}\n`+`    resisted orgasms: ${h.Resisted??0}\n`+`    Played with breast: ${h.BreastPlayed??0}\n`+`    Played with vulva: ${h.VulvaPlayed??0}\n`+`    Spanked: ${h.Spanked??0}\n`+`  Last suit maintenance check: ${a>0?(u=a,new Date(u).toLocaleString()):"No records"}\n`+`  Restrained Lightweight Mode Time: ${d(s)}`})}},{match:/^((扫描身体敏感部位)|(Scan sensitive body parts))/i,prerequisite:pt,run(e,t,o){H.global.push({description:"ScanBody",works:[new $e({mode:"action",msg:"Command received, scanning body parameters"}),new $e({mode:"action",msg:"Several small streams of metallic silver water flow out of {player_wg}'s collar and along {player_wg}'s body to various parts of her body. They briefly cover {player_wg}'s body, just like a silver latex suit covering her entire body. After a burst of itchiness, this strange latex suit turns back into a silver stream of water and returns to the collar along the same path."}),new Me(5e3),new xe((e=>{if(void 0===e.ArousalSettings||"Inactive"===e.ArousalSettings.Active)return Ne({mode:"action",msg:"The scan data analysis is complete. {player_wg}'s sexual arousal center is in a shut-down state and no physical data has been collected."},{player:e}),W.interrupted;const t=AssetGroup.filter((e=>e.IsItem())).map((e=>e.Name)).map((t=>PreferenceGetArousalZone(e,t))).filter((e=>!!e)),o=t.filter((e=>3===e.Factor)).map((t=>AssetGroupGet(e.AssetFamily,t.Name)?.Description)).filter((e=>!!e)).join(", "),n=t.filter((e=>4===e.Factor)).map((t=>AssetGroupGet(e.AssetFamily,t.Name)?.Description)).filter((e=>!!e)).join(", "),i=t.filter((e=>e.Orgasm)).map((t=>AssetGroupGet(e.AssetFamily,t.Name)?.Description)).filter((e=>!!e)).join(", ");Ne({mode:"action",msg:"The scan data has been analyzed. The more sensitive parts of {player_wg}'s body are {value3Zones}, and the most sensitive parts of {player_wg}'s body are {value4Zones}. Among them, the part that can make {player_wg} climax is {orgasmZones}. The scan data summary is complete."},{player:e},{value3Zones:o,value4Zones:n,orgasmZones:i})}))]})}}];class Ht{constructor(){this.isWorking=()=>!1}onInject(){}hook(e,t){}update(e){}}const Vt=[class extends Ht{constructor(){super(...arguments),this.cumulate="refresh",this.name="anesthetic",this.duration=9e5,this.disperse=void 0}onInject(){void 0!==Player?.ArousalSettings?.Progress&&(Player.ArousalSettings.Progress=0,CharacterSetFacialExpression(Player,"Eyes","Closed")),CurrentCharacter&&(CurrentCharacter.FocusGroup&&(CurrentCharacter.FocusGroup=null),CurrentCharacter=null)}update(e){const t=ElementValue("InputChat"),o=Math.random();o<.1?ElementValue("InputChat",t.substring(1)):o<.6?ElementValue("InputChat",t.replace(/^([z\.]*)./,"$1z")):ElementValue("InputChat",t.replace(/^([z\.]*)./,"$1."))}hook(e,t){t((()=>{e.hookFunction("Player.CanWalk",1,((e,t)=>!this.isWorking()&&t(e))),e.hookFunction("Player.GetBlurLevel",1,((e,t)=>{const o=t(e);return this.isWorking()?o+3:o}))})),e.hookFunction("ChatRoomFocusCharacter",1,((e,t)=>{if(!this.isWorking())return t(e)})),e.hookFunction("SpeechGetGagLevel",1,((e,t)=>{const o=t(e);return e[0].IsPlayer()&&this.isWorking()?o+2:o}))}},class extends Ht{constructor(){super(...arguments),this.name="pickmeup",this.duration=0,this.cumulate="none",this.disperse={mode:"all_cancel",target:["anesthetic"]}}},class extends Ht{constructor(){super(...arguments),this.disperse={target:["inhibitor"],mode:"timely_cancel"},this.cumulate="add",this.name="aphrodisiac",this.duration=9e5,this.savedArousal=-1}onInject(){Player&&CharacterSetFacialExpression(Player,"Eyes","HeartPink")}update(e){if(void 0!==e?.ArousalSettings?.Progress){if(this.isWorking()&&-1!==this.savedArousal){const t=e.ArousalSettings.Progress-this.savedArousal;t>0&&(e.ArousalSettings.Progress+=t)}this.savedArousal=e.ArousalSettings.Progress}}hook(e){e.hookFunction("ChatRoomDrawArousalScreenFilter",1,((e,t)=>((!e[3]||e[3]<60)&&(e[3]=60),t(e))))}},class extends Ht{constructor(){super(...arguments),this.cumulate="add",this.name="inhibitor",this.duration=9e5,this.disperse={mode:"timely_cancel",target:["aphrodisiac"]},this.savedArousal=-1}onInject(){Player?.ArousalSettings?.Progress&&(Player.ArousalSettings.Progress=0)}update(e){if(void 0!==e?.ArousalSettings?.Progress){if(this.isWorking()&&-1!==this.savedArousal){const t=e.ArousalSettings.Progress-this.savedArousal;t>0&&(e.ArousalSettings.Progress-=.5*t)}this.savedArousal=e.ArousalSettings.Progress}}}];class zt{constructor(e,t){this.working=new Map,this.injections=new Map(Vt.map((e=>new e)).map((e=>[e.name,e]))),this.injections.forEach((o=>o.hook(e,t))),this.injections.forEach(((e,t)=>e.isWorking=()=>this.working.has(t))),setInterval((()=>{const e=Date.now();this.working.forEach(((t,o)=>{t<e?this.working.delete(o):Player?.MemberNumber&&this.injections.get(o)?.update(Player)}))}),100)}doInject(e){const t=this.injections.get(e);if(!t)return;const o=Date.now();let n=t.duration;if(t.disperse){const e=t.disperse;"all_cancel"===e.mode?e.target.forEach((e=>this.working.delete(e))):"timely_cancel"===e.mode&&e.target.forEach((e=>{const t=this.working.get(e);if(void 0!==t){const i=t-n;i>o?this.working.set(e,i):(this.working.delete(e),n-=t-o)}}))}t.onInject(),"refresh"===t.cumulate?this.working.set(e,Date.now()+n):"add"===t.cumulate&&this.working.has(e)&&this.working.set(e,this.working.get(e)+n)}static get instance(){return zt._instance}static init(e,t){zt._instance||(zt._instance=new zt(e,t))}}zt._instance=void 0;const Ut={aphrodisiac:{finish:{mode:"chat-action",msg:"Aphrodisiac injection completed"},f_action:{mode:"action",msg:"Oh, it's an aphrodisiac. Although it won't lead to an orgasm directly, subsequent arousal will be more impactful. I hope {player_wg} won't let the pleasure spoil her brain."}},inhibitor:{finish:{mode:"chat-action",msg:"Inhibitor injection completed"},f_action:{mode:"action",msg:"{player_wg}'s harness injected her with an inhibitor that can temporarily suppress the pain, but the side effect is that it suppresses the brain's perception of pleasure. If this is injected when she is in estrus... don't treat your body too much because of desire, okay?"}},anesthetic:{finish:{mode:"chat-action",msg:"Anesthetic injection completed"},f_action:{mode:"action",msg:"{player_wg}, who has lost her ability to resist, seems to be able to be played with at will. Maybe in a few minutes we need to call the EIL recycling team to pick her up."}},pickmeup:{finish:{mode:"chat-action",msg:"Recovery injection completed"},f_action:{mode:"action",msg:"With the injection of the recovery agent, {player_wg}'s body gradually regains strength and she gradually regained control of her limbs."}},EasterUniversalDispersal:{finish:{mode:"chat-action",msg:"The injection of general dispersant is completed"},f_action:{mode:"action",msg:"Complex magic circuits, inherited ancient bloodlines, tedious preparations for casting spells, how can a great magician who takes decades to become a master avoid being caught up by technology? The low threshold for using technology has never been comparable to those magicians who require so-called bloodlines and origins."}}};function Kt(e,t){t?function(e,t){const o=[new xe((e=>Ne(t.finish,{player:e}))),new xe((e=>Ne(t.f_action,{player:e}))),new xe((()=>zt.instance.doInject(e)))];H.global.push_front({description:`InstantInjection${e}`,works:o})}(e,Ut[e]):function(e,t){let o={msg:Ce};const n=[new Re(["ItemTorso2"],((e,t)=>{if(t.missing.length>0){const o=t.missing.map((e=>e.Craft.Name)).join(", ");return Ne(_e,{player:e},{missing_formated:o}),W.interrupted}o.msg={mode:"chat-action",msg:"Received the order, the medicine is being prepared"}})),new xe((e=>Ne(o.msg,{player:e}))),new Me(1e3),new xe((t=>{zt.instance.doInject(e)})),new xe((e=>Ne(t.finish,{player:e}))),new xe((e=>Ne(t.f_action,{player:e})))];H.global.push({description:`InjectionSequence${e}`,works:n})}(e,Ut[e])}const Jt={"Label-ChatOther-ItemNeck-WolfGirlItemsSwitch":"Toggle-Wolf-Girl-Item-Mode","Label-ChatSelf-ItemNeck-WolfGirlItemsSwitch":"Toggle-Wolf-Girl-Item-Mode","Label-ChatOther-ItemPelvis-WolfGirlItemsSwitch":"Toggle-Wolf-Girl-Item-Mode","Label-ChatSelf-ItemPelvis-WolfGirlItemsSwitch":"Toggle-Wolf-Girl-Item-Mode","ChatOther-ItemNeck-WolfGirlItemsSwitch":"SourceCharacter gently touches TargetCharacter's collar, and a faint light turns on.","ChatSelf-ItemNeck-WolfGirlItemsSwitch":"SourceCharacter gently touches her collar, and a faint light flickers on.","ChatOther-ItemPelvis-WolfGirlItemsSwitch":"SourceCharacter gently touches TargetCharacter's training underwear, and a faint light turns on.","ChatSelf-ItemPelvis-WolfGirlItemsSwitch":"SourceCharacter lightly touches her training underwear, and a faint light flickers on."},Yt=["ItemNeck","ItemPelvis"];class Zt extends M{constructor(){super("onself",Yt,{Name:"WolfGirlItemsSwitch",MaxProgress:0,Prerequisite:["UseHands","CanSwitchWGItem"],Target:Yt,TargetSelf:Yt},"Assets/Female3DCG/ItemNeck/Preview/FuturisticCollar.png")}on(e,t,o){o.TargetCharacter===e.MemberNumber&&yt(e,t)&&(lt.outfit.items.size>0?Nt():It())}adjustDict(e,t){return t.push({Tag:`MISSING ACTIVITY DESCRIPTION FOR KEYWORD ${e}`,Text:this.text(e)}),t}text(e){return Jt[e]??e}}class Qt extends x{constructor(){super(...arguments),this.name="CanSwitchWGItem"}test(e,t,o){return!!function(e,t,o){if(!t)return!1;const n=e.Appearance.find((e=>e.Asset.Group.Name===t.Asset.Group));return!!n&&T(n,t,o)}(t,D.get(o.Name),{lock:!0})&&(!t.IsPlayer()||lt.points.points>10)}}class Xt extends P{constructor(){super("selfonother",void 0,"Inject"),this.type=void 0}on(e,t,o){const n=ChatRoomCharacter.find((e=>e.MemberNumber===o.TargetCharacter));n&&function(e,t,o){const n=I(e),i=V.Access.craft,s={craft:{MemberName:i.name,MemberNumber:i.uid},lock:o};return t.every((e=>{const t="string"==typeof e?e:e.Asset.Group,o=n.get(t),i="string"==typeof e?D.get(t):e;return!(!o||!i)&&T(o,i,s)}))}(e,[j,L],!1)&&void 0===this.type&&_t(e,n)}adjustDict(e,t){return this.type&&t.push({Tag:"WolfGirlInjectType",Text:this.type}),t}}class eo extends P{constructor(){super("onself",void 0,"Inject")}on(e,t,o){const n=o.BCDictionary.find((e=>"WolfGirlInjectType"===e.Tag));n&&le(e)&&Kt(n.Text,!0)}}class to extends P{constructor(){super("onself",["ItemMouth"],"SipItem"),this.RedbullDrinkTimeout=0}on(e,t,o){if(o.Asset&&o.ActivityGroup.startsWith("ItemMouth")){const n=t.Appearance.find((e=>e.Asset.Group.Name===o.Asset.GroupName));if(!n)return;const i=$.find((e=>e.Asset.Group===o.Asset.GroupName&&e.Asset.Name===o.Asset.AssetName&&e.Craft.Name===o.Asset.CraftName));if(!i)return;if(!K(n,i))return;"情欲之水"===i.Craft.Name||"Water of Desire"===i.Craft.Name?le(e)&&this.DrinkAphrodisiac(e):"特种红牛"!==i.Craft.Name&&"Special Redbull"!==i.Craft.Name||this.DrinkRedbull(e)}}DrinkAphrodisiac(e){Ne({mode:"local",msg:"What you just drank makes you feel very aroused"}),void 0!==e?.ArousalSettings?.Progress&&(e.ArousalSettings.Progress=100,ActivityOrgasmPrepare(e,!1))}DrinkRedbull(e){Ne({mode:"local",msg:"You drink a can of Red Bull and feel full of energy, as if you can break free from all constraints"}),this.RedbullDrinkTimeout=Date.now()+9e5}init(e){e.hookFunction("DialogStruggleStart",1,((e,t)=>{const[o,n,i,s]=e;return o.MemberNumber===Player?.MemberNumber&&this.RedbullDrinkTimeout>Date.now()&&"ActionStruggle"===n&&(i.Difficulty=-50,this.RedbullDrinkTimeout=0),t(e)}))}}class oo{constructor(e){this.injector=new Xt,this.facility=new R(e),this.facility.addPrerequisite(new Qt),this.facility.addActivity(new Zt),this.facility.addActivityExtension(this.injector),this.facility.addActivityExtension(new eo),this.facility.addActivityExtension(new to)}static init(e){this._instance=new oo(e)}static run(e,t,o){this._instance?.facility.run(e,t,o)}static get instance(){return this._instance}}const no={anesthetic:{mode:"chat-action",msg:"Shh... maybe it's time to kidnap someone. Who will be the lucky one?"},pickmeup:{mode:"chat-action",msg:"It's really boring to play with a dead fish with no reaction or movement, isn't it? The prey's escape and struggle are also part of the fun of hunting, right?"},aphrodisiac:{mode:"chat-action",msg:"Is it to discipline or to play around? Whether it is for others or for yourself, something very interesting is about to happen, isn't it?"},inhibitor:{mode:"chat-action",msg:"If injected into a person in heat, this would undoubtedly be the most severe punishment. Compared to being unable to orgasm, a drug that would make it impossible for a person to even feel much pleasure is truly a demon."},chips:{mode:"chat-action",msg:"It looks like trainer {player_id} is about to capture a new wolf girl, but please don't capture her and send her into the wolf girl assembly line at will, okay?"}};function io(e,t){const o=[new Re([L],((e,o)=>{if(o.missing.length>0)return Ne(ve,{player:e},{missing_formated:L.Craft.Name}),W.interrupted;oo.instance.injector.type=t}),!1),new $e({mode:"chat-action",msg:`The syringe has switched to ${e} mode`}),new $e({mode:"chat-action",msg:no[t||"chips"].msg})];H.global.push({description:`SwitchInjector${e}`,works:o})}const so=[{match:/^(注射麻醉剂)|(anesthetic)/i,prerequisite:pt,run(e,t,o){Kt("anesthetic")}},{match:/^(注射恢复剂)|(recovery agent)/i,prerequisite:pt,run(e,t,o){Kt("pickmeup")}},{match:/^(注射催情剂)|(aphrodisiac)/i,prerequisite:pt,run(e,t,o){Kt("aphrodisiac")}},{match:/^(注射抑制剂)|(inhibitor)/i,prerequisite:pt,run(e,t,o){Kt("inhibitor")}},{match:/^(泛用驱散剂)|(general repellent)/i,prerequisite:pt,run(e,t,o){Kt("EasterUniversalDispersal")}}],ao=[{match:/^(身份芯片)|(ID chip)/i,prerequisite:ht,run(e,t,o){io("ID chip",void 0)}},{match:/^(催情剂)|(aphrodisiac)/i,prerequisite:ht,run(e,t,o){io("aphrodisiac","aphrodisiac")}},{match:/^(抑制剂)|(inhibitor)/i,prerequisite:ht,run(e,t,o){io("inhibitor","inhibitor")}},{match:/^(麻醉剂)|(anesthetic)/i,prerequisite:ht,run(e,t,o){io("anesthetic","anesthetic")}},{match:/^(恢复剂)|(pickmeup)/i,prerequisite:ht,run(e,t,o){io("pickmeup","pickmeup")}},{match:/^(泛用驱散剂)|(EasterUniversalDispersal)/i,prerequisite:ht,run(e,t,o){!function(){const e=[new Re([L],((e,t)=>{if(t.missing.length>0)return Ne(ve,{player:e},{missing_formated:L.Craft.Name}),W.interrupted})),new $e({mode:"chat-action",msg:"Mode switching completed, current mode: general repellent injection"}),new $e({mode:"action",msg:"With this external power that has never been offered to the Shadow King who rules the world, he turned it into a supreme treasure."}),new Me(2500),new $e({mode:"action",msg:"Pray for a good harvest and sing the sacred praises"}),new Me(2500),new $e({mode:"action",msg:"The Holy Spirit bestowed upon him a noble gift, which made his name go down in history."}),new Me(2500),new $e({mode:"action",msg:"We will use our powerful magic power to corrode the spreading filth into mud."}),new Me(2500),new $e({mode:"action",msg:"We will curb the rampant madness with our firm belief"}),new Me(2500),new $e({mode:"action",msg:"Achieve a thorough intervention of thoughts on matter"}),new Me(2500),new $e({mode:"chat-action",msg:"The currently loaded firmware has been detected to be abnormal, and the default firmware is being reloaded."}),new Me(5e3),new $e({mode:"chat-action",msg:"Firmware recovery complete"}),new $e({mode:"chat-action",msg:"Mode switching completed, current mode: general repellent injection"}),new $e({mode:"action",msg:"Complex magic circuits, inherited ancient bloodlines, tedious preparations for casting spells, how can a great magician who takes decades to become a master avoid being caught up by technology? The low threshold for using technology has never been comparable to those magicians who require so-called bloodlines and origins."})];H.global.push({description:"UniversalDispersalInjectionSwitchSequence",works:e})}()}}],ro=[wt,xt,Mt,St,Bt,Wt,so].flat(),co=[qt].flat(),lo=[ao].flat();function ho(e){return e.replace(/^[\s\p{P}]*/u,"")}function mo(e,t,o,n){o=ho(o).toLowerCase();const i="use reward points",s="injection gun mode switch";let a;const r=new RegExp(`^wolf girl *${e.MemberNumber??""}`).exec(o);if(r?(o=ho(o=o.slice(r[0].length)),a=ro):o.startsWith(i)?(o=ho(o=o.slice(17)),a=co):o.startsWith(s)&&(o=ho(o=o.slice(25)),a=lo),a)for(const i of a){if(i.type&&i.type!==n.type)continue;if(!i.prerequisite(e,t))continue;const s=i.match.exec(o);if(s)return i.run(e,t,s,n),void S(e)}}function uo(e,t,o,n){"Chat"!==n&&"Whisper"!==n||mo(e,t,o,{type:n})}function po(e,t,o){oo.run(e,t,o),$t.instance.onActivity(e,t,o)}function go(e){e.hookFunction("ServerAccountBeep",2,((e,t)=>{t(e),Player&&function(e,t){if(!t.MemberName||!t.MemberNumber||"string"!=typeof t.Message)return;if(e.GhostList&&e.GhostList.indexOf(t.MemberNumber)>=0)return;const o=(()=>{if(void 0!==t.ChatRoomName&&void 0!==t.ChatRoomSpace)return{name:t.ChatRoomName,space:t.ChatRoomSpace}})();mo(e,t.MemberNumber,t.Message,{type:"Beep",BeepRoom:o})}(Player,e[0])}))}const fo=new Map([["check",function(...e){const t=parseInt(e[0]);if(isNaN(t))return void k.instance.LocalInfo("Command error: Usage: wolfgirl check <target ID>");const o=ChatRoomCharacter.find((e=>e.MemberNumber===t));if(!o)return void k.instance.LocalInfo("Command error: Target not found");const n=O(o);V.Access.craft,k.instance.LocalInfo(`>> ${s} ${i} Debug Mode\n`),E.forEach(((e,t)=>{const i=n.get(e.Asset.Group),s=[];if(s.push(`>> Check work sequence${t+1}`),s.push(`  item: ${e.Asset.Name}`),s.push(`  position: ${e.Asset.Group}`),s.push(`  configuration：${e.Craft.Name}`),i){s.push(`  wearing: ${i.Asset.Name}`),s.push(`  color: ${i.Color}`);const t=J(o,e),n=K(i,e);t?(s.push(`  CheckItemOnTarget: ${t}`),s.push(`  CheckOutfitItem: ${n}`),s.push(`  LockedBy: ${i.Property?.LockedBy}`),s.push(`  TypeRecord: ${JSON.stringify(i.Property?.TypeRecord)}`)):s.push(`  CheckItemOnTarget: ${t}`),s.push("  concluding: "+(t&&n?"passed":"failed"))}else s.push("  wearing: undefined"),s.push("  concluding: failed");k.instance.LocalInfo(s.join("\n")+"\n")}))}]]),yo=[{Tag:"wolfgirl",Description:`<${[...fo.keys()].join("|")}> <Parameters> : WolfGirl Mod Commands`,Action:function(e,t){const[,...o]=t.split(" "),n=o?.shift();if(!n||!fo.has(n))return void k.instance.LocalInfo(`Command error, you can use the command: wolfgirl<${[...fo.keys()].join("|")}> <parameter>`);fo.get(n)?.(...o)}}];function wo(e,t){$t.init(e,t);const o=[e=>new Lt(1,5,e),e=>new Lt(2,10,e),e=>new jt(2,10,e,void 0,["ItemBreast","ItemNipplesPiercings","ItemNipples"]),e=>new jt(2,10,e,void 0,["ItemVulva","ItemPelvis","ItemVulvaPiercings"]),e=>new jt(2,10,e,["Slap","Spank","Kick","SpankItem"],void 0),e=>new Ft(2,5,e)];let n=Date.now();setInterval((()=>{if(Player&&Player.MemberNumber&&lt.instance){const i=Date.now(),s=6e5+n;if($t.instance.has_task()||"ChatRoom"!==CurrentScreen)n=i;else if(i>s&&(n=i,lt.points.points<-14)){const n=-14-lt.points.points,i=o[Math.floor(Math.random()*o.length)](n);e=Player,Ne({mode:"action",msg:`{player_wg} automatically accepts the task due to low reward points:\n${(t=i).summary()}`},{player:e}),$t.instance.push_task(t)}}var e,t}),e)}class bo{constructor(e){this.resolution=e,this.timer=Date.now(),setInterval((()=>{if(Player&&Player.MemberNumber&&lt.instance){const e=Date.now(),t=le(Player),o=lt.outfit.items.size>0;lt.statistics.add_time(t,o,e-this.timer),this.timer=e}}),e)}static init(e){bo._instance||(bo._instance=new bo(e))}static get instance(){return bo._instance}}bo._instance=void 0;class vo{constructor(e){this.resolution=e,this.holdStart=0,setInterval((()=>{Player&&Player.MemberNumber&&(void 0!==H.global.cur_description?this.holdStart=0:J(Player,j,!1)&&J(Player,L)&&(0===this.holdStart?this.holdStart=Date.now():Date.now()-this.holdStart>3e5&&(!function(){const e=[new Re([j,L],((e,t)=>{if(2==t.missing.length)return W.interrupted;Ne({mode:"local",msg:"It is found that the registered installation props have not been used for a long time, and the automatic storage process begins."})}),!1),new xe((e=>{J(e,L,!1)&&(e.Appearance=e.Appearance.filter((e=>e.Asset.Group.Name!==L.Asset.Group)),S(e,L.Asset.Group),Ne({mode:"local",msg:`${L.Craft.Name}Completed storage`}))})),new xe((e=>{J(e,j,!1)&&(e.Appearance=e.Appearance.filter((e=>e.Asset.Group.Name!==j.Asset.Group)),S(e,j.Asset.Group),Ne({mode:"local",msg:`${j.Craft.Name}Completed storage`}))})),new $e({mode:"local",msg:"The system reminds you: Do not play with tools in your hands, as this is dangerous."})];H.global.push({description:"InitSafetyUndressSequence",works:e})}(Player),this.holdStart=0)))}),e)}static get instance(){return this._instance}static init(e){this._instance||(this._instance=new vo(e))}}const _o={ItemHead:{value:{typed:3}},ItemEars:{value:{typed:3}},ItemMouth:{value:{g:2}},ItemArms:{value:{typed:3}},ItemHands:{value:{typed:0}},ItemLegs:{value:{typed:1}},ItemFeet:{value:{typed:1}},ItemVulva:{value:"special"}},ko={};function Co(e){return"string"==typeof e.value}function Ao(e){return!Co(e)}function Io(e,t){if(void 0===t)return!1;if(Ao(t))return function(e,t){const o=e.Property?.TypeRecord;return void 0!==o&&Object.keys(t.value).some((e=>o[e]!==t.value[e]))}(e,t);if(Co(t)){if("ItemVulva"===e.Asset.Group.Name){const t=e.Property?.TriggerValues;if(void 0===t)return!1;const o=t.split(",");return"*"!==o[o.length-1]}return!1}return!1}function No(e,t,o){if(Ao(o)&&function(e,t,o){const n=t.Property?.TypeRecord;if(void 0===n)return;const i={};Object.keys(o.value).forEach((e=>i[e]=n[e])),X.instance.on=!0,ExtendedItemSetOptionByRecord(e,t,o.value),X.instance.on=!1,ko[t.Asset.Group.Name]={time:Date.now(),value:i}}(e,t,o),Co(o)&&"ItemVulva"===t.Asset.Group.Name){if(void 0===t.Property?.TriggerValues)return;const o=t.Property.TriggerValues.split(","),n=o[o.length-1];o[o.length-1]="*",t.Property.TriggerValues=o.join(","),S(e,t.Asset.Group.Name),ko[t.Asset.Group.Name]={time:Date.now(),value:n}}}function To(e,t){if(void 0===t)return!1;if(Ao(t))return function(e,t){const o=e.Property?.TypeRecord;return void 0!==o&&void 0!==t&&Object.keys(t.value).some((e=>o[e]))}(e,t);if(Co(t)){if("ItemVulva"===e.Asset.Group.Name){const o=e.Property?.TriggerValues;if(void 0===o)return!1;const n=o.split(",");return n[n.length-1]!==t.value||(ko[e.Asset.Group.Name]=void 0,!1)}return!1}return!1}function So(e,t,o){if(Ao(o)&&function(e,t,o){const n=t.Property?.TypeRecord;void 0!==n&&(X.instance.on=!0,ExtendedItemSetOptionByRecord(e,t,o.value,{push:!0}),X.instance.on=!1)}(e,t,o),Co(o)&&"ItemVulva"===t.Asset.Group.Name){if(void 0===t.Property?.TriggerValues)return;const n=t.Property.TriggerValues.split(",");n[n.length-1]=o.value,t.Property.TriggerValues=n.join(","),S(e,t.Asset.Group.Name),ko[t.Asset.Group.Name]=void 0}}function Mo(e){return e[Math.floor(Math.random()*e.length)]}class Po{onOrgasm(e){if(!le(e))return;if(0===lt.settings.query("orgasmPunishMode"))return;const t=e.Appearance.filter((e=>"Item"===e.Asset.Group.Category)).filter((e=>K(e,D.get(e.Asset.Group.Name))));We(e,Mo(t));const o=t.filter((e=>Io(e,_o[e.Asset.Group.Name])));if(0===o.length){const t=1;lt.points.points-=t,Ne({mode:"action",msg:"{player_wg} has deducted {v} points, and the current points are {points}"},{player:e},{v:t,points:lt.points.points})}else{const t=Mo(o);No(e,t,_o[t.Asset.Group.Name]),Ne({mode:"chat-action",msg:"Oh, how does it feel? {player_wg}, do you know what this icon means now? Will you endure for the sake of freedom, or will you indulge yourself and sink into depravity and become a puppet?"},{player:e})}}onResist(e){if(!le(e))return;const t=lt.settings.query("orgasmPunishMode");if(0===t)return;if(this.resistCounter++,2===t&&this.resistCounter<=4)return;if(1===t&&this.resistCounter<=2)return;this.resistCounter=0;const o=e.Appearance.filter((e=>"Item"===e.Asset.Group.Category)).filter((e=>K(e,D.get(e.Asset.Group.Name)))).filter((e=>"object"==typeof ko[e.Asset.Group.Name])).filter((e=>To(e,_o[e.Asset.Group.Name])));if(0===o.length)return;const n=Mo(o);So(e,n,ko[n.Asset.Group.Name]),Ne({mode:"chat-action",msg:"Well done, {player_wg}. It looks like your hard work and perseverance paid off. So, good kids will naturally be rewarded. Keep up the hard work, ok?"},{player:e})}constructor(e,t=200){this.org=e,this.time_reso=t,this.resistCounter=0,setInterval((()=>{if(!Player||!le(Player))return void Object.keys(ko).forEach((e=>ko[e]=void 0));const e=lt.settings.query("orgasmPunishMode");if(0===e||2===e)return;const t=lt.points.orgasm_punish_time,o=Date.now(),n=N(Player);for(const[e,i]of Object.entries(ko)){if(void 0===i)continue;const s=n.get(e);void 0!==s&&K(s,D.get(s.Asset.Group.Name))?o-i.time>t&&(So(Player,s,i),ko[e]=void 0):ko[e]=void 0}}),t),e.onOrgasm((e=>this.onOrgasm(e))),e.onResist((e=>this.onResist(e)))}static init(e){this._instance||(this._instance=new Po(e))}}function xo(e){e.hookFunction("DialogInventoryBuild",1,((e,t)=>{var o;t(e),o=e[0],e[2]||($.forEach((e=>{const t=o.FocusGroup?.Name;if(!t||t!==e.Asset.Group)return;const n=U(o,o,e);n&&n.Craft&&DialogCanUseCraftedItem(o,n.Craft,n.Asset)&&DialogInventoryAdd(o,{Asset:n.Asset,Craft:n.Craft},!1)})),DialogInventorySort())}))}Po._instance=void 0,function(){if(window.BCWolfGirl_Loaded)return;window.BCWolfGirl_Loaded=!1;const e=document.getElementById("WolfGirlLoader")?.getAttribute("src");if(!e)return void console.error("WolfGirlLoader not found.");const t=e.substring(0,e.lastIndexOf("/")+1)+"assets/",o=n.registerMod({name:s,fullName:s,version:i,repository:"https://gitlab.com/dynilath/BCWolfGirl"}),a=[],r=e=>a.push(e);v.init(o).then((e=>lt.init(o,`${s} v${i} loaded.`).then((t=>{lt.arousal.setMonitor((e=>le(e)),e),wo(1e3,e),Po.init(e)})))),H.init(1e3),bo.init(1e3),vo.init(1e4),V.init(t),k.init(c),go(o),G.init(o).then((e=>function(e){e.onReceiveActivity(po),e.onReceiveChatWhisperEmote(uo)}(e))),xo(o),function(e,t){fe.forEach((o=>o.hook(e,t))),X.init(e,t)}(o,r),oo.init(o),Pt.init(o,r),zt.init(o,r);let l=!0;o.hookFunction("ChatRoomRun",20,((e,t)=>{t(e),l&&(k.instance.LocalAction(`EIL狼女训练套装智能化辅助系统 ${i} 已加载。`),l=!1)})),function(e){e((()=>CommandCombine(yo)))}(r),(async()=>{for(;void 0===window.Player;)await new Promise((e=>setTimeout(e,500)));a.forEach((e=>e()))})(),window.BCWolfGirl_Loaded=!0}()}();
//# sourceMappingURL=main.js.map
