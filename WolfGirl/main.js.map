{"version":3,"file":"main.js","sources":["../../node_modules/.pnpm/bondage-club-mod-sdk@1.2.0/node_modules/bondage-club-mod-sdk/dist/bcmodsdk.js","../../src/bc-wolf-girl/src/Definition.ts","../../src/bc-wolf-girl/src/Control/WolfGirlCtrl/IController.ts","../../src/bc-wolf-girl/src/Control/WolfGirlCtrl/Ctrls/Arousal.ts","../../src/bc-wolf-girl/src/Control/WolfGirlCtrl/Ctrls/Feet.ts","../../src/bc-wolf-girl/src/Control/WolfGirlCtrl/Ctrls/Hands.ts","../../src/bc-utilities/dist/Global.js","../../src/bc-utilities/dist/Orgasm.js","../../src/bc-utilities/dist/ChatMessages.js","../../src/bc-utilities/dist/TypeSupport.js","../../src/bc-utilities/dist/OutfitTypes.js","../../src/bc-utilities/dist/Update.js","../../src/bc-utilities/dist/ActivityFacility.js","../../src/bc-utilities/dist/ChatRoomHandler.js","../../src/bc-wolf-girl/src/Control/OutfitCtrl/Definition.ts","../../src/bc-wolf-girl/src/utils/Apperance.ts","../../src/bc-wolf-girl/src/Control/Worker.ts","../../src/bc-wolf-girl/src/Control/OutfitCtrl/OutfitWork.ts","../../src/bc-wolf-girl/src/Network.ts","../../src/bc-wolf-girl/src/utils/Character.ts","../../src/bc-wolf-girl/src/Control/OutfitCtrl/Utils.ts","../../src/bc-wolf-girl/src/Control/WolfGirlCtrl/Ctrls/FuturisticBypass.ts","../../src/bc-wolf-girl/src/Control/WolfGirlCtrl/Check.ts","../../src/bc-wolf-girl/src/Control/WolfGirlCtrl/Ctrls/Hearing.ts","../../src/bc-wolf-girl/src/Control/WolfGirlCtrl/Ctrls/Toys.ts","../../src/bc-wolf-girl/src/Control/WolfGirlCtrl/Ctrls/Vision.ts","../../src/bc-wolf-girl/src/Control/WolfGirlCtrl/Ctrls/Voice.ts","../../src/bc-wolf-girl/src/Control/WolfGirlCtrl/Ctrls/FCollar.ts","../../src/bc-wolf-girl/src/Control/WolfGirlCtrl/index.ts","../../src/bc-wolf-girl/src/Control/SequenceCtrl/ItemCmdSequence/CmdSequenceMessage.ts","../../src/bc-wolf-girl/src/Control/Message.ts","../../src/bc-wolf-girl/src/Control/CommonWork.ts","../../src/bc-wolf-girl/src/Control/WolfGirlCtrl/Works.ts","../../src/bc-wolf-girl/src/Control/SequenceCtrl/ItemCmdSequence/StdCmdSequence.ts","../../src/bc-wolf-girl/src/Control/SequenceCtrl/ItemCmdSequence/ArousalCtrlSequence.ts","../../src/bc-wolf-girl/src/Control/SequenceCtrl/ItemCmdSequence/HearingCtrlSequence.ts","../../src/bc-wolf-girl/src/Control/SequenceCtrl/ItemCmdSequence/VisionCtrlSequence.ts","../../src/bc-wolf-girl/src/Control/MessageWork.ts","../../src/bc-wolf-girl/src/Control/PunishWork.ts","../../src/bc-wolf-girl/src/Control/SequenceCtrl/ItemCmdSequence/HandsCtrlSequence.ts","../../src/bc-wolf-girl/src/Control/SequenceCtrl/ItemCmdSequence/FeetCtrlSequence.ts","../../src/bc-wolf-girl/src/Control/SequenceCtrl/ItemCmdSequence/VoiceCtrlSequence.ts","../../src/bc-wolf-girl/src/Data/PermissionUtilities.ts","../../src/bc-wolf-girl/src/Data/OutfitUtilities.ts","../../src/bc-wolf-girl/src/Data/DefaultValue.ts","../../src/bc-wolf-girl/src/Data/PointUtilities.ts","../../src/bc-wolf-girl/src/Data/ArousalUtilities.ts","../../src/bc-wolf-girl/src/Data/StatUtilities.ts","../../src/bc-wolf-girl/src/Data/DataCategory.ts","../../src/bc-wolf-girl/src/Data/DataManager.ts","../../src/bc-wolf-girl/src/ChatRoom/Prerequistes.ts","../../src/bc-wolf-girl/src/ChatRoom/Commands/ItemCmds.ts","../../src/bc-wolf-girl/src/Control/SequenceCtrl/ItemCmdSequence/ToysCtrlSequence.ts","../../src/bc-wolf-girl/src/Control/SequenceCtrl/ItemCmdSequence/FuturisticPublicCtrlSequence.ts","../../src/bc-wolf-girl/src/Control/OutfitCtrl/OutfitFixWork.ts","../../src/bc-wolf-girl/src/Control/SequenceCtrl/DressSequence.ts","../../src/bc-wolf-girl/src/Control/StashOutfit.ts","../../src/bc-wolf-girl/src/Control/SequenceCtrl/StopSequence.ts","../../src/bc-wolf-girl/src/Control/SequenceCtrl/StashSequence.ts","../../src/bc-wolf-girl/src/ChatRoom/Commands/OutfitCmds.ts","../../src/bc-wolf-girl/src/Control/SequenceCtrl/CtrlSequence.ts","../../src/bc-wolf-girl/src/ChatRoom/Commands/PermCmds.ts","../../src/bc-wolf-girl/src/Control/RoomCtrl/Work.ts","../../src/bc-wolf-girl/src/ChatRoom/Commands/RoomCmds.ts","../../src/bc-wolf-girl/src/Control/RoomCtrl/RoomCtrl.ts","../../src/bc-wolf-girl/src/Control/SequenceCtrl/StartPunishSequence.ts","../../src/bc-wolf-girl/src/Control/TaskCtrl/ITask.ts","../../src/bc-wolf-girl/src/Control/TaskCtrl/TimedCounterTask.ts","../../src/bc-wolf-girl/src/Control/TaskCtrl/Points.ts","../../src/bc-wolf-girl/src/Control/TaskCtrl/BegOrgasmTask.ts","../../src/bc-wolf-girl/src/Control/TaskCtrl/InteractTask.ts","../../src/bc-wolf-girl/src/Control/TaskCtrl/ResistTask.ts","../../src/bc-wolf-girl/src/Control/TaskCtrl/TaskCtrl.ts","../../src/bc-wolf-girl/src/ChatRoom/Commands/PointsCmds.ts","../../src/bc-wolf-girl/src/ChatRoom/Commands/StatCmds.ts","../../src/bc-wolf-girl/src/Control/Injection/IInjection.ts","../../src/bc-wolf-girl/src/Control/Injection/index.ts","../../src/bc-wolf-girl/src/Control/Injection/Anesthetic.ts","../../src/bc-wolf-girl/src/Control/Injection/Pickmeup.ts","../../src/bc-wolf-girl/src/Control/Injection/Aphrodisiac.ts","../../src/bc-wolf-girl/src/Control/Injection/Inhibitor.ts","../../src/bc-wolf-girl/src/Control/SequenceCtrl/InjectionSequence/index.ts","../../src/bc-wolf-girl/src/ChatRoom/Activity/WolfGirlItemsSwitch.ts","../../src/bc-wolf-girl/src/ChatRoom/Activity/InjectionExtend.ts","../../src/bc-wolf-girl/src/ChatRoom/Activity/DrinkExtend.ts","../../src/bc-wolf-girl/src/ChatRoom/Activity/index.ts","../../src/bc-wolf-girl/src/Control/SequenceCtrl/InjectionSequence/SwitchInjector.ts","../../src/bc-wolf-girl/src/ChatRoom/Commands/InjectionCmds.ts","../../src/bc-wolf-girl/src/ChatRoom/Commands/index.ts","../../src/bc-wolf-girl/src/ChatRoom/Run.ts","../../src/bc-wolf-girl/src/ChatRoom/Handler.ts","../../src/bc-wolf-girl/src/ChatRoom/OutfitCheckChatCmd.ts","../../src/bc-wolf-girl/src/Control/TaskCtrl/index.ts","../../src/bc-wolf-girl/src/Control/TimeStat.ts","../../src/bc-wolf-girl/src/Control/ToolsSafety.ts","../../src/bc-wolf-girl/src/Control/OrgasmPunishMode.ts","../../src/bc-wolf-girl/src/Control/OutfitCtrl/Inventory.ts","../../src/bc-wolf-girl/src/WolfGirl.ts"],"sourcesContent":["// Bondage Club Mod Development Kit (1.2.0)\n// For more info see: https://github.com/Jomshir98/bondage-club-mod-sdk\n/** @type {ModSDKGlobalAPI} */\nvar bcModSdk=function(){\"use strict\";const o=\"1.2.0\";function e(o){alert(\"Mod ERROR:\\n\"+o);const e=new Error(o);throw console.error(e),e}const t=new TextEncoder;function n(o){return!!o&&\"object\"==typeof o&&!Array.isArray(o)}function r(o){const e=new Set;return o.filter((o=>!e.has(o)&&e.add(o)))}const i=new Map,a=new Set;function c(o){a.has(o)||(a.add(o),console.warn(o))}function s(o){const e=[],t=new Map,n=new Set;for(const r of f.values()){const i=r.patching.get(o.name);if(i){e.push(...i.hooks);for(const[e,a]of i.patches.entries())t.has(e)&&t.get(e)!==a&&c(`ModSDK: Mod '${r.name}' is patching function ${o.name} with same pattern that is already applied by different mod, but with different pattern:\\nPattern:\\n${e}\\nPatch1:\\n${t.get(e)||\"\"}\\nPatch2:\\n${a}`),t.set(e,a),n.add(r.name)}}e.sort(((o,e)=>e.priority-o.priority));const r=function(o,e){if(0===e.size)return o;let t=o.toString().replaceAll(\"\\r\\n\",\"\\n\");for(const[n,r]of e.entries())t.includes(n)||c(`ModSDK: Patching ${o.name}: Patch ${n} not applied`),t=t.replaceAll(n,r);return(0,eval)(`(${t})`)}(o.original,t);let i=function(e){var t,i;const a=null===(i=(t=m.errorReporterHooks).hookChainExit)||void 0===i?void 0:i.call(t,o.name,n),c=r.apply(this,e);return null==a||a(),c};for(let t=e.length-1;t>=0;t--){const n=e[t],r=i;i=function(e){var t,i;const a=null===(i=(t=m.errorReporterHooks).hookEnter)||void 0===i?void 0:i.call(t,o.name,n.mod),c=n.hook.apply(this,[e,o=>{if(1!==arguments.length||!Array.isArray(e))throw new Error(`Mod ${n.mod} failed to call next hook: Expected args to be array, got ${typeof o}`);return r.call(this,o)}]);return null==a||a(),c}}return{hooks:e,patches:t,patchesSources:n,enter:i,final:r}}function l(o,e=!1){let r=i.get(o);if(r)e&&(r.precomputed=s(r));else{let e=window;const a=o.split(\".\");for(let t=0;t<a.length-1;t++)if(e=e[a[t]],!n(e))throw new Error(`ModSDK: Function ${o} to be patched not found; ${a.slice(0,t+1).join(\".\")} is not object`);const c=e[a[a.length-1]];if(\"function\"!=typeof c)throw new Error(`ModSDK: Function ${o} to be patched not found`);const l=function(o){let e=-1;for(const n of t.encode(o)){let o=255&(e^n);for(let e=0;e<8;e++)o=1&o?-306674912^o>>>1:o>>>1;e=e>>>8^o}return((-1^e)>>>0).toString(16).padStart(8,\"0\").toUpperCase()}(c.toString().replaceAll(\"\\r\\n\",\"\\n\")),d={name:o,original:c,originalHash:l};r=Object.assign(Object.assign({},d),{precomputed:s(d),router:()=>{},context:e,contextProperty:a[a.length-1]}),r.router=function(o){return function(...e){return o.precomputed.enter.apply(this,[e])}}(r),i.set(o,r),e[r.contextProperty]=r.router}return r}function d(){for(const o of i.values())o.precomputed=s(o)}function p(){const o=new Map;for(const[e,t]of i)o.set(e,{name:e,original:t.original,originalHash:t.originalHash,sdkEntrypoint:t.router,currentEntrypoint:t.context[t.contextProperty],hookedByMods:r(t.precomputed.hooks.map((o=>o.mod))),patchedByMods:Array.from(t.precomputed.patchesSources)});return o}const f=new Map;function u(o){f.get(o.name)!==o&&e(`Failed to unload mod '${o.name}': Not registered`),f.delete(o.name),o.loaded=!1,d()}function g(o,t){o&&\"object\"==typeof o||e(\"Failed to register mod: Expected info object, got \"+typeof o),\"string\"==typeof o.name&&o.name||e(\"Failed to register mod: Expected name to be non-empty string, got \"+typeof o.name);let r=`'${o.name}'`;\"string\"==typeof o.fullName&&o.fullName||e(`Failed to register mod ${r}: Expected fullName to be non-empty string, got ${typeof o.fullName}`),r=`'${o.fullName} (${o.name})'`,\"string\"!=typeof o.version&&e(`Failed to register mod ${r}: Expected version to be string, got ${typeof o.version}`),o.repository||(o.repository=void 0),void 0!==o.repository&&\"string\"!=typeof o.repository&&e(`Failed to register mod ${r}: Expected repository to be undefined or string, got ${typeof o.version}`),null==t&&(t={}),t&&\"object\"==typeof t||e(`Failed to register mod ${r}: Expected options to be undefined or object, got ${typeof t}`);const i=!0===t.allowReplace,a=f.get(o.name);a&&(a.allowReplace&&i||e(`Refusing to load mod ${r}: it is already loaded and doesn't allow being replaced.\\nWas the mod loaded multiple times?`),u(a));const c=o=>{let e=g.patching.get(o.name);return e||(e={hooks:[],patches:new Map},g.patching.set(o.name,e)),e},s=(o,t)=>(...n)=>{var i,a;const c=null===(a=(i=m.errorReporterHooks).apiEndpointEnter)||void 0===a?void 0:a.call(i,o,g.name);g.loaded||e(`Mod ${r} attempted to call SDK function after being unloaded`);const s=t(...n);return null==c||c(),s},p={unload:s(\"unload\",(()=>u(g))),hookFunction:s(\"hookFunction\",((o,t,n)=>{\"string\"==typeof o&&o||e(`Mod ${r} failed to patch a function: Expected function name string, got ${typeof o}`);const i=l(o),a=c(i);\"number\"!=typeof t&&e(`Mod ${r} failed to hook function '${o}': Expected priority number, got ${typeof t}`),\"function\"!=typeof n&&e(`Mod ${r} failed to hook function '${o}': Expected hook function, got ${typeof n}`);const s={mod:g.name,priority:t,hook:n};return a.hooks.push(s),d(),()=>{const o=a.hooks.indexOf(s);o>=0&&(a.hooks.splice(o,1),d())}})),patchFunction:s(\"patchFunction\",((o,t)=>{\"string\"==typeof o&&o||e(`Mod ${r} failed to patch a function: Expected function name string, got ${typeof o}`);const i=l(o),a=c(i);n(t)||e(`Mod ${r} failed to patch function '${o}': Expected patches object, got ${typeof t}`);for(const[n,i]of Object.entries(t))\"string\"==typeof i?a.patches.set(n,i):null===i?a.patches.delete(n):e(`Mod ${r} failed to patch function '${o}': Invalid format of patch '${n}'`);d()})),removePatches:s(\"removePatches\",(o=>{\"string\"==typeof o&&o||e(`Mod ${r} failed to patch a function: Expected function name string, got ${typeof o}`);const t=l(o);c(t).patches.clear(),d()})),callOriginal:s(\"callOriginal\",((o,t,n)=>{\"string\"==typeof o&&o||e(`Mod ${r} failed to call a function: Expected function name string, got ${typeof o}`);const i=l(o);return Array.isArray(t)||e(`Mod ${r} failed to call a function: Expected args array, got ${typeof t}`),i.original.apply(null!=n?n:globalThis,t)})),getOriginalHash:s(\"getOriginalHash\",(o=>{\"string\"==typeof o&&o||e(`Mod ${r} failed to get hash: Expected function name string, got ${typeof o}`);return l(o).originalHash}))},g={name:o.name,fullName:o.fullName,version:o.version,repository:o.repository,allowReplace:i,api:p,loaded:!0,patching:new Map};return f.set(o.name,g),Object.freeze(p)}function h(){const o=[];for(const e of f.values())o.push({name:e.name,fullName:e.fullName,version:e.version,repository:e.repository});return o}let m;const y=void 0===window.bcModSdk?window.bcModSdk=function(){const e={version:o,apiVersion:1,registerMod:g,getModsInfo:h,getPatchingInfo:p,errorReporterHooks:Object.seal({apiEndpointEnter:null,hookEnter:null,hookChainExit:null})};return m=e,Object.freeze(e)}():(n(window.bcModSdk)||e(\"Failed to init Mod SDK: Name already in use\"),1!==window.bcModSdk.apiVersion&&e(`Failed to init Mod SDK: Different version already loaded ('1.2.0' vs '${window.bcModSdk.version}')`),window.bcModSdk.version!==o&&alert(`Mod SDK warning: Loading different but compatible versions ('1.2.0' vs '${window.bcModSdk.version}')\\nOne of mods you are using is using an old version of SDK. It will work for now but please inform author to update`),window.bcModSdk);return\"undefined\"!=typeof exports&&(Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.default=y),y}();\n","export const ModVersion = __mod_version__;\r\nexport const ModName = __mod_name__;\r\nexport const GIT_REPO = __repo__;\r\nexport const SCRIPT_ID = __script_id__;\r\n\r\nexport const HTMLIDPrefix = \"BCWG_\";\r\n\r\nexport const DebugMode = false;\r\n\r\nexport const FrequentDataKeyName = \"BCWolfGirlFrequentData\";\r\nexport const DataKeyName = \"BCWolfGirlData\";\r\n\r\nexport const CUSTOM_ACTION_TAG = \"SSCustomAction\";","import { ModSDKModAPI } from \"bondage-club-mod-sdk\";\r\n\r\nexport interface TestCtrlMissingResult {\r\n    missing: AssetGroupItemName[];\r\n}\r\n\r\nexport type TestCtrlResult = Partial<TestCtrlMissingResult> & {\r\n    rejected?: \"type\" | \"mode\" | \"itemprop\" | \"unchanged\";\r\n}\r\n\r\nexport abstract class IController {\r\n    abstract readonly type: ControllerType;\r\n    abstract readonly target_item: AssetGroupItemName[];\r\n    abstract readonly available_ctrls: CtrlType[];\r\n    abstract set(player: PlayerCharacter, item: (Item | undefined)[], type: CtrlType): void;\r\n    abstract test(player: PlayerCharacter, item: Item[], type: CtrlType): TestCtrlResult;\r\n    hook(mod: ModSDKModAPI, lateHook: (callback: () => void) => void): void { };\r\n}\r\n\r\nexport type ControllerType = \"ArousalCtrl\" | \"FeetCtrl\" | \"HandsCtrl\" | \"ToysCtrl\" | \"VisionCtrl\" |\r\n    \"VoiceCtrl\" | \"HearingCtrl\" | \"FuturisticPublicCtrl\";\r\n\r\nexport type CtrlType = \"off\" | \"base\" | \"total\" | \"edge\" | \"deny\" | \"open\" | \"max\" | \"close\" | \"random\";\r\n\r\nexport function DetailedItemTestRecords(items: Item[], compare: (oldrecords: TypeRecord[]) => TestCtrlResult): TestCtrlResult {\r\n    const oldrecords = CollectTypeRecords(items);\r\n    if (!oldrecords) return TReject(\"itemprop\");\r\n    return compare(oldrecords);\r\n}\r\n\r\nexport function StandardItemTestRecords(items: Item[], target: TypeRecord[]): TestCtrlResult {\r\n    const oldrecords = CollectTypeRecords(items);\r\n    if (!oldrecords) return TReject(\"itemprop\");\r\n    if (RecordsEqual(target, oldrecords)) return TReject(\"unchanged\");\r\n    return TAccept();\r\n}\r\n\r\nexport const TReject = (reason: Required<TestCtrlResult>[\"rejected\"]) => ({ rejected: reason }) as TestCtrlResult;\r\n\r\nexport const TAccept = () => ({}) as TestCtrlResult;\r\n\r\nexport function RecordsEqual(target: TypeRecord[], cur: TypeRecord[]) {\r\n    if (target.length > cur.length) return false;\r\n    return target.every((e, idx) => Object.keys(e).every(key => e[key] === cur[idx][key]));\r\n}\r\n\r\nexport function CollectTypeRecords(items: Item[]): TypeRecord[] | undefined {\r\n    if (items.some(item => item.Property?.TypeRecord === undefined)) return undefined;\r\n    return items.map(item => item.Property?.TypeRecord) as TypeRecord[];\r\n}\r\n\r\nexport function StandardItemSetRecords(player: PlayerCharacter, items: (Item | undefined)[], target: TypeRecord[]) {\r\n    items.forEach((item, idx) => target[idx] && item && ExtendedItemSetOptionByRecord(player, item, target[idx]));\r\n}\r\n\r\n","import { CtrlType } from \"../IController\";\r\nimport { TAccept } from \"../IController\";\r\nimport { TReject } from \"../IController\";\r\nimport { TestCtrlResult } from \"../IController\";\r\nimport { IController } from \"../IController\";\r\nimport { DetailedItemTestRecords } from \"../IController\";\r\n\r\nfunction calcRecordValue(type: CtrlType) {\r\n    if (type === \"off\") return { o: 0 };\r\n    else if (type === \"edge\") return { o: 1 };\r\n    else if (type === \"deny\") return { o: 2 };\r\n    else return { o: 0 };\r\n}\r\n\r\nexport class ArousalCtrl extends IController {\r\n    readonly type = \"ArousalCtrl\";\r\n    readonly target_item: AssetGroupItemName[] = [\"ItemPelvis\"];\r\n    readonly available_ctrls: CtrlType[] = [\"off\", \"edge\", \"deny\"];\r\n    set(player: PlayerCharacter, item: (Item | undefined)[], type: CtrlType): void {\r\n        const [pelvis] = item;\r\n        if (!pelvis) return;\r\n\r\n        const oldLock = pelvis.Property?.LockedBy;\r\n        const oldMember = pelvis.Property?.LockMemberNumber;\r\n        ExtendedItemSetOptionByRecord(player, pelvis, calcRecordValue(type));\r\n\r\n        // record setting is not correct for some reason\r\n        ExtendedItemInit(player, pelvis);\r\n        if (oldLock && oldMember) InventoryLock(player, pelvis, oldLock, oldMember);\r\n    }\r\n\r\n    test(player: PlayerCharacter, item: Item[], type: CtrlType): TestCtrlResult {\r\n        return DetailedItemTestRecords(item, (oldrecords) => {\r\n            const [pelvis] = oldrecords;\r\n            if (pelvis.o !== undefined) {\r\n                if (pelvis.o === calcRecordValue(type).o) return TReject(\"unchanged\");\r\n                return TAccept();\r\n            }\r\n            return TReject(\"itemprop\");\r\n        });\r\n    }\r\n}","import { CtrlType } from \"../IController\";\r\nimport { TestCtrlResult } from \"../IController\";\r\nimport { IController } from \"../IController\";\r\nimport { StandardItemSetRecords } from \"../IController\";\r\nimport { StandardItemTestRecords } from \"../IController\";\r\n\r\nfunction calcRecordValue(type: CtrlType) {\r\n    if (type === \"off\") return [{ typed: 0 }, { typed: 0 }];\r\n    else if (type === \"base\") return [{ typed: 2 }, { typed: 2 }];\r\n    else if (type === \"total\") return [{ typed: 1 }, { typed: 1 }];\r\n    else return [];\r\n}\r\n\r\nexport class FeetCtrl extends IController {\r\n    readonly type = \"FeetCtrl\";\r\n    readonly target_item: AssetGroupItemName[] = [\"ItemFeet\", \"ItemLegs\", \"ItemBoots\"];\r\n    available_ctrls: CtrlType[] = [\"off\", \"base\", \"total\"];\r\n\r\n    set(player: PlayerCharacter, item: (Item | undefined)[], type: CtrlType): void {\r\n        StandardItemSetRecords(player, item, calcRecordValue(type));\r\n    }\r\n\r\n    test(player: PlayerCharacter, item: Item[], type: CtrlType): TestCtrlResult {\r\n        return StandardItemTestRecords(item, calcRecordValue(type));\r\n    }\r\n}","import { CtrlType } from \"../IController\";\r\nimport { TAccept } from \"../IController\";\r\nimport { TReject } from \"../IController\";\r\nimport { TestCtrlResult } from \"../IController\";\r\nimport { IController } from \"../IController\";\r\nimport { StandardItemSetRecords } from \"../IController\";\r\nimport { RecordsEqual } from \"../IController\";\r\nimport { StandardItemTestRecords } from \"../IController\";\r\nimport { DetailedItemTestRecords } from \"../IController\";\r\n\r\nfunction calcRecordValue(type: CtrlType): TypeRecord[] {\r\n    if (type === \"off\") return [{ typed: 1 }, { typed: 0 }];\r\n    else if (type === \"base\") return [{ typed: 0 }, { typed: 1 }];\r\n    else if (type === \"total\") return [{ typed: 0 }, { typed: 3 }];\r\n    else return [{ typed: 1 }, { typed: 0 }];\r\n}\r\n\r\nexport class HandsCtrl extends IController {\r\n    readonly type = \"HandsCtrl\";\r\n    readonly target_item: AssetGroupItemName[] = [\"ItemHands\", \"ItemArms\"];\r\n    available_ctrls: CtrlType[] = [\"off\", \"base\", \"total\"];\r\n    set(player: PlayerCharacter, item: (Item | undefined)[], type: CtrlType): void {\r\n        StandardItemSetRecords(player, item, calcRecordValue(type));\r\n    }\r\n\r\n    test(player: PlayerCharacter, item: Item[], type: CtrlType): TestCtrlResult {\r\n        return StandardItemTestRecords(item, calcRecordValue(type));\r\n    }\r\n}","const GlobalKey = \"BCUtilities\";\nexport function AquireGlobal(key, defaultValue) {\n    return new Promise((resolve) => {\n        if (!window[GlobalKey])\n            window[GlobalKey] = {};\n        const global = window[GlobalKey];\n        const handlerGetter = global[key];\n        if (handlerGetter && typeof handlerGetter === \"function\") {\n            const handler = handlerGetter();\n            if (handler) {\n                resolve(handler);\n                return;\n            }\n        }\n        const handler = defaultValue();\n        global[key] = () => handler;\n        resolve(handler);\n    });\n}\n","import { AquireGlobal } from \"./Global\";\nexport class OrgasmMonitor {\n    constructor(mod) {\n        this.events = {\n            Orgasm: [],\n            Resist: [],\n            Ruined: []\n        };\n        mod.hookFunction('ActivityOrgasmStop', 9, (args, next) => {\n            const C = args[0];\n            const Progress = args[1];\n            if (C.IsPlayer()) {\n                if (ActivityOrgasmRuined)\n                    this.events.Ruined.forEach(_ => _(C));\n                else if (Progress >= 60)\n                    this.events.Resist.forEach(_ => _(C));\n            }\n            next(args);\n        });\n        mod.hookFunction('ActivityOrgasmStart', 9, (args, next) => {\n            const C = args[0];\n            if (C.IsPlayer() && !ActivityOrgasmRuined)\n                this.events.Orgasm.forEach(_ => _(C));\n            next(args);\n        });\n    }\n    onOrgasm(event) {\n        this.events.Orgasm.push(event);\n    }\n    onResist(event) {\n        this.events.Resist.push(event);\n    }\n    onRuined(event) {\n        this.events.Ruined.push(event);\n    }\n    on(event, callback) {\n        this.events[event]?.push(callback);\n    }\n    static init(mod) {\n        return AquireGlobal(\"OrgasmMonitor\", () => new OrgasmMonitor(mod));\n    }\n}\n","function isTargetCharacter(v) {\n    return typeof v.TargetCharacter === \"number\";\n}\nfunction isSourceCharacter(v) {\n    return typeof v.SourceCharacter === \"number\";\n}\nfunction isActivityName(v) {\n    return typeof v.ActivityName === \"string\";\n}\nfunction isFocusAssetGroup(v) {\n    return typeof v.FocusGroupName === \"string\";\n}\nfunction isActivityAsset(v) {\n    return v.Tag === \"ActivityAsset\";\n}\nexport function ActivityDeconstruct(dict) {\n    const ret = dict.reduce((pv, cv) => {\n        if (isTargetCharacter(cv))\n            pv.TargetCharacter = cv.TargetCharacter;\n        else if (isSourceCharacter(cv))\n            pv.SourceCharacter = cv.SourceCharacter;\n        else if (isActivityName(cv))\n            pv.ActivityName = cv.ActivityName;\n        else if (isFocusAssetGroup(cv))\n            pv.ActivityGroup = cv.FocusGroupName;\n        else if (isActivityAsset(cv)) {\n            pv.Asset = {\n                AssetName: cv.AssetName,\n                GroupName: cv.GroupName,\n                CraftName: cv.CraftName || \"\",\n            };\n        }\n        return pv;\n    }, { BCDictionary: dict });\n    return [ret.TargetCharacter, ret.SourceCharacter, ret.ActivityName, ret.ActivityGroup].some((x) => x === undefined)\n        ? undefined\n        : ret;\n}\nexport class ChatRoomAction {\n    static get instance() {\n        return ChatRoomAction._instance;\n    }\n    static init(tag) {\n        if (ChatRoomAction._instance)\n            return;\n        ChatRoomAction._instance = new ChatRoomAction(tag);\n    }\n    constructor(CUSTOM_ACTION_TAG) {\n        this.CUSTOM_ACTION_TAG = CUSTOM_ACTION_TAG;\n        const DictItem = (Content) => { return { Tag: `MISSING TEXT IN \"Interface.csv\": ${CUSTOM_ACTION_TAG}`, Text: Content }; };\n        this.SendAction = (Content) => {\n            if (!Content || !Player || !Player.MemberNumber)\n                return;\n            ServerSend(\"ChatRoomChat\", {\n                Content: CUSTOM_ACTION_TAG,\n                Type: \"Action\",\n                Dictionary: [DictItem(Content)]\n            });\n        };\n        this.SendChat = (Content) => {\n            if (!Content || !Player || !Player.MemberNumber)\n                return;\n            ServerSend(\"ChatRoomChat\", {\n                Content: Content,\n                Type: \"Chat\"\n            });\n        };\n        this.LocalAction = (Content) => {\n            if (!Content || !Player || !Player.MemberNumber)\n                return;\n            ChatRoomMessage({\n                Sender: Player.MemberNumber,\n                Content: CUSTOM_ACTION_TAG,\n                Type: \"Action\",\n                Dictionary: [DictItem(Content)],\n            });\n        };\n        this.LocalInfo = (Content) => {\n            if (!Content || !Player || !Player.MemberNumber)\n                return;\n            ChatRoomMessage({\n                Sender: Player.MemberNumber,\n                Content: Content,\n                Type: \"LocalMessage\",\n            });\n        };\n        this.SendWhisper = (target, Content) => {\n            if (!Content || !Player || !Player.MemberNumber)\n                return;\n            ServerSend(\"ChatRoomChat\", {\n                Content: Content,\n                Type: \"Whisper\",\n                Target: target\n            });\n        };\n        this.SendBeep = (target, Content) => {\n            if (!Content || !Player || !Player.MemberNumber)\n                return;\n            ServerSend(\"AccountBeep\", {\n                MemberNumber: target,\n                Message: Content,\n                BeepType: \"\",\n                IsSecret: false\n            });\n        };\n    }\n}\nChatRoomAction._instance = undefined;\n","export function Result(cal) {\n    return cal instanceof Function ? cal() : cal;\n}\nexport function IsStringArray(v) {\n    return Array.isArray(v) && v.every(i => typeof i === \"string\");\n}\nexport function CompareColor(a, b) {\n    if (a === b)\n        return true;\n    if (!a || !b)\n        return false;\n    if (a.length !== b.length)\n        return false;\n    return a.every((v, i) => v === b[i]);\n}\nexport function CompareRecord(a, b) {\n    return Object.keys(a).every(k => a[k] === b[k]);\n}\n","import { CompareColor, CompareRecord, IsStringArray, Result } from \"./TypeSupport\";\nexport function buildOutfitItemMap(src) {\n    return new Map(src.map(_ => [_.Asset.Group, _]));\n}\nexport function filterOutfitItemMap(src, group) {\n    return new Map(group.map(_ => [_, src.get(_)]));\n}\nexport function buildAppMap(src) {\n    return new Map(src.Appearance.map(_ => [_.Asset.Group.Name, _]));\n}\nexport function buildItemsMap(src) {\n    return new Map(src.Appearance.filter(_ => _.Asset.Group.Category === \"Item\").map(_ => [_.Asset.Group.Name, _]));\n}\nexport function CheckOutfitItem(V, E, option) {\n    if (!V || !E)\n        return false;\n    if (V.Asset.Name !== E.Asset.Name)\n        return false;\n    if (V.Asset.AllowLock) {\n        if (!V.Property)\n            return false;\n        if (option?.lock === true && !V.Property?.LockedBy)\n            return false;\n        if (typeof option?.lock === \"string\" && V.Property?.LockedBy !== option.lock)\n            return false;\n    }\n    if (option?.group && V.Asset.Group.Name !== E.Asset.Group)\n        return false;\n    if (option?.craft) {\n        if (typeof option.craft === \"boolean\") {\n            if (!V.Craft || V.Craft.Name !== E.Craft.Name || V.Craft.Description !== E.Craft.Description)\n                return false;\n        }\n        else {\n            if (!V.Craft || V.Craft.Name !== E.Craft.Name || V.Craft.Description !== E.Craft.Description\n                || V.Craft.MemberNumber !== option.craft.MemberNumber || V.Craft.MemberName !== option.craft.MemberName)\n                return false;\n        }\n    }\n    return true;\n}\nexport function CheckOutfitItemCE(C, E, option) {\n    if (!E)\n        return false;\n    const iV = C.Appearance.find(e => e.Asset.Group.Name === E.Asset.Group);\n    if (!iV)\n        return false;\n    return CheckOutfitItem(iV, E, option);\n}\nexport function CheckOutfitCloth(V, E, option) {\n    if (!E)\n        return false;\n    if (V.Asset.Name !== E.Asset.Name)\n        return false;\n    if (option?.color && !CompareColor(V.Color, Result(E.Color)))\n        return false;\n    return true;\n}\nexport function CheckTargetOutfitItems(Target, Es, option) {\n    const app_map = new Map(Target.Appearance.map(_ => [_.Asset.Group.Name, _]));\n    return Es.every(E => {\n        let V = app_map.get(E.Asset.Group);\n        return V && CheckOutfitItem(V, E, option);\n    });\n}\nexport function OutfitItemManifest(Wearer, E, option) {\n    const Asset = AssetGet(Wearer.AssetFamily, E.Asset.Group, E.Asset.Name);\n    if (!Asset)\n        return;\n    const Color = Result(E.Color);\n    const Craft = option?.craft && E.Craft && {\n        ...E.Craft,\n        MemberNumber: option.craft.MemberNumber,\n        MemberName: option.craft.MemberName,\n        Item: E.Asset.Name,\n        ItemProperty: null,\n        Color: typeof Color === \"string\" ? Color : Color.join(\",\"),\n        Lock: E.Craft?.Lock ? E.Craft.Lock : \"\",\n        Private: true,\n    };\n    let ret = { Asset, Color, Craft };\n    ExtendedItemInit(Wearer, ret, false, false);\n    ret.Difficulty = option?.difficulty ?? Asset.Difficulty;\n    const props = E.Property && Result(E.Property);\n    if (props) {\n        if (props.TypeRecord)\n            ExtendedItemSetOptionByRecord(Wearer, ret, props.TypeRecord, { push: false });\n        if (!ret.Property)\n            ret.Property = {};\n        const rProps = ret.Property;\n        for (const key in props) {\n            const k = key;\n            if (key === \"TypeRecord\")\n                continue;\n            else if (key === \"Effect\") {\n                if (IsStringArray(props.Effect)) {\n                    if (IsStringArray(rProps.Effect)) {\n                        props.Effect.forEach(e => {\n                            if (rProps.Effect && !rProps.Effect.includes(e)) {\n                                rProps.Effect.push(e);\n                            }\n                        });\n                    }\n                    else {\n                        rProps.Effect = Array.from(props.Effect);\n                    }\n                }\n            }\n            else if (key === \"ExcludeEffect\") {\n                if (IsStringArray(props.ExcludeEffect) && IsStringArray(rProps.Effect)) {\n                    rProps.Effect = rProps.Effect.filter(e => !props.ExcludeEffect?.includes(e));\n                }\n            }\n            else if (rProps[k] === undefined || typeof rProps[k] === typeof props[k]) {\n                Object.assign(rProps, { [k]: props[k] });\n            }\n        }\n    }\n    if (option?.lock) {\n        const lock = AssetGet(Wearer.AssetFamily, \"ItemMisc\", option.lock.Lock);\n        if (lock)\n            InventoryLock(Wearer, ret, { Asset: lock }, option.lock.MemberNumber, false);\n    }\n    else if (E.Craft?.Lock) {\n        const lock = AssetGet(Wearer.AssetFamily, \"ItemMisc\", E.Craft.Lock);\n        if (lock)\n            InventoryLock(Wearer, ret, { Asset: lock }, null, false);\n    }\n    return ret;\n}\nexport function OutfitClothManifest(Wearer, E) {\n    const Asset = AssetGet(Wearer.AssetFamily, E.Asset.Group, E.Asset.Name);\n    if (!Asset)\n        return;\n    const Color = Result(E.Color);\n    let ret = { Asset, Color };\n    ExtendedItemInit(Wearer, ret, false, false);\n    if (E.Property?.TypeRecord)\n        ExtendedItemSetOptionByRecord(Wearer, ret, E.Property?.TypeRecord, { push: false });\n    if (E.Property?.OverridePriority) {\n        if (ret.Property)\n            ret.Property.OverridePriority = E.Property.OverridePriority;\n    }\n    return ret;\n}\nfunction CompareCraft(A, B) {\n    if (A === B)\n        return true;\n    if (!A || !B)\n        return false;\n    return ['Item', 'Description', 'Lock', 'Color', 'Property', 'MemberName', 'MemberNumber']\n        .every(key => A[key] === B[key]);\n}\nfunction CompareTypeRecord(A, B) {\n    if (A === B)\n        return true;\n    if (!A || !B)\n        return false;\n    return CompareRecord(A, B);\n}\nfunction CompareEffect(A, B) {\n    if (A === B)\n        return true;\n    if (!A || !B)\n        return false;\n    return A.length === B.length && A.every(e => B.includes(e));\n}\nexport function CompareItem(A, B) {\n    for (const key in A) {\n        if (key === \"Asset\") {\n            if (A.Asset.Name !== B.Asset.Name || A.Asset.Group.Name !== B.Asset.Group.Name)\n                return false;\n        }\n        else if (key === \"Color\") {\n            if (!CompareColor(A.Color, B.Color))\n                return false;\n        }\n        else if (key === \"Craft\") {\n            if (!CompareCraft(A.Craft, B.Craft))\n                return false;\n        }\n        else if (key === \"Difficulty\") {\n            if (A.Difficulty !== B.Difficulty)\n                return false;\n        }\n        else if (key === \"Property\") {\n            if (!CompareTypeRecord(A.Property?.TypeRecord, B.Property?.TypeRecord))\n                return false;\n            if (!CompareEffect(A.Property?.Effect, B.Property?.Effect))\n                return false;\n            if (!['LockedBy', 'Text',\n                'Text2', 'Text3'].every(k => A.Property?.[k] === B.Property?.[k]))\n                return false;\n        }\n    }\n    return true;\n}\n","export function AppearanceUpdate(C, ...Group) {\n    if (ChatRoomData) {\n        CharacterRefresh(C, false);\n        if (Group.length > 0)\n            Group.forEach(G => { ChatRoomCharacterItemUpdate(C, G); });\n        else\n            ChatRoomCharacterUpdate(C);\n    }\n    else {\n        CharacterRefresh(C, true);\n    }\n}\n","import { ActivityDeconstruct } from \"./ChatMessages\";\nexport class IActivityCustom {\n    adjustDict(Content, dict) { return dict; }\n    ;\n    init(mod) { }\n    ;\n    constructor(mode, onBodyparts, activity, image) {\n        this.mode = mode;\n        this.onBodyparts = onBodyparts;\n        this.activity = activity;\n        this.image = image;\n    }\n}\nexport class IActivityExtended {\n    adjustDict(Content, dict) { return dict; }\n    ;\n    init(mod) { }\n    ;\n    constructor(mode, onBodyparts, activity) {\n        this.mode = mode;\n        this.onBodyparts = onBodyparts;\n        this.activity = activity;\n    }\n}\nexport class IActivityPrerequisite {\n}\nexport class ActivityFacility {\n    constructor(mod) {\n        this.mod = mod;\n        this.prereqMap = new Map();\n        this.customActMap = new Map();\n        this.actHandlers = new Map();\n        mod.hookFunction(\"ActivityCheckPrerequisite\", 1, (args, next) => {\n            const [prereq, acting, acted, group] = args;\n            const cusPrereq = this.prereqMap.get(prereq);\n            if (cusPrereq)\n                return cusPrereq.test(acting, acted, group);\n            return next(args);\n        });\n        mod.hookFunction(\"DrawGetImage\", 1, (args, next) => {\n            const values = args[0].split(\"/\");\n            if (values[2] === \"Activity\") {\n                const act = this.customActMap.get(values[3].split(\".\")[0]);\n                if (act)\n                    return next([act.image]);\n            }\n            return next(args);\n        });\n        mod.hookFunction(\"ActivityDictionaryText\", 1, (args, next) => {\n            const splits = args[0].split(\"-\");\n            const activity_name = splits[splits.length - 1];\n            return this.customActMap.get(activity_name)?.text(args[0]) ?? next(args);\n        });\n        mod.hookFunction(\"ServerSend\", 1, (args, next) => {\n            if (args[0] !== \"ChatRoomChat\" || args[1]?.Type !== \"Activity\")\n                return next(args);\n            const dict = args[1].Dictionary;\n            if (!dict)\n                return next(args);\n            const d = ActivityDeconstruct(dict);\n            if (!d)\n                return next(args);\n            const myact = this.actHandlers.get(d.ActivityName);\n            if (!myact)\n                return next(args);\n            args[1].Dictionary = myact.reduce((acc, act) => act.adjustDict(args[1].Content, acc), dict);\n            return next(args);\n        });\n    }\n    run(player, sender, info) {\n        this.actHandlers.get(info.ActivityName)?.forEach(h => {\n            if (h.onBodyparts !== undefined && !h.onBodyparts.includes(info.ActivityGroup))\n                return;\n            if (h.mode === \"onself\" && info.TargetCharacter !== player.MemberNumber)\n                return;\n            if (h.mode === \"selfonother\"\n                && (info.TargetCharacter === player.MemberNumber\n                    || info.SourceCharacter !== player.MemberNumber))\n                return;\n            h.on(player, sender, info);\n        });\n    }\n    addPrerequisite(prereq) {\n        this.prereqMap.set(prereq.name, prereq);\n    }\n    addActivity(act) {\n        this.customActMap.set(act.activity.Name, act);\n        ActivityFemale3DCG?.push(act.activity);\n        ActivityFemale3DCGOrdering?.push(act.activity.Name);\n        const acts = this.actHandlers.get(act.activity.Name);\n        if (acts)\n            acts.push(act);\n        else\n            this.actHandlers.set(act.activity.Name, [act]);\n        act.init(this.mod);\n    }\n    addActivityExtension(act) {\n        const acts = this.actHandlers.get(act.activity);\n        if (acts)\n            acts.push(act);\n        else\n            this.actHandlers.set(act.activity, [act]);\n        act.init(this.mod);\n    }\n}\n","import { ActivityDeconstruct } from \"./ChatMessages\";\nimport { AquireGlobal } from \"./Global\";\nexport class ChatRoomHandler {\n    constructor(mod) {\n        this.playerJoin = [];\n        this.playerLeave = [];\n        this.receiveChatOrWhisper = [];\n        this.receiveActivity = [];\n        mod.hookFunction(\"ChatRoomSync\", 1, (args, next) => {\n            if (Player && (!ChatRoomData || !Player.LastChatRoom || ChatRoomData.Name !== Player.LastChatRoom.Name)) {\n                const pl = Player;\n                this.playerJoin.forEach(f => f(pl));\n            }\n            return next(args);\n        });\n        mod.hookFunction(\"ServerSend\", 1, (args, next) => {\n            if (args[0] === \"ChatRoomLeave\") {\n                if (Player) {\n                    const pl = Player;\n                    this.playerLeave.forEach(f => f(pl));\n                }\n            }\n            return next(args);\n        });\n        mod.callOriginal(\"ChatRoomRegisterMessageHandler\", [this.ChatRoomMsgHandler(mod)]);\n    }\n    onAfterPlayerJoin(f) { this.playerJoin.push(f); }\n    onBeforePlayerLeave(f) { this.playerLeave.push(f); }\n    onReceiveChatWhisperEmote(f) { this.receiveChatOrWhisper.push(f); }\n    onReceiveActivity(f) { this.receiveActivity.push(f); }\n    ChatRoomMsgHandler(mod) {\n        return {\n            Description: \"BC-utilities Message Hook\",\n            Priority: 90,\n            Callback: (data, sender, msg, metadata) => {\n                if (Player && Player.MemberNumber) {\n                    const pl = Player;\n                    if (data.Type === \"Chat\" || data.Type === \"Whisper\" || data.Type === \"Emote\") {\n                        const type = data.Type;\n                        if (mod.callOriginal(\"ChatRoomCharacterViewIsActive\", []) || mod.callOriginal(\"ChatRoomMapViewCharacterIsHearable\", [sender]))\n                            this.receiveChatOrWhisper.forEach(f => f(pl, sender, msg, type));\n                    }\n                    if (data.Type === \"Activity\" && data.Dictionary) {\n                        const d = ActivityDeconstruct(data.Dictionary);\n                        if (d)\n                            this.receiveActivity.forEach(f => f(pl, sender, d));\n                    }\n                }\n                return false;\n            },\n        };\n    }\n    static init(mod) {\n        return AquireGlobal(\"ChatRoomHandler\", () => new ChatRoomHandler(mod));\n    }\n}\n","import { OutfitItemType, buildOutfitItemMap } from \"bc-utilities\";\r\n\r\nexport const OutfitItems: OutfitItemType[] = [\r\n    {\r\n        Asset: {\r\n            Name: \"ElectronicTag\",\r\n            Group: \"ItemNeckAccessories\",\r\n        },\r\n        Color: [\"#595959\", \"Default\", \"#FFFFFF\"],\r\n        Craft: {\r\n            Name: \"Wolf Girl Tag Mk.II\",\r\n            Description:\r\n                \"An exquisite electronic display board, originally used as an operating panel and display screen in the Wolf Girl and Cat Girl suits, but after the successful miniaturization of holographic projection technology, the interactive function of the device was abandoned. Now it is just a simple electronic tag, used to display the wearer's identity and affiliation, and also as a pass and payment method when going out alone. The low-power screen only needs body temperature to operate continuously, and does not require power supply and maintenance. Although the original interactive function has been abandoned, the wiring and pads on the internal circuit board have not been cancelled. After a certain modification, many functions can be expanded.\",\r\n            Property: \"Comfy\",\r\n        },\r\n        Property: { OverridePriority: 41 },\r\n    },\r\n    {\r\n        Asset: {\r\n            Name: \"VibeHeartPiercings\",\r\n            Group: \"ItemNipplesPiercings\",\r\n        },\r\n        Color: [\"#6C6C6C\", \"Default\"],\r\n        Craft: {\r\n            Name: \"Wolf Girl Nipple Pleasure Module Mk.II\",\r\n            Description:\r\n                \"The pleasure stimulation module that is clamped on the nipple is also used as a backup positioning beacon to monitor and record every sexual excitement of the wolf girl. It can be linked to the pleasure controller to provide greater pleasure or punishment. Because of its simple and reliable structure and the use of body temperature to provide working energy, it almost does not need to be disassembled for maintenance. It is the cheapest module in the set. There are even frequent activities by second-level agents to buy other wolf girl kits and give away this component. The development engineer of this module suffered a huge blow and had serious psychological barriers for a time. In the end, she stuffed herself into the wolf girl training assembly line and became a wolf girl. It was really a pity.\",\r\n            Property: \"Arousing\",\r\n        },\r\n        Property: { OverridePriority: 13 },\r\n    },\r\n    {\r\n        Asset: {\r\n            Name: \"VibeNippleClamp\",\r\n            Group: \"ItemNipples\",\r\n        },\r\n        Color: [\"#787878\"],\r\n        Craft: {\r\n            Name: \"Wolf Girl Multifunctional Nipple Clamp Mk.II\",\r\n            Property: \"Arousing\",\r\n            Description:\r\n                \"A pair of small nipple clamps, which clamp the nipples to bring a sense of tightness that cannot be ignored and can vibrate to provide pleasure. However, its power is not high, and the weak pleasure it provides is difficult for the wearer to reach orgasm using only the nipples. Instead, it reminds the wearer of their identity and certain facts of lust at all times. The built-in electric shock module is naturally indispensable, but this generation of electric shock module cancels the defibrillator mode function, because the research found that a large number of reckless owners used this function to punish wolf girls, causing the wolf girls to be in danger of life. We oppose such rude and arrogant behavior, and will blacklist customers who abuse this function.\",\r\n        },\r\n        Property: { OverridePriority: 22 },\r\n    },\r\n    {\r\n        Asset: {\r\n            Name: \"LockingVibePlug\",\r\n            Group: \"ItemButt\",\r\n        },\r\n        Color: [\"Default\"],\r\n        Craft: {\r\n            Name: \"Wolf Girl Anal Control Module Mk.II\",\r\n            Property: \"Arousing\",\r\n            Description:\r\n                \"The module inserted into the anus, the new generation of products has added the option of releasing protein glue for permanent bonding in the expansion and locking function. The relevant structure has been proven to be reliable and non-rejecting, and can safely replace the sphincter to control excretion. The installed vibration and thrusting module has upgraded the power and strengthened the structure, avoiding the serious problem of the previous generation of products breaking and damaging in certain extreme use situations, causing physical trauma. The electric shock module limits the maximum power limit to improve battery life. In addition, a converter is installed in the tail compartment, which can slowly convert excrement into energy to provide its own operation, and can also provide energy for other modules in the form of wireless transmission.\",\r\n        },\r\n    },\r\n    {\r\n        Asset: {\r\n            Name: \"VibeHeartClitPiercing\",\r\n            Group: \"ItemVulvaPiercings\",\r\n        },\r\n        Color: [\"#595959\", \"Default\"],\r\n        Craft: {\r\n            Name: \"Wolf Girl Clitoris Pleasure Module Mk.II\",\r\n            Property: \"Arousing\",\r\n            Description:\r\n                \"The pleasure stimulation module uses a metal clamp at the base of the clitoris, which is also a backup positioning beacon. It integrates a new generation of sensors to monitor and record the sexual excitement data of the wolf girl every time and links the pleasure control system to perform data analysis to provide greater pleasure rewards or repeated orgasm destruction as punishment. Because of its simple and reliable structure and the use of body temperature to provide working energy, it almost does not need to be disassembled and maintained. However, in the high-power working mode, the anal control module needs to provide additional energy for normal operation. Please do not keep it in full-load operation for a long time, because the heat dissipation problem caused by its small size is very serious and may even burn the circuit.\",\r\n        },\r\n        Property: { OverridePriority: 13 },\r\n    },\r\n    {\r\n        Asset: {\r\n            Name: \"FuturisticMuzzle\",\r\n            Group: \"ItemMouth3\",\r\n        },\r\n        Color: [\"Default\", \"Default\", \"Default\", \"#FF0000\"],\r\n        Craft: {\r\n            Name: \"Wolf Girl Muzzle Outer Layer Additional Module Mk.II\",\r\n            Property: \"Comfy\",\r\n            Description:\r\n                \"The muzzle's outer protective system is replaced with a new generation of composite materials. Although the thickness is slightly increased compared to the first generation of wolf girl outer muzzle, there is no need to worry about the extra weight. The built-in air detection and filtration system effectively prevents the wolf girl from inhaling toxic and harmful substances in the air. If necessary, the external air path can be completely closed and the internal compressed air tank can be used for safe breathing for fifteen minutes. The built-in metal mesh and Kevlar lining protect the fragile face. The optional flexible LCD screen can display specific patterns or text on the wolf girl's face to facilitate communication when necessary. The police model can be equipped with a pheromone analysis system to track specific targets.\",\r\n        },\r\n    },\r\n    {\r\n        Asset: {\r\n            Name: \"FuturisticMuzzle\",\r\n            Group: \"ItemMouth2\",\r\n        },\r\n        Color: [\"Default\"],\r\n        Craft: {\r\n            Name: \"Wolf Girl Muzzle Mk.II\",\r\n            Property: \"Comfy\",\r\n            Description:\r\n                \"The muzzle is used to prevent the wolf girl from uncontrollably spitting saliva everywhere when wearing a ball gag. It has a built-in waterproof layer and water guide belt to prevent saliva accumulation, and a new converter with the same anal control module is added to convert the flowing saliva into energy supply components to ensure that the face is always breathable and dry. The full coverage design of the mouth can prevent the wolf girl from eating privately or accidentally eating outside, but there is no need to worry about feeding problems after wearing it. The mouth is equipped with an eating auxiliary module. After the owner authorizes the unlocking, the mouth can be replenished with water and fed liquid food without removing the mouth gag. However, please do not feed food other than the recommended types, otherwise it may cause damage to the module and possible suffocation.\",\r\n        },\r\n    },\r\n    {\r\n        Asset: {\r\n            Name: \"FuturisticHarnessBallGag\",\r\n            Group: \"ItemMouth\",\r\n        },\r\n        Color: [\"#5E5E5E\", \"#242424\", \"Default\", \"Default\", \"Default\"],\r\n        Craft: {\r\n            Name: \"Wolf girl training ball Mk.II\",\r\n            Property: \"Small\",\r\n            Description:\r\n                \"The gag is made of high-strength rubber to prevent the wolf girl from hurting innocent people during the initial training. Most of the time, it will not hinder communication, but it has a built-in sensor to detect what the wolf girl said or tried to say. It can be expanded into a spherical or phallic shape according to the corresponding settings to penetrate deep into the throat to punish and restrict communication. It is also connected to the feeding auxiliary module of the inner layer of the gag. When used with the phallic mode, it can quickly train the wolf girl's oral sex ability. The new generation of products has added a directional sound wave generator to restrict and replace the wolf girl's external communication. The fixed rigging is a metal composite braided cable, which cannot be violently removed without hurting the wolf girl.\",\r\n        },\r\n        Property: { OverridePriority: 35 },\r\n    },\r\n    {\r\n        Asset: {\r\n            Name: \"FuturisticHarness\",\r\n            Group: \"ItemTorso\",\r\n        },\r\n        Color: [\"#666666\", \"#7A7A7A\", \"#393939\", \"#FFFFFF\"],\r\n        Craft: {\r\n            Name: \"Wolf Girl Training Harness Mk.II\",\r\n            Property: \"Comfy\",\r\n            Description:\r\n                \"The harness on the wolf girl can be used as a data bus to provide wired data communication connections between modules and to be used as an external signal transmission antenna. Although each module already has the ability to form a wireless network, the existence of the physical link of the harness increases throughput and saves a lot of energy consumption, which is still very necessary. The main body is made of metal composite braided cables, and the interface is also waterproof. It does not need to be removed before entering the water like the previous generation of products. Thanks to its reliable structural strength, it can even be used as a climbing rope and traction rope when necessary, but please note that the original communication function cannot be restored after being disassembled into a climbing rope or traction rope.\",\r\n        },\r\n    },\r\n    {\r\n        Asset: {\r\n            Name: \"HighSecurityHarness\",\r\n            Group: \"ItemTorso2\",\r\n        },\r\n        Color: [\"#444444\", \"Default\"],\r\n        Craft: {\r\n            Name: \"Wolf Girl Harness Outer Frame Mk.II\",\r\n            Property: \"Comfy\",\r\n            Description:\r\n                \"The extra frame on the outer layer of the harness is attached to the training harness in most cases, but it can also be used independently. It stores nutrient solution and various medicines, which are prepared and injected into the body in real time according to the control core instructions to ensure that the body is in the best condition at all times. It also has a quick replenishment interface, which makes maintenance simple and convenient. The waist node stores several emergency injections, which can be used to rescue others when necessary. Although this device is a component of the Wolf Girl Training Set, a large number of users purchase this component separately to use medicines. Please note that this product is only a special equipment, not a medical device. EIL is not responsible for possible accidents caused by the use of this component.\",\r\n        },\r\n        Property: { OverridePriority: 1 },\r\n    },\r\n    {\r\n        Asset: {\r\n            Name: \"SciFiPleasurePanties\",\r\n            Group: \"ItemPelvis\",\r\n        },\r\n        Color: [\"#454545\", \"#202020\", \"#878787\", \"#202020\", \"#878787\", \"#878787\", \"Default\"],\r\n        Craft: {\r\n            Name: \"Wolf girl training underwear Mk.II\",\r\n            Property: \"Arousing\",\r\n            Description:\r\n                \"The new generation of training underwear has been adapted and connected to the central control component, avoiding the embarrassment of the previous generation of products requiring secondary configuration. The embedded position of the built-in vibrator has been modified to be more reasonable and will not cause bruises to the skin after long-term work, while the electric shock device also limits high-power electric shocks. Although it is acceptable as a punishment, we despise the wanton venting of emotions without regard for the health of the wolf girl. It has a pleasure detection and orgasm control module, which can make the wolf girl stay on the edge of orgasm or destroy the orgasm so that she has no satisfaction, which helps to tame the wolf girl. And the opening is thoughtfully designed, which will not affect excretion and masturbation when the owner allows it.\",\r\n        },\r\n        Property: { TypeRecord: { c: 0, i: 0, o: 2, s: 0 } },\r\n    },\r\n    {\r\n        Asset: {\r\n            Name: \"FuturisticCuffs\",\r\n            Group: \"ItemArms\",\r\n        },\r\n        Color: [\"#4F4F4F\", \"#353535\", \"#FFFFFF\"],\r\n        Craft: {\r\n            Name: \"Wolf Girl Bracelet Mk.II\",\r\n            Property: \"Comfy\",\r\n            Description:\r\n                \"The restraint control system installed on the arm is a very beautiful decorative ring when not activated. The new generation of products has upgraded the electrical stimulation system, which can maintain the muscle state to avoid atrophy under long-term restraint, and can enhance explosive power to deal with certain emergencies when necessary. The extensive use of composite materials makes the weight lighter than the previous generation while still having ultra-high strength. Even the lowest configuration of this generation of products is equipped with a tactile simulation system, which can provide the wearer with a realistic hug warmth at any time. Whether it is a human or a god, it is never shameful to require the body temperature of another individual. EIL will never lose its focus on emotional and psychological needs.\",\r\n        },\r\n    },\r\n    {\r\n        Asset: {\r\n            Name: \"FuturisticMittens\",\r\n            Group: \"ItemHands\",\r\n        },\r\n        Color: [\"#777777\", \"#6E6E6E\", \"#3D3D3D\", \"Default\"],\r\n        Craft: {\r\n            Name: \"Wolf Girl Gloves Mk.II\",\r\n            Property: \"Comfy\",\r\n            Description:\r\n                \"The Wolf Girl gloves, which use NMRB technology, abandon the complex and high-power ERMR, are more reliable, lightweight and energy-efficient. The speed of switching between fingerless gloves and normal gloves is nearly three times faster, and anomalies caused by insufficient power supply during failure or mode conversion are avoided. The internal padding has also been upgraded to enhance temperature management and reduce the impact of high temperatures in summer and low temperatures in winter, while the tactile obstruction module has been moved to the wrist locking ring to avoid repeated impacts that cause the module to fail. The optional adsorption climbing module has also become standard, which can also make the Wolf Girl's hands almost completely lose friction and unable to grasp objects.\",\r\n        },\r\n        Property: { TypeRecord: { typed: 1 } },\r\n    },\r\n    {\r\n        Asset: {\r\n            Name: \"FuturisticAnkleCuffs\",\r\n            Group: \"ItemFeet\",\r\n        },\r\n        Color: [\"#000000\", \"#494949\", \"#303030\", \"#FFFFFF\"],\r\n        Craft: {\r\n            Name: \"Wolf Girl Smart Leg Ring Mk.II\",\r\n            Property: \"Comfy\",\r\n            Description:\r\n                \"The new ankle restraint control system cancels the automatic connection and locking function of the aggressive sensor, saving more space for installing the limb action controller. After linking the step controller component, the lower limbs' mobility can be fully controlled. The additional action posture stabilization system can prevent the body from losing stability and even falling in almost all extreme situations. Although it helps to provide additional safety in some special scenarios, EIL does not recommend such use, let alone private modification, otherwise the warranty terms will be invalidated, and EIL will not compensate for accidents caused by such application scenarios of the prop.\",\r\n        },\r\n    },\r\n    {\r\n        Asset: {\r\n            Name: \"FuturisticHeels2\",\r\n            Group: \"ItemBoots\",\r\n        },\r\n        Color: [\"#212121\", \"#4A4A4A\", \"#383838\", \"#3D3D3D\", \"#404040\", \"#3D3D3D\", \"Default\"],\r\n        Craft: {\r\n            Name: \"Wolf Girl Foot Training System Mk.II\",\r\n            Property: \"Comfy\",\r\n            Description:\r\n                \"The high-heeled shoes have metal wires woven into the lining, and the built-in electric structure in the heel can change the height of the heel according to the training progress or reward and punishment rules. The bottom is embedded with a heavy metal plate as a counterweight to increase stability and passively train the leg muscles to prevent muscle atrophy caused by long-term restraint. It is also equipped with a motion sensor to count the amount of exercise, and cooperates with other components to collect data to assist the central controller in making decisions to modify the training plan and modify the nutritional meal formula accordingly to add trace elements to better maintain physical health. The additional neural interference module can be used as a reward to greatly reduce the pain caused by walking in high heels, and can also be linked to the pace controller to take over the movement of the wolf girl.\",\r\n        },\r\n        Property: { TypeRecord: { typed: 1 } },\r\n    },\r\n    {\r\n        Asset: {\r\n            Name: \"FuturisticLegCuffs\",\r\n            Group: \"ItemLegs\",\r\n        },\r\n        Color: [\"#000000\", \"#4A4A4A\", \"#383838\", \"#FFFFFF\"],\r\n        Craft: {\r\n            Name: \"Wolf Girl Step Stance Controller Mk.II\",\r\n            Property: \"Comfy\",\r\n            Description:\r\n                \"The pace controller for training elegant walking posture can be connected and completely fixed as part of the control system, which can minimize the ability to struggle and escape. The built-in electrical stimulation module has been upgraded to a version with tactile simulation, which can massage the thigh muscles to give rewards and also provide arousal and teasing. The muscle strength limiter has been replaced with a model that can finely adjust the output. Combined with other leg components, it completely takes over the mobility, so that the owner can play more. Although the second-generation wolf girl suit uses composite materials to reduce weight, this module is still made of alloy as an additional weight to assist stability and prevent muscle and blood vessel problems caused by long-term restraint.\",\r\n        },\r\n    },\r\n    {\r\n        Asset: {\r\n            Name: \"FuturisticVibrator\",\r\n            Group: \"ItemVulva\",\r\n        },\r\n        Color: [\"#454545\", \"#555555\", \"Default\"],\r\n        Craft: {\r\n            Name: \"Wolf Girl Central Pleasure Controller Mk.II\",\r\n            Property: \"Arousing\",\r\n            Description:\r\n                \"The new generation of central pleasure controller is equipped with an advanced computing unit and can be used as a backup central controller. The vibration and thrusting module has a new mechanical expansion function in this version, which can adjust the diameter to a certain extent, fill the vagina to give stronger stimulation, or shrink to a level that can be felt but cannot get pleasure during the climax. The electric shock device also limits the maximum power and trigger conditions, deletes the setting that any sound can trigger the electric shock, and deletes the part of the urination control module in the custom interface so that it can only use a few preset modes, and has a mechanical emergency unlocking to avoid setting errors or some special circumstances that may cause physical damage.\",\r\n        },\r\n    },\r\n    {\r\n        Asset: {\r\n            Name: \"FuturisticEarphones\",\r\n            Group: \"ItemEars\",\r\n        },\r\n        Color: [\"#898989\", \"#2A2A2A\", \"Default\"],\r\n        Craft: {\r\n            Name: \"Wolf Girl Multi-Purpose Auxiliary Earphones Mk.II\",\r\n            Property: \"Comfy\",\r\n            Description:\r\n                \"The microphone array upgrade combined with the new neural interference module can even calculate the launch position of every bullet that passes by in a short time when running at full power. The active noise reduction system also benefits from the module upgrade and has stronger performance. It can accurately locate the faint cry for help in a battlefield full of bullets and spells, and naturally make it so that the wolf girl can only hear the master's words in a busy city. However, the neural interference module will not be open source in the official release, because in the initial testing, we found some situations that distorted the use of the module, and such behavior crossed the bottom line of EIL.\",\r\n        },\r\n    },\r\n    {\r\n        Asset: {\r\n            Name: \"InteractiveVisor\",\r\n            Group: \"ItemHead\",\r\n        },\r\n        Color: [\"#5D5D5D\"],\r\n        Craft: {\r\n            Name: \"Wolf Girl Enhanced Auxiliary Goggles Mk.II\",\r\n            Property: \"Comfy\",\r\n            Description:\r\n                \"The transparent circuit and battery are integrated into the thin and reliable polymer shell, and the sensor matrix is ​​placed in the temples on both sides. The effective recognition range has been increased to 220 degrees, and the recognition distance and accuracy have been significantly improved, while the old The visual control module has been replaced with a neural interference module, which avoids the shortcomings of poor battery life caused by excessive power consumption and the disadvantages caused by large amounts of heat. With the headphone module, it can perform absolute interference between vision and hearing, and continuously adjust vision. Or you can directly play the training and brainwashing video, but the remote scheduling function of this module has been locked by the hardware to prevent hackers from hijacking the master's instructions.\",\r\n        },\r\n    },\r\n    {\r\n        Asset: { Name: \"FuturisticBra\", Group: \"ItemBreast\" },\r\n        Color: [\"#4A4A4A\", \"#FFFFFF\", \"#FFFFFF\", \"#4B4B4B\", \"#363636\"],\r\n        Craft: {\r\n            Name: \"Wolf Girl Composite Sports Bra Mk.II\",\r\n            Property: \"Comfy\",\r\n            Description:\r\n                \"The bra is made of electric muscle and equipped with a motion sensor to adjust the posture in real time. It is thin and soft to avoid the overly tight feeling of the previous generation, while providing sufficient support for the breasts to avoid the unstable center of gravity caused by the shaking of the breasts during high-speed movement. When it detects an attempt to masturbate through the breasts, it will tighten and harden to prevent the wolf girl from getting any pleasure. It can also massage and electrically stimulate the breasts to keep them healthy, and can also provide pleasure as a reward. It has a built-in vital sign monitor and sends physiological data to the terminal in real time, so that the owner can check the wolf girl's physical condition at any time. Although a certain breast enhancement effect was observed during the test, it is not universal. Please do not flash firmware not recommended by EIL at will.\",\r\n        },\r\n        Property: { TypeRecord: { typed: 2 } },\r\n    },\r\n    {\r\n        Asset: { Name: \"FuturisticCollar\", Group: \"ItemNeck\" },\r\n        Color: [\"#606060\", \"Default\", \"Default\", \"Default\"],\r\n        Craft: {\r\n            Name: \"Wolf Girl System Main Control Core Mk.II\",\r\n            Property: \"Comfy\",\r\n            Description:\r\n                \"The appearance of the central controller has not changed much, but the computing power and battery life have been upgraded. It can calculate the body parameters and the posture parameters of each component more quickly and accurately for timely adjustment. Although the computing power is strong enough, its ability to parse the virtual currency algorithm has been limited by both software and hardware to avoid being used for other purposes. After installing the expensive communication module, the multiple wolf girls owned by the owner can form a network connection similar to the Misaka network proposed by Academy City at close range, sharing information and processing power among the wolf girls. And it is equipped with additional visual sensors to avoid abnormal environmental perception caused by damaged goggles.\",\r\n        },\r\n    },\r\n];\r\n\r\nexport const OutfitItemsMap = buildOutfitItemMap(OutfitItems);\r\n\r\nexport const ToolsCrate: OutfitItemType = {\r\n    Asset: {\r\n        Name: \"FuturisticCrate\",\r\n        Group: \"ItemDevices\",\r\n    },\r\n    Color: [\r\n        \"#222222\",\r\n        \"Default\",\r\n        \"#444444\",\r\n        \"Default\",\r\n        \"Default\",\r\n        \"#FF1199\",\r\n        \"Default\",\r\n        \"#444444\",\r\n        \"#555555\",\r\n        \"#3B7F2C\",\r\n        \"Default\",\r\n        \"Default\",\r\n        \"#BBBBFF\",\r\n        \"Default\",\r\n    ],\r\n    Craft: {\r\n        Name: \"Wolf Girl Training Facility Maintenance Cabin Mk.II\",\r\n        Property: \"Comfy\",\r\n        Description:\r\n            \"The basic wolf girl transport storage cabin has been newly equipped with surgical modules and component maintenance modules, and sufficient materials are stored to quickly make restraints on site. The addition of a new generation of robotic arms and scanning matrices makes the operation more precise, and the restraints are more comfortable and close-fitting. The installation of the surgical module means that the wolf girl does not have to worry about life danger even if she suffers serious trauma. However, due to the fact that the production and yield of the injection-type nano-surgical robot are not ideal, the huge purchase price and high maintenance cost have caused the price of the maintenance cabin to rise sharply on the black market, and even attacked the EIL team. The component will now be remotely dropped by EIL.\",\r\n    },\r\n};\r\n\r\nexport const ToolsVisor: OutfitItemType = {\r\n    Asset: {\r\n        Name: \"InteractiveVisor\",\r\n        Group: \"ItemHead\",\r\n    },\r\n    Color: [\"#3A3A3A\"],\r\n    Craft: {\r\n        Name: \"Wolf Girl Trainer Multi-purpose Auxiliary Terminal Mk.II\",\r\n        Property: \"Thin\",\r\n        Description:\r\n            \"Standard auxiliary goggles, connected to the EIL database to view the wolf girl's physiological status, identity information and other data. The sensor in one of the temples was removed and replaced with an auxiliary positioning system to remotely deploy the training facility maintenance cabin, which is convenient for trainers to perform component maintenance and additional training props on the wolf girl at any time, and naturally also convenient for trainers to hunt new targets. It has a built-in biometric lock and self-destruct system. It will automatically lock when the auxiliary terminal is removed, and will self-destruct when used by non-EIL registered personnel to avoid leakage of authority and information, effectively improving the security of the EIL internal network.\",\r\n    },\r\n};\r\n\r\nexport const ToolsInjector: OutfitItemType = {\r\n    Asset: {\r\n        Name: \"MedicalInjector\",\r\n        Group: \"ItemHandheld\",\r\n    },\r\n    Color: [\"#8F8F8F\"],\r\n    Craft: {\r\n        Name: \"Wolf Girl Trainer Multi-Purpose Injection Gun Mk.II\",\r\n        Property: \"Comfy\",\r\n        Description:\r\n            \"Multi-purpose injection gun, most of the time filled with a disposable identity chip for the initial installation and information registration of the training kit for the new wolf girl, but it can be replaced with various medicines, or even the injection-type nano-surgical robot used in the maintenance cabin, to perform first aid when necessary. The advanced injection gun will not leave needle holes on the skin, and can even be injected through clothing, and the extremely high injection speed does not worry about accidents when the target struggles.\",\r\n    },\r\n};\r\n\r\nexport const Tools: OutfitItemType[] = [\r\n    ToolsCrate,\r\n    ToolsVisor,\r\n    ToolsInjector,\r\n    {\r\n        Asset: {\r\n            Name: \"GlassFilled\",\r\n            Group: \"ItemHandheld\",\r\n        },\r\n        Color: \"Default\",\r\n        Craft: {\r\n            Name: \"Water of Desire\",\r\n            Description: \"A glass of water? Maybe.\",\r\n            Property: \"Normal\",\r\n        },\r\n    },\r\n    {\r\n        Asset: {\r\n            Name: \"GlassFilled\",\r\n            Group: \"ItemHandheld\",\r\n        },\r\n        Color: \"Default\",\r\n        Craft: {\r\n            Name: \"Special Redbull\",\r\n            Description: \"A mixture of Red Bull, alcohol, caffeine, steroids, gorilla testicle extract, etc., Power!\",\r\n            Property: \"Normal\",\r\n        },\r\n    },\r\n];\r\n","export function GatherAppMap(C: Character) {\r\n    return new Map<string, Item>(C.Appearance.map(i => [i.Asset.Group.Name, i]));\r\n}","export enum TimedWorkState {\r\n    running, finished, interrupted\r\n}\r\nexport abstract class TimedWork {\r\n    abstract run(player: PlayerCharacter): TimedWorkState;\r\n}\r\n\r\ntype TimerState = 'working' | 'paused';\r\n\r\ninterface TimedWorkSuite {\r\n    description: string;\r\n    works: TimedWork[];\r\n}\r\n\r\nexport class TimedWorker {\r\n    private readonly work_suites: TimedWorkSuite[] = [];\r\n    private readonly _timer;\r\n\r\n    private _state: TimerState = 'working';\r\n    constructor(readonly time_reso: number) {\r\n        this._timer = setInterval(() => {\r\n            do {\r\n                if (Player && this.work_suites.length > 0 && this._state === 'working') {\r\n                    const cur_suite = this.work_suites[0];\r\n                    if (cur_suite.works.length === 0) {\r\n                        this.work_suites.shift();\r\n                        continue;\r\n                    }\r\n\r\n                    const state = cur_suite.works[0].run(Player);\r\n                    if (state === TimedWorkState.finished) {\r\n                        cur_suite.works.shift();\r\n                    } else if (state === TimedWorkState.interrupted) {\r\n                        this.work_suites.shift();\r\n                    }\r\n                }\r\n                break;\r\n            } while (true);\r\n        }, time_reso);\r\n    }\r\n\r\n    skip_until(pred: (t: TimedWorkSuite) => boolean) {\r\n        do {\r\n            if (this.work_suites.length === 0) return;\r\n            const cur_suite = this.work_suites[0];\r\n            if (cur_suite.works.length === 0)\r\n                this.work_suites.shift();\r\n            if (pred(cur_suite))\r\n                cur_suite.works.shift();\r\n            else return;\r\n        } while (true);\r\n    }\r\n\r\n    pause() {\r\n        this._state = 'paused';\r\n    }\r\n\r\n    resume() {\r\n        this._state = 'working';\r\n    }\r\n\r\n    push_front(work: TimedWorkSuite) {\r\n        this.work_suites.unshift(work);\r\n    }\r\n\r\n    push(work: TimedWorkSuite) {\r\n        this.work_suites.push(work);\r\n    }\r\n\r\n    insert_after_first(work: TimedWorkSuite) {\r\n        if (this.work_suites.length === 0) {\r\n            this.work_suites.push(work);\r\n            return;\r\n        } else {\r\n            this.work_suites.splice(1, 0, work);\r\n        }\r\n    }\r\n\r\n    get cur_description(): string | undefined {\r\n        if (this.work_suites.length === 0) return undefined;\r\n        return this.work_suites[0].description;\r\n    }\r\n\r\n    private static _global: TimedWorker | undefined;\r\n\r\n    static init(time_reso: number) {\r\n        if (TimedWorker._global) return;\r\n        TimedWorker._global = new TimedWorker(time_reso);\r\n    }\r\n\r\n    static get global(): TimedWorker {\r\n        return TimedWorker._global as TimedWorker;\r\n    }\r\n}\r\n","import { GatherAppMap } from \"../../utils/Apperance\";\r\nimport { OutfitItemsMap, OutfitItems } from \"./Definition\";\r\nimport { TimedWork } from \"../Worker\";\r\nimport { TimedWorkState } from \"../Worker\";\r\nimport { CalculateLocks, ItemFromOutfit } from \"./Utils\";\r\nimport { ExtractMemberNumber } from \"../../utils/Character\";\r\nimport { AppearanceUpdate, OutfitItemType } from \"bc-utilities\";\r\nimport { FuturisticBypass } from \"../WolfGirlCtrl/Ctrls/FuturisticBypass\";\r\n\r\nenum TargetMode {\r\n    TARGET_ACTING,\r\n    TARGET_ACTED\r\n}\r\n\r\nexport class ItemWearWork extends TimedWork {\r\n    readonly _items: OutfitItemType[];\r\n    readonly target_num: number;\r\n\r\n    static readonly TARGET_ACTING = TargetMode.TARGET_ACTING;\r\n    static readonly TARGET_ACTED = TargetMode.TARGET_ACTED;\r\n    constructor(readonly items: AssetGroupItemName[] | OutfitItemType[], private readonly target: number | Character, private readonly mode: TargetMode = TargetMode.TARGET_ACTED) {\r\n        super();\r\n        if (items.length === 0) this._items = [];\r\n        else if (typeof items[0] === \"string\") this._items = (items as AssetGroupItemName[]).map(e => OutfitItemsMap.get(e) as OutfitItemType);\r\n        else this._items = items as OutfitItemType[];\r\n        this.target_num = ExtractMemberNumber(target);\r\n    }\r\n\r\n    static ItemWearSingle(item: OutfitItemType, acting: number, acted: Character) {\r\n        const item_ = ItemFromOutfit(acting, acted, item);\r\n        if (!item_) return;\r\n        const oldIdx = acted.Appearance.findIndex(e => e.Asset.Group === item_.Asset.Group);\r\n        if (oldIdx >= 0) acted.Appearance[oldIdx] = item_;\r\n        else acted.Appearance.push(item_);\r\n    }\r\n\r\n    run(player: PlayerCharacter): TimedWorkState {\r\n        const player_num = player.MemberNumber;\r\n        if (!player_num) return TimedWorkState.interrupted;\r\n\r\n        if (this.mode === TargetMode.TARGET_ACTING) {\r\n            this._items.forEach(outfit => ItemWearWork.ItemWearSingle(outfit, this.target_num, player));\r\n            AppearanceUpdate(player);\r\n        } else {\r\n            const acted = ChatRoomCharacter.find(c => c.MemberNumber === this.target_num);\r\n            if (!acted) return TimedWorkState.interrupted;\r\n\r\n            this._items.forEach(outfit => ItemWearWork.ItemWearSingle(outfit, player_num, acted));\r\n            AppearanceUpdate(acted);\r\n        }\r\n\r\n        return TimedWorkState.finished;\r\n    }\r\n}\r\n\r\ninterface ItemOptionWorkIUnit {\r\n    readonly target: Item;\r\n    readonly option: TypeRecord;\r\n}\r\n\r\ninterface ItemOptionWorkSUnit {\r\n    readonly target: string;\r\n    readonly option: TypeRecord;\r\n}\r\n\r\ntype ItemOptionWorkUnit = ItemOptionWorkIUnit | ItemOptionWorkSUnit;\r\n\r\nexport class ItemOptionWork extends TimedWork {\r\n    readonly _target: number;\r\n    readonly _options: ItemOptionWorkUnit[];\r\n\r\n    constructor(target: number | Character, option: ItemOptionWorkUnit[]) {\r\n        super();\r\n        this._target = ExtractMemberNumber(target);\r\n        this._options = option;\r\n    }\r\n\r\n    static ItemOptionSingleI(target: Character, option: ItemOptionWorkIUnit) {\r\n        ExtendedItemSetOptionByRecord(target, option.target, option.option);\r\n    }\r\n\r\n    static ItemOptionSingleS(target: Character, option: ItemOptionWorkSUnit) {\r\n        const item = target.Appearance.find(e => e.Asset.Group.Name === option.target);\r\n        if (!item) return;\r\n        ExtendedItemSetOptionByRecord(target, item, option.option);\r\n    }\r\n\r\n    run(player: PlayerCharacter): TimedWorkState {\r\n        const target = ChatRoomCharacter.find(c => c.MemberNumber === this._target);\r\n        if (!target) return TimedWorkState.interrupted;\r\n\r\n        FuturisticBypass.instance.on = true;\r\n        const app_map = GatherAppMap(target);\r\n        (this._options.map(i => { return { target: typeof i.target === \"string\" ? app_map.get(i.target) : i.target, option: i.option } })\r\n            .filter(i => i.target) as ItemOptionWorkIUnit[])\r\n            .forEach(option => ItemOptionWork.ItemOptionSingleI(target, option));\r\n        if (this._options.length > 0) AppearanceUpdate(target);\r\n        FuturisticBypass.instance.on = false;\r\n        return TimedWorkState.finished;\r\n    }\r\n}\r\n\r\nexport class ItemRemoveWork extends TimedWork {\r\n    readonly _items: (string | OutfitItemType)[];\r\n    readonly _target: number;\r\n    constructor(target: number | Character, readonly items: (string | OutfitItemType)[]) {\r\n        super();\r\n        this._items = items;\r\n        this._target = ExtractMemberNumber(target);\r\n    }\r\n\r\n    run(player: PlayerCharacter): TimedWorkState {\r\n        const target = ChatRoomCharacter.find(c => c.MemberNumber === this._target);\r\n        if (!target) return TimedWorkState.interrupted;\r\n        const new_app: Item[] = []\r\n        target.Appearance.forEach(e => {\r\n            if (!this._items.some(item => {\r\n                if (typeof item === \"string\") return e.Asset.Name === item;\r\n                return e.Asset.Group.Name === item.Asset.Group && e.Asset.Name === item.Asset.Name;\r\n            })) new_app.push(e);\r\n        });\r\n        target.Appearance = new_app;\r\n        AppearanceUpdate(target);\r\n        return TimedWorkState.finished;\r\n    }\r\n}\r\n\r\nexport class ClothRemoveWork extends TimedWork {\r\n    readonly _stash: Item[];\r\n    readonly _target: number;\r\n    constructor(target: number | Character, readonly stash: Item[]) {\r\n        super();\r\n        this._stash = stash;\r\n        this._target = ExtractMemberNumber(target);\r\n    }\r\n\r\n    run(player: PlayerCharacter): TimedWorkState {\r\n        const target = ChatRoomCharacter.find(c => c.MemberNumber === this._target);\r\n        if (!target) return TimedWorkState.interrupted;\r\n        const new_app: Item[] = []\r\n        target.Appearance.forEach(e => {\r\n            if (e.Asset.Group.Clothing) {\r\n                this._stash.push(e);\r\n            } else {\r\n                new_app.push(e);\r\n            }\r\n        });\r\n        target.Appearance = new_app;\r\n        AppearanceUpdate(target);\r\n        return TimedWorkState.finished;\r\n    }\r\n}\r\n\r\nexport class ClothRestoreWork extends TimedWork {\r\n    readonly _stash: Item[];\r\n    readonly _target: number;\r\n    constructor(target: number | Character, readonly stash: Item[]) {\r\n        super();\r\n        this._stash = stash;\r\n        this._target = ExtractMemberNumber(target);\r\n    }\r\n\r\n    run(player: PlayerCharacter): TimedWorkState {\r\n        const target = ChatRoomCharacter.find(c => c.MemberNumber === this._target);\r\n        if (!target) return TimedWorkState.interrupted;\r\n        target.Appearance = target.Appearance.concat(this._stash);\r\n        AppearanceUpdate(target);\r\n        return TimedWorkState.finished;\r\n    }\r\n}\r\n\r\nexport class ItemLockWork extends TimedWork {\r\n    readonly _target: number;\r\n    readonly _group: string[];\r\n    readonly _lock?: string;\r\n    constructor(readonly group: string[], target: number | Character, lock?: string) {\r\n        super();\r\n        this._group = group;\r\n        this._target = ExtractMemberNumber(target);\r\n        this._lock = lock;\r\n    }\r\n\r\n    run(player: PlayerCharacter): TimedWorkState {\r\n        const target = ChatRoomCharacter.find(c => c.MemberNumber === this._target);\r\n        if (!target) return TimedWorkState.interrupted;\r\n\r\n        const lock = CalculateLocks(player, target);\r\n\r\n        this._group.forEach(group => {\r\n            const item = target.Appearance.find(e => e.Asset.Group.Name === group);\r\n            if (item) InventoryLock(target, item, lock, player.MemberNumber, false);\r\n        })\r\n        AppearanceUpdate(target);\r\n        return TimedWorkState.finished;\r\n    }\r\n}\r\n\r\ninterface ItemPropertyWorkItem {\r\n    readonly group: string;\r\n    readonly property: ItemProperties;\r\n}\r\n\r\nexport class ItemPropertyWork extends TimedWork {\r\n    readonly _target: number;\r\n    readonly _items: ItemPropertyWorkItem[];\r\n    constructor(target: number | Character, items: ItemPropertyWorkItem[]) {\r\n        super();\r\n        this._target = ExtractMemberNumber(target);\r\n        this._items = items;\r\n    }\r\n\r\n    run(player: PlayerCharacter): TimedWorkState {\r\n        const target = ChatRoomCharacter.find(c => c.MemberNumber === this._target);\r\n        if (!target) return TimedWorkState.interrupted;\r\n        this._items.forEach(item => {\r\n            const item_ = target.Appearance.find(e => e.Asset.Group.Name === item.group);\r\n            if (!item_) return;\r\n            if (!item_.Property) item_.Property = {};\r\n            Object.assign(item_.Property, item.property);\r\n        })\r\n        AppearanceUpdate(target);\r\n        return TimedWorkState.finished;\r\n    }\r\n}","interface EILData {\r\n    uids: number[];\r\n    room: {\r\n        name: string;\r\n        space: ServerChatRoomSpace;\r\n    },\r\n    craft: {\r\n        uid: number;\r\n        name: string;\r\n    }\r\n}\r\n\r\nexport class EILNetwork {\r\n    private _data: EILData;\r\n\r\n    private Time: number = 0;\r\n\r\n    constructor(data: EILData) {\r\n        this._data = data;\r\n        this.Time = Date.now();\r\n    }\r\n\r\n    isEIL(uid: number): boolean {\r\n        return this._data.uids.includes(uid);\r\n    }\r\n\r\n    get craft() {\r\n        return this._data.craft;\r\n    }\r\n\r\n    get room() {\r\n        return this._data.room;\r\n    }\r\n\r\n    static get Access(): EILNetwork {\r\n        return EILNetwork._Access();\r\n    }\r\n\r\n    static _Access: () => EILNetwork = () => {\r\n        throw new Error('EILNetwork is not ready.');\r\n    }\r\n\r\n    private static last_fetched: EILNetwork | undefined = undefined;\r\n\r\n    static async fetch(asset_url: string): Promise<EILNetwork> {\r\n        return fetch(asset_url + `EIL.json?t=${Date.now()}`).then((res) => {\r\n            if (!res.ok) { throw new Error('EIL.json not found.'); }\r\n            return res.json() as Promise<EILData>;\r\n        }).then(d => EILNetwork.last_fetched = new EILNetwork(d));\r\n    }\r\n\r\n    static force_fetch: () => Promise<EILNetwork>;\r\n\r\n    static init(asset_url: string) {\r\n        return this.fetch(asset_url).then(d => {\r\n            EILNetwork._Access = () => {\r\n                if (EILNetwork.last_fetched) {\r\n                    if (Date.now() - EILNetwork.last_fetched.Time > 60000)\r\n                        EILNetwork.fetch(asset_url);\r\n                }\r\n                return EILNetwork.last_fetched as EILNetwork;\r\n            }\r\n            EILNetwork.force_fetch = () => EILNetwork.fetch(asset_url);\r\n        });\r\n    }\r\n}","\r\nexport function ExtractMemberNumber(target: number | Character): number {\r\n    return typeof target === \"number\" ? target : target.MemberNumber as number;\r\n}","import { EILNetwork } from \"../../Network\";\r\nimport { ExtractMemberNumber } from \"../../utils/Character\";\r\nimport { OutfitItems, OutfitItemsMap } from \"./Definition\";\r\nimport { CheckOutfitItem, OutfitItemManifest, OutfitItemType, buildAppMap } from \"bc-utilities\";\r\n\r\nexport function ItemFromOutfit(acting: number | Character, acted: Character, v: OutfitItemType) {\r\n    const num = ExtractMemberNumber(acting);\r\n    const lock = CalculateLocks(num, acted);\r\n    const ecraft = EILNetwork.Access.craft;\r\n    return OutfitItemManifest(acted, v, {\r\n        craft: { MemberName: ecraft.name, MemberNumber: ecraft.uid }, lock: {\r\n            Lock: lock,\r\n            MemberNumber: num,\r\n        },\r\n        difficulty: 42\r\n    });\r\n}\r\n\r\n/**\r\n * Check if the bc item matches the outfit item\r\n * @param item The bc item, if undefined, return false\r\n * @param v The outfit item, if undefined, return false\r\n * @param lock whether to check the lock status\r\n * @returns return true if the item matches the outfit item\r\n */\r\nexport function DefaultCheckOutfitItem(item: Item | undefined, v: OutfitItemType | undefined, lock?: boolean) {\r\n    const ecraft = EILNetwork.Access.craft;\r\n    return CheckOutfitItem(item, v, { craft: { MemberName: ecraft.name, MemberNumber: ecraft.uid }, lock: lock ?? true });\r\n}\r\n\r\nexport function DefaultCheckItemOnTarget(target: Character, item: OutfitItemType | undefined, lock?: boolean) {\r\n    if (!item) return false;\r\n    const i = target.Appearance.find(e => e.Asset.Group.Name === item.Asset.Group);\r\n    if (!i) return false;\r\n    return DefaultCheckOutfitItem(i, item, lock);\r\n}\r\n\r\nexport function DefaultCheckItemByGroup(target: Character, group: AssetGroupItemName, lock?: boolean) {\r\n    const oi = OutfitItemsMap.get(group);\r\n    if (!oi) return false;\r\n    return DefaultCheckItemOnTarget(target, oi, lock);\r\n}\r\n\r\nexport function DefaultCheckItems(target: Character, item: (OutfitItemType | AssetGroupName)[], lock?: boolean) {\r\n    const items_map = buildAppMap(target);\r\n    const ecraft = EILNetwork.Access.craft;\r\n    const option = { craft: { MemberName: ecraft.name, MemberNumber: ecraft.uid }, lock };\r\n\r\n    return item.every(e => {\r\n        const group = typeof e === \"string\" ? e : e.Asset.Group;\r\n        const item = items_map.get(group);\r\n        const oitem = typeof e === \"string\" ? OutfitItemsMap.get(group) : e;\r\n        if (!item || !oitem) return false;\r\n\r\n        return CheckOutfitItem(item, oitem, option);\r\n    });\r\n}\r\n\r\nexport function CheckMissingItems(player: PlayerCharacter, lock?: boolean) {\r\n    const app_map = buildAppMap(player);\r\n    const ecraft = EILNetwork.Access.craft;\r\n    const option = { craft: { MemberName: ecraft.name, MemberNumber: ecraft.uid }, lock };\r\n\r\n    const missing = new Set<string>();\r\n    OutfitItems.forEach(e => {\r\n        const i = app_map.get(e.Asset.Group);\r\n        if (!i || !CheckOutfitItem(i, e, option)) missing.add(e.Asset.Group);\r\n    });\r\n    return missing;\r\n}\r\n\r\nexport function CalculateLocks(locking: Character | number, locked: Character): AssetLockType {\r\n    const num = ExtractMemberNumber(locking);\r\n    if (locked.Ownership && locked.Ownership.MemberNumber === num) return \"OwnerPadlock\";\r\n    if (locked.Lovership && locked.Lovership.some(e => e.MemberNumber === num))\r\n        return \"LoversPadlock\";\r\n    return \"ExclusivePadlock\";\r\n}","import { ModSDKModAPI } from \"bondage-club-mod-sdk\";\r\n\r\nexport class FuturisticBypass {\r\n    private _state: boolean = false;\r\n\r\n    get on(): boolean {\r\n        return this._state;\r\n    }\r\n\r\n    set on(value: boolean) {\r\n        this._state = value;\r\n    }\r\n\r\n    static instance: FuturisticBypass;\r\n\r\n    static init(mod: ModSDKModAPI, lateHook: (callback: () => void) => void) {\r\n        FuturisticBypass.instance = new FuturisticBypass(mod);\r\n    }\r\n\r\n    constructor(mod: ModSDKModAPI) {\r\n        mod.hookFunction('InventoryItemFuturisticValidate', 2, (args, next) => {\r\n            if (this._state) return \"\";\r\n            return next(args);\r\n        });\r\n\r\n        mod.hookFunction('ExtendedItemValidate', 2, (args, next) => {\r\n            const item = args[2] as Item;\r\n            if (item.Asset.Name.startsWith(\"Futuristic\") && this._state) return \"\";\r\n            return next(args);\r\n        })\r\n    }\r\n}","import { CheckOutfitItem } from \"bc-utilities\";\r\nimport { OutfitItems, OutfitItemsMap } from \"../OutfitCtrl\";\r\n\r\nexport function IsFullyDressed(player: Character): boolean {\r\n    const items_map = new Map<string, Item>(\r\n        player.Appearance.map(e => [e.Asset.Group.Name, e])\r\n    );\r\n    return OutfitItems.every(e => {\r\n        const item = items_map.get(e.Asset.Group);\r\n        if (!item || !CheckOutfitItem(item, e, { craft: true, lock: true })) return false;\r\n        return true;\r\n    });\r\n}\r\n\r\nexport function IsCollarOn(target: Character): boolean {\r\n    const group = \"ItemNeck\";\r\n    const item = target.Appearance.find(e => e.Asset.Group.Name === group);\r\n    const outfit = OutfitItemsMap.get(group);\r\n    if (!item || !outfit) return false;\r\n    if (!CheckOutfitItem(item, outfit, { craft: true, lock: true })) return false;\r\n    return true;\r\n}\r\n\r\nfunction IsGroupsDressed(player: PlayerCharacter, groups: AssetGroupItemName[]) {\r\n    let tItems = player.Appearance.filter(e => groups.includes(e.Asset.Group.Name as AssetGroupItemName));\r\n    if (tItems.length !== groups.length) return false;\r\n    return tItems.every(e => {\r\n        const outfit = OutfitItemsMap.get(e.Asset.Group.Name);\r\n        if (!CheckOutfitItem(e, outfit, { craft: true, lock: true })) return false;\r\n        return true;\r\n    });\r\n}\r\n\r\nexport function IsPlayerWolfGirl(player: PlayerCharacter): boolean {\r\n    return IsGroupsDressed(player, [\"ItemNeck\"]) || IsGroupsDressed(player, [\"ItemVulva\"]);\r\n}","import { ModSDKModAPI } from \"bondage-club-mod-sdk\";\r\nimport { IsPlayerWolfGirl } from \"../Check\";\r\nimport { CtrlType } from \"../IController\";\r\nimport { TestCtrlResult } from \"../IController\";\r\nimport { IController } from \"../IController\";\r\nimport { CUSTOM_ACTION_TAG } from \"../../../Definition\";\r\nimport { StandardItemSetRecords } from \"../IController\";\r\nimport { StandardItemTestRecords } from \"../IController\";\r\n\r\nfunction ChatOrWhisperToWolfGirl(data: ServerChatRoomMessage, then: (player: PlayerCharacter, sender: Character) => void) {\r\n    if (data.Type === \"Chat\" || data.Type === \"Whisper\") {\r\n        const sender = ChatRoomCharacter.find(c => c.MemberNumber === data.Sender);\r\n        if (sender && Player && Player.MemberNumber && IsPlayerWolfGirl(Player)) {\r\n            const item = Player.Appearance.find(e => e.Asset.Group.Name === \"ItemEars\") as Item;\r\n            const typed = item?.Property?.TypeRecord?.typed;\r\n            if (typed !== undefined && typed > 0) then(Player, sender);\r\n        }\r\n    }\r\n}\r\n\r\nfunction calcRecordValue(type: CtrlType): TypeRecord[] {\r\n    if (type === \"off\") return [{ typed: 0 }];\r\n    else if (type === \"base\") return [{ typed: 1 }];\r\n    else if (type === \"total\") return [{ typed: 3 }];\r\n    else return [{ typed: 0 }];\r\n}\r\n\r\nexport class HearingCtrl extends IController {\r\n    readonly type = \"HearingCtrl\";\r\n    readonly target_item: AssetGroupItemName[] = [\"ItemEars\"];\r\n    readonly available_ctrls: CtrlType[] = [\"off\", \"base\", \"total\"];\r\n\r\n    set(player: PlayerCharacter, item: (Item | undefined)[], type: CtrlType) {\r\n        StandardItemSetRecords(player, item, calcRecordValue(type));\r\n    }\r\n\r\n    test(player: PlayerCharacter, item: Item[], type: CtrlType): TestCtrlResult {\r\n        return StandardItemTestRecords(item, calcRecordValue(type));\r\n    }\r\n\r\n    hook(mod: ModSDKModAPI, lateHook: (callback: () => void) => void) {\r\n        mod.hookFunction(\"ChatRoomMessage\", 1, (args, next) => {\r\n            const [data] = args as [ServerChatRoomMessage];\r\n            ChatOrWhisperToWolfGirl(data, (player, sender) => {\r\n                (data as any)[CUSTOM_ACTION_TAG] = mod.callOriginal(\"SpeechGarble\", [sender, data.Content]);\r\n            });\r\n\r\n            return next(args);\r\n        });\r\n\r\n        mod.hookFunction(\"ChatRoomMessageDisplay\", 1, (args, next) => {\r\n            const typedArgs = args as [ServerChatRoomMessage, string, Character, any];\r\n            ChatOrWhisperToWolfGirl(typedArgs[0], () => {\r\n                typedArgs[1] = (typedArgs[0] as any)[CUSTOM_ACTION_TAG] ?? typedArgs[1];\r\n            });\r\n            return next(typedArgs);\r\n        });\r\n    }\r\n}","import { CtrlType } from \"../IController\";\r\nimport { TAccept } from \"../IController\";\r\nimport { TReject } from \"../IController\";\r\nimport { TestCtrlResult } from \"../IController\";\r\nimport { IController } from \"../IController\";\r\n\r\nfunction calcValue(type: CtrlType): number {\r\n    if (type === \"off\") return 0;\r\n    else if (type === \"open\") return 2;\r\n    else if (type === \"max\") return 4;\r\n    else if (type === \"random\") return 5;\r\n    else return 0;\r\n}\r\n\r\nexport class ToysCtrl extends IController {\r\n    readonly type = \"ToysCtrl\";\r\n    readonly target_item: AssetGroupItemName[] = [\"ItemVulva\", \"ItemPelvis\", \"ItemVulvaPiercings\", \"ItemButt\", \"ItemNipples\", \"ItemNipplesPiercings\"];\r\n    readonly available_ctrls: CtrlType[] = [\"open\", \"max\", \"off\", \"random\"];\r\n\r\n    set(player: PlayerCharacter, item: (Item | undefined)[], type: CtrlType): void {\r\n        const target = calcValue(type);\r\n        item.forEach(i => {\r\n            if (!i) return;\r\n            if (i.Asset.Archetype === \"vibrating\")\r\n                ExtendedItemSetOptionByRecord(player, i, { vibrating: target })\r\n            else if (i.Asset.Archetype === \"modular\") {\r\n                if (i.Property?.TypeRecord?.i === undefined) return;\r\n                if (type === \"random\") ExtendedItemSetOptionByRecord(player, i, { i: 0 });\r\n                else ExtendedItemSetOptionByRecord(player, i, { i: target });\r\n            }\r\n        });\r\n    }\r\n\r\n    test(player: PlayerCharacter, item: Item[], type: CtrlType): TestCtrlResult {\r\n        if (type === \"random\") return TAccept();\r\n\r\n        const target = calcValue(type);\r\n        if (item.every(i => {\r\n            if (i.Asset.Archetype === \"vibrating\") {\r\n                if (i.Property?.TypeRecord?.vibrating === target) return true;\r\n            } else if (i.Asset.Archetype === \"modular\") {\r\n                if (i.Property?.TypeRecord?.i === target) return true;\r\n            }\r\n            return false;\r\n        })) return TReject(\"unchanged\");\r\n        return TAccept();\r\n    }\r\n}","import { CtrlType } from \"../IController\";\r\nimport { TestCtrlResult } from \"../IController\";\r\nimport { IController } from \"../IController\";\r\nimport { StandardItemSetRecords } from \"../IController\";\r\nimport { StandardItemTestRecords } from \"../IController\";\r\n\r\nfunction calcRecordValue(type: CtrlType): TypeRecord[] {\r\n    if (type === \"off\") return [{ typed: 0 }];\r\n    else if (type === \"base\") return [{ typed: 1 }];\r\n    else if (type === \"total\") return [{ typed: 3 }];\r\n    else return [];\r\n}\r\n\r\nexport class VisionCtrl extends IController {\r\n    readonly type = \"VisionCtrl\";\r\n    readonly target_item: AssetGroupItemName[] = [\"ItemHead\"];\r\n    readonly available_ctrls: CtrlType[] = [\"off\", \"base\", \"total\"];\r\n\r\n    set(player: PlayerCharacter, item: (Item | undefined)[], type: CtrlType): void {\r\n        StandardItemSetRecords(player, item, calcRecordValue(type));\r\n    }\r\n\r\n    test(player: PlayerCharacter, item: Item[], type: CtrlType): TestCtrlResult {\r\n        return StandardItemTestRecords(item, calcRecordValue(type));\r\n    }\r\n}","import { CtrlType } from \"../IController\";\r\nimport { TestCtrlResult } from \"../IController\";\r\nimport { IController } from \"../IController\";\r\nimport { StandardItemSetRecords } from \"../IController\";\r\nimport { StandardItemTestRecords } from \"../IController\";\r\n\r\nfunction calcRecordValue(type: CtrlType): TypeRecord[] {\r\n    if (type === \"off\") return [{ g: 0, p: 0, t: 0 }];\r\n    else if (type === \"base\") return [{ g: 0, p: 3, t: 0 }];\r\n    else if (type === \"total\") return [{ g: 2, p: 3, t: 4 }];\r\n    else return [];\r\n}\r\n\r\nexport class VoiceCtrl extends IController {\r\n    readonly type = \"VoiceCtrl\";\r\n    readonly target_item: AssetGroupItemName[] = [\"ItemMouth\"];\r\n    readonly available_ctrls: CtrlType[] = [\"off\", \"base\", \"total\"];\r\n\r\n    set(player: PlayerCharacter, item: (Item | undefined)[], type: CtrlType): void {\r\n        const target = calcRecordValue(type);\r\n        const [mouth] = item;\r\n        const oldg = mouth?.Property?.TypeRecord?.g;\r\n        StandardItemSetRecords(player, item, target);\r\n        if (target[0].g !== oldg && mouth?.Property?.AutoPunishUndoTime !== undefined)\r\n            mouth.Property.AutoPunishUndoTime = 0;\r\n    }\r\n\r\n    test(player: PlayerCharacter, item: Item[], type: CtrlType): TestCtrlResult {\r\n        return StandardItemTestRecords(item, calcRecordValue(type));\r\n    }\r\n}","import { CtrlType } from \"../IController\";\r\nimport { TAccept } from \"../IController\";\r\nimport { TReject } from \"../IController\";\r\nimport { TestCtrlResult } from \"../IController\";\r\nimport { IController } from \"../IController\";\r\n\r\nconst props = {\r\n    open: {\r\n        \"OpenPermission\": true,\r\n        \"OpenPermissionChastity\": true,\r\n        \"OpenPermissionArm\": true,\r\n        \"OpenPermissionLeg\": true\r\n    },\r\n    close: {\r\n        \"OpenPermission\": false,\r\n        \"OpenPermissionChastity\": false,\r\n        \"OpenPermissionArm\": false,\r\n        \"OpenPermissionLeg\": false\r\n    }\r\n}\r\n\r\nexport class FCollarPublic extends IController {\r\n    readonly type = \"FuturisticPublicCtrl\";\r\n    readonly target_item: AssetGroupItemName[] = [\"ItemNeck\"];\r\n    readonly available_ctrls: CtrlType[] = [\"open\", \"close\"];\r\n\r\n    set(player: PlayerCharacter, item: (Item | undefined)[], type: CtrlType): void {\r\n        const [collar] = item;\r\n        if (!collar) return;\r\n        if (!collar.Property) collar.Property = {};\r\n        if (type === \"open\") {\r\n            Object.assign(collar.Property, props.open)\r\n        }\r\n        else if (type === \"close\") {\r\n            Object.assign(collar.Property, props.close)\r\n        }\r\n    }\r\n\r\n    test(player: PlayerCharacter, item: Item[], type: CtrlType): TestCtrlResult {\r\n        const [collar] = item;\r\n        const collar_props = collar.Property;\r\n        if (!collar_props) return TReject(\"itemprop\");\r\n\r\n        const target_props = type === \"open\" ? props.open : props.close;\r\n        const filtered = Object.keys(target_props).map(k => collar_props[k as keyof ItemProperties] === (target_props as any)[k]);\r\n        if (filtered.every(i => i)) return TReject(\"unchanged\");\r\n        return TAccept();\r\n    }\r\n}","import { ModSDKModAPI } from \"bondage-club-mod-sdk\";\r\nimport { ArousalCtrl } from \"./Ctrls/Arousal\";\r\nimport { FeetCtrl } from \"./Ctrls/Feet\";\r\nimport { HandsCtrl } from \"./Ctrls/Hands\";\r\nimport { HearingCtrl } from \"./Ctrls/Hearing\";\r\nimport { ToysCtrl } from \"./Ctrls/Toys\";\r\nimport { VisionCtrl } from \"./Ctrls/Vision\";\r\nimport { VoiceCtrl } from \"./Ctrls/Voice\";\r\nimport { FuturisticBypass } from \"./Ctrls/FuturisticBypass\";\r\nimport { FCollarPublic } from \"./Ctrls/FCollar\";\r\nimport { IController } from \"./IController\";\r\nimport { TestCtrlResult } from \"./IController\";\r\nimport { ControllerType } from \"./IController\";\r\nimport { CtrlType } from \"./IController\";\r\nimport { TReject } from \"./IController\";\r\nimport { buildAppMap, buildItemsMap } from \"bc-utilities\";\r\nimport { CheckItem, OutfitItemsMap } from \"../OutfitCtrl\";\r\nimport { DefaultCheckOutfitItem } from \"../OutfitCtrl/Utils\";\r\n\r\nexport { IsPlayerWolfGirl } from \"./Check\";\r\n\r\nconst WolfGirlCtrls = [HearingCtrl, ArousalCtrl, FeetCtrl,\r\n    HandsCtrl, ToysCtrl, VisionCtrl, VoiceCtrl, FCollarPublic].map(c => new c);\r\n\r\nexport const WolfGirlCtrlMap = new Map(WolfGirlCtrls.map(c => [c.type, c] as [ControllerType, IController]));\r\n\r\nexport function RunControls(player: PlayerCharacter, type: ControllerType, mode: CtrlType) {\r\n    const ctrl = WolfGirlCtrlMap.get(type);\r\n    if (!ctrl) return false;\r\n    const app_map = new Map(player.Appearance.map(e => [e.Asset.Group.Name, e] as [string, Item]));\r\n    FuturisticBypass.instance.on = true;\r\n    ctrl.set(player, ctrl.target_item.map(e => app_map.get(e)), mode);\r\n    FuturisticBypass.instance.on = false;\r\n    return true;\r\n}\r\n\r\nexport function TestRunControls(player: PlayerCharacter, type: ControllerType, mode: CtrlType) {\r\n    const ctrl = WolfGirlCtrlMap.get(type);\r\n\r\n    if (!ctrl) return TReject(\"type\");\r\n    if (!ctrl.available_ctrls.includes(mode)) return TReject(\"mode\");\r\n\r\n    const app_map = buildItemsMap(player);\r\n    const missing = ctrl.target_item.filter(e => !DefaultCheckOutfitItem(app_map.get(e), OutfitItemsMap.get(e)));\r\n\r\n    if (missing.length > 0) return { missing } as TestCtrlResult;\r\n    return ctrl.test(player, ctrl.target_item.map(e => app_map.get(e) as Item), mode);\r\n}\r\n\r\nexport function GetWolfGirlName(target: Character): string {\r\n    return `wolf girl ${target.MemberNumber ?? \"\"}`;\r\n}\r\n\r\nexport function GetCommandPrefix(target: Character): RegExp {\r\n    return new RegExp(`^wolf girl *${target.MemberNumber ?? \"\"}`);\r\n}\r\n\r\nexport function WolfGirlCtrlInit(mod: ModSDKModAPI, lateHook: (callback: () => void) => void) {\r\n    WolfGirlCtrls.forEach(item => item.hook(mod, lateHook));\r\n    FuturisticBypass.init(mod, lateHook);\r\n}\r\n\r\nexport function ReduceTypeRecords(records: TypeRecord[], ref: TypeRecord): TypeRecord | undefined {\r\n    if (records.length === 0) return undefined;\r\n    const ref_ = { ...ref }\r\n    Object.keys(ref_).forEach(key => ref_[key] = 0);\r\n\r\n    for (const record of records) {\r\n        if (Object.keys(record).some(key => ref_[key] === undefined)) return undefined;\r\n        Object.keys(record).forEach(key => ref_[key] = Math.max(record[key], ref_[key]));\r\n    }\r\n\r\n    return ref_;\r\n}\r\n\r\n\r\n","import { CtrlType } from \"../../WolfGirlCtrl/IController\";\r\nimport { IMessage } from \"../../Message\";\r\n\r\n\r\nexport type CmdSequenceMessage = CmdSequenceModeMessage & {\r\n    missing: CmdSequenceMessageItem;\r\n}; export interface CmdSequenceModeMessage {\r\n    modes: {\r\n        [key in CtrlType]?: CmdSequenceMessageItem;\r\n    };\r\n}\r\nexport interface CmdSequenceMessageItem {\r\n    notify: IMessage;\r\n    action: IMessage;\r\n}\r\n\r\nexport const StdMissingMsgBase: IMessage = { mode: \"chat-action\", msg: \"The command was received, but the command execution was abnormal. The component {missing_formated} was not online, so the command could not be completed.\" }\r\nexport const StdMissingMsgN: IMessage = { mode: \"chat-action\", msg: \"The command was received but executed abnormally. The component {missing_formated} is not online. The corresponding functional module group is incomplete. The command cannot be completed.\" }\r\nexport const StdMissingMsgNPart: IMessage = { mode: \"chat-action\", msg: \"The command was received but executed abnormally. The component {missing_formated} is not online. The corresponding functional module group is incomplete. The command cannot be fully completed.\" }\r\nexport const StdMissingAction: IMessage = { mode: \"action\", msg: \"{player_wg}'s central control core makes a small error beep, but other than that nothing happens\" }\r\n\r\nexport const StdMissing: CmdSequenceMessageItem = {\r\n    notify: StdMissingMsgBase,\r\n    action: StdMissingAction\r\n};\r\n\r\n","import { CommandType } from \"../ChatRoom/ICmds\";\r\nimport { ExtractMemberNumber } from \"../utils/Character\";\r\nimport { ChatRoomAction } from \"bc-utilities\";\r\nimport { GetWolfGirlName } from \"./WolfGirlCtrl\";\r\n\r\nexport interface IMessage {\r\n    mode: IMessageMode;\r\n    msg: string;\r\n}\r\n\r\nexport type IMessageMode = \"action\" | \"chat-action\" | \"local\" | \"chat\" | \"local-status\";\r\n\r\nexport function FormatMessage(msg: string, src?: { player?: Character, target?: Character }, args?: { [key: string]: any }) {\r\n    if (!src) src = {};\r\n    return msg.replace(/{([\\w\\d_]+)}/g, (match, p1) => {\r\n        if (src?.target) {\r\n            if (p1 === \"target\") return CharacterNickname(src.target);\r\n            if (p1 === \"target_id\") return src.target.MemberNumber?.toString() ?? \"\";\r\n            if (p1 === \"target_wg\") return GetWolfGirlName(src.target);\r\n        }\r\n        if (src?.player) {\r\n            if (p1 === \"player\") return CharacterNickname(src.player);\r\n            if (p1 === \"player_id\") return src.player.MemberNumber?.toString() ?? \"\";\r\n            if (p1 === \"player_wg\") return GetWolfGirlName(src.player);\r\n        }\r\n        if (args && args[p1]) {\r\n            return args[p1].toString();\r\n        }\r\n        return match;\r\n    });\r\n}\r\n\r\nexport function ParseMessage(option: IMessage, src?: { player?: Character, target?: Character }, args?: { [key: string]: any }) {\r\n    const formated = FormatMessage(option.msg, src, args);\r\n    if (option.mode === \"action\") {\r\n        ChatRoomAction.instance.SendAction(formated);\r\n    } else if (option.mode === \"chat-action\") {\r\n        ChatRoomAction.instance.SendAction(\"\\\"\" + formated + \"\\\"\");\r\n    } else if (option.mode === \"local\") {\r\n        ChatRoomAction.instance.LocalAction(formated);\r\n    } else if (option.mode === \"chat\") {\r\n        ChatRoomAction.instance.SendChat(formated);\r\n    } else if (option.mode === \"local-status\") {\r\n        ChatRoomAction.instance.LocalInfo(formated);\r\n    }\r\n}\r\n\r\nexport function MessageSimWrongCoding(src: string, weight: number) {\r\n    const WrongCodingSrc: string[] = [\r\n        \"�\", \"�2�\", \"□��\",\r\n        \"??\", \"????\", \"??????\",\r\n        \"烫烫\", \"烫烫烫\", \"烫烫烫烫\", \"烫烫烫烫烫\",\r\n        \"ììð\", \"ñâââ\", \"îýîú\", \"ýýýÿÿÿ\",\r\n    ]\r\n\r\n    const replace = (c: string, idx: number) => {\r\n        const p = idx / src.length * weight * 0.5 + weight * 0.5;\r\n        if (Math.random() < p) {\r\n            return WrongCodingSrc[Math.floor(Math.random() * WrongCodingSrc.length)];\r\n        }\r\n        return c;\r\n    };\r\n\r\n    return src.split('').map(replace).join('');\r\n}\r\n\r\nexport function RouteIM(type: CommandType, player: PlayerCharacter, target: number | Character, msg: string, args?: { [key: string]: any }) {\r\n    const formated = FormatMessage(msg, { player }, args);\r\n    const tnum = ExtractMemberNumber(target);\r\n    if (type === \"Chat\") {\r\n        ChatRoomAction.instance.SendAction(formated);\r\n    } else if (type === \"Whisper\") {\r\n        ChatRoomAction.instance.SendWhisper(tnum, formated);\r\n    } else if (type === \"Beep\") {\r\n        ChatRoomAction.instance.SendBeep(tnum, formated);\r\n    }\r\n}\r\n","import { OutfitItemType, buildItemsMap } from \"bc-utilities\";\r\nimport { IMessage, IMessageMode, ParseMessage } from \"./Message\";\r\nimport { OutfitItemsMap } from \"./OutfitCtrl\";\r\nimport { TimedWork, TimedWorkState } from \"./Worker\";\r\nimport { DefaultCheckOutfitItem } from \"./OutfitCtrl/Utils\";\r\n\r\n\r\nexport class DelayWork extends TimedWork {\r\n    _timeout: number;\r\n    first_run: boolean = true;\r\n    constructor(delay: number) {\r\n        super();\r\n        this._timeout = delay;\r\n    }\r\n\r\n    run(player: PlayerCharacter): TimedWorkState {\r\n        if (this.first_run) {\r\n            this.first_run = false;\r\n            this._timeout = Date.now() + this._timeout;\r\n        }\r\n\r\n        if (Date.now() < this._timeout) return TimedWorkState.running;\r\n        return TimedWorkState.finished;\r\n    }\r\n}\r\n\r\ninterface CheckWorkState {\r\n    passed: boolean;\r\n    state: TimedWorkState;\r\n}\r\n\r\ninterface CheckWorkMessage {\r\n    mode: IMessageMode;\r\n    passed: string;\r\n    failed: string;\r\n}\r\n\r\nexport class CheckWork extends TimedWork {\r\n    readonly _check: (player: PlayerCharacter) => CheckWorkState;\r\n    readonly message?: CheckWorkMessage | ((player: PlayerCharacter, result: CheckWorkState) => IMessage | void);\r\n    constructor(check: (player: PlayerCharacter) => CheckWorkState, message?: CheckWorkMessage | ((player: PlayerCharacter, result: CheckWorkState) => IMessage | void)) {\r\n        super();\r\n        this._check = check;\r\n        this.message = message;\r\n    }\r\n\r\n    run(player: PlayerCharacter): TimedWorkState {\r\n        const checked = this._check(player);\r\n\r\n        if (this.message) {\r\n            const rmessage: IMessage | void = (() => {\r\n                if (typeof this.message === \"function\") return this.message(player, checked);\r\n                if (checked.passed) return { mode: this.message.mode, msg: this.message.passed };\r\n                return { mode: this.message.mode, msg: this.message.failed };\r\n            })()\r\n            if (rmessage) {\r\n                ParseMessage(rmessage, { player });\r\n            }\r\n        }\r\n        return checked.state;\r\n    }\r\n\r\n    static readonly Accepted: CheckWorkState = { state: TimedWorkState.finished, passed: true };\r\n    static readonly Continue: CheckWorkState = { state: TimedWorkState.finished, passed: false };\r\n    static readonly Rejected: CheckWorkState = { state: TimedWorkState.interrupted, passed: false };\r\n    static readonly Stop: CheckWorkState = { state: TimedWorkState.interrupted, passed: true };\r\n}\r\n\r\nexport class CommonWork {\r\n    readonly _callback: (player: PlayerCharacter) => void | TimedWorkState;\r\n\r\n    constructor(callback: (player: PlayerCharacter) => void | TimedWorkState) {\r\n        this._callback = callback;\r\n    }\r\n\r\n    run(player: PlayerCharacter): TimedWorkState {\r\n        const result = this._callback(player);\r\n        if (result === undefined) return TimedWorkState.finished;\r\n        return result;\r\n    }\r\n}\r\n\r\nexport class CheckItemsWork extends TimedWork {\r\n    _target: OutfitItemType[];\r\n    constructor(target: (AssetGroupItemName | OutfitItemType)[], readonly callback: (player: PlayerCharacter, result: { missing: OutfitItemType[] }) => TimedWorkState | void, readonly checkLock?: boolean) {\r\n        super();\r\n        this._target = target.map(e => typeof e === \"string\" ? OutfitItemsMap.get(e) : e).filter(e => e !== undefined) as OutfitItemType[];\r\n    }\r\n\r\n    run(player: PlayerCharacter): TimedWorkState {\r\n        const app_map = buildItemsMap(player);\r\n        const missing = this._target.filter(e => {\r\n            return !DefaultCheckOutfitItem(app_map.get(e.Asset.Group), e, this.checkLock);\r\n        })\r\n\r\n        const result = this.callback(player, { missing });\r\n        if (result === undefined) return TimedWorkState.finished;\r\n        return result;\r\n    }\r\n}","import { RunControls } from \".\";\r\nimport { ControllerType } from \"./IController\";\r\nimport { CtrlType } from \"./IController\";\r\nimport { TestCtrlResult } from \"./IController\";\r\nimport { TimedWork, TimedWorkState } from \"../Worker\";\r\nimport { TestRunControls } from \".\";\r\n\r\nexport class RunControlWork extends TimedWork {\r\n    constructor(readonly type: ControllerType, readonly mode: CtrlType) { super(); }\r\n\r\n    run(player: PlayerCharacter): TimedWorkState {\r\n        RunControls(player, this.type, this.mode);\r\n        return TimedWorkState.finished;\r\n    }\r\n}\r\n\r\nexport class TestControlWork extends TimedWork {\r\n    constructor(readonly type: ControllerType, readonly mode: CtrlType, readonly call: (r: TestCtrlResult) => TimedWorkState | void) {\r\n        super();\r\n    }\r\n\r\n    run(player: PlayerCharacter): TimedWorkState {\r\n        const result = TestRunControls(player, this.type, this.mode);\r\n        return this.call(result) || TimedWorkState.finished;\r\n    }\r\n}","import { CommonWork } from \"../../CommonWork\";\r\nimport { IMessage, ParseMessage } from \"../../Message\";\r\nimport { OutfitItemsMap } from \"../../OutfitCtrl\";\r\nimport { ControllerType, TestCtrlMissingResult, TestCtrlResult } from \"../../WolfGirlCtrl/IController\";\r\nimport { CtrlType } from \"../../WolfGirlCtrl/IController\";\r\nimport { RunControls } from \"../../WolfGirlCtrl\";\r\nimport { TestControlWork } from \"../../WolfGirlCtrl/Works\";\r\nimport { TimedWork, TimedWorkState, TimedWorker } from \"../../Worker\";\r\nimport { StdMissing } from \"./CmdSequenceMessage\";\r\nimport { CmdSequenceMessage } from \"./CmdSequenceMessage\";\r\nimport { AppearanceUpdate } from \"bc-utilities\";\r\n\r\nexport interface CmdData {\r\n    xMessage?: IMessage | undefined;\r\n    do_work?: boolean;\r\n    type: ControllerType;\r\n    mode: CtrlType;\r\n}\r\n\r\nexport type CmdMissingCallback = (result: TestCtrlMissingResult, data: CmdData) => TimedWorkState | void;\r\nexport type CmdSuccessCallback = (data: CmdData) => TimedWorkState | void;\r\n\r\n\r\nexport function StdResultBranch(player: PlayerCharacter, data: CmdData, on_missing: CmdMissingCallback, on_success: CmdSuccessCallback) {\r\n    return (result: TestCtrlResult) => {\r\n        const call_result = (() => {\r\n            if (result.missing) return on_missing(result as TestCtrlMissingResult, data);\r\n            else if (result.rejected === \"unchanged\") {\r\n                ParseMessage({ mode: \"chat-action\", msg: \"Received a command, but the command execution was abnormal. Staying in current working mode\" }, { player });\r\n                data.xMessage = StdMissing.action;\r\n            }\r\n            else if (result.rejected) {\r\n                ParseMessage({ mode: \"chat-action\", msg: `[DEBUG] error message: WGException.${data.type}.Rejected.${result.rejected}` }, { player });\r\n                return TimedWorkState.interrupted;\r\n            }\r\n            else return on_success(data);\r\n        })();\r\n        return call_result ?? TimedWorkState.finished;\r\n    }\r\n}\r\n\r\nexport function StdCmdSequence(player: PlayerCharacter, type: ControllerType, mode: CtrlType, messages: CmdSequenceMessage) {\r\n\r\n    let data: CmdData = { type, mode };\r\n\r\n    const work_sequence: TimedWork[] = [\r\n        new TestControlWork(type, data.mode, StdResultBranch(player, data, (missing_result, data) => {\r\n            const missing_formated = missing_result.missing.map(g => OutfitItemsMap.get(g)?.Craft.Name).join(\", \");\r\n            ParseMessage(messages.missing.notify, { player }, { missing_formated });\r\n            data.xMessage = messages.missing.action;\r\n        }, (data) => {\r\n            const msg = messages.modes[data.mode];\r\n            if (msg) {\r\n                ParseMessage(msg.notify, { player });\r\n                data.xMessage = msg.action;\r\n                data.do_work = true;\r\n            } else {\r\n                ParseMessage({ mode: \"chat-action\", msg: `[DEBUG] error message: WGException.${data.type}.MissingDialog.${data.mode}` }, { player });\r\n                return TimedWorkState.interrupted;\r\n            }\r\n        })),\r\n        new CommonWork(() => {\r\n            if (data.do_work) {\r\n                RunControls(player, type, data.mode);\r\n                AppearanceUpdate(player);\r\n            }\r\n        }),\r\n        new CommonWork(() => { if (data.xMessage) ParseMessage(data.xMessage, { player }); }),\r\n    ];\r\n\r\n    TimedWorker.global.push({ description: `SetItemSequence${type}`, works: work_sequence });\r\n}\r\n","import { CtrlType } from \"../../WolfGirlCtrl/IController\";\r\nimport { StdMissing } from \"./CmdSequenceMessage\";\r\nimport { CmdSequenceMessage } from \"./CmdSequenceMessage\";\r\nimport { StdCmdSequence } from \"./StdCmdSequence\";\r\n\r\n\r\nexport function ArousalCtrlSequence(player: PlayerCharacter, mode: CtrlType) {\r\n    const messages: CmdSequenceMessage = {\r\n        missing: StdMissing,\r\n        modes: {\r\n            \"off\": {\r\n                notify: { mode: \"chat-action\", msg: \"Received the instruction, the orgasm lock has been disabled\" },\r\n                action: { mode: \"action\", msg: \"{player_wg}'s orgasm lock icon goes out as the command was spoken. Although her body did not feel any changes, a strange sense of freedom might be washing over her heart. Perhaps the only orgasm she wanted was the one allowed by command.\" },\r\n            },\r\n            \"edge\": {\r\n                notify: { mode: \"chat-action\", msg: \"Received the command, the orgasm lock has been turned on, the current mode is: edge\" },\r\n                action: { mode: \"action\", msg: \"An icon slowly begins to flash in {player_wg}'s field of vision. Even without the manual, one could roughly guess the meaning of the small lock icon embedded in the flashing light red heart. Perhaps, in the next second, the next touch, {player_wg} will reach the other end of the corridor. However, it seems that the end was only a short distance away.\" },\r\n            },\r\n            \"deny\": {\r\n                notify: { mode: \"chat-action\", msg: \"Received command, orgasm lock has been turned on, current mode: deny orgasm\" },\r\n                action: { mode: \"action\", msg: \"An icon slowly begins to flash in {player_wg}'s field of vision, and the heart with a small lock embedded in it splits into two halves, while the lock was still the most conspicuous. Endless pleasure does not bring endless satisfaction. Even if the belt is open and {player_wg} is allowed to masturbate or have sex, she will never be satisfied. Or is this another kind of satisfaction for her?\" },\r\n            }\r\n        }\r\n    };\r\n\r\n    StdCmdSequence(player, \"ArousalCtrl\", mode, messages);\r\n}\r\n","import { CtrlType } from \"../../WolfGirlCtrl/IController\";\r\nimport { StdMissing } from \"./CmdSequenceMessage\";\r\nimport { CmdSequenceMessage } from \"./CmdSequenceMessage\";\r\nimport { StdCmdSequence } from \"./StdCmdSequence\";\r\n\r\n\r\nexport function HearingCtrlSequence(player: PlayerCharacter, mode: CtrlType) {\r\n    const messages: CmdSequenceMessage = {\r\n        missing: StdMissing,\r\n        modes: {\r\n            \"off\": {\r\n                notify: { mode: \"chat-action\", msg: \"Received command, hearing restriction has been turned off\" },\r\n                action: { mode: \"action\", msg: \"The red light on {player_wg}'s headset gradually fades, leaving only a barely detectable light blue. The sounds of the world passed through the machine and hazily entered {player_wg}'s ears. Without the dead silence just now, there is no need to concentrate on reading lips, so she is able to relax a lot now, right?\"},\r\n            },\r\n            \"base\": {\r\n                notify: { mode: \"chat-action\", msg: \"Received command, hearing restriction has been turned on\" },\r\n                action: { mode: \"action\", msg: \"The sound in {player_wg}'s ears suddenly becomes fainter and more blurred and hazy. The indicator light on her earphones lights up as a small red light. Although it is covered by {player_wg}'s hair, it could still be vaguely detected.\" },\r\n            },\r\n            \"total\": {\r\n                notify: { mode: \"chat-action\", msg: \"Received command, hearing limit has been set to high power operation\" },\r\n                action: { mode: \"action\", msg: \"{player_wg}'s headphones seem to tighten slightly, and the outside world seems to have been paused at this moment and fallen into silence. The faint light just now is now a striking red flash, as if trying to announce something, but so what? The hustle and bustle of the world is already too noisy and disturbing, maybe this can help calm down\" },\r\n            }\r\n        }\r\n    };\r\n    StdCmdSequence(player, \"HearingCtrl\", mode, messages);\r\n}\r\n","import { CtrlType } from \"../../WolfGirlCtrl/IController\";\r\nimport { StdMissing } from \"./CmdSequenceMessage\";\r\nimport { CmdSequenceMessage } from \"./CmdSequenceMessage\";\r\nimport { StdCmdSequence } from \"./StdCmdSequence\";\r\n\r\n\r\nexport function VisionCtrlSequence(player: PlayerCharacter, mode: CtrlType) {\r\n    const messages: CmdSequenceMessage = {\r\n        missing: StdMissing,\r\n        modes: {\r\n            \"off\": {\r\n                notify: { mode: \"chat-action\", msg: \"Received command, visual restriction has been disabled\" },\r\n                action: { mode: \"action\", msg: \"{player_wg}'s goggles gradually return to their original appearance, and the neural interference module becomes softer as the color changes. A little light breaks into {player_wg}'s dark world. Although it is not clear enough, it is enough to prevent her from falling to the ground and hitting obstacles. In this situation, it might be fun to play some chasing games.\" },\r\n            },\r\n            \"base\": {\r\n                notify: { mode: \"chat-action\", msg: \"Received command, visual restriction is enabled\" },\r\n                action: { mode: \"action\", msg: \"{player_wg}'s goggles flicker slightly and dim slightly. The work of the neural interference module combined with the change of the lens make {player_wg}'s vision more and more blurred.\" },\r\n            },\r\n            \"total\": {\r\n                notify: { mode: \"chat-action\", msg: \"Received command, visual restriction set to high power operation\" },\r\n                action: { mode: \"action\", msg: \"{player_wg}'s goggles are completely dark, and the power of the neural interference module increase significantly. {player_wg} is almost completely unable to see, but without vision, in the dark world, wouldn't the sense of security brought by the embrace and breath of a trusted person be more intoxicating? No longer need to see other people, and will never see other people again, maybe just a trace of residual fragrance is enough to guide the direction\" },\r\n            }\r\n        }\r\n    };\r\n    StdCmdSequence(player, \"VisionCtrl\", mode, messages);\r\n}\r\n","import { ExtractMemberNumber } from \"../utils/Character\";\r\nimport { ParseMessage } from \"./Message\";\r\nimport { IMessage } from \"./Message\";\r\nimport { TimedWork } from \"./Worker\";\r\nimport { TimedWorkState } from \"./Worker\";\r\n\r\nexport class MessageWork extends TimedWork {\r\n    constructor(readonly message: IMessage, readonly config?: { target?: number | Character, args?: Record<string, any> }) {\r\n        super();\r\n    }\r\n\r\n    run(player: PlayerCharacter): TimedWorkState {\r\n        const target = (() => {\r\n            if (!this.config?.target) return undefined;\r\n            const t = this.config.target;\r\n            if (typeof t === 'number') return ChatRoomCharacter.find(c => c.MemberNumber === t);\r\n            return t;\r\n        })();\r\n        ParseMessage(this.message, { player, target }, this.config?.args);\r\n        return TimedWorkState.finished;\r\n    }\r\n}\r\n\r\ninterface WaitResponseWorkOptions {\r\n    accept: RegExp,\r\n    reject: RegExp,\r\n    accept_msg?: IMessage,\r\n    reject_msg?: IMessage\r\n}\r\n\r\nexport class WaitResponseWork extends TimedWork {\r\n    private _target: number;\r\n    private _options: WaitResponseWorkOptions;\r\n\r\n    private _timeout: number;\r\n    private _last_query: number;\r\n\r\n    private _then: (player: PlayerCharacter, target: Character) => void;\r\n\r\n    private first_run: boolean = true;\r\n\r\n    constructor(target: number | Character, options: WaitResponseWorkOptions, timeout: number, then: (player: PlayerCharacter, target: Character) => void,) {\r\n        super();\r\n        this._target = ExtractMemberNumber(target);\r\n        this._options = options;\r\n        this._last_query = 0;\r\n        this._timeout = timeout;\r\n        this._then = then;\r\n    }\r\n\r\n    run(player: PlayerCharacter): TimedWorkState {\r\n        if (this.first_run) {\r\n            this.first_run = false;\r\n            this._timeout = Date.now() + this._timeout;\r\n            this._last_query = Date.now();\r\n        }\r\n\r\n        const target = ChatRoomCharacter.find(c => c.MemberNumber === this._target);\r\n        if (!target) return TimedWorkState.interrupted;\r\n        if (ChatRoomChatLog == null) return TimedWorkState.interrupted;\r\n\r\n        let result: 'accept' | 'reject' | 'default' | 'timeout' = 'default';\r\n        for (const L of ChatRoomChatLog.filter(m => m.SenderMemberNumber === this._target && m.Time > this._last_query)) {\r\n            if (this._options.accept.test(L.Original)) {\r\n                result = 'accept';\r\n                break;\r\n            } else if (this._options.reject.test(L.Original)) {\r\n                result = 'reject';\r\n                break;\r\n            }\r\n            this._last_query = Math.max(this._last_query, L.Time);\r\n        };\r\n\r\n        if (result === 'default' && Date.now() > this._timeout) {\r\n            result = 'timeout';\r\n        }\r\n\r\n        if (result === 'accept' && this._options.accept_msg) {\r\n            ParseMessage(this._options.accept_msg);\r\n            return TimedWorkState.finished;\r\n        }\r\n\r\n        if (result === 'reject' && this._options.reject_msg) {\r\n            ParseMessage(this._options.reject_msg);\r\n            return TimedWorkState.finished;\r\n        }\r\n\r\n        if (result === 'timeout') {\r\n            this._then(player, target);\r\n            return TimedWorkState.finished;\r\n        }\r\n        return TimedWorkState.running;\r\n    }\r\n}\r\n","import { OutfitItemsMap } from \"./OutfitCtrl\";\r\nimport { TimedWork, TimedWorkState } from \"./Worker\";\r\n\r\nfunction IsSimpleChat(msg: string) {\r\n    return msg.trim().length > 0 && !msg.startsWith(\"/\") && !msg.startsWith(\"(\") && !msg.startsWith(\"*\");\r\n}\r\n\r\nfunction ChatRoomInterceptMessage(cur_msg: string, msg: string) {\r\n    if (!cur_msg) return;\r\n    ElementValue(\"InputChat\", cur_msg + \"... \" + msg);\r\n    ChatRoomSendChat();\r\n}\r\n\r\nexport function DoShockPunish(player: PlayerCharacter, item: Item | undefined) {\r\n    if (CurrentCharacter !== null)\r\n        CurrentCharacter.FocusGroup = null;\r\n    CurrentCharacter = null;\r\n    if (CurrentScreen === 'Preference')\r\n        CommonSetScreen(\"Character\", \"InformationSheet\");\r\n    if (CurrentScreen === 'ChatAdmin')\r\n        CommonSetScreen('Online', 'ChatRoom');\r\n    if (CurrentScreen === 'InformationSheet' && InformationSheetPreviousModule)\r\n        CommonSetScreen(InformationSheetPreviousModule, InformationSheetPreviousScreen);\r\n    let msg = ElementValue(\"InputChat\");\r\n    if (IsSimpleChat(msg))\r\n        ChatRoomInterceptMessage(msg, '');\r\n\r\n    const MemberNumber = player.MemberNumber;\r\n\r\n    if (!MemberNumber) return;\r\n\r\n    const intensity = 2;\r\n\r\n    const Dictionary = [\r\n        { Tag: \"DestinationCharacterName\", Text: CharacterNickname(player), MemberNumber: MemberNumber } as CharacterReferenceDictionaryEntry,\r\n        { Tag: \"AssetName\", AssetName: item?.Asset.Name, GroupName: item?.Asset.Group.Name } as AssetReferenceDictionaryEntry,\r\n        { ShockIntensity: intensity * 1.5 } as ShockEventDictionaryEntry,\r\n        { FocusGroupName: item?.Asset.Group.Name } as FocusGroupDictionaryEntry,\r\n        { Automatic: true } as AutomaticEventDictionaryEntry,\r\n    ] as ChatMessageDictionary;\r\n\r\n    if (CurrentScreen == \"ChatRoom\")\r\n        ChatRoomMessage({ Content: 'TriggerShock' + intensity, Type: \"Action\", Sender: MemberNumber, Dictionary: Dictionary });\r\n\r\n    InventoryShockExpression(player);\r\n}\r\n\r\nexport class PunishWork extends TimedWork {\r\n    private _timer: number;\r\n    static punish_flag = false;\r\n\r\n    constructor(timer: number) {\r\n        super();\r\n        this._timer = timer;\r\n    }\r\n\r\n    private first_run = false;\r\n    run(player: PlayerCharacter): TimedWorkState {\r\n        if (!this.first_run) {\r\n            this.first_run = true;\r\n            this._timer = Date.now() + this._timer;\r\n        }\r\n\r\n        if (!PunishWork.punish_flag) return TimedWorkState.finished;\r\n\r\n        const collar = InventoryGet(player, \"ItemNeck\");\r\n        if (!collar) return TimedWorkState.interrupted;\r\n\r\n        DoShockPunish(player, collar);\r\n\r\n        if (Date.now() > this._timer) return TimedWorkState.finished;\r\n        return TimedWorkState.running;\r\n    }\r\n}\r\n\r\nexport class RandomSinglePunishWork extends TimedWork {\r\n    run(player: PlayerCharacter): TimedWorkState {\r\n        const items = player.Appearance.filter(i => i.Asset.Group.Name.startsWith(\"Item\"));\r\n        const item = items[Math.floor(Math.random() * items.length)];\r\n        const oi = OutfitItemsMap.get(item.Asset.Group.Name);\r\n        if (oi) {\r\n            DoShockPunish(player, item);\r\n        }\r\n        return TimedWorkState.finished;\r\n    }\r\n}\r\n\r\n\r\nexport function StopPunish(player: PlayerCharacter) {\r\n    PunishWork.punish_flag = false;\r\n}","import { CommonWork, DelayWork } from \"../../CommonWork\";\r\nimport { MessageSimWrongCoding, ParseMessage } from \"../../Message\";\r\nimport { MessageWork } from \"../../MessageWork\";\r\nimport { OutfitItemsMap } from \"../../OutfitCtrl\";\r\nimport { DefaultCheckItemByGroup, CheckMissingItems } from \"../../OutfitCtrl/Utils\";\r\nimport { RandomSinglePunishWork } from \"../../PunishWork\";\r\nimport { ControllerType, TestCtrlMissingResult, TestCtrlResult } from \"../../WolfGirlCtrl/IController\";\r\nimport { CtrlType } from \"../../WolfGirlCtrl/IController\";\r\nimport { RunControls } from \"../../WolfGirlCtrl\";\r\nimport { TestControlWork } from \"../../WolfGirlCtrl/Works\";\r\nimport { TimedWork, TimedWorkState, TimedWorker } from \"../../Worker\";\r\nimport { StdMissing, StdMissingMsgBase, StdMissingMsgN, StdMissingMsgNPart } from \"./CmdSequenceMessage\";\r\nimport { CmdSequenceModeMessage } from \"./CmdSequenceMessage\";\r\nimport { CmdData, StdResultBranch } from \"./StdCmdSequence\";\r\nimport { AppearanceUpdate } from \"bc-utilities\";\r\n\r\n\r\nexport function HandsCtrlSequence(player: PlayerCharacter, mode: CtrlType) {\r\n\r\n    const messages: CmdSequenceModeMessage = {\r\n        modes: {\r\n            off: {\r\n                notify: { mode: \"chat-action\", msg: \"Received command, arm restraints are disabled\" },\r\n                action: { mode: \"action\", msg: \"The energy beams between the cuffs on {player_wg}'s arms gradually extinguish, and the neural interference module also shuts down the control of the arm. The nanomachines on the gloves return to their original positions with a slight vibration, releasing {player_wg}'s arms and hands. Is it really freedom, or is it just a momentary illusion?\" }\r\n            },\r\n            base: {\r\n                notify: { mode: \"chat-action\", msg: \"Received command, arm restraints have been enabled\" },\r\n                action: { mode: \"action\", msg: \"The handcuffs on {player_wg}'s arms begin to attract each other, and the coordination between the electrical stimulation system and the neural interference module made the force of the handcuffs tightening. {player_wg} was always slightly greater than her thoughts of struggling and resisting, so she can only watch her arms and fingers being gradually gathered and connected.\" }\r\n            },\r\n            total: {\r\n                notify: { mode: \"chat-action\", msg: \"Received command, arm restraints have been set to the strongest mode\" },\r\n                action: { mode: \"action\", msg: \"The cuffs on {player_wg}'s arms suddenly tighten, and the unquestionable force even makes {player_wg} feel a little pain. She even ignored the nanomachines on the gloves that tighten and press her fists a little bit. The tight closure of her arms and the squeezing of her fingers and palms, or perhaps for {player_wg}'s heart, was this a better situation?\" }\r\n            }\r\n        }\r\n    };\r\n\r\n    const type: ControllerType = \"HandsCtrl\";\r\n\r\n    let data: CmdData = { type, mode };\r\n\r\n    const missing_route_01 = (result: TestCtrlMissingResult) => {\r\n        ParseMessage(StdMissingMsgBase, { player }, { missing_formated: result.missing.map(g => OutfitItemsMap.get(g)?.Craft.Name).join(\", \") });\r\n        data.xMessage = StdMissing.action;\r\n    }\r\n\r\n    const missing_route_02 = (result: TestCtrlMissingResult) => {\r\n        ParseMessage(StdMissingMsgNPart, { player },\r\n            { missing_formated: result.missing.map(g => OutfitItemsMap.get(g)?.Craft.Name).join(\", \") });\r\n        data.xMessage = { mode: \"action\", msg: \"{player_wg}'s central control core beeps a little, and then the fingers of the glove slowly deform and tighten, causing her hands to curl into two balls of flesh that could not be grasped.\" };\r\n        data.mode = \"total\";\r\n        data.do_work = true;\r\n    }\r\n\r\n    const missing_route_03 = (result: TestCtrlMissingResult) => {\r\n        ParseMessage(StdMissingMsgNPart, { player },\r\n            { missing_formated: result.missing.map(g => OutfitItemsMap.get(g)?.Craft.Name).join(\", \") });\r\n        data.xMessage = { mode: \"action\", msg: \"The cuffs on {player_wg}'s arms are quickly tightened with a punishing force, tightening {player_wg}'s arms, which would obviously cause sufficient and lasting pain.\" };\r\n        data.mode = \"total\";\r\n        data.do_work = true;\r\n    }\r\n\r\n    const missing_route_04 = (result: TestCtrlMissingResult) => {\r\n        ParseMessage(StdMissingMsgN, { player },\r\n            { missing_formated: result.missing.map(g => OutfitItemsMap.get(g)?.Craft.Name).join(\", \") });\r\n        data.xMessage = StdMissing.action;\r\n    }\r\n\r\n    const missing_route_05 = (result: TestCtrlMissingResult) => {\r\n        const missing_formated = result.missing.map(g => OutfitItemsMap.get(g)?.Craft.Name).join(\", \");\r\n\r\n        if (DefaultCheckItemByGroup(player, \"ItemVulva\")) {\r\n            ParseMessage(StdMissingMsgN, { player }, { missing_formated });\r\n            data.xMessage = StdMissing.action;\r\n            return;\r\n        }\r\n\r\n        if (CheckMissingItems(player).size >= 5) {\r\n            const err_works: TimedWork[] = [\r\n                new MessageWork({ mode: \"chat-action\", msg: \"Received command, arm restraints are disabled\" }),\r\n                new CommonWork(() => ParseMessage(StdMissingMsgNPart, { player }, { missing_formated })),\r\n                new MessageWork({ mode: \"chat-action\", msg: \"Received the instruction, arms limit limit limit limit limit limit limit.....\" }),\r\n                new MessageWork({ mode: \"action\", msg: \"{player_wg}'s central control core emits a sharp and continuous beeping sound, but soon returns to silence.\" }),\r\n                new MessageWork({ mode: \"action\", msg: MessageSimWrongCoding(StdMissingMsgBase.msg, 0.5) }),\r\n                new RandomSinglePunishWork(),\r\n                new MessageWork({ mode: \"action\", msg: MessageSimWrongCoding(StdMissingMsgBase.msg, 0.9) }),\r\n                new RandomSinglePunishWork(),\r\n                new DelayWork(1000),\r\n                new RandomSinglePunishWork(),\r\n                new DelayWork(1000),\r\n                new RandomSinglePunishWork(),\r\n                new MessageWork({ mode: \"action\", msg: \"{player_wg}'s central control core once again emits a sharp sound, but soon returns to silence again.\" }),\r\n                new MessageWork({ mode: \"chat-action\", msg: \"An error in the execution of a command was detected, and the execution of the command has been terminated and retried.\" }),\r\n            ];\r\n            TimedWorker.global.insert_after_first({ description: `SetItemSequence${type}`, works: err_works });\r\n            return TimedWorkState.interrupted;\r\n        }\r\n\r\n        ParseMessage({ mode: \"chat-action\", msg: \"Received command, arm restraints are disabled\" }, { player });\r\n        mode = \"off\";\r\n        data.do_work = true;\r\n    }\r\n\r\n    const work_sequence: TimedWork[] = [\r\n        new TestControlWork(type, mode, StdResultBranch(player, data, (missing_result, data) => {\r\n            if (missing_result.missing.length === 2) return missing_route_01(missing_result);\r\n            if (mode === \"off\") return missing_route_05(missing_result);\r\n            if (Math.random() < 0.5) return missing_route_04(missing_result);\r\n            if (missing_result.missing.includes(\"ItemArms\")) return missing_route_02(missing_result);\r\n            if (missing_result.missing.includes(\"ItemHands\")) return missing_route_03(missing_result);\r\n        }, (data) => {\r\n            const msg = messages.modes[mode];\r\n            if (msg) {\r\n                ParseMessage(msg.notify, { player });\r\n                data.xMessage = msg.action;\r\n                data.do_work = true;\r\n            } else {\r\n                ParseMessage({ mode: \"chat-action\", msg: `[DEBUG] error message: WGException.${data.type}.MissingDialog.${data.mode}` }, { player });\r\n                return TimedWorkState.interrupted;\r\n            }\r\n        })),\r\n        new CommonWork(() => {\r\n            if (data.do_work) {\r\n                RunControls(player, type, data.mode);\r\n                AppearanceUpdate(player);\r\n            }\r\n        }),\r\n        new CommonWork(() => { if (data.xMessage) ParseMessage(data.xMessage, { player }); }),\r\n    ];\r\n\r\n    TimedWorker.global.push({ description: `SetItemSequence${type}`, works: work_sequence });\r\n}\r\n","import { AppearanceUpdate } from \"bc-utilities\";\r\nimport { CommonWork, DelayWork } from \"../../CommonWork\";\r\nimport { MessageSimWrongCoding, ParseMessage } from \"../../Message\";\r\nimport { MessageWork } from \"../../MessageWork\";\r\nimport { OutfitItemsMap } from \"../../OutfitCtrl\";\r\nimport { DefaultCheckItemByGroup, CheckMissingItems } from \"../../OutfitCtrl/Utils\";\r\nimport { RandomSinglePunishWork } from \"../../PunishWork\";\r\nimport { RunControls } from \"../../WolfGirlCtrl\";\r\nimport { ControllerType, TestCtrlMissingResult } from \"../../WolfGirlCtrl/IController\";\r\nimport { CtrlType } from \"../../WolfGirlCtrl/IController\";\r\nimport { TestControlWork } from \"../../WolfGirlCtrl/Works\";\r\nimport { TimedWorkState, TimedWork, TimedWorker } from \"../../Worker\";\r\nimport { CmdSequenceModeMessage, StdMissing, StdMissingMsgBase, StdMissingMsgN, StdMissingMsgNPart } from \"./CmdSequenceMessage\";\r\nimport { CmdData, StdResultBranch } from \"./StdCmdSequence\";\r\n\r\n\r\nexport function FeetCtrlSequence(player: PlayerCharacter, mode: CtrlType) {\r\n    const messages: CmdSequenceModeMessage = {\r\n        modes: {\r\n            off: {\r\n                notify: { mode: \"chat-action\", msg: \"Received instruction, walking restriction has been turned off\" },\r\n                action: { mode: \"action\", msg: \"The indicator lights on the limb action controllers on {player_wg}'s legs slowly turn off. Her legs, now free of any movement restrictions, might be able to stretch out for the first time in a long time. But don't worry, she won't be able to run away.\" },\r\n            },\r\n            base: {\r\n                notify: { mode: \"chat-action\", msg: \"Received instruction, walking restriction has been enabled\" },\r\n                action: { mode: \"action\", msg: \"{player_wg}'s leg motion controller is activated again, making {player_wg} feel the familiar weakness of the leg muscles and the slowness and restriction of the stiff joints. The energy beams between the cuffs announc that {player_wg} is currently in a restricted state, but it seems that she has difficulty taking a step without the energy beam connection.\" },\r\n            },\r\n            total: {\r\n                notify: { mode: \"chat-action\", msg: \"Received the instruction, the walking restriction has been set to the strongest restriction mode\" },\r\n                action: { mode: \"action\", msg: \"{player_wg}'s leg rings are suddenly tightened, without much time to react. Fortunately, the motion posture stabilization system interves in time to prevent {player_wg} from falling to the ground in pain and distress. However, it is only a matter of time before she is pushed down after losing the ability to walk. Who would have thought that {player_wg}, who was standing quietly and with a dignified posture, could not even take the simplest step?\" },\r\n            }\r\n        }\r\n    };\r\n\r\n    const type: ControllerType = \"FeetCtrl\";\r\n\r\n    let data: CmdData = { type, mode };\r\n\r\n    const missing_route_01 = (result: TestCtrlMissingResult, data: CmdData) => {\r\n        const missing_formated = result.missing.map(g => OutfitItemsMap.get(g)?.Craft.Name).join(\", \");\r\n        ParseMessage(StdMissingMsgBase, { player }, { missing_formated });\r\n        data.xMessage = StdMissing.action;\r\n    }\r\n\r\n    const missing_route_02 = (result: TestCtrlMissingResult, data: CmdData) => {\r\n        const missing_formated = result.missing.map(g => OutfitItemsMap.get(g)?.Craft.Name).join(\", \");\r\n        ParseMessage(StdMissingMsgNPart, { player }, { missing_formated });\r\n        data.xMessage = { mode: \"action\", msg: \"{player_wg}'s limb motion controller starts up with a small error beep from the central control core. She closes her legs and tries to maintain her position and balance as much as possible. However, due to the abnormal configuration parameters of the motion controller, she can only move slowly.\" };\r\n        data.mode = \"base\";\r\n        data.do_work = true;\r\n    }\r\n\r\n    const missing_route_03 = (result: TestCtrlMissingResult, data: CmdData) => {\r\n        const missing_formated = result.missing.map(g => OutfitItemsMap.get(g)?.Craft.Name).join(\", \");\r\n        ParseMessage(StdMissingMsgN, { player }, { missing_formated });\r\n        data.xMessage = { mode: \"action\", msg: \"{player_wg}'s body movement controller flashes a few times in rhythm with the central control core's error beep. Apart from that, nothing happens.\" };\r\n    }\r\n\r\n    const missing_route_04 = (result: TestCtrlMissingResult, data: CmdData) => {\r\n        const missing_formated = result.missing.map(g => OutfitItemsMap.get(g)?.Craft.Name).join(\", \");\r\n        ParseMessage(StdMissingMsgN, { player }, { missing_formated });\r\n        data.xMessage = StdMissing.action;\r\n    }\r\n\r\n    const missing_route_05 = (result: TestCtrlMissingResult, data: CmdData) => {\r\n        const missing_formated = result.missing.map(g => OutfitItemsMap.get(g)?.Craft.Name).join(\", \");\r\n\r\n        if (DefaultCheckItemByGroup(player, \"ItemVulva\")) {\r\n            ParseMessage(StdMissingMsgN, { player }, { missing_formated });\r\n            data.xMessage = StdMissing.action;\r\n            return;\r\n        }\r\n\r\n        if (CheckMissingItems(player).size >= 5) {\r\n            const err_works: TimedWork[] = [\r\n                new MessageWork({ mode: \"chat-action\", msg: \"Received instruction, walking restriction has been disabled\" }),\r\n                new CommonWork(() => ParseMessage(StdMissingMsgNPart, { player }, { missing_formated })),\r\n                new MessageWork({ mode: \"chat-action\", msg: \"Received the instruction, walking limit limit limit limit limit limit limit limit.....\" }),\r\n                new MessageWork({ mode: \"action\", msg: \"{player_wg}'s central control core emits a sharp and continuous beeping sound, but soon returns to silence.\" }),\r\n                new MessageWork({ mode: \"action\", msg: MessageSimWrongCoding(StdMissingMsgBase.msg, 0.5) }),\r\n                new RandomSinglePunishWork(),\r\n                new MessageWork({ mode: \"action\", msg: MessageSimWrongCoding(StdMissingMsgBase.msg, 0.9) }),\r\n                new RandomSinglePunishWork(),\r\n                new DelayWork(1000),\r\n                new RandomSinglePunishWork(),\r\n                new DelayWork(1000),\r\n                new RandomSinglePunishWork(),\r\n                new MessageWork({ mode: \"action\", msg: \"{player_wg}'s central control core once again emits a sharp sound, but soon returns to silence.\" }),\r\n                new MessageWork({ mode: \"chat-action\", msg: \"An error in the execution of a command was detected, and the execution of the command has been terminated and retried.\" }),\r\n            ];\r\n            TimedWorker.global.insert_after_first({ description: `SetItemSequence${type}`, works: err_works });\r\n            return TimedWorkState.interrupted;\r\n        }\r\n\r\n        ParseMessage({ mode: \"chat-action\", msg: \"Received instruction, walking restriction has been disabled\" }, { player });\r\n        data.mode = \"off\";\r\n        data.do_work = true;\r\n    }\r\n\r\n    const work_sequence: TimedWork[] = [\r\n        new TestControlWork(type, mode, StdResultBranch(player, data, (missing_result, data) => {\r\n            if (missing_result.missing.length === 3) return missing_route_01(missing_result, data);\r\n            if (mode === \"off\") return missing_route_05(missing_result, data);\r\n            if (Math.random() < 0.5) return missing_route_04(missing_result, data);\r\n            if (missing_result.missing.length === 1) return missing_route_02(missing_result, data);\r\n            if (missing_result.missing.length === 2) return missing_route_03(missing_result, data);\r\n        }, (data) => {\r\n            const msg = messages.modes[mode];\r\n            if (msg) {\r\n                ParseMessage(msg.notify, { player });\r\n                data.xMessage = msg.action;\r\n                data.do_work = true;\r\n            } else {\r\n                ParseMessage({ mode: \"chat-action\", msg: `[DEBUG] error message: WGException.${data.type}.MissingDialog.${data.mode}` }, { player });\r\n                return TimedWorkState.interrupted;\r\n            }\r\n        })),\r\n        new CommonWork(() => {\r\n            if (data.do_work) {\r\n                RunControls(player, type, data.mode);\r\n                AppearanceUpdate(player);\r\n            }\r\n        }),\r\n        new CommonWork(() => { if (data.xMessage) ParseMessage(data.xMessage, { player }); }),\r\n    ];\r\n\r\n    TimedWorker.global.push({ description: `SetItemSequence${type}`, works: work_sequence });\r\n}\r\n","import { CtrlType } from \"../../WolfGirlCtrl/IController\";\r\nimport { StdMissing } from \"./CmdSequenceMessage\";\r\nimport { CmdSequenceMessage } from \"./CmdSequenceMessage\";\r\nimport { StdCmdSequence } from \"./StdCmdSequence\";\r\n\r\nexport function VoiceCtrlSequence(player: PlayerCharacter, mode: CtrlType) {\r\n    const messages: CmdSequenceMessage = {\r\n        missing: StdMissing,\r\n        modes: {\r\n            off: {\r\n                notify: { mode: \"chat-action\", msg: \"Received instruction, language restriction has been disabled\" },\r\n                action: {\r\n                    mode: \"action\",\r\n                    msg: \"{player_wg}'s smart gag makes a small hissing sound and slowly shrinks while the original built-in grooves reappear. Although it slightly reduces the sound of the words, at least one can clearly hear what {player_wg} wants to say. Shouldn't she say thank you?\",\r\n                },\r\n            },\r\n            base: {\r\n                notify: { mode: \"chat-action\", msg: \"Received instruction, language restriction is enabled\" },\r\n                action: {\r\n                    mode: \"action\",\r\n                    msg: \"{player_wg}'s gag vibrates slightly, and a small light on the gag's strap lights up, then slowly begins to expand. Although it slightly hinderes the pronunciation of the lips and tongue, she is still able to roughly express her wishes.\",\r\n                },\r\n            },\r\n            total: {\r\n                notify: { mode: \"chat-action\", msg: \"Received instruction, language restriction has been set to the strongest restriction mode\" },\r\n                action: {\r\n                    mode: \"action\",\r\n                    msg: \"{player_wg}'s gag continues to swell, and all the indicator lights on the straps light up. The expanded latex not only presses down her tender tongue, but also penetrates into her throat little by little, filling her mouth. The neural interference module suppresses the reflexive retching and coughing at the right time. Well, making a whining sound through the nose is indeed what wolves do when their mouths are restrained. Isn't this perfect?\",\r\n                },\r\n            },\r\n        },\r\n    };\r\n\r\n    StdCmdSequence(player, \"VoiceCtrl\", mode, messages);\r\n}\r\n","import { EILNetwork } from \"../Network\";\r\nimport { ExtractMemberNumber } from \"../utils/Character\";\r\nimport { DataManager } from \"./DataManager\";\r\n\r\nexport class PermissionUtilities {\r\n    moderators: Set<number>;\r\n    constructor(readonly parent: DataManager) {\r\n        this.moderators = new Set<number>(this.parent.data.permission.moderators);\r\n    }\r\n\r\n    private save() {\r\n        this.parent.save(\"permission\");\r\n    }\r\n\r\n    setLoverMode(arg: boolean) {\r\n        this.parent.data.permission.loverModerators = arg;\r\n        this.save();\r\n    }\r\n\r\n    setModerator(id: number, add: boolean) {\r\n        if (add) {\r\n            if (!this.moderators.has(id)) {\r\n                this.moderators.add(id);\r\n                this.parent.data.permission.moderators.push(id);\r\n                this.save();\r\n            }\r\n        } else {\r\n            if (this.moderators.has(id)) {\r\n                this.moderators.delete(id);\r\n                this.parent.data.permission.moderators = Array.from(this.moderators);\r\n                this.save();\r\n            }\r\n        }\r\n    }\r\n\r\n    get data() {\r\n        return this.parent.data.permission;\r\n    }\r\n\r\n    isCommandAuthorized(moderatee: Character, moderator: number | Character): boolean {\r\n        const num = ExtractMemberNumber(moderator);\r\n        if (this.isEILNet(moderator)) return true;\r\n        if (this.isOwner(moderator, moderatee)) return true;\r\n        if (this.isAdditionModerator(num)) return true;\r\n        if (this.parent.data.permission.loverModerators\r\n            && this.isLover(moderator, moderatee)) return true;\r\n        return false;\r\n    }\r\n\r\n    isEILNet(moderator: number | Character): boolean {\r\n        const num = ExtractMemberNumber(moderator);\r\n        return EILNetwork.Access.isEIL(num);\r\n    }\r\n\r\n    isLover(moderator: number | Character, moderatee: Character): boolean {\r\n        const num = ExtractMemberNumber(moderator);\r\n        if (moderatee.Lovership && moderatee.Lovership.some(i => i.MemberNumber === num)) return true;\r\n        return false;\r\n    }\r\n\r\n    isOwner(moderator: number | Character, moderatee: Character): boolean {\r\n        const num = ExtractMemberNumber(moderator);\r\n        if (moderatee.Ownership && moderatee.Ownership.MemberNumber === num) return true;\r\n        return false;\r\n    }\r\n\r\n    isAdditionModerator(moderator: number | Character): boolean {\r\n        const num = ExtractMemberNumber(moderator);\r\n        return this.moderators.has(num);\r\n    }\r\n}\r\n","import { DataManager } from \"./DataManager\";\r\n\r\n\r\nexport class OutfitUtilities {\r\n    constructor(readonly parent: DataManager) {\r\n        this._items = new Map<string, DataOutfitItem>(parent.data.outfit.items.map(i => [i.asset.group, i]));\r\n        this._color_store = new Map<string, ColorStoreItem>(parent.data.outfit.color_store.map(i => [i.group, i]));\r\n    }\r\n\r\n    private save() {\r\n        this.parent.save(\"outfit\");\r\n    }\r\n\r\n    private get data() {\r\n        return this.parent.data.outfit;\r\n    }\r\n\r\n    get lite_mode() {\r\n        return this.data.lite_mode;\r\n    }\r\n\r\n    set lite_mode(arg: boolean) {\r\n        this.data.lite_mode = arg;\r\n        this.save();\r\n    }\r\n\r\n    private _items: Map<string, DataOutfitItem>;\r\n    add(item: DataOutfitItem | DataOutfitItem[]) {\r\n        if (Array.isArray(item)) {\r\n            item.forEach(i => this._items.set(i.asset.group, i));\r\n        } else {\r\n            this._items.set(item.asset.group, item);\r\n        }\r\n        this.data.items = [...this._items.values()];\r\n        this.save();\r\n    }\r\n\r\n    get items(): Map<string, DataOutfitItem> {\r\n        return this._items;\r\n    }\r\n\r\n    set items(arg: DataOutfitItem[] | Map<string, DataOutfitItem>) {\r\n        if (Array.isArray(arg)) {\r\n            this.data.items = arg;\r\n            this._items = new Map<string, DataOutfitItem>(arg.map(i => [i.asset.group, i]));\r\n        } else {\r\n            this.data.items = [...arg.values()];\r\n            this._items = arg;\r\n        }\r\n        this.save();\r\n    }\r\n\r\n    private _color_store: Map<string, ColorStoreItem>;\r\n    get color_store(): Map<string, ColorStoreItem> {\r\n        return this._color_store;\r\n    }\r\n\r\n    set color_store(arg: ColorStoreItem[] | Map<string, ColorStoreItem>) {\r\n        if (Array.isArray(arg)) {\r\n            this.data.color_store = arg;\r\n            this._color_store = new Map<string, ColorStoreItem>(arg.map(i => [i.group, i]));\r\n        } else {\r\n            this.data.color_store = [...arg.values()];\r\n            this._color_store = arg;\r\n        }\r\n        this.save();\r\n    }\r\n}\r\n","export function defaultValue(): WolfGirlData {\r\n    return {\r\n        outfit: {\r\n            lite_mode: false,\r\n            items: [],\r\n            color_store: []\r\n        },\r\n        permission: {\r\n            moderators: [],\r\n            loverModerators: true\r\n        },\r\n        settings: {\r\n            orgasmPunishMode: 0\r\n        },\r\n        stat: {\r\n            script_run_time: 0,\r\n            wolfgirl_time: 0,\r\n            stash_time: 0,\r\n            last_fix_time: 0,\r\n            task: {\r\n                finished: 0,\r\n                failed: 0,\r\n                counter: {}\r\n            }\r\n        },\r\n        points: {\r\n            current: 0,\r\n            punish_time: 5 * 60 * 1000,\r\n            task_time: 15 * 60 * 1000,\r\n            orgasm_punish_time: 5 * 60 * 1000\r\n        },\r\n        arousal: {\r\n            orgasm: 0,\r\n            ruined: 0,\r\n            resist: 0,\r\n            edge_time: 0,\r\n        }\r\n    };\r\n}\r\n\r\nfunction IsStringArray(data: any): data is string[] {\r\n    if (!Array.isArray(data)) return false;\r\n    return data.every((item) => typeof item === \"string\");\r\n}\r\n\r\nfunction IsNumberArray(data: any): data is number[] {\r\n    if (!Array.isArray(data)) return false;\r\n    return data.every((item) => typeof item === \"number\");\r\n}\r\n\r\nexport function Validate(data: any): WolfGirlData {\r\n    const defaultData = defaultValue();\r\n    const xd = data as Partial<WolfGirlData>;\r\n\r\n    const ret: Partial<WolfGirlData> = {};\r\n\r\n    ret.outfit = ((data: Partial<WolfGirlData[\"outfit\"]> | undefined) => {\r\n        const dvalue = defaultData.outfit;\r\n        if (data === undefined) return dvalue;\r\n\r\n        if (typeof data.lite_mode === \"boolean\") dvalue.lite_mode = data.lite_mode;\r\n        if (Array.isArray(data.items)) {\r\n            let items: DataOutfitItem[] = [];\r\n            for (const item of data.items) {\r\n                if (typeof item !== \"object\") continue;\r\n                const ii = item as Partial<DataOutfitItem>;\r\n                if (typeof ii.asset !== \"object\") continue;\r\n                if (typeof ii.asset.name !== \"string\") continue;\r\n                if (typeof ii.asset.group !== \"string\") continue;\r\n                if (typeof ii.color !== \"string\" && !IsStringArray(ii.color)) continue;\r\n                if (typeof ii.property !== \"object\") continue;\r\n                items.push(ii as DataOutfitItem);\r\n            }\r\n            dvalue.items = items;\r\n        }\r\n\r\n        if (Array.isArray(data.color_store)) {\r\n            let color_store: ColorStoreItem[] = [];\r\n            for (const item of data.color_store) {\r\n                if (typeof item !== \"object\") continue;\r\n                const ii = item as Partial<ColorStoreItem>;\r\n                if (typeof ii.asset !== \"string\") continue;\r\n                if (typeof ii.group !== \"string\") continue;\r\n                if (typeof ii.color !== \"string\" && !IsStringArray(ii.color)) continue;\r\n                color_store.push(ii as ColorStoreItem);\r\n            }\r\n            dvalue.color_store = color_store;\r\n        }\r\n        return dvalue;\r\n    })(xd.outfit);\r\n\r\n    ret.permission = ((data: Partial<WolfGirlData[\"permission\"]> | undefined) => {\r\n        const dvalue = defaultData.permission;\r\n        if (data === undefined) return dvalue;\r\n        if (IsNumberArray(data.moderators)) dvalue.moderators = data.moderators;\r\n        if (typeof data.loverModerators === \"boolean\") dvalue.loverModerators = data.loverModerators;\r\n        return dvalue;\r\n    })(xd.permission);\r\n\r\n    ret.settings = ((data: Partial<WolfGirlData[\"settings\"]> | undefined) => {\r\n        const dvalue = defaultData.settings;\r\n        if (data === undefined) return dvalue;\r\n        if (typeof data.orgasmPunishMode === \"number\") dvalue.orgasmPunishMode = data.orgasmPunishMode;\r\n        return dvalue;\r\n    })(xd.settings);\r\n\r\n    ret.stat = ((data: Partial<WolfGirlData[\"stat\"]> | undefined) => {\r\n        const dvalue = defaultData.stat;\r\n        if (data === undefined) return dvalue;\r\n        if (typeof data.script_run_time === \"number\") dvalue.script_run_time = data.script_run_time;\r\n        if (typeof data.wolfgirl_time === \"number\") dvalue.wolfgirl_time = data.wolfgirl_time;\r\n        if (typeof data.stash_time === \"number\") dvalue.stash_time = data.stash_time;\r\n        if (typeof data.last_fix_time === \"number\") dvalue.last_fix_time = data.last_fix_time;\r\n        if (typeof data.task === \"object\") {\r\n            const dvalue = defaultData.stat.task;\r\n            if (typeof data.task.finished === \"number\") dvalue.finished = data.task.finished;\r\n            if (typeof data.task.failed === \"number\") dvalue.failed = data.task.failed;\r\n            if (typeof data.task.counter === \"object\") {\r\n                const dvalue = defaultData.stat.task.counter;\r\n                for (const key in data.task.counter) {\r\n                    if (typeof data.task.counter[key as TaskCounterType] === \"number\")\r\n                        dvalue[key as TaskCounterType] = (data.task.counter[key as TaskCounterType] as number);\r\n                }\r\n            }\r\n        }\r\n        return dvalue;\r\n    })(xd.stat);\r\n\r\n    ret.points = ((data: Partial<WolfGirlData[\"points\"]> | undefined) => {\r\n        const dvalue = defaultData.points;\r\n        if (data === undefined) return dvalue;\r\n        if (typeof data.current === \"number\") dvalue.current = data.current;\r\n        if (typeof data.punish_time === \"number\") dvalue.punish_time = data.punish_time;\r\n        if (typeof data.task_time === \"number\") dvalue.task_time = data.task_time;\r\n        if (typeof data.orgasm_punish_time === \"number\") dvalue.orgasm_punish_time = data.orgasm_punish_time;\r\n        return dvalue;\r\n    })(xd.points);\r\n\r\n    ret.arousal = ((data: Partial<WolfGirlData[\"arousal\"]> | undefined) => {\r\n        const dvalue = defaultData.arousal;\r\n        if (data === undefined) return dvalue;\r\n        if (typeof data.orgasm === \"number\") dvalue.orgasm = data.orgasm;\r\n        if (typeof data.ruined === \"number\") dvalue.ruined = data.ruined;\r\n        if (typeof data.resist === \"number\") dvalue.resist = data.resist;\r\n        if (typeof data.edge_time === \"number\") dvalue.edge_time = data.edge_time;\r\n        return dvalue;\r\n    })(xd.arousal);\r\n\r\n    return ret as WolfGirlData;\r\n}","import { DataManager } from \"./DataManager\";\r\n\r\ntype points_callback = (cur_points: number) => void;\r\n\r\nexport class PointsUtilities {\r\n    constructor(readonly parent: DataManager) { }\r\n\r\n    private save() {\r\n        this.parent.save(\"points\");\r\n    }\r\n\r\n    get data() {\r\n        return this.parent.data.points;\r\n    }\r\n\r\n    get points() {\r\n        return this.parent.data.points.current;\r\n    }\r\n\r\n    set points(arg: number) {\r\n        this.parent.data.points.current = arg;\r\n        this.save();\r\n    }\r\n\r\n    get punish_time() {\r\n        return this.parent.data.points.punish_time;\r\n    }\r\n\r\n    set punish_time(arg: number) {\r\n        this.parent.data.points.punish_time = arg;\r\n        this.save();\r\n    }\r\n\r\n    get orgasm_punish_time() {\r\n        return this.parent.data.points.orgasm_punish_time;\r\n    }\r\n\r\n    set orgasm_punish_time(arg: number) {\r\n        this.parent.data.points.orgasm_punish_time = arg;\r\n        this.save();\r\n    }\r\n\r\n    get task_time() {\r\n        return this.parent.data.points.task_time;\r\n    }\r\n\r\n    set task_time(arg: number) {\r\n        this.parent.data.points.task_time = arg;\r\n        this.save();\r\n    }\r\n\r\n    use_points(arg: number) {\r\n        return {\r\n            then: (accept: points_callback, reject?: points_callback) => {\r\n                if (this.points < arg) {\r\n                    if (reject) reject(this.points);\r\n                } else {\r\n                    this.points -= arg;\r\n                    accept(this.points);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}","import { OrgasmMonitor } from \"bc-utilities\";\r\nimport { DataManager } from \"./DataManager\";\r\n\r\nexport class ArousalUtilities {\r\n    constructor(readonly parent: DataManager) { }\r\n\r\n    private save() {\r\n        this.parent.save(\"arousal\");\r\n    }\r\n\r\n    get data() {\r\n        return this.parent.data.arousal;\r\n    }\r\n\r\n    get ruined() {\r\n        return this.data.ruined;\r\n    }\r\n\r\n    set ruined(num: number) {\r\n        this.data.ruined = num;\r\n        this.save();\r\n    }\r\n\r\n    get orgasm() {\r\n        return this.data.orgasm;\r\n    }\r\n\r\n    set orgasm(num: number) {\r\n        this.data.orgasm = num;\r\n        this.save();\r\n    }\r\n\r\n    get resist() {\r\n        return this.data.resist;\r\n    }\r\n\r\n    set resist(num: number) {\r\n        this.data.resist = num;\r\n        this.save();\r\n    }\r\n\r\n    setMonitor(filter: (player: PlayerCharacter) => boolean, orgasm: OrgasmMonitor) {\r\n        const rfilter = (player: PlayerCharacter, cb: () => void) => { if (filter(player)) cb(); }\r\n        orgasm.onOrgasm((player) => rfilter(player, () => this.orgasm += 1));\r\n        orgasm.onResist((player) => rfilter(player, () => this.resist += 1));\r\n        orgasm.onRuined((player) => rfilter(player, () => this.ruined += 1));\r\n    }\r\n}","import { DataManager } from \"./DataManager\";\r\n\r\nexport class StatUtilities {\r\n    constructor(readonly parent: DataManager) { }\r\n\r\n    private save() {\r\n        this.parent.save(\"stat\");\r\n    }\r\n\r\n    add_counter(taskKey: TaskCounterType, count: number) {\r\n        const couter = this.parent.data.stat.task.counter;\r\n        if (couter[taskKey] === undefined) {\r\n            couter[taskKey] = count;\r\n        } else {\r\n            (couter[taskKey] as number) += count;\r\n        }\r\n        this.save();\r\n    }\r\n\r\n    task_finished(succeed: boolean) {\r\n        if (succeed) {\r\n            this.parent.data.stat.task.finished++;\r\n        } else {\r\n            this.parent.data.stat.task.failed++;\r\n        }\r\n        this.save();\r\n    }\r\n\r\n    add_time_counter: number = 0;\r\n    add_time(isWolfGirl: boolean, isStashed: boolean, time: number) {\r\n        this.parent.data.stat.script_run_time += time;\r\n        if (isWolfGirl) {\r\n            this.parent.data.stat.wolfgirl_time += time;\r\n        }\r\n        if (isStashed) {\r\n            this.parent.data.stat.stash_time += time;\r\n        }\r\n        if (this.add_time_counter++ > 10) {\r\n            this.save();\r\n            this.add_time_counter = 0;\r\n        }\r\n    }\r\n\r\n    set_last_fix_time(time: number) {\r\n        this.parent.data.stat.last_fix_time = time;\r\n        this.save();\r\n    }\r\n\r\n}\r\n","export type DataKeys = keyof WolfGirlData;\r\n\r\ntype DataCategoryType = \"Default\" | \"Frequent\";\r\n\r\nconst DataCategory: Record<DataKeys, DataCategoryType> = {\r\n    outfit: \"Default\",\r\n    permission: \"Default\",\r\n    stat: \"Frequent\",\r\n    settings: \"Default\",\r\n    points: \"Default\",\r\n    arousal: \"Frequent\"\r\n}\r\n\r\nexport type FrequentData = Pick<WolfGirlData, \"stat\" | \"arousal\">;\r\nexport type DefaultData = Omit<WolfGirlData, \"stat\" | \"arousal\">;\r\n\r\nexport function isFrequentDataKey(key: string): key is keyof FrequentData {\r\n    return DataCategory[key as DataKeys] === \"Frequent\";\r\n}\r\n\r\nexport function isDefaultDataKey(key: string): key is keyof DefaultData {\r\n    return DataCategory[key as DataKeys] === \"Default\";\r\n}\r\n\r\nexport function isDefaultData(data: Partial<WolfGirlData>): data is WolfGirlData {\r\n    return Object.keys(DataCategory).every((key) => data[key as DataKeys] !== undefined);\r\n}\r\n\r\nexport function PickDefaultData(data: Partial<WolfGirlData>): DefaultData {\r\n    return Object.keys(DataCategory).reduce((prev, cur) => {\r\n        if (isDefaultDataKey(cur))\r\n            Object.assign(prev, { [cur]: data[cur] });\r\n        return prev;\r\n    }, {} as Partial<DefaultData>) as DefaultData;\r\n}\r\n\r\nexport function PickFrequenceData(data: Partial<WolfGirlData>): FrequentData {\r\n    return Object.keys(DataCategory).reduce((prev, cur) => {\r\n        if (isFrequentDataKey(cur))\r\n            Object.assign(prev, { [cur]: data[cur] });\r\n        return prev;\r\n    }, {} as Partial<FrequentData>) as FrequentData;\r\n}","import { ModSDKModAPI } from \"bondage-club-mod-sdk\";\r\nimport { DataKeyName, FrequentDataKeyName } from \"../Definition\";\r\nimport { PermissionUtilities } from \"./PermissionUtilities\";\r\nimport { OutfitUtilities } from \"./OutfitUtilities\";\r\nimport { Validate } from \"./DefaultValue\";\r\nimport { PointsUtilities } from \"./PointUtilities\";\r\nimport { ArousalUtilities } from \"./ArousalUtilities\";\r\nimport { StatUtilities } from \"./StatUtilities\";\r\nimport { FrequentData, DefaultData, isDefaultDataKey, PickDefaultData, isFrequentDataKey, PickFrequenceData, DataKeys } from \"./DataCategory\";\r\n\r\n\r\nfunction deserialize(str: (string | undefined)[]): WolfGirlData {\r\n    const data = str.reduce((prev, cur) => {\r\n        if (!cur) return prev;\r\n        let d = LZString.decompressFromBase64(cur);\r\n        if (!d) return prev;\r\n        try {\r\n            let decoded = JSON.parse(d);\r\n            return Object.assign(prev, decoded);\r\n        } catch {\r\n            return prev;\r\n        }\r\n    }, {} as Partial<WolfGirlData>);\r\n    return Validate(data);\r\n}\r\n\r\nfunction serialize(data: FrequentData | DefaultData): string {\r\n    return LZString.compressToBase64(JSON.stringify(data));\r\n}\r\n\r\nclass SettingUtilities {\r\n    constructor(private readonly _data: DataManager) { }\r\n\r\n    query(key: keyof WolfGirlDataSettings) {\r\n        return this._data.data.settings[key];\r\n    }\r\n\r\n    update(key: keyof WolfGirlDataSettings, value: WolfGirlDataSettings[typeof key]) {\r\n        this._data.data.settings[key] = value;\r\n        this._data.save(\"settings\");\r\n    }\r\n}\r\n\r\nconst WrongDataKeyName = \"BCWolfGrilData\";\r\nconst WrongFrequentDataKeyName = \"BCWolfGrilFrequentData\";\r\n\r\nfunction load(C: PlayerCharacter, mod: ModSDKModAPI) {\r\n    const wrongDefaultData = C.ExtensionSettings[WrongDataKeyName];\r\n    const wrongFrequentData = C.ExtensionSettings[WrongFrequentDataKeyName];\r\n    if (wrongDefaultData || wrongFrequentData) {\r\n        const ret = deserialize([wrongDefaultData, wrongFrequentData]);\r\n        delete C.ExtensionSettings[WrongDataKeyName];\r\n        delete C.ExtensionSettings[WrongFrequentDataKeyName];\r\n        C.ExtensionSettings[DataKeyName] = wrongDefaultData;\r\n        C.ExtensionSettings[FrequentDataKeyName] = wrongFrequentData;\r\n\r\n        mod.callOriginal(\"ServerSend\", [\"AccountUpdate\", { ExtensionSettings: C.ExtensionSettings }]);\r\n        return ret;\r\n    }\r\n\r\n    const defaultData = C.ExtensionSettings[DataKeyName];\r\n    const frequentData = C.ExtensionSettings[FrequentDataKeyName];\r\n    return deserialize([defaultData, frequentData]);\r\n}\r\n\r\nfunction save(data: WolfGirlData, key?: DataKeys) {\r\n    if (Player && Player.ExtensionSettings) {\r\n        if (key === undefined || isDefaultDataKey(key)) {\r\n            Player.ExtensionSettings[DataKeyName] = serialize(PickDefaultData(data));\r\n            ServerPlayerExtensionSettingsSync(DataKeyName);\r\n        }\r\n        if (key === undefined || isFrequentDataKey(key)) {\r\n            Player.ExtensionSettings[FrequentDataKeyName] = serialize(PickFrequenceData(data));\r\n            ServerPlayerExtensionSettingsSync(FrequentDataKeyName);\r\n        }\r\n    }\r\n}\r\n\r\nexport class DataManager {\r\n    private static _instance: DataManager | undefined = undefined;\r\n    private _permission: PermissionUtilities;\r\n    private _outfit: OutfitUtilities;\r\n    private _points: PointsUtilities;\r\n    private _arousal: ArousalUtilities;\r\n    private _stat: StatUtilities;\r\n    private _setting: SettingUtilities;\r\n\r\n    constructor(readonly data: WolfGirlData) {\r\n        this._permission = new PermissionUtilities(this);\r\n        this._outfit = new OutfitUtilities(this);\r\n        this._points = new PointsUtilities(this);\r\n        this._arousal = new ArousalUtilities(this);\r\n        this._stat = new StatUtilities(this);\r\n        this._setting = new SettingUtilities(this);\r\n    }\r\n\r\n    save(key?: DataKeys) {\r\n        save(this.data, key);\r\n    }\r\n\r\n    public static get instance(): DataManager {\r\n        return this._instance as DataManager;\r\n    }\r\n\r\n    public static get permission(): PermissionUtilities {\r\n        return this.instance._permission;\r\n    }\r\n\r\n    public static get outfit(): OutfitUtilities {\r\n        return this.instance._outfit;\r\n    }\r\n\r\n    public static get points(): PointsUtilities {\r\n        return this.instance._points;\r\n    }\r\n\r\n    public static get arousal(): ArousalUtilities {\r\n        return this.instance._arousal;\r\n    }\r\n\r\n    public static get statistics(): StatUtilities {\r\n        return this.instance._stat;\r\n    }\r\n\r\n    public static get settings(): SettingUtilities {\r\n        return this.instance._setting;\r\n    }\r\n\r\n    public static init(mod: ModSDKModAPI, msg?: string) {\r\n        return new Promise<DataManager>((resolve) => {\r\n            const load_then_message = (C: PlayerCharacter | null | undefined) => {\r\n                if (this._instance) return;\r\n                if (C) {\r\n                    const data = load(C, mod);\r\n                    this._instance = new DataManager(data);\r\n                    if (msg) console.log(msg);\r\n                    resolve(this._instance);\r\n                }\r\n            };\r\n\r\n            mod.hookFunction('LoginResponse', 1, (args, next) => {\r\n                next(args);\r\n                load_then_message(Player);\r\n            });\r\n\r\n            if (Player && Player.MemberNumber) {\r\n                load_then_message(Player);\r\n            }\r\n        });\r\n    }\r\n}\r\n","import { IsPlayerWolfGirl } from \"../Control/WolfGirlCtrl\";\r\nimport { DataManager } from \"../Data\";\r\n\r\nexport type Prerequisite = (player: PlayerCharacter, sender: Character | number) => boolean;\r\n\r\nexport const IsSelf: Prerequisite = (player: PlayerCharacter, sender: Character | number) =>\r\n    (typeof sender !== \"number\" ? sender.MemberNumber : sender) === player.MemberNumber;\r\n\r\nexport const IsModerator: Prerequisite = (player: PlayerCharacter, moderator: Character | number) => {\r\n    if (DataManager.permission.isCommandAuthorized(player, moderator)) return true;\r\n    return false;\r\n}\r\n\r\nexport const Or = (...prerequisites: Prerequisite[]): Prerequisite => {\r\n    return (player: PlayerCharacter, sender: Character | number) => {\r\n        return prerequisites.some(p => p(player, sender));\r\n    }\r\n}\r\n\r\nexport const And = (...prerequisites: Prerequisite[]): Prerequisite => {\r\n    return (player: PlayerCharacter, sender: Character | number) => {\r\n        return prerequisites.every(p => p(player, sender));\r\n    }\r\n}\r\n\r\nexport const Not = (prerequisite: Prerequisite): Prerequisite => {\r\n    return (player: PlayerCharacter, sender: Character | number) => {\r\n        return !prerequisite(player, sender);\r\n    }\r\n}\r\n\r\nexport const BasicPrerequisites: Prerequisite = And(Not(IsSelf), IsPlayerWolfGirl, IsModerator);\r\nexport const OutfitFixPrerequisites: Prerequisite = And(Not(IsSelf), IsModerator);\r\nexport const SelfPrerequisites: Prerequisite = And(IsSelf, IsPlayerWolfGirl);\r\nexport const ModOrSelfPrerequisites: Prerequisite = And(Or(IsSelf, IsModerator), IsPlayerWolfGirl);","import { ArousalCtrlSequence, FeetCtrlSequence, FuturisticPublicCtrlSequence, HandsCtrlSequence, HearingCtrlSequence, ToysCtrlSequence, VisionCtrlSequence, VoiceCtrlSequence } from \"../../Control/SequenceCtrl/ItemCmdSequence\";\r\nimport { CommandTemplate } from \"../ICmds\";\r\nimport { BasicPrerequisites } from \"../Prerequistes\";\r\n\r\nexport const ItemCmds: CommandTemplate[] = [\r\n    {\r\n        match: /^((关闭|基础|完全)听觉限制)|(hearing limitation (off|basic|full))/i,\r\n        prerequisite: BasicPrerequisites,\r\n        run(player, sender, content) {\r\n            HearingCtrlSequence(player, (() => {\r\n                if (content[2] === \"关闭\" || content[4].toLowerCase() === \"off\") return \"off\";\r\n                if (content[2] === \"基础\" || content[4].toLowerCase() === \"basic\") return \"base\";\r\n                if (content[2] === \"完全\" || content[4].toLowerCase() === \"full\") return \"total\";\r\n                return \"total\";\r\n            })())\r\n        }\r\n    },\r\n    {\r\n        match: /^((关闭|基础|完全)视觉限制)|(visual restrictions (off|basic|full))/i,\r\n        prerequisite: BasicPrerequisites,\r\n        run(player, sender, content) {\r\n            VisionCtrlSequence(player, (() => {\r\n                if (content[2] === \"关闭\" || content[4].toLowerCase() === \"off\") return \"off\";\r\n                if (content[2] === \"基础\" || content[4].toLowerCase() === \"basic\") return \"base\";\r\n                if (content[2] === \"完全\" || content[4].toLowerCase() === \"full\") return \"total\";\r\n                return \"total\";\r\n            })());\r\n        }\r\n    },\r\n    {\r\n        match: /^((关闭|基础|完全)语言限制)|(language restrictions (off|basic|full))/i,\r\n        prerequisite: BasicPrerequisites,\r\n        run(player, sender, content) {\r\n            VoiceCtrlSequence(player, (() => {\r\n                if (content[2] === \"关闭\" || content[4].toLowerCase() === \"off\") return \"off\";\r\n                if (content[2] === \"基础\" || content[4].toLowerCase() === \"basic\") return \"base\";\r\n                if (content[2] === \"完全\" || content[4].toLowerCase() === \"full\") return \"total\";\r\n                return \"total\";\r\n            })());\r\n        }\r\n    },\r\n    {\r\n        match: /^((关闭|基础|完全)手臂限制)|(arm restraint (off|basic|full))/i,\r\n        prerequisite: BasicPrerequisites,\r\n        run(player, sender, content) {\r\n            HandsCtrlSequence(player, (() => {\r\n                if (content[2] === \"关闭\" || content[4].toLowerCase() === \"off\") return \"off\";\r\n                if (content[2] === \"基础\" || content[4].toLowerCase() === \"basic\") return \"base\";\r\n                if (content[2] === \"完全\" || content[4].toLowerCase() === \"full\") return \"total\";\r\n                return \"total\";\r\n            })());\r\n        }\r\n    },\r\n    {\r\n        match: /^((关闭|基础|完全)行走限制)|(leg restraint (off|basic|full))/i,\r\n        prerequisite: BasicPrerequisites,\r\n        run(player, sender, content) {\r\n            FeetCtrlSequence(player, (() => {\r\n                if (content[2] === \"关闭\" || content[4].toLowerCase() === \"off\") return \"off\";\r\n                if (content[2] === \"基础\" || content[4].toLowerCase() === \"basic\") return \"base\";\r\n                if (content[2] === \"完全\" || content[4].toLowerCase() === \"full\") return \"total\";\r\n                return \"total\";\r\n            })());\r\n        }\r\n    },\r\n    {\r\n        match: /^((关闭|寸止|拒绝)高潮锁)|(orgasm lock (off|edge|deny))/i,\r\n        prerequisite: BasicPrerequisites,\r\n        run(player, sender, content) {\r\n            ArousalCtrlSequence(player, (() => {\r\n                if (content[2] === \"关闭\" || content[4].toLowerCase() === \"off\") return \"off\";\r\n                if (content[2] === \"寸止\" || content[4].toLowerCase() === \"edge\") return \"edge\";\r\n                if (content[2] === \"拒绝\" || content[4].toLowerCase() === \"deny\") return \"deny\";\r\n                return \"off\";\r\n            })());\r\n        }\r\n    },\r\n    {\r\n        match: /^((关闭|打开|最大)振动器)|(vibrator (off|on|max))/i,\r\n        prerequisite: BasicPrerequisites,\r\n        run(player, sender, content) {\r\n            ToysCtrlSequence(player, (() => {\r\n                if (content[2] === \"关闭\" || content[4].toLowerCase() === \"off\") return \"off\";\r\n                if (content[2] === \"打开\" || content[4].toLowerCase() === \"on\") return \"open\";\r\n                if (content[2] === \"最大\" || content[4].toLowerCase() === \"max\") return \"max\";\r\n                return \"max\";\r\n            })());\r\n        }\r\n    },\r\n    {\r\n        match: /^((关闭|打开)公开操作权限)|(public operation permissions (close|open))/i,\r\n        prerequisite: BasicPrerequisites,\r\n        run(player, sender, content) {\r\n            FuturisticPublicCtrlSequence(player, (() => {\r\n                if (content[2] === \"关闭\" || content[4].toLowerCase() === \"close\") return \"close\";\r\n                if (content[2] === \"打开\" || content[4].toLowerCase() === \"open\") return \"open\";\r\n                return \"open\";\r\n            })());\r\n        }\r\n    },\r\n];\r\n","import { CommonWork } from \"../../CommonWork\";\r\nimport { IMessage, ParseMessage } from \"../../Message\";\r\nimport { OutfitItemsMap } from \"../../OutfitCtrl\";\r\nimport { ControllerType } from \"../../WolfGirlCtrl/IController\";\r\nimport { CtrlType } from \"../../WolfGirlCtrl/IController\";\r\nimport { RunControls } from \"../../WolfGirlCtrl\";\r\nimport { TestControlWork } from \"../../WolfGirlCtrl/Works\";\r\nimport { TimedWork, TimedWorkState, TimedWorker } from \"../../Worker\";\r\nimport { StdMissing } from \"./CmdSequenceMessage\";\r\nimport { CmdSequenceMessage } from \"./CmdSequenceMessage\";\r\nimport { CmdData, StdResultBranch } from \"./StdCmdSequence\";\r\nimport { AppearanceUpdate } from \"bc-utilities\";\r\n\r\n\r\nexport function ToysCtrlSequence(player: PlayerCharacter, mode: CtrlType) {\r\n    const messages: CmdSequenceMessage = {\r\n        missing: StdMissing,\r\n        modes: {\r\n            off: {\r\n                notify: { mode: \"chat-action\", msg: \"Received command, vibrator turned off\" },\r\n                action: { mode: \"action\", msg: \"All the vibrators on {player_wg}'s body suddenly stop. Maybe she has a little chance to relax. Is she tired? One wonders if {player_wg} is dissatisfied with the current silence after the previous waves of pleasure?\" },\r\n            },\r\n            open: {\r\n                notify: { mode: \"chat-action\", msg: \"Received command, vibrator turned on\" },\r\n                action: { mode: \"action\", msg: \"{player_wg}'s vibrators begin to vibrate slightly. Although it is not strong enough, it is enough to slowly push her towards orgasm. There is not much buzzing sound at this power, so there is no need to worry about being discovered. Of course, if she can orgasm is hard to say.\" },\r\n            },\r\n            max: {\r\n                notify: { mode: \"chat-action\", msg: \"Received command, the vibrator has been set to maximum power mode\" },\r\n                action: { mode: \"action\", msg: \"The vibrators on {player_wg}'s body suddenly emit a clear buzzing sound. Even with the barrier of body and clothes, it is clearly audible if one gets a little closer. However, {player_wg} obviously doesn't have much energy to pay attention to this. After all, wave after wave of pleasure wash over her brain, erasing her reason and thoughts bit by bit.\" },\r\n            }\r\n        }\r\n    };\r\n\r\n    const type: ControllerType = \"ToysCtrl\";\r\n\r\n    let data: CmdData = { type, mode };\r\n\r\n    const work_sequence: TimedWork[] = [\r\n        new TestControlWork(type, mode, StdResultBranch(player, data, (result, data) => {\r\n            const missing_formated = result.missing.map(g => OutfitItemsMap.get(g)?.Craft.Name).join(\", \");\r\n            if (!result.missing.includes(\"ItemVulva\")) {\r\n                ParseMessage(messages.missing.notify, { player }, { missing_formated });\r\n                data.xMessage = { mode: \"action\", msg: \"Although {player_wg}'s vibrator indicates that it had been set up successfully, judging by the sound, something has clearly gone wrong. The humming sound of the vibrations is like the ups and downs of the sea in a storm, as if it is toying with {player_wg}, as if this mistake has been made intentionally and carelessly.\" };\r\n                data.mode = \"random\";\r\n                data.do_work = true;\r\n            } else {\r\n                ParseMessage(messages.missing.notify, { player }, { missing_formated });\r\n                data.xMessage = messages.missing.action;\r\n            }\r\n        }, (data) => {\r\n            const msg = messages.modes[mode];\r\n            if (msg) {\r\n                ParseMessage(msg.notify, { player });\r\n                data.xMessage = msg.action;\r\n                data.do_work = true;\r\n            } else {\r\n                ParseMessage({ mode: \"chat-action\", msg: `[DEBUG] error message: WGException.${data.type}.MissingDialog.${data.mode}` }, { player });\r\n                return TimedWorkState.interrupted;\r\n            }\r\n        })),\r\n        new CommonWork(() => {\r\n            if (data.do_work) {\r\n                RunControls(player, type, data.mode);\r\n                AppearanceUpdate(player);\r\n            }\r\n        }),\r\n        new CommonWork(() => { if (data.xMessage) ParseMessage(data.xMessage, { player }); }),\r\n    ];\r\n\r\n    TimedWorker.global.push({ description: `SetItemSequence${type}`, works: work_sequence });\r\n}\r\n","import { CtrlType } from \"../../WolfGirlCtrl/IController\";\r\nimport { StdMissing } from \"./CmdSequenceMessage\";\r\nimport { CmdSequenceMessage } from \"./CmdSequenceMessage\";\r\nimport { StdCmdSequence } from \"./StdCmdSequence\";\r\n\r\n\r\nexport function FuturisticPublicCtrlSequence(player: PlayerCharacter, mode: CtrlType) {\r\n    const messages: CmdSequenceMessage = {\r\n        missing: StdMissing,\r\n        modes: {\r\n            \"close\": {\r\n                notify: { mode: \"chat-action\", msg: \"Received instruction, public operation permission has been disabled\" },\r\n                action: { mode: \"action\", msg: \"The public operation panel on the collar gradually goes out. It was a pity that it can't be played with by others anymore. If {player_wg} wants something, maybe it would be better to ask her master and lovers now...\" },\r\n            },\r\n            \"open\": {\r\n                notify: { mode: \"chat-action\", msg: \"Received instructions, public operation permissions have been enabled\" },\r\n                action: { mode: \"action\", msg: \"The public operation panel on {player_wg}'s collar lights up immediately, projecting small operation panels all over her body so that anyone can play with her body at any time. Perhaps if she serves well, a kind-hearted person would allow {player_wg} to gain a brief freedom?\" },\r\n            }\r\n        }\r\n    };\r\n\r\n    StdCmdSequence(player, \"FuturisticPublicCtrl\", mode, messages);\r\n}\r\n","import { AppearanceUpdate, OutfitItemType } from \"bc-utilities\";\r\nimport { DataManager } from \"../../Data\";\r\nimport { EILNetwork } from \"../../Network\";\r\nimport { GatherAppMap } from \"../../utils/Apperance\";\r\nimport { IMessage, ParseMessage } from \"../Message\";\r\nimport { TimedWork, TimedWorkState } from \"../Worker\";\r\nimport { OutfitItemsMap } from \"./Definition\";\r\nimport { CalculateLocks, DefaultCheckItemOnTarget, DefaultCheckOutfitItem, ItemFromOutfit } from \"./Utils\";\r\nimport { FuturisticBypass } from \"../WolfGirlCtrl/Ctrls/FuturisticBypass\";\r\n\r\n\r\ninterface OutfitCheckWorkItem {\r\n    readonly target: OutfitItemType;\r\n    readonly option?: TypeRecord;\r\n    readonly property?: ItemProperties;\r\n}\r\n\r\ninterface OutfitCheckStringWorkItem {\r\n    readonly target: AssetGroupItemName;\r\n    readonly option?: TypeRecord;\r\n    readonly property?: ItemProperties;\r\n}\r\n\r\ntype OutfitCheckWorkParamItem = OutfitCheckWorkItem | OutfitCheckStringWorkItem;\r\n\r\nfunction IsWorkParamItem(item: OutfitCheckWorkParamItem | OutfitItemType): item is OutfitCheckWorkParamItem {\r\n    return (item as OutfitCheckWorkParamItem).target !== undefined;\r\n}\r\n\r\nfunction IsWorkItem(item: OutfitCheckWorkParamItem | OutfitItemType): item is OutfitCheckWorkItem {\r\n    return IsWorkParamItem(item) && typeof (item as OutfitCheckWorkParamItem).target !== \"string\";\r\n}\r\n\r\nfunction IsStringWorkItem(item: OutfitCheckWorkParamItem | OutfitItemType): item is OutfitCheckStringWorkItem {\r\n    return IsWorkParamItem(item) && typeof (item as OutfitCheckWorkParamItem).target === \"string\";\r\n}\r\n\r\nexport interface OutfitFixWorkResult {\r\n    ret: \"passed\" | \"canfix\" | \"blocked\";\r\n    blocked?: string[];\r\n    counter?: number;\r\n}\r\n\r\nexport class OutfitFixWork extends TimedWork {\r\n    private readonly _target: OutfitCheckWorkItem[];\r\n\r\n    constructor(private readonly acting: Character | number, target: (AssetGroupItemName | OutfitItemType | OutfitCheckWorkParamItem)[], private readonly message?: (result: OutfitFixWorkResult) => IMessage | undefined | void) {\r\n        super();\r\n        this._target = target.map(i => {\r\n            if (typeof i === \"string\") return { target: OutfitItemsMap.get(i) as OutfitItemType };\r\n            else if (IsWorkItem(i)) return i;\r\n            else if (IsStringWorkItem(i)) return { ...i, target: OutfitItemsMap.get(i.target) as OutfitItemType };\r\n            else return { target: i };\r\n        });\r\n    }\r\n\r\n    run(player: PlayerCharacter): TimedWorkState {\r\n        const app_map = GatherAppMap(player);\r\n        const craft = EILNetwork.Access.craft;\r\n\r\n        let result = this._target.reduce((acc, i) => {\r\n            const existed_i = app_map.get(i.target.Asset.Group);\r\n            if (!existed_i) acc.canRepair.push(i);\r\n            else if (DefaultCheckOutfitItem(existed_i, i.target)) { } // do nothing\r\n            else if (existed_i.Property && existed_i.Property.Effect?.includes(\"Lock\")) acc.blocked.push(i);\r\n            else acc.canRepair.push(i);\r\n            return acc;\r\n        }, { canRepair: [], blocked: [] } as { canRepair: OutfitCheckWorkItem[], blocked: OutfitCheckWorkItem[] });\r\n\r\n        const locked_items = result.blocked.map(i => i.target.Asset.Group).map(i => (app_map.get(i) as Item).Asset.Description).join(\", \");\r\n\r\n        const do_message = (result: OutfitFixWorkResult) =>\r\n            (((msg) => msg && ParseMessage(msg, { player }, { locked_items }))(this.message?.(result)));\r\n\r\n        if (result.blocked.length > 0) {\r\n            do_message({ ret: \"blocked\", blocked: result.blocked.map(i => i.target.Asset.Group) });\r\n            return TimedWorkState.interrupted;\r\n        }\r\n\r\n        if (result.canRepair.length === 0) {\r\n            do_message({ ret: \"passed\" });\r\n            return TimedWorkState.finished;\r\n        }\r\n\r\n        const saved_item = DataManager.outfit.color_store;\r\n\r\n        const lock = CalculateLocks(this.acting, player);\r\n\r\n        FuturisticBypass.instance.on = true;\r\n        player.Appearance = player.Appearance.concat(result.canRepair.map(i => {\r\n            const existed_i = app_map.get(i.target.Asset.Group);\r\n            const expected_i = ItemFromOutfit(this.acting, player, i.target);\r\n            if (!expected_i) return undefined;\r\n\r\n            const saved = saved_item.get(i.target.Asset.Group);\r\n\r\n            if (saved && saved.asset === expected_i.Asset.Name) expected_i.Color = saved.color;\r\n            if (i.option) ExtendedItemSetOptionByRecord(player, expected_i, i.option);\r\n            if (expected_i?.Property?.LockedBy === undefined) InventoryLock(player, expected_i, lock, player.MemberNumber);\r\n            if (!expected_i.Property) expected_i.Property = {};\r\n            if (i.property) Object.assign(expected_i.Property, i.property);\r\n\r\n            if (!existed_i) return expected_i;\r\n            else Object.assign(existed_i, expected_i);\r\n        }).filter(i => i !== undefined) as Item[]);\r\n        FuturisticBypass.instance.on = false;\r\n        AppearanceUpdate(player);\r\n        do_message({ ret: \"canfix\", counter: result.canRepair.length });\r\n        return TimedWorkState.finished;\r\n    }\r\n}","import { DataManager } from \"../../Data\";\r\nimport { EILNetwork } from \"../../Network\";\r\nimport { ChatRoomAction } from \"bc-utilities\";\r\nimport { CheckItemsWork, CheckWork, CommonWork, DelayWork } from \"../CommonWork\";\r\nimport { IMessage, ParseMessage } from \"../Message\";\r\nimport { MessageWork, WaitResponseWork } from \"../MessageWork\";\r\nimport { OutfitItems, ToolsCrate } from \"../OutfitCtrl\";\r\nimport { ClothRemoveWork, ClothRestoreWork, ItemLockWork, ItemOptionWork, ItemPropertyWork, ItemRemoveWork, ItemWearWork } from \"../OutfitCtrl\";\r\nimport { OutfitFixWorkResult, OutfitFixWork } from \"../OutfitCtrl/OutfitFixWork\";\r\nimport { IsCollarOn, IsFullyDressed } from \"../WolfGirlCtrl/Check\";\r\nimport { TimedWork, TimedWorker } from \"../Worker\";\r\nimport { StdMissingAction } from \"./ItemCmdSequence/CmdSequenceMessage\";\r\n\r\nexport function DressSequence(net: EILNetwork, player: PlayerCharacter, target: Character) {\r\n    const clothing_stash: Item[] = [];\r\n    const craft = net.craft;\r\n    const work_sequence: TimedWork[] = [\r\n        new CheckWork((player) => {\r\n            return IsFullyDressed(target) ? CheckWork.Stop : CheckWork.Continue;\r\n        }, (pl, result) => {\r\n            if (result.passed) return StdMissingAction;\r\n        }),\r\n        new MessageWork({ mode: \"chat-action\", msg: \"Target selected, wolf girl identity chip detected, remote device connection opening\" }),\r\n        new DelayWork(5000),\r\n        new MessageWork({ mode: \"chat-action\", msg: \"Remote connection activated, deploying portable wolf girl training facility maintenance pod\" }),\r\n        new MessageWork({ mode: \"action\", msg: \"{player} openes a small partition on the side of her glasses, and an auxiliary positioning beacon floats out and soon hovers behind {target}\" }, { target }),\r\n        new DelayWork(5000),\r\n        new MessageWork({ mode: \"action\", msg: \"There seems to be some small ripples in the space, and with a small cyclone, a complex maintenance cabin filled with exquisite equipment appears behind {target}, and several mechanical arms stretch out from it and pull her into the maintenance cabin.\" }, { target }),\r\n        new ItemWearWork([ToolsCrate], target),\r\n        new DelayWork(5000),\r\n        new MessageWork({ mode: \"chat-action\", msg: \"Target detected, maintenance bay secured and locked. Scanning size and collecting data\" }),\r\n        new ItemOptionWork(target, [{ target: ToolsCrate.Asset.Group, option: { \"w\": 1, \"l\": 2, \"a\": 1, \"d\": 0, \"t\": 0, \"h\": 4 } }]),\r\n        new DelayWork(5000),\r\n        new MessageWork({ mode: \"action\", msg: \"Confirmed trainer is {player}, confirmed training kit installation target is {target}\" }, { target }),\r\n        new MessageWork({ mode: \"chat-action\", msg: \"After collecting the body information, start installing the training components\" }),\r\n        new MessageWork({ mode: \"chat-action\", msg: \"Clothes are being removed. Please close your eyes and hold your breath.\" }),\r\n        new DelayWork(5000),\r\n        new MessageWork({ mode: \"action\", msg: \"A mechanical arm extends from the top of the equipment compartment, surrounding {target}'s body and spraying solvent. Soon, {target}'s clothes melt bit by bit, and the dissolved clothes flow down along the body to the bottom of the maintenance compartment and are discharged.\" }, { target }),\r\n        new ClothRemoveWork(target, clothing_stash),\r\n        new DelayWork(5000),\r\n        new MessageWork({ mode: \"chat-action\", msg: \"Confirmed that the clothes have been cleaned\" }),\r\n        new MessageWork({ mode: \"action\", msg: \"Several mechanical arms extend from the upper and lower parts of the maintenance cabin, take the limbs of {target} from the cabin's fixing system, and stretch them out forcefully.\" }, { target }),\r\n        new ItemOptionWork(target, [{ target: ToolsCrate.Asset.Group, option: { \"w\": 1, \"l\": 3, \"a\": 3, \"d\": 0, \"t\": 0, \"h\": 4 } }]),\r\n        new DelayWork(5000),\r\n        new MessageWork({ mode: \"chat-action\", msg: \"{target}, are you willing to be trained to be a wolf girl? Please answer with yes or no. If yes, does it mean that you will lose enough but still retain a little autonomy, or does it mean gaining and owning for you?\" }, { target }),\r\n        new MessageWork({ mode: \"chat-action\", msg: \"Please answer yes or no. Of course, remaining silent and refusing to answer is also an option.\" }),\r\n        new WaitResponseWork(target, {\r\n            accept: /^(?!.*no).*/g,\r\n            accept_msg: { mode: \"chat-action\", msg: \"Willingness confirmed, installation process continuing\" },\r\n            reject: /No/g,\r\n            reject_msg: { mode: \"action\", msg: \"Regardless of the answer, the maintenance cabin is still faithfully executing the program and continuing the installation process.\" }\r\n        }, 15 * 1000, (player, target) => {\r\n            ParseMessage({ mode: \"action\", msg: \"The reply waiting time has timed out, it is considered as default and the next installation process is in progress\" }, { player, target });\r\n        }),\r\n        new DelayWork(5000),\r\n        new MessageWork({ mode: \"action\", msg: \"With the help of the mechanical arm, several delicate cuffs are installed on {target}. The small mechanical locking sound is faint but clearly audible.\" }, { target }),\r\n        ...(['ItemArms', 'ItemFeet', 'ItemLegs'] as AssetGroupItemName[]).map(e => new ItemWearWork([e], target)),\r\n        new DelayWork(5000),\r\n        new MessageWork({ mode: \"chat-action\", msg: \"Restrain self-examination\" }),\r\n        new DelayWork(5000),\r\n        new MessageWork({ mode: \"action\", msg: \"The cuffs on {target} vibrate slightly, and a small lock icon lights up.\" }, { target }),\r\n        new ItemLockWork(['ItemArms', 'ItemFeet', 'ItemLegs'], target),\r\n        new MessageWork({ mode: \"chat-action\", msg: \"Confirmed to be installed in place and locked\" }),\r\n        new DelayWork(5000),\r\n        new MessageWork({ mode: \"action\", msg: \"Two more sophisticated robotic arms extend from both sides and gently pinch {target}'s nipples.\" }, { target }),\r\n        new MessageWork({ mode: \"action\", msg: \"It seems to be just a cold touch, followed by a tight feeling and pulling force that makes {target} realize that a prop has been installed on her nipple.\" }, { target }),\r\n        new ItemWearWork(['ItemNipplesPiercings', 'ItemNipples'], target),\r\n        new MessageWork({ mode: \"chat-action\", msg: \"Confirmed that the components are installed properly\" }),\r\n        new DelayWork(5000),\r\n        new MessageWork({ mode: \"action\", msg: \"The robot arm lets go of {target}'s nipple, move down little by little, and stop at {target}'s lower abdomen. The robot arm gently separates the labia and foreskin, exposing the tender clitoris\" }, { target }),\r\n        new MessageWork({ mode: \"action\", msg: \"The pleasure brought by the tightness on the clitoris is obviously more obvious, and at the same time, the pleasure brought by the sudden fullness in the vagina and the back hole is in contrast, making {target}'s body unconsciously twist slightly in the restraint of the maintenance cabin\" }, { target }),\r\n        new ItemWearWork(['ItemVulvaPiercings', 'ItemVulva', 'ItemButt'], target),\r\n        new MessageWork({ mode: \"chat-action\", msg: \"Restrain self-examination\" }),\r\n        new DelayWork(5000),\r\n        new MessageWork({ mode: \"action\", msg: \"A small vibration brings {target} some insignificant pleasure, and then a beeping sound indicates that the locking is completed sounds. What does this mean?\" }, { target }),\r\n        new ItemLockWork(['ItemVulvaPiercings', 'ItemVulva', 'ItemButt', 'ItemNipplesPiercings'], target),\r\n        new MessageWork({ mode: \"chat-action\", msg: \"Confirmed to be installed in place and locked\" }),\r\n        new MessageWork({ mode: \"action\", msg: \"Just like the automated maintenance corridor outside Tony Stark's building in New York, the robotic arms lifts up several armor-like equipments. The equipments have been preheated long ago, so hopefully they will not bring chill to {target}, maybe?\" }, { target }),\r\n        new MessageWork({ mode: \"action\", msg: \"The chest, torso, and hips are covered with warmth, accompanied by the subtle vibrations of the mechanical combination. It seems that it was just a set of extremely close-fitting and comfortable underwear that was put on the body in this way.\" }, { target }),\r\n        new ItemWearWork(['ItemBreast', 'ItemPelvis', 'ItemTorso', 'ItemTorso2'], target),\r\n        new DelayWork(5000),\r\n        new MessageWork({ mode: \"chat-action\", msg: \"Restrain self-examination\" }),\r\n        new DelayWork(5000),\r\n        new MessageWork({ mode: \"action\", msg: \"The beeping sound rings out again, and the number of lock icons displayed on {target} increase. Is it announcing loss or possession?\" }, { target }),\r\n        new ItemLockWork(['ItemBreast', 'ItemPelvis', 'ItemTorso', 'ItemTorso2'], target),\r\n        new MessageWork({ mode: \"chat-action\", msg: \"Confirmed to be installed in place and locked\" }),\r\n        new DelayWork(5000),\r\n        new MessageWork({ mode: \"action\", msg: \"A barrel-shaped structure connected to several sophisticated devices slowly decend and cover {target}'s head. The brief bright light and loud noise make {target} close her eyes.\" }, { target }),\r\n        new ItemWearWork(['ItemEars', 'ItemHead'], target),\r\n        new MessageWork({ mode: \"action\", msg: \"After the brief trance and dizziness ends, {target} does not have much time to notice the new equipment in front of her eyes and ears, because the mechanical claws gently pinch her nose, forcing her to open her mouth to breathe.\" }, { target }),\r\n        new MessageWork({ mode: \"action\", msg: \"But it is obviously a conspiracy of the maintenance cabin, because soon a ball gag is stuffed into her mouth, and the mouthpiece and accessories follow.\" }, { target }),\r\n        new ItemWearWork(['ItemMouth', 'ItemMouth2', 'ItemMouth3'], target),\r\n        new DelayWork(5000),\r\n        new ItemPropertyWork(target, [{ group: 'ItemMouth2', property: { OverridePriority: 1 } }, { group: 'ItemMouth3', property: { OverridePriority: 1 } }]),\r\n        new MessageWork({ mode: \"action\", msg: \"The muzzle's camouflage is quickly activated, completely exposing {target}'s face and the ball gag in her mouth.\" }, { target }),\r\n        new DelayWork(5000),\r\n        new MessageWork({ mode: \"chat-action\", msg: \"Restrain self-examination\" }),\r\n        new DelayWork(5000),\r\n        new ItemLockWork(['ItemEars', 'ItemHead', 'ItemMouth', 'ItemMouth2', 'ItemMouth3'], target),\r\n        new MessageWork({ mode: \"action\", msg: \"A lock icon lights up in the air in front of the ball, but unfortunately it is a holographic projection that cannot be blocked.\" }, { target }),\r\n        new ItemPropertyWork(target, [{ group: 'ItemMouth3', property: { OverridePriority: { \"Straps\": 1, \"Nose\": 1, \"Mask\": 1, \"IconLock\": 42, \"IconMute\": 1, \"IconX\": 1 } } }]),\r\n        new ItemOptionWork(target, [{ target: 'ItemMouth3', option: { \"n\": 0, \"h\": 0, \"s\": 1 } }]),\r\n        new MessageWork({ mode: \"chat-action\", msg: \"Confirmed to be installed in place and locked\" }),\r\n        new DelayWork(5000),\r\n        new MessageWork({ mode: \"action\", msg: \"The mechanical arms holding {target}'s limbs lift her body slightly. The previously installed cuffs seem to have activated some kind of working mode, causing {target}'s hands and feet to lose strength temporarily.\" }, { target }),\r\n        new ItemWearWork(['ItemHands', 'ItemBoots'], target),\r\n        new MessageWork({ mode: \"action\", msg: \"While {target}'s hands and feet are naturally stretched, several robotic arms deftly put gloves and high heels on her body, carefully adjusting the position to ensure comfort.\" }, { target }),\r\n        new DelayWork(5000),\r\n        new MessageWork({ mode: \"chat-action\", msg: \"Restrain self-examination\" }),\r\n        new DelayWork(5000),\r\n        new MessageWork({ mode: \"action\", msg: \"With a slight tightening feeling coming from the wrists and ankles, {target} seems to have successfully controlled her hands and feet. She will get used to the warm wrapping feeling and hazy touch eventually, right?\" }, { target }),\r\n        new ItemLockWork(['ItemHands', 'ItemBoots'], target),\r\n        new MessageWork({ mode: \"chat-action\", msg: \"Confirmed to be installed in place and locked\" }),\r\n        new DelayWork(5000),\r\n        new MessageWork({ mode: \"chat-action\", msg: \"The control core and brand name will be installed soon. I wish {target} to become an excellent wolf girl in advance.\" }, { target }),\r\n        new DelayWork(5000),\r\n        new MessageWork({ mode: \"action\", msg: \"The delicate collar is quickly placed around {target}'s neck, and then slowly begins to tighten until the collar is slightly embedded in the neck. Even so, the tightening of the collar does not affect the smooth breathing and blood flow at all.\" }, { target }),\r\n        new ItemWearWork(['ItemNeck'], target),\r\n        new DelayWork(5000),\r\n        new MessageWork({ mode: \"action\", msg: \"The last robotic arm approaches {target} little by little. The name tag on it indicating {target}'s name with a string of numbers. Perhaps this will be the last time she is called by this name.\" }, { target }),\r\n        new ItemWearWork(['ItemNeckAccessories'], target),\r\n        new ItemPropertyWork(target, [{ group: 'ItemNeckAccessories', property: { Text: target.MemberNumber?.toString() ?? \"\" } }]),\r\n        new MessageWork({ mode: \"chat-action\", msg: \"Control core self-checking\" }),\r\n        new DelayWork(5000),\r\n        new ItemLockWork(['ItemNeck', 'ItemNeckAccessories'], target),\r\n        new MessageWork({ mode: \"chat-action\", msg: \"Confirmed that it is installed in place and locked, and that connections are successfully established with all components\" }),\r\n        new DelayWork(5000),\r\n        new MessageWork({ mode: \"chat-action\", msg: \"Rebuilding {target_wg}'s clothing according to settings\" }, { target }),\r\n        new ClothRestoreWork(target, clothing_stash),\r\n        new DelayWork(5000),\r\n        new MessageWork({ mode: \"chat-action\", msg: \"Trainer {player}, {target_wg} has installed the training kit and the kit has been initialized. I wish you a happy game.\" }, { target }),\r\n        new ItemOptionWork(target, [{ target: ToolsCrate.Asset.Group, option: { \"w\": 1, \"l\": 0, \"a\": 0, \"d\": 0, \"t\": 0, \"h\": 0 } }]),\r\n        new ItemOptionWork(target, [\r\n            { target: 'ItemArms', option: { typed: 1 } },\r\n            { target: 'ItemFeet', option: { typed: 2 }, },\r\n            { target: 'ItemLegs', option: { typed: 2 } },\r\n            { target: 'ItemHands', option: { typed: 0 } }\r\n        ]),\r\n        new DelayWork(5000),\r\n        new MessageWork({ mode: \"action\", msg: \"The maintenance hatch opens, and the mechanical arm pushes {target_wg} out. Then it begins to gradually become distorted and transparent, and the small auxiliary positioning beacon behind {target_wg} automatically returns to the trainer {player}'s wolf trainer multi-purpose auxiliary glasses.\" }, { target }),\r\n        new ItemRemoveWork(target, [ToolsCrate]),\r\n    ];\r\n    TimedWorker.global.push({ description: \"Dress Sequence\", works: work_sequence });\r\n}\r\n\r\nexport function InitDressSequence(player: PlayerCharacter, target: Character) {\r\n    ChatRoomAction.instance.LocalInfo(\">> Connecting to Wolf Girl network...\");\r\n    EILNetwork.force_fetch().then(net => {\r\n        const work_sequence: TimedWork[] = [\r\n            new MessageWork({ mode: \"local-status\", msg: \"   ...connected to the Wolf Girl network\" }),\r\n            new MessageWork({ mode: \"local-status\", msg: \">> Permission check starts\" }),\r\n            new MessageWork({ mode: \"local-status\", msg: `   EIL Network Administrator: ${DataManager.permission.isEILNet(player) ? \"passed\" : \"Failed\"}` }),\r\n            new MessageWork({ mode: \"local-status\", msg: `   Lover permissions: ${DataManager.permission.isLover(player, target) ? \"passed\" : \"Failed\"}` }),\r\n            new MessageWork({ mode: \"local-status\", msg: `   Owner permissions: ${DataManager.permission.isOwner(player, target) ? \"passed\" : \"Failed\"}` }),\r\n            new CheckWork((player) => {\r\n                const passed = [\r\n                    DataManager.permission.isEILNet(player),\r\n                    DataManager.permission.isLover(player, target),\r\n                    DataManager.permission.isOwner(player, target)\r\n                ].some(i => i);\r\n                if (passed) return CheckWork.Accepted;\r\n                else return CheckWork.Rejected;\r\n            }, (player, result) => {\r\n                if (result.passed) return { mode: \"local-status\", msg: \"   The permission check passes and the installation process starts\" };\r\n                else return { mode: \"local-status\", msg: \"   The command has been rejected, aborting the installation process\" };\r\n            }),\r\n            new CommonWork(() => {\r\n                DressSequence(EILNetwork.Access, player, target);\r\n            })\r\n        ];\r\n        TimedWorker.global.push({ description: \"Init Dress Sequence\", works: work_sequence });\r\n    }).catch(e => {\r\n        ChatRoomAction.instance.LocalInfo(\"...Wolf Girl Network disconnected, aborting process.\");\r\n    });\r\n}\r\n\r\nexport function DressFixSequence(sender: Character | number, player: PlayerCharacter) {\r\n    const cannot_fix: IMessage = {\r\n        mode: \"chat-action\",\r\n        msg: \"Found item {locked_items} replaced by locked item, cannot be automatically repaired, stopping the repair process.\"\r\n    };\r\n\r\n    const craft = EILNetwork.Access.craft;\r\n\r\n    let cumm_counter = 0;\r\n\r\n    const create_result_process = (msg: IMessage) => (result: OutfitFixWorkResult) => {\r\n        if (result.ret === \"canfix\" && result.counter) { cumm_counter += result.counter; return msg; }\r\n        else if (result.ret === \"blocked\") return cannot_fix;\r\n    };\r\n\r\n    const work_sequence: TimedWork[] = [\r\n        new CheckWork(() => {\r\n            if (IsCollarOn(player)) return CheckWork.Accepted;\r\n            return CheckWork.Rejected;\r\n        }, (pl, result) => {\r\n            if (!result.passed) return { mode: \"chat-action\", msg: \"Warning, the central control core is lost, please go to EIL or find EIL personnel to handle it\" };\r\n        }),\r\n        new MessageWork({ mode: \"chat-action\", msg: \"Instructions received, maintenance mode enabled\" }),\r\n        new MessageWork({ mode: \"chat-action\", msg: \"Remote connection activated, deploying portable wolf girl training facility maintenance pod\" }),\r\n        new DelayWork(5000),\r\n        new MessageWork({ mode: \"chat-action\", msg: \"There seems to be some small ripples in the space, and with a small cyclone, a complex maintenance cabin filled with exquisite equipment appears behind {player_wg}, and several mechanical arms stretch out from it and pull her into the maintenance cabin.\" }),\r\n        new ItemWearWork([ToolsCrate], sender, ItemWearWork.TARGET_ACTING),\r\n        new DelayWork(5000),\r\n        new MessageWork({ mode: \"chat-action\", msg: \"Target detected, maintenance bay secured and locked. Scanning\" }),\r\n        new ItemOptionWork(player, [{ target: ToolsCrate.Asset.Group, option: { \"w\": 1, \"l\": 2, \"a\": 2, \"d\": 0, \"t\": 0, \"h\": 4 } }]),\r\n        new CheckWork(() => {\r\n            if (IsFullyDressed(player)) return CheckWork.Stop;\r\n            else return CheckWork.Continue;\r\n        }, (pl, r) => {\r\n            if (r.passed) return { mode: \"chat-action\", msg: \"Component scan completed, all online and functioning normally, energy core fully charged, maintenance mode ended, please exit maintenance mode\" };\r\n            else return { mode: \"chat-action\", msg: \"Component scan completed, found some components missing or offline, entered repair mode\" };\r\n        }),\r\n        new MessageWork({ mode: \"chat-action\", msg: \"Several mechanical arms quickly extend from the maintenance cabin and scan up and down in front of {player_wg}. A light blue beam shines on her, seeming able to see through everything.\" }),\r\n        new OutfitFixWork(sender, [\r\n            { target: \"ItemEars\" },\r\n            { target: \"ItemHead\" },\r\n            { target: \"ItemMouth\" },\r\n            { target: \"ItemMouth2\", property: { OverridePriority: 1 } },\r\n            {\r\n                target: \"ItemMouth3\",\r\n                option: { \"n\": 0, \"h\": 0, \"s\": 1 },\r\n                property: { OverridePriority: { \"Straps\": 1, \"Nose\": 1, \"Mask\": 1, \"IconLock\": 42, \"IconMute\": 1, \"IconX\": 1 } }\r\n            }\r\n        ],\r\n            create_result_process({\r\n                mode: \"chat-action\",\r\n                msg: \"Maybe {player_wg} wants to satisfy some cravings. Simple audio-visual experience can make her imagine that nothing has happened, and eating human food can give her brain an illusion? Or maybe she want to use her tongue and mouth to satisfy some obscene things because of the blockage of her body? Is fate unchangeable, or has she long forgotten when she made the choice for herself?\"\r\n            })),\r\n        new OutfitFixWork(sender, ['ItemBreast', 'ItemNipplesPiercings', 'ItemNipples'], create_result_process({\r\n            mode: \"action\",\r\n            msg: \"The plump breasts are indeed eye-catching, but is it a bit presumptuous to expose this asset that no longer belongs to you, no? The maintenance cabin uses a small electric shocker to shock {player_wg}'s nipples on both sides, and then resumes the installation of components.\"\r\n        })),\r\n        new OutfitFixWork(sender, ['ItemHands',\r\n            { target: 'ItemArms', option: { typed: 1 } }], create_result_process({\r\n                mode: \"action\",\r\n                msg: \"It seems that {player_wg} has lost her bracelet and gloves. She seems to want to do something drastic. Was she trying some lewd actions? Or maybe she just wanted to feel the touch? However, the maintenance cabin doesn't care what her purpose was. It just faithfully follows the instructions and installs a new set of equipment back on {player_wg}.\"\r\n            })),\r\n        new OutfitFixWork(sender, [{ target: 'ItemTorso' }, { target: 'ItemTorso2' }, { target: 'ItemNeckAccessories', property: { Text: player.MemberNumber?.toString() ?? \"\" } }], create_result_process({\r\n            mode: \"chat-action\",\r\n            msg: \"The external communication belt module, the drug injection module or the identity tag are abnormal. It is true that these modules are very easy to be damaged or lost. They are being repaired, but please note that there will be no discount on the repair cost.\"\r\n        })),\r\n        new OutfitFixWork(sender, ['ItemVulva', 'ItemPelvis', 'ItemButt', 'ItemVulvaPiercings'], create_result_process({\r\n            mode: \"chat-action\",\r\n            msg: \"Your body, your breath, even your thoughts and your soul all belong to your master. Naturally, the right to orgasm does not belong to you. The pleasure you are allowed to obtain is to remind you of your identity, and the joy of orgasm is a reward from the master. Eating the forbidden fruit will naturally be severely punished.\"\r\n        })),\r\n        new OutfitFixWork(sender, ['ItemBoots',\r\n            { target: 'ItemFeet', option: { typed: 2 }, },\r\n            { target: 'ItemLegs', option: { typed: 2 } }], create_result_process({\r\n                mode: \"action\",\r\n                msg: \"It looks like {player_wg}'s walking controller is missing. It's really difficult to remove it. Is she trying to escape? But since she became a wolf girl, isn't the freedom she has enough? Unfortunately, unless the master allows it, she can't escape anyway. Well, maybe I should tell the master about this. The maintenance cabin gives {player_wg} a slight electric shock, and then installs a new controller for her.\"\r\n            })),\r\n        new MessageWork({ mode: \"chat-action\", msg: \"The component has been repaired. The corresponding reward points have been deducted according to the component loss situation. Rescanning and self-checking\" }),\r\n        new CommonWork((player) => {\r\n            DataManager.points.points -= cumm_counter;\r\n            ParseMessage({ mode: \"local\", msg: `${cumm_counter} points have been deducted, current points are ${DataManager.points.points}` });\r\n        }),\r\n        new DelayWork(5000),\r\n        new CheckItemsWork(OutfitItems, (player, result) => {\r\n            DataManager.statistics.set_last_fix_time(Date.now());\r\n            DataManager.outfit.items = [];\r\n            if (result.missing.length === 0) {\r\n                ParseMessage({ mode: \"chat-action\", msg: \"Component scan completed, all online and functioning normally, energy core fully charged, maintenance mode ended, please exit maintenance mode\" }, { player });\r\n            } else {\r\n                const missing_formated = result.missing.map(g => g.Craft.Name).join(\", \");\r\n                ParseMessage({ mode: \"chat-action\", msg: \"Error: Component repair failed, there are still unworn components: {missing_formated}\" }, { player }, { missing_formated });\r\n            }\r\n        })\r\n    ];\r\n\r\n    TimedWorker.global.push({ description: \"DressFixSequence\", works: work_sequence });\r\n}\r\n\r\n","import { AppearanceUpdate } from \"bc-utilities\";\r\nimport { DataManager } from \"../Data\";\r\nimport { EILNetwork } from \"../Network\";\r\nimport { GatherAppMap } from \"../utils/Apperance\";\r\nimport { OutfitItemsMap } from \"./OutfitCtrl\";\r\nimport { DefaultCheckOutfitItem, ItemFromOutfit } from \"./OutfitCtrl/Utils\";\r\n\r\n\r\nexport function GatherDataOutfitItem(player: PlayerCharacter): DataOutfitItem[] {\r\n    let result: DataOutfitItem[] = [];\r\n\r\n    player.Appearance.forEach(item => {\r\n        const ti = OutfitItemsMap.get(item.Asset.Group.Name);\r\n        if (ti && DefaultCheckOutfitItem(item, ti)) {\r\n            result.push({\r\n                asset: {\r\n                    group: item.Asset.Group.Name as AssetGroupItemName,\r\n                    name: item.Asset.Name,\r\n                },\r\n                color: item.Color ?? \"Default\",\r\n                property: item.Property,\r\n            });\r\n        }\r\n    });\r\n\r\n    return result;\r\n}\r\n\r\nexport function GatherColorStoreItem(player: PlayerCharacter): ColorStoreItem[] {\r\n    let result: ColorStoreItem[] = [];\r\n    player.Appearance.forEach(item => {\r\n        const ti = OutfitItemsMap.get(item.Asset.Group.Name);\r\n        if (ti && DefaultCheckOutfitItem(item, ti)) {\r\n            result.push({\r\n                asset: item.Asset.Name,\r\n                group: item.Asset.Group.Name as AssetGroupItemName,\r\n                color: item.Color ?? \"Default\",\r\n            });\r\n        }\r\n    });\r\n    return result;\r\n}\r\n\r\nexport function StashOutfit(player: PlayerCharacter) {\r\n    const exclude = ['ItemNeck', 'ItemPelvis'];\r\n    let saved: DataOutfitItem[] = [];\r\n    player.Appearance = player.Appearance.map(item => {\r\n        if (exclude.includes(item.Asset.Group.Name)) return item;\r\n        const ti = OutfitItemsMap.get(item.Asset.Group.Name);\r\n        if (ti && DefaultCheckOutfitItem(item, ti)) {\r\n            saved.push({\r\n                asset: {\r\n                    group: item.Asset.Group.Name as AssetGroupItemName,\r\n                    name: item.Asset.Name,\r\n                },\r\n                color: item.Color ?? \"Default\",\r\n                property: item.Property,\r\n            });\r\n            return undefined;\r\n        }\r\n        return item;\r\n    }).filter(i => i !== undefined) as Item[];\r\n\r\n    DataManager.outfit.items = saved;\r\n    AppearanceUpdate(player);\r\n}\r\n\r\nexport enum StashPopResult {\r\n    Success,\r\n    Locked\r\n}\r\n\r\nexport function StashPopOutfit(player: PlayerCharacter): StashPopResult {\r\n    const saved = [...DataManager.outfit.items.values()];\r\n\r\n    const app_map = GatherAppMap(player);\r\n\r\n    const craft = EILNetwork.Access.craft;\r\n\r\n    if (saved.some(i => {\r\n        const item = app_map.get(i.asset.group);\r\n        if (!item) return false;\r\n        if (DefaultCheckOutfitItem(item, OutfitItemsMap.get(i.asset.group))) return false;\r\n        if (item.Property?.Effect?.includes(\"Lock\") ?? true) return true;\r\n        return false;\r\n    })) return StashPopResult.Locked;\r\n\r\n    saved.forEach(i => {\r\n        const item = app_map.get(i.asset.group);\r\n        const oi = OutfitItemsMap.get(i.asset.group);\r\n        if (!oi) return;\r\n        if (oi.Asset.Name !== i.asset.name) return;\r\n        const nitem = ItemFromOutfit(player, player, oi);\r\n        if (!nitem) return;\r\n\r\n        Object.assign(nitem, { Color: i.color, Property: i.property });\r\n\r\n        if (!item) {\r\n            player.Appearance.push(nitem);\r\n        } else {\r\n            Object.assign(item, nitem);\r\n        }\r\n    });\r\n\r\n    DataManager.outfit.items = [];\r\n    AppearanceUpdate(player);\r\n    return StashPopResult.Success;\r\n}","import { MessageWork } from \"../MessageWork\";\r\nimport { TimedWorker } from \"../Worker\";\r\nimport { StdMissingMsgN, StdMissingAction } from \"./ItemCmdSequence/CmdSequenceMessage\";\r\n\r\nexport function PushMissingStopSequence(missing_formated: string) {\r\n    TimedWorker.global.insert_after_first({\r\n        description: \"StopSequence\", works: [\r\n            new MessageWork(StdMissingMsgN, { args: { missing_formated } }),\r\n            new MessageWork(StdMissingAction)\r\n        ]\r\n    });\r\n}","import { DataManager } from \"../../Data\";\r\nimport { CheckItemsWork, CommonWork, DelayWork } from \"../CommonWork\";\r\nimport { ParseMessage } from \"../Message\";\r\nimport { MessageWork } from \"../MessageWork\";\r\nimport { GatherColorStoreItem, StashOutfit, StashPopOutfit, StashPopResult } from \"../StashOutfit\";\r\nimport { TimedWork, TimedWorkState, TimedWorker } from \"../Worker\";\r\nimport { StdMissingAction, StdMissingMsgN } from \"./ItemCmdSequence/CmdSequenceMessage\";\r\nimport { PushMissingStopSequence } from \"./StopSequence\";\r\n\r\nexport function StartStashSequence(player: PlayerCharacter) {\r\n    const work_sequence: TimedWork[] = [\r\n        new CheckItemsWork([\"ItemNeck\", \"ItemPelvis\"], (player, result) => {\r\n            if (result.missing.length > 0) {\r\n                PushMissingStopSequence(result.missing.map(g => g.Craft.Name).join(\", \"));\r\n                return TimedWorkState.interrupted;\r\n            } else {\r\n                ParseMessage({ mode: \"chat-action\", msg: `Activating the Nano-bee Swarm Storage Restraint Device to enter hidden mode` });\r\n            }\r\n        }),\r\n        new DelayWork(5000),\r\n        new MessageWork({ mode: \"action\", msg: \"{player_wg}'s restraints seem to be dissolving bit by bit, turning into a small stream of metallic silver water flowing along her skin to the main control core and training underwear. As the water flow disappears, the original restraints disappear as if they had never existed. However, the collar on her neck and the training underwear on her body obviously disagreed with this idea.\" }),\r\n        new CommonWork((player) => {\r\n            StashOutfit(player);\r\n            DataManager.outfit.lite_mode = true;\r\n            ParseMessage({ mode: \"chat-action\", msg: \"Switched to lightweight item mode.\" });\r\n        })\r\n    ];\r\n\r\n    TimedWorker.global.push({ description: \"StartStashSequence\", works: work_sequence });\r\n}\r\n\r\nexport function StartStashPopSequence(player: PlayerCharacter) {\r\n    const work_sequence: TimedWork[] = [\r\n        new CheckItemsWork([\"ItemNeck\", \"ItemPelvis\"], (player, result) => {\r\n            if (result.missing.length > 0) {\r\n                PushMissingStopSequence(result.missing.map(g => g.Craft.Name).join(\", \"));\r\n                return TimedWorkState.interrupted;\r\n            } else {\r\n                ParseMessage({ mode: \"chat-action\", msg: `Exiting restraint hiding mode, nanobee swarm at work` });\r\n            }\r\n        }),\r\n        new DelayWork(5000),\r\n        new MessageWork({ mode: \"action\", msg: \"The main control core and training underwear vibrate slightly. If someone else were to look, they would see some small streams of metallic silver flowing out of them, flowing to all parts of {player_wg}'s body, slowly forming the original restraints and reconnecting the various components.\" }),\r\n        new CommonWork((player) => {\r\n            if (StashPopOutfit(player) === StashPopResult.Locked) {\r\n                ParseMessage({ mode: \"chat-action\", msg: \"There is a locked item, unable to switch modes.\" });\r\n            } else {\r\n                DataManager.outfit.lite_mode = false;\r\n                ParseMessage({ mode: \"chat-action\", msg: \"Switched to full item mode.\" });\r\n            }\r\n        })\r\n    ];\r\n    TimedWorker.global.push({ description: \"StartStashPopSequence\", works: work_sequence });\r\n}\r\n\r\nexport function ColorSaveSequence(player: PlayerCharacter, sender: Character) {\r\n    const work_sequence: TimedWork[] = [\r\n        new MessageWork({ mode: \"chat-action\", msg: \"Received command, scanning for changes in package appearance\" }),\r\n        new MessageWork({ mode: \"action\", msg: \"Several small streams of metallic silver water flow out of {player_wg}'s collar, slowly flowing along {player_wg}'s body to the restraints on various parts of her body. After a short stay, they return to the collar along the same path.\" }),\r\n        new DelayWork(5000),\r\n        new CommonWork((player) => {\r\n            DataManager.outfit.color_store = GatherColorStoreItem(player);\r\n            const collar = player.Appearance.find(a => a.Asset.Group.Name === \"ItemNeck\");\r\n            const color = (collar?.Color ?? [\"#000000\"])[0];\r\n            ParseMessage({ mode: \"chat-action\", msg: `The color scheme has been scanned and stored in the core, the current color scheme is marked as (${color})` });\r\n        })\r\n    ];\r\n    TimedWorker.global.push({ description: \"ColorSaveSequence\", works: work_sequence });\r\n}","import { ExitFixSequence } from \"../../Control/SequenceCtrl/CtrlSequence\";\r\nimport { DressFixSequence } from \"../../Control/SequenceCtrl/DressSequence\";\r\nimport { ColorSaveSequence, StartStashPopSequence, StartStashSequence } from \"../../Control/SequenceCtrl/StashSequence\";\r\nimport { DataManager } from \"../../Data\";\r\nimport { CommandTemplate } from \"../ICmds\";\r\nimport { BasicPrerequisites, OutfitFixPrerequisites } from \"../Prerequistes\";\r\n\r\nexport const OutfitCmds: CommandTemplate[] = [\r\n    {\r\n        match: /^(存储色彩方案)|(Save color scheme)/i,\r\n        prerequisite: BasicPrerequisites,\r\n        run(player) {\r\n            ColorSaveSequence(player, player);\r\n        },\r\n    },\r\n    {\r\n        match: /^((进入|退出)维护模式)|((enter|exit) Maintainance Mode)/i,\r\n        prerequisite: OutfitFixPrerequisites,\r\n        run(player, sender, content) {\r\n            if (content[2] === \"进入\" || content[4].toLowerCase() === \"Enter\") DressFixSequence(sender, player);\r\n            if (content[2] === \"退出\" || content[4].toLowerCase() === \"Exit\") ExitFixSequence(player);\r\n        },\r\n    },\r\n    {\r\n        match: /^(切换狼女物品模式)|(Toggle-Wolf-Girl-Item-Mode)/i,\r\n        prerequisite: BasicPrerequisites,\r\n        run(player, sender) {\r\n            if (DataManager.outfit.items.size > 0) {\r\n                StartStashPopSequence(player);\r\n            } else {\r\n                StartStashSequence(player);\r\n            }\r\n        },\r\n    },\r\n];\r\n","import { CheckWork, DelayWork } from \"../CommonWork\";\r\nimport { MessageWork } from \"../MessageWork\";\r\nimport { ToolsCrate } from \"../OutfitCtrl\";\r\nimport { ItemRemoveWork } from \"../OutfitCtrl\";\r\nimport { CheckItem } from \"../OutfitCtrl\";\r\nimport { TimedWork, TimedWorker } from \"../Worker\";\r\n\r\nexport function ExitFixSequence(player: PlayerCharacter) {\r\n\r\n    const work_sequence: TimedWork[] = [\r\n        new CheckWork(() => {\r\n            if (CheckItem(player, ToolsCrate)) return CheckWork.Accepted;\r\n            return CheckWork.Rejected;\r\n        }, (pl, result) => {\r\n            if (!result.passed) return { mode: \"chat-action\", msg: \"Error: Not in maintenance mode.\" }\r\n        }),\r\n        new MessageWork({ mode: \"chat-action\", msg: \"Received instruction to exit maintenance mode\" }),\r\n        new DelayWork(5000),\r\n        new MessageWork({ mode: \"action\", msg: \"The maintenance cabin door opens, and the robotic arm pushes {player_wg} out. Then it gradually becomes distorted and transparent, and finally only a small cyclone was left.\" }),\r\n        new ItemRemoveWork(player, [ToolsCrate]),\r\n    ]\r\n\r\n    TimedWorker.global.push({ description: \"ExitFixSequence\", works: work_sequence });\r\n}\r\n\r\n","import { DataManager } from \"../../Data\";\r\nimport { ExtractMemberNumber } from \"../../utils/Character\";\r\nimport { CommandTemplate } from \"../ICmds\";\r\nimport { RouteIM } from \"../../Control/Message\";\r\nimport { BasicPrerequisites } from \"../Prerequistes\";\r\n\r\n\r\nexport const PermCmds: CommandTemplate[] = [\r\n    {\r\n        match: /((打开|关闭)恋人语音权限)|(((Open)|(Close)) Lover voice permission)/i,\r\n        prerequisite: BasicPrerequisites,\r\n        run(player, sender, content, args) {\r\n            DataManager.permission.setLoverMode(content[2] === \"打开\" || content[4].toLowerCase() == \"open\");\r\n\r\n            const data = DataManager.permission.data;\r\n            const perm_report = \"Current voice permissions:\\n\"\r\n                + \"  Lover voice permission: \" + (data.loverModerators ? \"Open\" : \"Closed\")\r\n\r\n            RouteIM(args.type, player, sender, perm_report);\r\n        }\r\n    },\r\n    {\r\n        match: /((设置(添加|移除)|((add )|(remove )))(\\d{1,10})(语音权限)|( voice permission))/i,\r\n        prerequisite: BasicPrerequisites,\r\n        run(player, sender, content, args) {\r\n            const add = (content[3] === \"添加\" || content[4].toLowerCase() === \"add\");\r\n            const id = parseInt(content[7]);\r\n            DataManager.permission.setModerator(id, add);\r\n\r\n            const perm = DataManager.permission;\r\n            const perm_report = \"Current voice permissions:\\n\"\r\n                + \"  Additional permissions list: \" + (perm.isAdditionModerator(id) ? \"+\" : \"-\") + \" \" + id;\r\n\r\n            RouteIM(args.type, player, sender, perm_report);\r\n        }\r\n    },\r\n    {\r\n        match: /(查询语音权限)|(get voice permissions)/i,\r\n        prerequisite: BasicPrerequisites,\r\n        run(player, sender, content, args) {\r\n            const num = ExtractMemberNumber(sender);\r\n            const data = DataManager.permission.data;\r\n            const perm_report = \"Current voice permissions:\\n\"\r\n                + \"  Lover voice permission: \" + (data.loverModerators ? \"Open\" : \"Closed\") + \"\\n\"\r\n                + \"  Additional permissions list:\\n\"\r\n                + data.moderators.map((i, idx, arr) => `    ${i}`).join(\"\\n\");\r\n\r\n            RouteIM(args.type, player, sender, perm_report);\r\n        }\r\n    }\r\n];","import { ModSDKModAPI } from \"bondage-club-mod-sdk\";\r\nimport { TimedWork, TimedWorkState } from \"../Worker\";\r\n\r\ninterface ChatRoomWorkSearchTask {\r\n    join: (data: any) => void;\r\n}\r\n\r\ninterface ChatRoomWorkSyncTask {\r\n    cleanup: (data: any) => void;\r\n}\r\n\r\ninterface ChatRoomWorkTask {\r\n    once_before_ChatSearchQuery?: () => void;\r\n    once_after_ChatSearchResultResponse: () => void;\r\n    once_after_ChatRoomSync?: () => void;\r\n}\r\n\r\ntype ChatRoomWorkFailState = \"notfound\" | \"full\" | \"banned\" | \"rejected\" | \"not_target\";\r\n\r\nexport class ChatRoomWork extends TimedWork {\r\n    _state: TimedWorkState = TimedWorkState.running;\r\n    _first_run: boolean = true;\r\n\r\n    constructor(readonly room: { name: string, space: ServerChatRoomSpace } | undefined, readonly onfailed?: (player: PlayerCharacter, reason: ChatRoomWorkFailState) => void, readonly onfinished?: (player: PlayerCharacter, dest: string | undefined) => void) {\r\n        super();\r\n    }\r\n\r\n    run(player: PlayerCharacter): TimedWorkState {\r\n        if (!this._first_run) {\r\n            return this._state;\r\n        }\r\n        this._first_run = false;\r\n        if (this.room === undefined) {\r\n            ChatRoomPlayerCanJoin = true;\r\n            const work: ChatRoomWorkTask = {\r\n                once_after_ChatSearchResultResponse: () => {\r\n                    this.onfinished?.(player, undefined);\r\n                    this._state = TimedWorkState.finished;\r\n                }\r\n            }\r\n            ChatRoomWork.chatRoomWorkSearchResultTasks.push(work);\r\n            CommonSetScreen(\"Online\", \"ChatSearch\");\r\n        } else {\r\n            const cj = this.room;\r\n            ChatRoomPlayerCanJoin = false;\r\n            const work: ChatRoomWorkTask = {\r\n                once_before_ChatSearchQuery: () => {\r\n                    ChatRoomSpace = cj.space;\r\n                    ElementValue(\"InputSearch\", cj.name);\r\n                },\r\n                once_after_ChatSearchResultResponse: () => {\r\n                    const target = ChatSearchResult.find(e => e.Name === cj.name);\r\n                    this._state = TimedWorkState.interrupted;\r\n                    if (!target) this.onfailed?.(player, \"notfound\");\r\n                    else if (target.MemberCount >= target.MemberLimit) this.onfailed?.(player, \"full\");\r\n                    else {\r\n                        ServerSend(\"ChatRoomJoin\", { Name: cj.name });\r\n                        this._state = TimedWorkState.running;\r\n                    }\r\n                },\r\n                once_after_ChatRoomSync: () => {\r\n                    if (ChatRoomData && ChatRoomData.Name === cj.name) {\r\n                        this.onfinished?.(player, cj.name);\r\n                        this._state = TimedWorkState.finished;\r\n                    } else {\r\n                        this.onfailed?.(player, \"not_target\");\r\n                        this._state = TimedWorkState.interrupted;\r\n                    }\r\n                }\r\n            }\r\n\r\n            ChatRoomWork.chatRoomWorkSearchQueryTasks.push(work);\r\n            ChatRoomWork.chatRoomWorkSearchResultTasks.push(work);\r\n            ChatRoomWork.chatRoomWorkRoomSyncTasks.push(work);\r\n        }\r\n        ChatRoomLeave();\r\n        CommonSetScreen(\"Online\", \"ChatSearch\");\r\n        return this._state;\r\n    }\r\n\r\n    static readonly chatRoomWorkSearchQueryTasks: ChatRoomWorkTask[] = [];\r\n    static readonly chatRoomWorkSearchResultTasks: ChatRoomWorkTask[] = [];\r\n    static readonly chatRoomWorkRoomSyncTasks: ChatRoomWorkTask[] = [];\r\n\r\n    static init(mod: ModSDKModAPI, lateHook: (callback: () => void) => void) {\r\n        mod.hookFunction(\"ChatSearchQuery\", 1, (args, next) => {\r\n            while (this.chatRoomWorkSearchQueryTasks.length > 0) {\r\n                this.chatRoomWorkSearchQueryTasks.shift()?.once_before_ChatSearchQuery?.();\r\n            }\r\n            next(args);\r\n        });\r\n\r\n        mod.hookFunction(\"ChatSearchResultResponse\", 1, (args, next) => {\r\n            next(args);\r\n            ChatRoomPlayerCanJoin = true;\r\n            while (this.chatRoomWorkSearchResultTasks.length > 0) {\r\n                this.chatRoomWorkSearchResultTasks.shift()?.once_after_ChatSearchResultResponse();\r\n            }\r\n        });\r\n\r\n        mod.hookFunction(\"ChatRoomSync\", 1, (args, next) => {\r\n            next(args);\r\n            while (this.chatRoomWorkRoomSyncTasks.length > 0) {\r\n                this.chatRoomWorkRoomSyncTasks.shift()?.once_after_ChatRoomSync?.();\r\n            }\r\n        });\r\n    }\r\n}","import { RoomComeHereSequence, RoomForceLeaveSequence, RoomLeaveSequence } from \"../../Control/RoomCtrl/RoomCtrl\";\r\nimport { CommandTemplate } from \"../ICmds\";\r\nimport { BasicPrerequisites } from \"../Prerequistes\";\r\n\r\n\r\nexport const RoomCmds: CommandTemplate[] = [\r\n    {\r\n        match: /^((离开这个房间)|(Leave this room))/i,\r\n        prerequisite: BasicPrerequisites,\r\n        run(player, sender, content, args) {\r\n            RoomLeaveSequence(player, { sender: sender, type: args.type });\r\n        }\r\n    },\r\n    {\r\n        match: /^((强行离开这个房间)|(Force-leave this room))/i,\r\n        prerequisite: BasicPrerequisites,\r\n        run(player, sender, content, args) {\r\n            RoomForceLeaveSequence(player, { sender: sender, type: args.type });\r\n        }\r\n    },\r\n    {\r\n        type: \"Beep\",\r\n        match: /^((到我这里来)|(Come to me))/i,\r\n        prerequisite: BasicPrerequisites,\r\n        run(player, sender, content, args) {\r\n            RoomComeHereSequence(player, {\r\n                sender: sender,\r\n                type: args.type,\r\n                room: args.BeepRoom as { name: string, space: ServerChatRoomSpace } | undefined\r\n            });\r\n        }\r\n    }\r\n];","import { CommandType } from \"../../ChatRoom/ICmds\";\r\nimport { EILNetwork } from \"../../Network\";\r\nimport { ExtractMemberNumber } from \"../../utils/Character\";\r\nimport { CheckItemsWork, CheckWork, CommonWork, DelayWork } from \"../CommonWork\";\r\nimport { ParseMessage, RouteIM } from \"../Message\";\r\nimport { MessageWork, } from \"../MessageWork\";\r\nimport { OutfitItemsMap } from \"../OutfitCtrl/Definition\";\r\nimport { DefaultCheckOutfitItem } from \"../OutfitCtrl/Utils\";\r\nimport { StdMissingAction, StdMissingMsgN } from \"../SequenceCtrl/ItemCmdSequence/CmdSequenceMessage\";\r\nimport { TimedWork, TimedWorkState, TimedWorker } from \"../Worker\";\r\nimport { ChatRoomWork } from \"./Work\";\r\n\r\nexport function RoomLeaveSequence(player: PlayerCharacter, cmd_src: { sender: number | Character, type: CommandType }) {\r\n    const work_sequence: TimedWork[] = [\r\n        new MessageWork({ mode: \"action\", msg: \"Received the command to leave the room and started the kinematic check\" }),\r\n        new CheckItemsWork([\"ItemLegs\", \"ItemFeet\", \"ItemBoots\"], (pl, result) => {\r\n            const missing_formated = result.missing.map(g => g.Craft.Name).join(\", \");\r\n            if (result.missing.length === 3) {\r\n                RouteIM(cmd_src.type, player, cmd_src.sender, StdMissingMsgN.msg, { missing_formated });\r\n                ParseMessage(StdMissingAction, { player });\r\n                return TimedWorkState.interrupted;\r\n            }\r\n            RouteIM(cmd_src.type, player, cmd_src.sender, `Received the command, planning the path and executing it`);\r\n        }),\r\n        new CheckWork((pl) => {\r\n            if (pl.Appearance.some(e => {\r\n                if (OutfitItemsMap.has(e.Asset.Group.Name)) return false;\r\n                if (e.Property && e.Property.Effect)\r\n                    return e.Property.Effect.some(f => [\"Tethered\", \"Mounted\", \"Leash\", \"Freeze\"].includes(f));\r\n            })) return CheckWork.Rejected;\r\n            return CheckWork.Accepted;\r\n        }, (pl, result) => {\r\n            if (result.passed) {\r\n                ParseMessage({ mode: \"action\", msg: \"The walking posture controller on {player_wg} lights up, controlling {player_wg} to slowly walk out of the room.\" }, { player });\r\n            } else {\r\n                RouteIM(cmd_src.type, player, cmd_src.sender, `Action path planning failed, please remove obstacles or use forced exit command`);\r\n                ParseMessage(StdMissingAction, { player });\r\n            }\r\n        }),\r\n        new DelayWork(5000),\r\n        new ChatRoomWork(undefined),\r\n    ];\r\n    TimedWorker.global.push({ description: \"Room Leave Sequence\", works: work_sequence });\r\n}\r\n\r\nexport function RoomForceLeaveSequence(player: PlayerCharacter, cmd_src: { sender: number | Character, type: CommandType }) {\r\n    const CurryRouteIM = (msg: string, args?: { [key: string]: any }) => RouteIM(cmd_src.type, player, cmd_src.sender, msg, args);\r\n\r\n    const work_sequence: TimedWork[] = [\r\n        new CheckItemsWork([\"ItemVulvaPiercings\", \"ItemNipplesPiercings\"], (pl, result) => {\r\n            if (result.missing.length === 2) {\r\n                const missing_formated = result.missing.map(g => g.Craft.Name).join(\", \");\r\n                CurryRouteIM(StdMissingMsgN.msg, { missing_formated });\r\n                ParseMessage(StdMissingAction, { player });\r\n                return TimedWorkState.interrupted;\r\n            }\r\n            CurryRouteIM(`Forced departure procedure activated, beacon deployed, ready to be transmitted to EIL facility`);\r\n        }),\r\n        new DelayWork(5000),\r\n        new MessageWork({ mode: \"action\", msg: \"The space behind {player_wg} ripples slightly, and after a nearly instant of blinding white light, her figure completely disappears, leaving only a small cyclone behind.\" }),\r\n        new ChatRoomWork(EILNetwork.Access.room, (pl, reason) => {\r\n            CurryRouteIM(\"No access to EIL facilities, rooms are full or locked\");\r\n        }, (pl, dest) => {\r\n            ParseMessage({ mode: \"action\", msg: \"{player_wg}A blinding white light suddenly appears in the teleporter, slightly disturbing the comfortable temperature in the facility.\" }, { player });\r\n        }),\r\n        new MessageWork({ mode: \"chat-action\", msg: \"Welcome to the EIL facility. Please do your own maintenance. Please find a cat maid for storage services. Please find a trainer for new wolf girls. Have fun.\" }),\r\n    ];\r\n    TimedWorker.global.push({ description: \"Room Force Leave Sequence\", works: work_sequence });\r\n}\r\n\r\nexport function RoomComeHereSequence(player: PlayerCharacter, cmd_src: { sender: number | Character, type: CommandType, room: { name: string, space: ServerChatRoomSpace } | undefined }) {\r\n\r\n    let data: { work?: \"leave-join\" | \"leave-only\" } = {}\r\n\r\n    const CurryRouteIM = (msg: string, args?: { [key: string]: any }) => RouteIM(cmd_src.type, player, cmd_src.sender, msg, args);\r\n\r\n    const work_sequence: TimedWork[] = [\r\n        new CheckItemsWork([\"ItemLegs\", \"ItemFeet\", \"ItemBoots\"], (pl, result) => {\r\n            if (result.missing.length === 3) {\r\n                const missing_formated = result.missing.map(g => g.Craft.Name).join(\", \");\r\n                CurryRouteIM(StdMissingMsgN.msg, { missing_formated });\r\n                ParseMessage(StdMissingAction, { player });\r\n                return TimedWorkState.interrupted;\r\n            }\r\n            CurryRouteIM(`Received the command, planning the path and executing it`);\r\n            ParseMessage({ mode: \"chat-action\", msg: \"Received the command, planning the path and executing it\" }, { player })\r\n        }),\r\n        new CheckWork((pl) => {\r\n            if (pl.Appearance.some(e => {\r\n                const oi = OutfitItemsMap.get(e.Asset.Group.Name);\r\n                if (oi && DefaultCheckOutfitItem(e, oi)) return false;\r\n                if (Array.isArray(e.Property?.Effect))\r\n                    return e.Property.Effect.some(f => [\"Tethered\", \"Mounted\", \"Freeze\"].includes(f));\r\n                return false;\r\n            })) return CheckWork.Rejected;\r\n            return CheckWork.Accepted;\r\n        }, (pl, result) => {\r\n            if (!result.passed) {\r\n                CurryRouteIM(`Action path planning failed, there are obstacles`);\r\n                ParseMessage(StdMissingAction, { player });\r\n            }\r\n        }),\r\n        new CheckItemsWork([\"ItemNeckAccessories\"], (pl, result) => {\r\n            if (result.missing.length === 1 || cmd_src.room === undefined) {\r\n                data.work = \"leave-only\";\r\n            } else {\r\n                data.work = \"leave-join\";\r\n                CurryRouteIM(`Heading to`);\r\n            }\r\n        }),\r\n        new MessageWork({ mode: \"action\", msg: \"{player_wg}'s walking posture controller lights up, controlling {player_wg} to slowly walk out of the door.\" }),\r\n        new ChatRoomWork(cmd_src.room, (pl, reason) => {\r\n            CurryRouteIM(`Left the previous room, but cannot enter the room where {sender_num} is located, the room is full or locked`, { sender_num: cmd_src.sender });\r\n        }, (pl, dest) => {\r\n            if (dest === undefined) {\r\n                CurryRouteIM(`The command does not contain room information, so the room entry operation cannot be performed.。`, { sender_num: cmd_src.sender });\r\n            } else {\r\n                if (data.work === \"leave-only\") {\r\n                    CurryRouteIM(`The identity beacon is lost, the pass is abnormal, and the previous room has been left, but the room where {sender_num} is located cannot be entered`, { sender_num: cmd_src.sender });\r\n                }\r\n            }\r\n        }),\r\n        new CommonWork((pl) => {\r\n            const sender_num = ExtractMemberNumber(cmd_src.sender);\r\n            const target: any = ChatRoomCharacter.find(c => c.MemberNumber === sender_num);\r\n            const target_name = (() => {\r\n                if (target) return CharacterNickname(target);\r\n                else {\r\n                    const friend = pl.FriendNames?.get(sender_num);\r\n                    if (friend === undefined) return sender_num.toString();\r\n                    return friend;\r\n                }\r\n            })();\r\n            ParseMessage({ mode: \"action\", msg: \"{player_wg}'s walking posture controller controlls {player_wg} to enter the room, walk to {target_name}, and obediently rub {target_name} with her body.\" }, { player }, { target_name });\r\n        }),\r\n    ];\r\n    TimedWorker.global.push({ description: \"Room Come Here Sequence\", works: work_sequence });\r\n}","import { DataManager } from \"../../Data\";\r\nimport { AppearanceUpdate } from \"bc-utilities\";\r\nimport { CommonWork } from \"../CommonWork\";\r\nimport { MessageWork } from \"../MessageWork\";\r\nimport { ItemOptionWork } from \"../OutfitCtrl\";\r\nimport { FuturisticBypass } from \"../WolfGirlCtrl/Ctrls/FuturisticBypass\";\r\nimport { TimedWorker } from \"../Worker\";\r\nimport { PunishWork } from \"../PunishWork\";\r\n\r\n\r\n\r\nexport function StartPunish(player: PlayerCharacter) {\r\n    const time = DataManager.points.punish_time;\r\n\r\n    const lock_down = [\r\n        { target: \"ItemEars\", option: { typed: 3 } },\r\n        { target: 'ItemEyes', option: { typed: 3 } },\r\n        { target: 'ItemArms', option: { typed: 3 } },\r\n        { target: 'ItemHands', option: { typed: 0 } },\r\n        { target: 'ItemFeet', option: { typed: 1 } },\r\n        { target: 'ItemLegs', option: { typed: 1 } }\r\n    ];\r\n\r\n    const stash = new Map<string, TypeRecord | null>(lock_down.map(\r\n        i => [i.target, null]\r\n    ));\r\n\r\n    const works = [\r\n        new MessageWork({ mode: \"chat-action\", msg: \"Received the instruction, the penalty mode has been turned on\" }),\r\n        new MessageWork({ mode: \"action\", msg: \"It seemed that {player_wg} has done something wrong, which led to her current situation. All the restraints on her body are tightly binding her flesh, and the electric shocks make her struggle and twist like a fish, shaking her body and making her struggle to maintain her sanity and balance.\" }),\r\n        new CommonWork((player) => {\r\n            player.Appearance.forEach(item => {\r\n                if (stash.has(item.Asset.Group.Name) && item.Property?.TypeRecord)\r\n                    stash.set(item.Asset.Group.Name, { ...item.Property.TypeRecord });\r\n            });\r\n            FuturisticBypass.instance.on = true;\r\n            lock_down.forEach(i => ItemOptionWork.ItemOptionSingleS(player, i));\r\n            FuturisticBypass.instance.on = false;\r\n            PunishWork.punish_flag = true;\r\n        }),\r\n        new ItemOptionWork(player, lock_down),\r\n        new MessageWork({ mode: \"local-status\", msg: `>> Penalty mode is activated, estimated duration ${(time / 60 / 1000).toFixed(2)} minutes` }),\r\n        new PunishWork(time),\r\n        new MessageWork({ mode: \"local-status\", msg: `>> Punishment mode has ended` }),\r\n        new CommonWork((player) => {\r\n            PunishWork.punish_flag = false;\r\n            FuturisticBypass.instance.on = true;\r\n            player.Appearance.forEach(item => {\r\n                const record = stash.get(item.Asset.Group.Name);\r\n                if (record) ExtendedItemSetOptionByRecord(player, item, record);\r\n            });\r\n            FuturisticBypass.instance.on = false;\r\n            AppearanceUpdate(player);\r\n        }),\r\n        new MessageWork({ mode: \"chat-action\", msg: \"{player_wg}'s restraints return to their previous mode, and the stun gun returns to standby mode, leaving only {player_wg}'s stiff muscles and the lingering pain from the electric shocks to tell her what had just happened. Although this was not the most severe form of punishment, I hope she has realized her mistake.\" })\r\n    ];\r\n\r\n    TimedWorker.global.push({ description: \"punish work\", works: works });\r\n}\r\n","import { ActivityInfo } from \"bc-utilities\";\r\nimport { CommandType } from \"../../ChatRoom/ICmds\";\r\n\r\nexport enum TaskState {\r\n    Running,\r\n    Success,\r\n    Failed\r\n}\r\n\r\nexport abstract class ITask {\r\n    abstract run(player: PlayerCharacter): TaskState;\r\n    abstract finalize(player: PlayerCharacter, s: TaskState): void;\r\n    onChat(player: PlayerCharacter, sender: Character, msg: string, type: CommandType): void { };\r\n    onActivity(player: PlayerCharacter, sender: Character, activity: ActivityInfo): void { };\r\n    onOrgasm(player: PlayerCharacter): void { };\r\n    onResist(player: PlayerCharacter): void { };\r\n    abstract summary(): string;\r\n}\r\n\r\n","import { IncreaseAndMessage } from \"./Points\";\r\nimport { StartPunish } from \"../SequenceCtrl/StartPunishSequence\";\r\nimport { DataManager } from \"../../Data\";\r\nimport { ITask } from \"./ITask\";\r\nimport { TaskState } from \"./ITask\";\r\n\r\n\r\nexport abstract class TimedCounterTask extends ITask {\r\n    readonly time_out: number;\r\n    cur: number;\r\n\r\n    constructor(readonly time_limit_rate: number, readonly expected: number, readonly bonus: number) {\r\n        super();\r\n        this.time_out = DataManager.points.task_time * time_limit_rate + Date.now();\r\n        this.cur = 0;\r\n    }\r\n\r\n    run(player: PlayerCharacter): TaskState {\r\n        if (Date.now() > this.time_out) return TaskState.Failed;\r\n        if (this.cur >= this.expected) return TaskState.Success;\r\n        return TaskState.Running;\r\n    }\r\n\r\n    finalize(player: PlayerCharacter, s: TaskState): void {\r\n        if (s === TaskState.Success) IncreaseAndMessage(player, this.bonus);\r\n        else StartPunish(player);\r\n        DataManager.statistics.task_finished(s === TaskState.Success);\r\n    }\r\n}\r\n","import { DataManager } from \"../../Data\";\r\nimport { ParseMessage } from \"../Message\";\r\n\r\nexport function IncreaseAndMessage(player: PlayerCharacter, points: number) {\r\n    DataManager.points.points += points;\r\n    ParseMessage({ mode: \"chat-action\", msg: `{player_wg}'s bonus points increased by ${points} points.` }, { player })\r\n}\r\n","import { DataManager } from \"../../Data\";\r\nimport { TimedCounterTask } from \"./TimedCounterTask\";\r\nimport { ActivityInfo } from \"bc-utilities\";\r\n\r\nexport class BegOrgasmTask extends TimedCounterTask {\r\n    summary(): string {\r\n        return `Before ${new Date(this.time_out).toLocaleTimeString()} (${this.time_limit_rate}x task base time), beg ${this.expected} people for an orgasm, and if successful, receive ${this.bonus} points as a reward`\r\n    }\r\n    constructor(readonly time_limit: number, readonly counter: number, readonly bonus: number) {\r\n        super(time_limit, counter, bonus);\r\n    }\r\n\r\n    last_interact_num: number = 0;\r\n    interact_list: Set<number> = new Set();\r\n    onActivity(player: PlayerCharacter, sender: Character, activity: ActivityInfo): void {\r\n        if (activity.SourceCharacter === player.MemberNumber) return;\r\n        if (activity.TargetCharacter !== player.MemberNumber) return;\r\n        this.last_interact_num = sender.MemberNumber ?? -1;\r\n    }\r\n\r\n    onOrgasm(player: PlayerCharacter): void {\r\n        this.interact_list.add(this.last_interact_num);\r\n        this.cur = this.interact_list.size;\r\n        DataManager.statistics.add_counter('Orgasmed', 1);\r\n    }\r\n}","import { DataManager } from \"../../Data\";\r\nimport { TimedCounterTask } from \"./TimedCounterTask\";\r\nimport { ActivityInfo } from \"bc-utilities\";\r\n\r\nexport class InteractTask extends TimedCounterTask {\r\n    summary(): string {\r\n        const time_report = `Before ${new Date(this.time_out).toLocaleTimeString()} (${this.time_limit_rate}xtask base time)`;\r\n        const group_report = this._check_groups ? `at ${[...this._check_groups.values()].map(i => AssetGroupGet('Female3DCG', i)?.Description).filter(i => i !== undefined).join(\", \")} ` : '';\r\n        const act_report = this._check_act ? `of ${[...this._check_act.values()].map(i => ActivityDictionaryText(`Activity${i}`)).join(\", \")} Interaction` : 'Interaction';\r\n\r\n        return `${time_report}, accept ${this.expected} individual ${group_report}${act_report}, and get ${this.bonus} points reward after success`\r\n    }\r\n    private _interact_list: Set<number> = new Set();\r\n    private _check_act: Set<ActivityName> | undefined;\r\n    private _check_groups: Set<AssetGroupItemName> | undefined;\r\n\r\n    constructor(readonly time_limit_rate: number, readonly counter: number, readonly bonus: number, check_act: ActivityName[] | undefined, check_groups: AssetGroupItemName[] | undefined) {\r\n        super(time_limit_rate, counter, bonus);\r\n        this._check_act = check_act ? new Set(check_act) : undefined;\r\n        this._check_groups = check_groups ? new Set(check_groups) : undefined;\r\n    }\r\n\r\n    onActivity(player: PlayerCharacter, sender: Character, activity: ActivityInfo): void {\r\n        if (activity.SourceCharacter === player.MemberNumber) return;\r\n        if (activity.TargetCharacter !== player.MemberNumber) return;\r\n        if (this._check_act && !this._check_act.has(activity.ActivityName as ActivityName)) return;\r\n        if (this._check_groups && !this._check_groups.has(activity.ActivityGroup as AssetGroupItemName)) return;\r\n        this._interact_list.add(activity.SourceCharacter);\r\n        this.cur = this._interact_list.size;\r\n        if (this._check_groups?.has('ItemBreast'))\r\n            DataManager.statistics.add_counter('BreastPlayed', 1);\r\n        else if (this._check_groups?.has('ItemVulva'))\r\n            DataManager.statistics.add_counter('VulvaPlayed', 1);\r\n        else if (this._check_act?.has('Slap'))\r\n            DataManager.statistics.add_counter('Spanked', 1);\r\n    }\r\n}","import { DataManager } from \"../../Data\";\r\nimport { TimedCounterTask } from \"./TimedCounterTask\";\r\n\r\nexport class ResistTask extends TimedCounterTask {\r\n    summary(): string {\r\n        return `Before ${new Date(this.time_out).toLocaleTimeString()} (${this.time_limit_rate}x task base time), endure ${this.expected} climaxes, and get ${this.bonus} points of reward if successful`\r\n    }\r\n    constructor(readonly time_limit_rate: number, readonly counter: number, readonly bonus: number) {\r\n        super(time_limit_rate, counter, bonus);\r\n    }\r\n    onResist(player: PlayerCharacter): void {\r\n        this.cur++;\r\n        DataManager.statistics.add_counter('Resisted', 1);\r\n    }\r\n}","import { ActivityInfo, OrgasmMonitor } from \"bc-utilities\";\r\nimport { CommandType } from \"../../ChatRoom/ICmds\";\r\nimport { TaskState } from \"./ITask\";\r\nimport { ITask } from \"./ITask\";\r\nimport { IsPlayerWolfGirl } from \"../WolfGirlCtrl\";\r\n\r\nexport class TaskCtrl {\r\n    private _active_task: ITask | undefined;\r\n\r\n    constructor(time_reso: number, om: OrgasmMonitor) {\r\n        setInterval(() => {\r\n            if (Player && Player.MemberNumber && IsPlayerWolfGirl(Player)) {\r\n                if (this._active_task) {\r\n                    const s = this._active_task.run(Player);\r\n                    if (s !== TaskState.Running) {\r\n                        this._active_task.finalize(Player, s);\r\n                        this._active_task = undefined;\r\n                    }\r\n                }\r\n            } else {\r\n                this._active_task = undefined;\r\n            }\r\n        }, time_reso);\r\n\r\n        om.onOrgasm(p => this.onOrgasm(p));\r\n        om.onResist(p => this.onResist(p));\r\n    }\r\n\r\n    push_task(t: ITask, reject?: (cur: ITask) => void) {\r\n        if (this._active_task) {\r\n            if (reject) reject(this._active_task);\r\n        }\r\n        else this._active_task = t;\r\n    }\r\n\r\n    has_task(): boolean {\r\n        return this._active_task !== undefined;\r\n    }\r\n\r\n    onChat(player: PlayerCharacter, sender: Character, msg: string, type: CommandType) {\r\n        this._active_task?.onChat(player, sender, msg, type);\r\n    }\r\n\r\n    onActivity(player: PlayerCharacter, sender: Character, activity: ActivityInfo) {\r\n        this._active_task?.onActivity(player, sender, activity);\r\n    }\r\n\r\n    onOrgasm(player: PlayerCharacter) {\r\n        this._active_task?.onOrgasm(player);\r\n    }\r\n\r\n    onResist(player: PlayerCharacter) {\r\n        this._active_task?.onResist(player);\r\n    }\r\n\r\n    private static _instance: TaskCtrl | undefined = undefined;\r\n\r\n    static get instance(): TaskCtrl {\r\n        return TaskCtrl._instance as TaskCtrl;\r\n    }\r\n\r\n    static init(time_reso: number, om: OrgasmMonitor) {\r\n        if (this._instance) return;\r\n        this._instance = new TaskCtrl(time_reso, om);\r\n    }\r\n}\r\n","import { ParseMessage } from \"../../Control/Message\";\r\nimport { ItemOptionWork } from \"../../Control/OutfitCtrl\";\r\nimport { StopPunish } from \"../../Control/PunishWork\";\r\nimport { StartPunish } from \"../../Control/SequenceCtrl/StartPunishSequence\";\r\nimport { ArousalCtrlSequence, FeetCtrlSequence, HandsCtrlSequence, HearingCtrlSequence, VisionCtrlSequence, VoiceCtrlSequence } from \"../../Control/SequenceCtrl/ItemCmdSequence\";\r\nimport { ITask } from \"../../Control/TaskCtrl/ITask\";\r\nimport { BegOrgasmTask } from \"../../Control/TaskCtrl/BegOrgasmTask\";\r\nimport { InteractTask } from \"../../Control/TaskCtrl/InteractTask\";\r\nimport { ResistTask } from \"../../Control/TaskCtrl/ResistTask\";\r\nimport { TaskCtrl } from \"../../Control/TaskCtrl/TaskCtrl\";\r\nimport { GetWolfGirlName, RunControls } from \"../../Control/WolfGirlCtrl\";\r\nimport { DataManager } from \"../../Data\";\r\nimport { CommandTemplate } from \"../ICmds\";\r\nimport { RouteIM } from \"../../Control/Message\";\r\nimport { BasicPrerequisites, SelfPrerequisites } from \"../Prerequistes\";\r\nimport { TimedWorker } from \"../../Control/Worker\";\r\nimport { MessageWork } from \"../../Control/MessageWork\";\r\nimport { CommonWork } from \"../../Control/CommonWork\";\r\n\r\nconst PushTask = (player: PlayerCharacter, t: ITask) => {\r\n    ParseMessage({ mode: \"action\", msg: `${GetWolfGirlName(player)} received Tasks：\\n${t.summary()}` });\r\n    TaskCtrl.instance.push_task(t, () => {\r\n        ParseMessage({ mode: \"action\", msg: `Failed to accept task: There is a task running.` });\r\n    });\r\n}\r\n\r\nexport const TaskPointsCmds: CommandTemplate[] = [\r\n    {\r\n        match: /^((忍耐)|(endure ))([1-9]\\d{0,2})((次高潮)|( orgasms))/i,\r\n        prerequisite: BasicPrerequisites,\r\n        run(player, sender, content) {\r\n            RunControls(player, \"ToysCtrl\", \"max\");\r\n            RunControls(player, \"ArousalCtrl\", \"off\");\r\n            PushTask(player, new ResistTask(1, parseInt(content[4]), 2))\r\n        }\r\n    },\r\n    {\r\n        match: /^((向)|(Beg for an orgasm from ))([1-9]\\d{0,2})((人乞求高潮)|( people))/i,\r\n        prerequisite: BasicPrerequisites,\r\n        run(player, sender, content) {\r\n            ItemOptionWork.ItemOptionSingleS(player, { target: \"ItemPelvis\", option: { c: 0 } });\r\n            RunControls(player, \"ArousalCtrl\", \"off\");\r\n            PushTask(player, new BegOrgasmTask(2, parseInt(content[4]), 2));\r\n        }\r\n    },\r\n    {\r\n        match: /^(让|(let ))([1-9]\\d{0,2})(( people play with your breasts)|(人玩弄你的胸部))/i,\r\n        prerequisite: BasicPrerequisites,\r\n        run(player, sender, content) {\r\n            PushTask(player, new InteractTask(1, parseInt(content[3]), 2, undefined, ['ItemBreast', 'ItemNipplesPiercings', 'ItemNipples']));\r\n        }\r\n    },\r\n    {\r\n        match: /^(让|(let ))([1-9]\\d{0,2})(( people play with your pussy)|(人玩弄你的阴部))/i,\r\n        prerequisite: BasicPrerequisites,\r\n        run(player, sender, content) {\r\n            ItemOptionWork.ItemOptionSingleS(player, { target: \"ItemPelvis\", option: { c: 0 } });\r\n            RunControls(player, \"ArousalCtrl\", \"off\");\r\n            PushTask(player, new InteractTask(1, parseInt(content[3]), 2, undefined, ['ItemVulva', 'ItemPelvis', 'ItemVulvaPiercings']));\r\n        }\r\n    },\r\n    {\r\n        match: /^(向|(Beg for whipping from ))([1-9]\\d{0,2})((人乞求鞭打)|( people))/i,\r\n        prerequisite: BasicPrerequisites,\r\n        run(player, sender, content) {\r\n            PushTask(player, new InteractTask(1, parseInt(content[3]), 2, [\"Slap\", \"Spank\", \"Kick\", \"SpankItem\"], undefined));\r\n        }\r\n    },\r\n    {\r\n        match: /^((设置惩罚时间为)|(Set the penalty time to ))([1-9]\\d{0,2})((分钟)|( minutes))/i,\r\n        prerequisite: BasicPrerequisites,\r\n        run(player, sender, content, args) {\r\n            const v = parseInt(content[4]);\r\n            DataManager.points.punish_time = v * 60 * 1000;\r\n            ParseMessage({ mode: \"chat-action\", msg: `Received the instruction, the penalty time of {player_wg} is ${DataManager.points.punish_time / 60 / 1000} minutes` }, { player })\r\n            ParseMessage({ mode: \"local\", msg: `The cold voice of the mechanical broadcast repeated the consequences of {player_wg}'s mission failure. It seemed to be completely emotionless, but a hint of amusement could be heard.` }, { player })\r\n        }\r\n    },\r\n    {\r\n        match: /^((设置任务时间为)|(Set the task time to ))([1-9]\\d{0,2})((分钟)|( minutes))/i,\r\n        prerequisite: BasicPrerequisites,\r\n        run(player, sender, content, args) {\r\n            const v = parseInt(content[4]);\r\n            DataManager.points.task_time = v * 60 * 1000;\r\n            ParseMessage({ mode: \"chat-action\", msg: `Received the instruction, the time to finish {player_wg}'s task is ${DataManager.points.task_time / 60 / 1000} minutes` }, { player });\r\n            ParseMessage({ mode: \"action\", msg: `The cold voice of the mechanical broadcast repeated {player_wg}'s mission time. Tick, tick, is there still time to be dazed? The precise technology will not miss even a second, right?` }, { player });\r\n        }\r\n    },\r\n    {\r\n        match: /^((进入|关闭)惩罚模式)|((Enter|Exit) punishment mode)/i,\r\n        prerequisite: BasicPrerequisites,\r\n        run(player, sender, content) {\r\n            if (content[2] === \"进入\" || content[4].toLowerCase() === \"enter\") StartPunish(player);\r\n            else StopPunish(player);\r\n        }\r\n    }, {\r\n        match: /^(((打开|Turn on )((严厉)|(harsh ))?)|((Turn off )|(关闭)))((高潮惩罚模式)|(Orgasm Punishment mode))/i,\r\n        prerequisite: BasicPrerequisites,\r\n        run(player, sender, content) {\r\n            if (content[1].startsWith(\"打开\") || content[1].toLowerCase().startsWith(\"Turn on\")) {\r\n                TimedWorker.global.push({\r\n                    description: \"OrgasmPunishMode\", works: [\r\n                        new MessageWork({ mode: \"action\", msg: \"Received the instruction, the orgasm punishment mode has been turned on\" }),\r\n                        new CommonWork(() => DataManager.settings.update(\"orgasmPunishMode\", content[4] ? 2 : 1)),\r\n                        new MessageWork({ mode: \"chat-action\", msg: \"The display on {player_wg}'s training underwear lights up with a small icon, a pink heart with a small lightning bolt imposed on it. What does it mean? Why not give it a try? Maybe {player_wg} will like the feeling.\" }),\r\n                    ]\r\n                });\r\n            } else {\r\n                TimedWorker.global.push({\r\n                    description: \"OrgasmPunishMode\", works: [\r\n                        new MessageWork({ mode: \"action\", msg: \"Received the instruction, the orgasm punishment mode has been turned off\" }),\r\n                        new CommonWork(() => DataManager.settings.update(\"orgasmPunishMode\", 0)),\r\n                        new MessageWork({ mode: \"chat-action\", msg: \"The small punishment icon on the display of {player_wg}'s training underwear gradually goes out.  {player_wg} can now climax freely... right? Is it that {player_wg} wants to be tightly tied up and usher in waves of pleasure?\" }),\r\n                    ]\r\n                });\r\n\r\n            }\r\n        }\r\n    }, {\r\n        match: /^((设置高潮惩罚时间为)|(Set the penalty time to ))([1-9]\\d{0,2})((分钟)|( Minutes))/i,\r\n        prerequisite: BasicPrerequisites,\r\n        run(player, sender, content, args) {\r\n            const v = parseInt(content[4]);\r\n            DataManager.points.orgasm_punish_time = v * 60 * 1000;\r\n            ParseMessage({ mode: \"chat-action\", msg: `Received the command, {player_wg}'s orgasm penalty time is ${DataManager.points.orgasm_punish_time / 60 / 1000} minutes` }, { player });\r\n            ParseMessage({ mode: \"action\", msg: \"The cold voice of the mechanical broadcast repeats the price {player_wg} has to pay after reaching orgasm at will. Perhaps with enough desire and hunger, {player_wg} will choose to indulge her body and sink into desire?\" }, { player })\r\n        }\r\n    },\r\n    {\r\n        match: /^(((扣除)|(奖励))|((Reward )|(Deduct )))([1-9]\\d{0,2})((积分)|( Points?))/i,\r\n        prerequisite: BasicPrerequisites,\r\n        run(player, sender, content, args) {\r\n            const v = parseInt(content[8]);\r\n            console.log(content);\r\n            const positive = (content[2] === \"奖励\" || content[5].toLowerCase() === \"reward \");\r\n            console.log(content[5].toLowerCase() === \"reward \");\r\n            console.log(positive);\r\n            const oper = positive ? \"rewarded\" : \"deducted\";\r\n            console.log(oper);\r\n            DataManager.points.points += positive ? v : -v;\r\n            const points = DataManager.points.points;\r\n            RouteIM(args.type, player, sender, \"{player_wg} is {oper} {v} points, current points: {points}\", { oper, v, points });\r\n        },\r\n    },\r\n    {\r\n        match: /^((查询奖励积分)|(Get reward points))/i,\r\n        prerequisite: BasicPrerequisites,\r\n        run(player, sender, content, args) {\r\n            const points = DataManager.points.points;\r\n            RouteIM(args.type, player, sender, \"{player_wg} Current reward points: {points}\", { points });\r\n            if (DataManager.points.points > 20)\r\n                ParseMessage({ mode: \"local\", msg: `{player_wg} did a great job, but there is no interest for accumulating points, or maybe you just want a good number? Be careful when you open the query next time, there may be a surprise.` }, { player })\r\n            else if (DataManager.points.points < 0)\r\n                ParseMessage({ mode: \"local\", msg: `Negative points are not what a good wolf girl should have. Keep working hard, but don't trigger the punishment task. Be careful that after multiple punishments, you will be abandoned and recycled into a living toy. However, with {player_wg}'s figure, maybe living furniture is not bad...` }, { player })\r\n        }\r\n    }\r\n]\r\n\r\nexport const SelfPointCmds: CommandTemplate[] = [\r\n    {\r\n        match: /^((允许高潮)|(Allow orgasm))/i,\r\n        prerequisite: SelfPrerequisites,\r\n        run(player, sender, content) {\r\n            DataManager.points.use_points(1).then(() => {\r\n                ArousalCtrlSequence(player, \"off\");\r\n            }, (p) => {\r\n                ParseMessage({ mode: \"local\", msg: `You do not have enough reward points. Current points: ${p}` })\r\n            })\r\n        }\r\n    },\r\n    {\r\n        match: /^((关闭语言限制)|(Turn off language restrictions))/,\r\n        prerequisite: SelfPrerequisites,\r\n        run(player, sender, content) {\r\n            DataManager.points.use_points(1).then(() => {\r\n                VoiceCtrlSequence(player, \"off\");\r\n            }, (p) => {\r\n                ParseMessage({ mode: \"local\", msg: `You do not have enough reward points. Current points: ${p}` })\r\n            })\r\n        }\r\n    },\r\n    {\r\n        match: /^((关闭手臂限制)|(Turn off arm restraints))/i,\r\n        prerequisite: SelfPrerequisites,\r\n        run(player, sender, content) {\r\n            DataManager.points.use_points(1).then(() => {\r\n                HandsCtrlSequence(player, \"off\");\r\n            }, (p) => {\r\n                ParseMessage({ mode: \"local\", msg: `You do not have enough reward points. Current points: ${p}` })\r\n            })\r\n        }\r\n    },\r\n    {\r\n        match: /^((关闭行走限制)|(Turn off leg restraints))/i,\r\n        prerequisite: SelfPrerequisites,\r\n        run(player, sender, content) {\r\n            DataManager.points.use_points(1).then(() => {\r\n                FeetCtrlSequence(player, \"off\");\r\n            }, (p) => {\r\n                ParseMessage({ mode: \"local\", msg: `You do not have enough reward points. Current points: ${p}` })\r\n            })\r\n        }\r\n    },\r\n    {\r\n        match: /^((关闭视觉限制)|(Turn off visual restrictions))/i,\r\n        prerequisite: SelfPrerequisites,\r\n        run(player, sender, content) {\r\n            DataManager.points.use_points(1).then(() => {\r\n                VisionCtrlSequence(player, \"off\");\r\n            }, (p) => {\r\n                ParseMessage({ mode: \"local\", msg: `You do not have enough reward points. Current points: ${p}` })\r\n            })\r\n        }\r\n    },\r\n    {\r\n        match: /^((关闭听觉限制)|(Turn off auditory restrictions))/i,\r\n        prerequisite: SelfPrerequisites,\r\n        run(player, sender, content) {\r\n            DataManager.points.use_points(1).then(() => {\r\n                HearingCtrlSequence(player, \"off\");\r\n            }, (p) => {\r\n                ParseMessage({ mode: \"local\", msg: `You do not have enough reward points. Current points: ${p}` })\r\n            })\r\n        }\r\n    },\r\n]","import { CommonWork, DelayWork } from \"../../Control/CommonWork\";\r\nimport { ParseMessage } from \"../../Control/Message\";\r\nimport { MessageWork } from \"../../Control/MessageWork\";\r\nimport { GetWolfGirlName } from \"../../Control/WolfGirlCtrl\";\r\nimport { TimedWorkState, TimedWorker } from \"../../Control/Worker\";\r\nimport { DataManager } from \"../../Data\";\r\nimport { CommandTemplate } from \"../ICmds\";\r\nimport { BasicPrerequisites, ModOrSelfPrerequisites } from \"../Prerequistes\";\r\n\r\n\r\nexport const StatCmds: CommandTemplate[] = [\r\n    {\r\n        match: /^((查询高潮统计)|(Get orgasm statistics))/i,\r\n        prerequisite: ModOrSelfPrerequisites,\r\n        run(player, sender, content) {\r\n            const { orgasm, resist, ruined } = DataManager.arousal;\r\n            const arousal_report = GetWolfGirlName(player) + \"The climax statistics are as follows: \\n\" +\r\n                `  Number of orgasms: ${orgasm}\\n` +\r\n                `  Number of resisted orgasms: ${resist}\\n` +\r\n                `  Number of ruined orgasms: ${ruined}\\n` +\r\n                `  Orgasm Rate: ${((orgasm) / (orgasm + resist + ruined) * 100).toFixed(2)}%`;\r\n            ParseMessage({ mode: \"chat-action\", msg: arousal_report });\r\n        }\r\n    },\r\n    {\r\n        match: /^((查询狼女训练统计)|(Get wolf girl training statistics))/i,\r\n        prerequisite: BasicPrerequisites,\r\n        run(player, sender, content) {\r\n            const { script_run_time, wolfgirl_time, stash_time, last_fix_time, task } = DataManager.instance.data.stat;\r\n            const { finished, failed, counter } = task;\r\n            const point = DataManager.instance.data.points.current;\r\n\r\n            const day_hour_minute_second = (time: number) => {\r\n                const seconds = Math.floor(time / 1000);\r\n                const days = Math.floor(seconds / (3600 * 24));\r\n                const daystring = days > 0 ? `${days}days` : \"\";\r\n                const hours = Math.floor((seconds % (3600 * 24)) / 3600);\r\n                const hourstring = days > 0 || hours > 0 ? `${hours}hours` : \"\";\r\n                const minutes = Math.floor((seconds % 3600) / 60);\r\n                const second = seconds % 60;\r\n                return `${daystring}${hourstring}${minutes}minutes${second}seconds`;\r\n            }\r\n\r\n            const local_time = (time: number) => {\r\n                return new Date(time).toLocaleString();\r\n            }\r\n\r\n            const task_report = GetWolfGirlName(player) + \"The training statistics are as follows: \\n\" +\r\n                `  Total running time of training assistance system: ${day_hour_minute_second(script_run_time)}\\n` +\r\n                `  Training module effective working time: ${day_hour_minute_second(wolfgirl_time)}\\n` +\r\n                `  Number of tasks completed: ${finished}\\n` +\r\n                `  Number of tasks failed: ${failed}\\n` +\r\n                `  Current task points: ${point}\\n` +\r\n                `  Task Count: \\n` +\r\n                `    climax: ${counter.Orgasmed ?? 0}\\n` +\r\n                `    resisted orgasms: ${counter.Resisted ?? 0}\\n` +\r\n                `    Played with breast: ${counter.BreastPlayed ?? 0}\\n` +\r\n                `    Played with vulva: ${counter.VulvaPlayed ?? 0}\\n` +\r\n                `    Spanked: ${counter.Spanked ?? 0}\\n` +\r\n                `  Last suit maintenance check: ${last_fix_time > 0 ? local_time(last_fix_time) : \"No records\"}\\n` +\r\n                `  Restrained Lightweight Mode Time: ${day_hour_minute_second(stash_time)}`;\r\n            ParseMessage({ mode: \"chat-action\", msg: task_report });\r\n        }\r\n    }, {\r\n        match: /^((扫描身体敏感部位)|(Scan sensitive body parts))/i,\r\n        prerequisite: BasicPrerequisites,\r\n        run(player, sender, content) {\r\n            TimedWorker.global.push({\r\n                description: \"ScanBody\", works: [\r\n                    new MessageWork({ mode: \"action\", msg: \"Command received, scanning body parameters\" }),\r\n                    new MessageWork({ mode: \"action\", msg: `Several small streams of metallic silver water flow out of {player_wg}'s collar and along {player_wg}'s body to various parts of her body. They briefly cover {player_wg}'s body, just like a silver latex suit covering her entire body. After a burst of itchiness, this strange latex suit turns back into a silver stream of water and returns to the collar along the same path.` }),\r\n                    new DelayWork(5000),\r\n                    new CommonWork((player) => {\r\n                        if (player.ArousalSettings === undefined || player.ArousalSettings.Active === \"Inactive\") {\r\n                            ParseMessage({ mode: \"action\", msg: \"The scan data analysis is complete. {player_wg}'s sexual arousal center is in a shut-down state and no physical data has been collected.\" }, { player });\r\n                            return TimedWorkState.interrupted;\r\n                        }\r\n                        const ZoneData = AssetGroup.filter(g => g.IsItem()).map(g => g.Name).map(g => PreferenceGetArousalZone(player, g)).filter(z => !!z) as ArousalZone[];\r\n                        const value3Zones = ZoneData.filter(z => z.Factor === 3).map(z => AssetGroupGet(player.AssetFamily, z.Name)?.Description).filter(z => !!z).join(\", \");\r\n                        const value4Zones = ZoneData.filter(z => z.Factor === 4).map(z => AssetGroupGet(player.AssetFamily, z.Name)?.Description).filter(z => !!z).join(\", \");\r\n                        const orgasmZones = ZoneData.filter(z => z.Orgasm).map(z => AssetGroupGet(player.AssetFamily, z.Name)?.Description).filter(z => !!z).join(\", \");\r\n                        ParseMessage({ mode: \"action\", msg: `The scan data has been analyzed. The more sensitive parts of {player_wg}'s body are {value3Zones}, and the most sensitive parts of {player_wg}'s body are {value4Zones}. Among them, the part that can make {player_wg} climax is {orgasmZones}. The scan data summary is complete.` },\r\n                            { player }, { value3Zones, value4Zones, orgasmZones });\r\n                    })\r\n                ]\r\n            });\r\n        }\r\n    }\r\n]","import { ModSDKModAPI } from \"bondage-club-mod-sdk\";\r\n\r\nexport type InjectionType = \"anesthetic\" | \"pickmeup\" | \"aphrodisiac\" | \"inhibitor\" | \"EasterUniversalDispersal\";\r\n\r\nexport type DisperseMode = \"timely_cancel\" | \"all_cancel\"\r\nexport type CummlateMode = \"refresh\" | \"add\" | \"none\"\r\n\r\nexport type DisperseSetting = {\r\n    mode: DisperseMode,\r\n    target: InjectionType[]\r\n}\r\n\r\nexport abstract class IInjection {\r\n    abstract name: InjectionType;\r\n    abstract duration: number;\r\n    abstract cumulate: CummlateMode;\r\n    abstract disperse: DisperseSetting | undefined;\r\n    isWorking: () => boolean = () => false;\r\n    onInject(): void { };\r\n    hook(mod: ModSDKModAPI, lateHook: (callback: () => void) => void): void { };\r\n    update(player: PlayerCharacter): void { };\r\n}","import { ModSDKModAPI } from \"bondage-club-mod-sdk\";\r\nimport { IInjection, InjectionType } from \"./IInjection\";\r\nimport { Anesthetic } from \"./Anesthetic\";\r\nimport { Pickmeup } from \"./Pickmeup\";\r\nimport { Aphrodisiac } from \"./Aphrodisiac\";\r\nimport { Inhibitor } from \"./Inhibitor\";\r\n\r\nconst injections = [Anesthetic, Pickmeup, Aphrodisiac, Inhibitor];\r\n\r\nexport class InjectionManager {\r\n    injections: Map<InjectionType, IInjection>;\r\n\r\n    // name -> end time\r\n    working: Map<InjectionType, number> = new Map();\r\n\r\n    constructor(mod: ModSDKModAPI, lateHook: (callback: () => void) => void) {\r\n        this.injections = new Map(injections.map(i => new i).map(injection => [injection.name, injection]));\r\n        this.injections.forEach(injection => injection.hook(mod, lateHook));\r\n        this.injections.forEach((i, name) => i.isWorking = () => this.working.has(name));\r\n\r\n        setInterval(() => {\r\n            const now = Date.now();\r\n            this.working.forEach((time, name) => {\r\n                if (time < now) this.working.delete(name);\r\n                else if (Player?.MemberNumber) this.injections.get(name)?.update(Player);\r\n            });\r\n        }, 100);\r\n    }\r\n\r\n    doInject(name: InjectionType) {\r\n        const injection = this.injections.get(name);\r\n        if (!injection) return;\r\n\r\n        const now = Date.now();\r\n        let duration = injection.duration;\r\n\r\n        if (injection.disperse) {\r\n            const disperse = injection.disperse;\r\n            if (disperse.mode === \"all_cancel\") {\r\n                disperse.target.forEach(target => this.working.delete(target));\r\n            } else if (disperse.mode === \"timely_cancel\") {\r\n                disperse.target.forEach(target => {\r\n                    const working = this.working.get(target);\r\n                    if (working !== undefined) {\r\n                        const remain = working - duration;\r\n                        if (remain > now) this.working.set(target, remain);\r\n                        else {\r\n                            this.working.delete(target);\r\n                            duration -= (working - now);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        }\r\n\r\n        injection.onInject();\r\n\r\n        if (injection.cumulate === \"refresh\") {\r\n            this.working.set(name, Date.now() + duration);\r\n        } else if (injection.cumulate === \"add\" && this.working.has(name)) {\r\n            this.working.set(name, this.working.get(name)! + duration);\r\n        }\r\n    }\r\n\r\n\r\n    static _instance: InjectionManager | undefined = undefined;\r\n\r\n    static get instance() {\r\n        return InjectionManager._instance as InjectionManager;\r\n    }\r\n\r\n    static init(mod: ModSDKModAPI, lateHook: (callback: () => void) => void) {\r\n        if (InjectionManager._instance) return;\r\n        InjectionManager._instance = new InjectionManager(mod, lateHook);\r\n    }\r\n}","import { ModSDKModAPI } from \"bondage-club-mod-sdk\";\r\nimport { CummlateMode, DisperseSetting, IInjection, InjectionType } from \"./IInjection\";\r\n\r\n\r\nexport class Anesthetic extends IInjection {\r\n    cumulate: CummlateMode = \"refresh\";\r\n    name: InjectionType = \"anesthetic\";\r\n    duration = 15 * 60 * 1000;\r\n    disperse = undefined;\r\n\r\n    onInject(): void {\r\n        if (Player?.ArousalSettings?.Progress !== undefined) {\r\n            Player.ArousalSettings.Progress = 0;\r\n            CharacterSetFacialExpression(Player, \"Eyes\", \"Closed\");\r\n        }\r\n\r\n        if (CurrentCharacter) {\r\n            if (CurrentCharacter.FocusGroup) {\r\n                CurrentCharacter.FocusGroup = null;\r\n            }\r\n            CurrentCharacter = null;\r\n        }\r\n    }\r\n\r\n    update(player: PlayerCharacter): void {\r\n        const input = ElementValue(\"InputChat\");\r\n        const rnd = Math.random();\r\n        if (rnd < 0.1) {\r\n            ElementValue(\"InputChat\", input.substring(1));\r\n        } else if (rnd < 0.6) {\r\n            ElementValue(\"InputChat\", input.replace(/^([z\\.]*)./, \"$1z\"));\r\n        } else {\r\n            ElementValue(\"InputChat\", input.replace(/^([z\\.]*)./, \"$1.\"));\r\n        }\r\n    }\r\n\r\n    hook(mod: ModSDKModAPI, lateHook: (callback: () => void) => void) {\r\n        lateHook(() => {\r\n            mod.hookFunction('Player.CanWalk', 1, (args, next) => {\r\n                if (this.isWorking()) return false;\r\n                return next(args);\r\n            });\r\n\r\n            mod.hookFunction('Player.GetBlurLevel', 1, (args, next) => {\r\n                const result = next(args);\r\n                if (this.isWorking()) return result + 3;\r\n                return result;\r\n            });\r\n        });\r\n\r\n        mod.hookFunction('ChatRoomFocusCharacter', 1, (args, next) => {\r\n            if (this.isWorking()) return;\r\n            return next(args);\r\n        });\r\n\r\n        mod.hookFunction('SpeechGetGagLevel', 1, (args, next) => {\r\n            const result = next(args);\r\n            if ((args[0] as Character).IsPlayer() && this.isWorking()) return result + 2;\r\n            return result;\r\n        });\r\n    }\r\n}\r\n","import { InjectionManager } from \".\";\r\n\r\nimport { CummlateMode, DisperseSetting, IInjection, InjectionType } from \"./IInjection\";\r\n\r\n\r\nexport class Pickmeup extends IInjection {\r\n    name: InjectionType = \"pickmeup\";\r\n    duration = 0;\r\n    cumulate: CummlateMode = \"none\";\r\n    disperse: DisperseSetting = {\r\n        mode: \"all_cancel\",\r\n        target: ['anesthetic'],\r\n    }\r\n}\r\n","import { ModSDKModAPI } from \"bondage-club-mod-sdk\";\r\nimport { CummlateMode, DisperseSetting, IInjection, InjectionType } from \"./IInjection\";\r\n\r\n\r\nexport class Aphrodisiac extends IInjection {\r\n    disperse: DisperseSetting = {\r\n        target: ['inhibitor'],\r\n        mode: \"timely_cancel\"\r\n    }\r\n    cumulate: CummlateMode = \"add\";\r\n    name: InjectionType = \"aphrodisiac\";\r\n    duration = 15 * 60 * 1000;\r\n\r\n    savedArousal: number = -1;\r\n\r\n    onInject(): void {\r\n        if (Player) {\r\n            CharacterSetFacialExpression(Player, \"Eyes\", \"HeartPink\");\r\n        }\r\n    }\r\n\r\n    update(player: PlayerCharacter): void {\r\n        if (player?.ArousalSettings?.Progress === undefined) return;\r\n        if (this.isWorking() && this.savedArousal !== -1) {\r\n            const diff = player.ArousalSettings.Progress - this.savedArousal;\r\n            if (diff > 0) player.ArousalSettings.Progress += diff;\r\n        }\r\n        this.savedArousal = player.ArousalSettings.Progress;\r\n    }\r\n\r\n    hook(mod: ModSDKModAPI): void {\r\n        mod.hookFunction('ChatRoomDrawArousalScreenFilter', 1, (args, next) => {\r\n            if (!args[3] || args[3] < 60) args[3] = 60;\r\n            return next(args);\r\n        });\r\n    }\r\n}\r\n","import { IInjection, DisperseMode, CummlateMode, InjectionType, DisperseSetting } from \"./IInjection\";\r\n\r\n\r\nexport class Inhibitor extends IInjection {\r\n    cumulate: CummlateMode = 'add';\r\n    name: InjectionType = \"inhibitor\";\r\n    duration = 15 * 60 * 1000;\r\n    disperse: DisperseSetting = {\r\n        mode: \"timely_cancel\",\r\n        target: ['aphrodisiac']\r\n    };\r\n\r\n    onInject(): void {\r\n        if (Player?.ArousalSettings?.Progress)\r\n            Player.ArousalSettings.Progress = 0;\r\n    }\r\n\r\n    savedArousal: number = -1;\r\n\r\n    update(player: PlayerCharacter): void {\r\n        if (player?.ArousalSettings?.Progress === undefined) return;\r\n\r\n        if (this.isWorking() && this.savedArousal !== -1) {\r\n            const diff = player.ArousalSettings.Progress - this.savedArousal;\r\n            if (diff > 0) player.ArousalSettings.Progress -= diff * 0.5;\r\n        }\r\n        this.savedArousal = player.ArousalSettings.Progress;\r\n    }\r\n}\r\n","import { CheckItemsWork, CommonWork, DelayWork } from \"../../CommonWork\";\r\nimport { InjectionManager } from \"../../Injection\";\r\nimport { InjectionType } from \"../../Injection/IInjection\";\r\nimport { IMessage, ParseMessage } from \"../../Message\";\r\nimport { TimedWork, TimedWorkState, TimedWorker } from \"../../Worker\";\r\nimport { StdMissingAction, StdMissingMsgN } from \"../ItemCmdSequence/CmdSequenceMessage\";\r\n\r\ninterface InjectionSequenceMsg {\r\n    finish: IMessage;\r\n    f_action: IMessage;\r\n}\r\n\r\nfunction InstantInjection(type: InjectionType, msg: InjectionSequenceMsg) {\r\n    const work_sequence: TimedWork[] = [\r\n        new CommonWork((player) => ParseMessage(msg.finish, { player })),\r\n        new CommonWork((player) => ParseMessage(msg.f_action, { player })),\r\n        new CommonWork(() => InjectionManager.instance.doInject(type))\r\n    ]\r\n    TimedWorker.global.push_front({ description: `InstantInjection${type}`, works: work_sequence })\r\n}\r\n\r\nfunction StdInjectionSequence(type: InjectionType, msg: InjectionSequenceMsg) {\r\n    let data = {\r\n        msg: StdMissingAction\r\n    }\r\n\r\n    const work_sequence: TimedWork[] = [\r\n        new CheckItemsWork([\"ItemTorso2\"], (player, result) => {\r\n            if (result.missing.length > 0) {\r\n                const missing_formated = result.missing.map(g => g.Craft.Name).join(\", \");\r\n                ParseMessage(StdMissingMsgN, { player }, { missing_formated });\r\n                return TimedWorkState.interrupted;\r\n            } else {\r\n                data.msg = { mode: \"chat-action\", msg: `Received the order, the medicine is being prepared` };\r\n            }\r\n        }),\r\n        new CommonWork((player) => ParseMessage(data.msg, { player })),\r\n        new DelayWork(1000),\r\n        new CommonWork((player) => {\r\n            InjectionManager.instance.doInject(type);\r\n        }),\r\n        new CommonWork((player) => ParseMessage(msg.finish, { player })),\r\n        new CommonWork((player) => ParseMessage(msg.f_action, { player }))\r\n    ]\r\n    TimedWorker.global.push({ description: `InjectionSequence${type}`, works: work_sequence })\r\n}\r\n\r\nconst messages: {\r\n    [k in InjectionType]: InjectionSequenceMsg;\r\n} = {\r\n    'aphrodisiac': {\r\n        finish: { mode: \"chat-action\", msg: \"Aphrodisiac injection completed\" },\r\n        f_action: { mode: \"action\", msg: \"Oh, it's an aphrodisiac. Although it won't lead to an orgasm directly, subsequent arousal will be more impactful. I hope {player_wg} won't let the pleasure spoil her brain.\" }\r\n    },\r\n    'inhibitor': {\r\n        finish: { mode: \"chat-action\", msg: \"Inhibitor injection completed\" },\r\n        f_action: { mode: \"action\", msg: \"{player_wg}'s harness injected her with an inhibitor that can temporarily suppress the pain, but the side effect is that it suppresses the brain's perception of pleasure. If this is injected when she is in estrus... don't treat your body too much because of desire, okay?\" }\r\n    },\r\n    'anesthetic': {\r\n        finish: { mode: \"chat-action\", msg: \"Anesthetic injection completed\" },\r\n        f_action: { mode: \"action\", msg: \"{player_wg}, who has lost her ability to resist, seems to be able to be played with at will. Maybe in a few minutes we need to call the EIL recycling team to pick her up.\" }\r\n    },\r\n    'pickmeup': {\r\n        finish: { mode: \"chat-action\", msg: \"Recovery injection completed\" },\r\n        f_action: { mode: \"action\", msg: \"With the injection of the recovery agent, {player_wg}'s body gradually regains strength and she gradually regained control of her limbs.\" }\r\n    },\r\n    \"EasterUniversalDispersal\": {\r\n        finish: { mode: \"chat-action\", msg: \"The injection of general dispersant is completed\" },\r\n        f_action: { mode: \"action\", msg: \"Complex magic circuits, inherited ancient bloodlines, tedious preparations for casting spells, how can a great magician who takes decades to become a master avoid being caught up by technology? The low threshold for using technology has never been comparable to those magicians who require so-called bloodlines and origins.\" }\r\n    }\r\n}\r\n\r\nexport function DoInjection(type: InjectionType, instant?: boolean) {\r\n    if (instant) {\r\n        InstantInjection(type, messages[type]);\r\n    } else {\r\n        StdInjectionSequence(type, messages[type]);\r\n    }\r\n}","import { DataManager } from \"../../Data\";\r\nimport { ActivityInfo, ActivityTriggerMode, CheckOutfitItemCE, CustomBCActivity, ExtendedActivityPrerequisite, ExtendedBCActivity, IActivityCustom, IActivityPrerequisite } from \"bc-utilities\";\r\nimport { StartStashPopSequence } from \"../../Control/SequenceCtrl/StashSequence\";\r\nimport { StartStashSequence } from \"../../Control/SequenceCtrl/StashSequence\";\r\nimport { ModOrSelfPrerequisites } from \"../Prerequistes\";\r\nimport { OutfitItemsMap } from \"../../Control/OutfitCtrl\";\r\n\r\nconst strings: { [index: string]: string } = {\r\n    \"Label-ChatOther-ItemNeck-WolfGirlItemsSwitch\": \"Toggle-Wolf-Girl-Item-Mode\",\r\n    \"Label-ChatSelf-ItemNeck-WolfGirlItemsSwitch\": \"Toggle-Wolf-Girl-Item-Mode\",\r\n    \"Label-ChatOther-ItemPelvis-WolfGirlItemsSwitch\": \"Toggle-Wolf-Girl-Item-Mode\",\r\n    \"Label-ChatSelf-ItemPelvis-WolfGirlItemsSwitch\": \"Toggle-Wolf-Girl-Item-Mode\",\r\n\r\n    \"ChatOther-ItemNeck-WolfGirlItemsSwitch\": \"SourceCharacter gently touches TargetCharacter's collar, and a faint light turns on.\",\r\n    \"ChatSelf-ItemNeck-WolfGirlItemsSwitch\": \"SourceCharacter gently touches her collar, and a faint light flickers on.\",\r\n    \"ChatOther-ItemPelvis-WolfGirlItemsSwitch\": \"SourceCharacter gently touches TargetCharacter's training underwear, and a faint light turns on.\",\r\n    \"ChatSelf-ItemPelvis-WolfGirlItemsSwitch\": \"SourceCharacter lightly touches her training underwear, and a faint light flickers on.\",\r\n};\r\n\r\nconst bodyParts: AssetGroupItemName[] = [\"ItemNeck\", \"ItemPelvis\"];\r\n\r\nexport class WolfGirlItemsSwitch extends IActivityCustom<CustomActivities, CustomPrerequisites> {\r\n    constructor() {\r\n        super(\r\n            \"onself\",\r\n            bodyParts,\r\n            {\r\n                Name: \"WolfGirlItemsSwitch\",\r\n                MaxProgress: 0,\r\n                Prerequisite: [\"UseHands\", \"CanSwitchWGItem\"],\r\n                Target: bodyParts,\r\n                TargetSelf: bodyParts\r\n            },\r\n            \"Assets/Female3DCG/ItemNeck/Preview/FuturisticCollar.png\"\r\n        )\r\n    }\r\n\r\n    on(player: PlayerCharacter, sender: Character, info: ActivityInfo): void {\r\n        if (info.TargetCharacter === player.MemberNumber) {\r\n            if (ModOrSelfPrerequisites(player, sender)) {\r\n                if (DataManager.outfit.items.size > 0) {\r\n                    StartStashPopSequence(player);\r\n                } else {\r\n                    StartStashSequence(player);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    adjustDict(content: string, dict: any[]): any[] {\r\n        dict.push({\r\n            Tag: `MISSING ACTIVITY DESCRIPTION FOR KEYWORD ${content}`,\r\n            Text: this.text(content)\r\n        });\r\n        return dict;\r\n    }\r\n\r\n    text(keyword: string) {\r\n        return strings[keyword] ?? keyword;\r\n    }\r\n}\r\n\r\nexport class CanSwitchWGItem extends IActivityPrerequisite<CustomPrerequisites> {\r\n    name: CustomPrerequisites = \"CanSwitchWGItem\";\r\n    test(acting: Character, acted: Character, group: AssetGroup): boolean {\r\n        if (!CheckOutfitItemCE(acted, OutfitItemsMap.get(group.Name), { lock: true })) return false;\r\n        if (acted.IsPlayer()) {\r\n            return DataManager.points.points > 10;\r\n        }\r\n        return true;\r\n    }\r\n}","import { ActivityInfo, ActivityTriggerMode, IActivityExtended } from \"bc-utilities\";\r\nimport { InitDressSequence } from \"../../Control/SequenceCtrl/DressSequence\";\r\nimport { InjectionType } from \"../../Control/Injection/IInjection\";\r\nimport { DoInjection } from \"../../Control/SequenceCtrl/InjectionSequence\";\r\nimport { IsPlayerWolfGirl } from \"../../Control/WolfGirlCtrl\";\r\nimport { ToolsInjector, ToolsVisor } from \"../../Control/OutfitCtrl\";\r\nimport { DefaultCheckItems } from \"../../Control/OutfitCtrl/Utils\";\r\n\r\ninterface InjectDictEntry extends TextDictionaryEntry {\r\n    Tag: 'WolfGirlInjectType';\r\n    Text: InjectionType;\r\n}\r\n\r\nfunction isInjectDictEntry(entry: ChatMessageDictionaryEntry): entry is InjectDictEntry {\r\n    return (entry as Partial<TextDictionaryEntry>).Tag === 'WolfGirlInjectType';\r\n}\r\n\r\nexport class InjectingExtend extends IActivityExtended<CustomActivities, CustomPrerequisites> {\r\n    constructor() { super(\"selfonother\", undefined, \"Inject\"); }\r\n\r\n    on(player: PlayerCharacter, sender: Character, info: ActivityInfo) {\r\n        const target = ChatRoomCharacter.find(c => c.MemberNumber === info.TargetCharacter);\r\n        if (!target) return;\r\n        if (!DefaultCheckItems(player, [ToolsVisor, ToolsInjector], false)) return;\r\n        if (this.type === undefined)\r\n            InitDressSequence(player, target);\r\n    }\r\n\r\n    public type: InjectionType | undefined = undefined;\r\n\r\n    adjustDict(Content: string, dict: ChatMessageDictionary): ChatMessageDictionary {\r\n        if (this.type) {\r\n            dict.push({\r\n                Tag: \"WolfGirlInjectType\",\r\n                Text: this.type\r\n            } as InjectDictEntry);\r\n        }\r\n        return dict;\r\n    }\r\n}\r\n\r\nexport class InjectedExtend extends IActivityExtended<CustomActivities, CustomPrerequisites> {\r\n    constructor() { super(\"onself\", undefined, \"Inject\"); }\r\n\r\n    on(player: PlayerCharacter, sender: Character, info: ActivityInfo) {\r\n        const v = info.BCDictionary.find(i => isInjectDictEntry(i));\r\n        if (v && IsPlayerWolfGirl(player)) {\r\n            DoInjection(v.Text as InjectionType, true);\r\n        }\r\n    }\r\n}","import { Tools } from \"../../Control/OutfitCtrl\";\r\nimport { IsPlayerWolfGirl } from \"../../Control/WolfGirlCtrl\";\r\nimport { ActivityInfo, ActivityTriggerMode, IActivityExtended } from \"bc-utilities\";\r\nimport { DefaultCheckOutfitItem } from \"../../Control/OutfitCtrl/Utils\";\r\nimport { ModSDKModAPI } from \"bondage-club-mod-sdk\";\r\nimport { ParseMessage } from \"../../Control/Message\";\r\n\r\nexport class DrinkExtend extends IActivityExtended<CustomActivities, CustomPrerequisites> {\r\n    constructor() { super(\"onself\", [\"ItemMouth\"], \"SipItem\"); }\r\n\r\n    on(player: PlayerCharacter, sender: Character, info: ActivityInfo): void {\r\n        if (info.Asset && info.ActivityGroup.startsWith(\"ItemMouth\")) {\r\n            const tItem = sender.Appearance.find(a => a.Asset.Group.Name === info.Asset!.GroupName);\r\n            if (!tItem) return;\r\n            const target = Tools.find(i => i.Asset.Group === info.Asset!.GroupName\r\n                && i.Asset.Name === info.Asset!.AssetName && i.Craft.Name === info.Asset!.CraftName);\r\n            if (!target) return;\r\n            if (!DefaultCheckOutfitItem(tItem, target)) return;\r\n\r\n            if (target.Craft.Name === \"情欲之水\" || target.Craft.Name === \"Water of Desire\") {\r\n                if (IsPlayerWolfGirl(player)) this.DrinkAphrodisiac(player);\r\n            } else if (target.Craft.Name === \"特种红牛\" || target.Craft.Name === \"Special Redbull\") {\r\n                this.DrinkRedbull(player);\r\n            }\r\n        }\r\n    }\r\n\r\n    private DrinkAphrodisiac(player: PlayerCharacter) {\r\n        ParseMessage({ mode: \"local\", msg: \"What you just drank makes you feel very aroused\" });\r\n        if (player?.ArousalSettings?.Progress !== undefined) {\r\n            player.ArousalSettings.Progress = 100;\r\n            ActivityOrgasmPrepare(player, false);\r\n        }\r\n    }\r\n\r\n    private RedbullDrinkTimeout = 0;\r\n\r\n    private DrinkRedbull(player: PlayerCharacter) {\r\n        ParseMessage({ mode: \"local\", msg: \"You drink a can of Red Bull and feel full of energy, as if you can break free from all constraints\" });\r\n        this.RedbullDrinkTimeout = Date.now() + 15 * 60 * 1000;\r\n    }\r\n\r\n    init(mod: ModSDKModAPI): void {\r\n        mod.hookFunction(\"DialogStruggleStart\", 1, (args, next) => {\r\n            const [C, Action, PrevItem, NextItem] = args as [Character, string, Item, Item];\r\n            if (C.MemberNumber === Player?.MemberNumber && this.RedbullDrinkTimeout > Date.now() && Action === \"ActionStruggle\") {\r\n                PrevItem.Difficulty = -50;\r\n                this.RedbullDrinkTimeout = 0;\r\n            }\r\n            return next(args);\r\n        });\r\n    }\r\n}","import { ModSDKModAPI } from \"bondage-club-mod-sdk\";\r\nimport { ActivityInfo, ActivityFacility } from \"bc-utilities\";\r\nimport { CanSwitchWGItem, WolfGirlItemsSwitch } from \"./WolfGirlItemsSwitch\";\r\nimport { InjectingExtend, InjectedExtend } from \"./InjectionExtend\";\r\nimport { DrinkExtend } from \"./DrinkExtend\";\r\n\r\nexport class ActivityProvider {\r\n    private facility: ActivityFacility<CustomActivities, CustomPrerequisites>;\r\n\r\n    readonly injector: InjectingExtend;\r\n\r\n    constructor(mod: ModSDKModAPI) {\r\n        this.injector = new InjectingExtend;\r\n\r\n        this.facility = new ActivityFacility(mod);\r\n        this.facility.addPrerequisite(new CanSwitchWGItem);\r\n        this.facility.addActivity(new WolfGirlItemsSwitch);\r\n        this.facility.addActivityExtension(this.injector);\r\n        this.facility.addActivityExtension(new InjectedExtend);\r\n        this.facility.addActivityExtension(new DrinkExtend);\r\n    }\r\n\r\n    static init(mod: ModSDKModAPI) {\r\n        this._instance = new ActivityProvider(mod);\r\n    }\r\n\r\n    static run(player: PlayerCharacter, sender: Character, info: ActivityInfo) {\r\n        this._instance?.facility.run(player, sender, info);\r\n    }\r\n\r\n    private static _instance: ActivityProvider;\r\n    static get instance(): ActivityProvider {\r\n        return this._instance;\r\n    }\r\n}","import { CheckItemsWork, DelayWork } from \"../../CommonWork\";\r\nimport { IMessage, ParseMessage } from \"../../Message\";\r\nimport { MessageWork } from \"../../MessageWork\";\r\nimport { ToolsInjector } from \"../../OutfitCtrl\";\r\nimport { TimedWork, TimedWorkState, TimedWorker } from \"../../Worker\";\r\nimport { StdMissingMsgBase } from \"../ItemCmdSequence/CmdSequenceMessage\";\r\nimport { InjectionType } from \"../../Injection/IInjection\";\r\nimport { ActivityProvider } from \"../../../ChatRoom/Activity\";\r\n\r\nexport type SwitchAvailableType = Exclude<InjectionType, \"EasterUniversalDispersal\">;\r\n\r\nexport const switchInjectorMessages: {\r\n    [key in SwitchAvailableType | \"chips\"]: IMessage;\r\n} = {\r\n    \"anesthetic\": { mode: \"chat-action\", msg: \"Shh... maybe it's time to kidnap someone. Who will be the lucky one?\" },\r\n    \"pickmeup\": { mode: \"chat-action\", msg: \"It's really boring to play with a dead fish with no reaction or movement, isn't it? The prey's escape and struggle are also part of the fun of hunting, right?\" },\r\n    \"aphrodisiac\": { mode: \"chat-action\", msg: \"Is it to discipline or to play around? Whether it is for others or for yourself, something very interesting is about to happen, isn't it?\" },\r\n    \"inhibitor\": { mode: \"chat-action\", msg: \"If injected into a person in heat, this would undoubtedly be the most severe punishment. Compared to being unable to orgasm, a drug that would make it impossible for a person to even feel much pleasure is truly a demon.\" },\r\n    \"chips\": { mode: \"chat-action\", msg: \"It looks like trainer {player_id} is about to capture a new wolf girl, but please don't capture her and send her into the wolf girl assembly line at will, okay?\" },\r\n};\r\n\r\nexport function SwitchInjector(mode: string, type: SwitchAvailableType | undefined) {\r\n    const work_sequence: TimedWork[] = [\r\n        new CheckItemsWork([ToolsInjector], (player, result) => {\r\n            if (result.missing.length > 0) {\r\n                ParseMessage(StdMissingMsgBase, { player }, { missing_formated: ToolsInjector.Craft.Name });\r\n                return TimedWorkState.interrupted;\r\n            }\r\n            ActivityProvider.instance.injector.type = type\r\n        }, false),\r\n        new MessageWork({ mode: \"chat-action\", msg: `The syringe has switched to ${mode} mode` }),\r\n        new MessageWork({ mode: \"chat-action\", msg: switchInjectorMessages[type || \"chips\"].msg }),\r\n    ];\r\n    TimedWorker.global.push({ description: `SwitchInjector${mode}`, works: work_sequence });\r\n}\r\n\r\nexport function UniversalDispersalSwitchInjection() {\r\n    const work_sequence: TimedWork[] = [\r\n        new CheckItemsWork([ToolsInjector], (player, result) => {\r\n            if (result.missing.length > 0) {\r\n                ParseMessage(StdMissingMsgBase, { player }, { missing_formated: ToolsInjector.Craft.Name });\r\n                return TimedWorkState.interrupted;\r\n            }\r\n        }),\r\n        new MessageWork({ mode: \"chat-action\", msg: \"Mode switching completed, current mode: general repellent injection\" }),\r\n        new MessageWork({ mode: \"action\", msg: \"With this external power that has never been offered to the Shadow King who rules the world, he turned it into a supreme treasure.\" }),\r\n        new DelayWork(2500),\r\n        new MessageWork({ mode: \"action\", msg: \"Pray for a good harvest and sing the sacred praises\" }),\r\n        new DelayWork(2500),\r\n        new MessageWork({ mode: \"action\", msg: \"The Holy Spirit bestowed upon him a noble gift, which made his name go down in history.\" }),\r\n        new DelayWork(2500),\r\n        new MessageWork({ mode: \"action\", msg: \"We will use our powerful magic power to corrode the spreading filth into mud.\" }),\r\n        new DelayWork(2500),\r\n        new MessageWork({ mode: \"action\", msg: \"We will curb the rampant madness with our firm belief\" }),\r\n        new DelayWork(2500),\r\n        new MessageWork({ mode: \"action\", msg: \"Achieve a thorough intervention of thoughts on matter\" }),\r\n        new DelayWork(2500),\r\n        new MessageWork({ mode: \"chat-action\", msg: \"The currently loaded firmware has been detected to be abnormal, and the default firmware is being reloaded.\" }),\r\n        new DelayWork(5000),\r\n        new MessageWork({ mode: \"chat-action\", msg: \"Firmware recovery complete\" }),\r\n        new MessageWork({ mode: \"chat-action\", msg: \"Mode switching completed, current mode: general repellent injection\" }),\r\n        new MessageWork({ mode: \"action\", msg: \"Complex magic circuits, inherited ancient bloodlines, tedious preparations for casting spells, how can a great magician who takes decades to become a master avoid being caught up by technology? The low threshold for using technology has never been comparable to those magicians who require so-called bloodlines and origins.\" })\r\n    ];\r\n    TimedWorker.global.push({ description: `UniversalDispersalInjectionSwitchSequence`, works: work_sequence });\r\n} \r\n","import { DoInjection } from \"../../Control/SequenceCtrl/InjectionSequence\";\r\nimport { SwitchInjector } from \"../../Control/SequenceCtrl/InjectionSequence/SwitchInjector\";\r\nimport { UniversalDispersalSwitchInjection } from \"../../Control/SequenceCtrl/InjectionSequence/SwitchInjector\";\r\nimport { CommandTemplate } from \"../ICmds\";\r\nimport { BasicPrerequisites, IsSelf } from \"../Prerequistes\";\r\n\r\nexport const InjectionCmds: CommandTemplate[] = [\r\n    {\r\n        match: /^(注射麻醉剂)|(anesthetic)/i,\r\n        prerequisite: BasicPrerequisites,\r\n        run(player, sender, content) {\r\n            DoInjection('anesthetic');\r\n        }\r\n    },\r\n    {\r\n        match: /^(注射恢复剂)|(recovery agent)/i,\r\n        prerequisite: BasicPrerequisites,\r\n        run(player, sender, content) {\r\n            DoInjection('pickmeup');\r\n        }\r\n    },\r\n    {\r\n        match: /^(注射催情剂)|(aphrodisiac)/i,\r\n        prerequisite: BasicPrerequisites,\r\n        run(player, sender, content) {\r\n            DoInjection('aphrodisiac');\r\n        }\r\n    },\r\n    {\r\n        match: /^(注射抑制剂)|(inhibitor)/i,\r\n        prerequisite: BasicPrerequisites,\r\n        run(player, sender, content) {\r\n            DoInjection('inhibitor');\r\n        }\r\n    },\r\n    {\r\n        match: /^(泛用驱散剂)|(general repellent)/i,\r\n        prerequisite: BasicPrerequisites,\r\n        run(player, sender, content) {\r\n            DoInjection('EasterUniversalDispersal');\r\n        }\r\n    }\r\n]\r\n\r\nexport const InjectionSwitchCmds: CommandTemplate[] = [\r\n    {\r\n        match: /^(身份芯片)|(ID chip)/i,\r\n        prerequisite: IsSelf,\r\n        run(player, sender, content) {\r\n            SwitchInjector('ID chip', undefined);\r\n        }\r\n    },\r\n    {\r\n        match: /^(催情剂)|(aphrodisiac)/i,\r\n        prerequisite: IsSelf,\r\n        run(player, sender, content) {\r\n            SwitchInjector('aphrodisiac', 'aphrodisiac');\r\n        }\r\n    },\r\n    {\r\n        match: /^(抑制剂)|(inhibitor)/i,\r\n        prerequisite: IsSelf,\r\n        run(player, sender, content) {\r\n            SwitchInjector('inhibitor', 'inhibitor');\r\n        }\r\n    },\r\n    {\r\n        match: /^(麻醉剂)|(anesthetic)/i,\r\n        prerequisite: IsSelf,\r\n        run(player, sender, content) {\r\n            SwitchInjector('anesthetic', 'anesthetic');\r\n        }\r\n    },\r\n    {\r\n        match: /^(恢复剂)|(pickmeup)/i,\r\n        prerequisite: IsSelf,\r\n        run(player, sender, content) {\r\n            SwitchInjector('pickmeup', 'pickmeup');\r\n        }\r\n    }, {\r\n        match: /^(泛用驱散剂)|(EasterUniversalDispersal)/i,\r\n        prerequisite: IsSelf,\r\n        run(player, sender, content) {\r\n            UniversalDispersalSwitchInjection();\r\n        }\r\n    }\r\n]","import { ItemCmds } from \"./ItemCmds\";\r\nimport { OutfitCmds } from \"./OutfitCmds\";\r\nimport { PermCmds } from \"./PermCmds\";\r\nimport { RoomCmds } from \"./RoomCmds\";\r\nimport { TaskPointsCmds, SelfPointCmds } from \"./PointsCmds\";\r\nimport { StatCmds } from \"./StatCmds\";\r\nimport { InjectionCmds, InjectionSwitchCmds } from \"./InjectionCmds\";\r\n\r\nexport const Commands = [ItemCmds, RoomCmds, PermCmds, OutfitCmds, StatCmds, TaskPointsCmds, InjectionCmds].flat();\r\n\r\nexport const PointCommands = [SelfPointCmds].flat();\r\n\r\nexport const InjectionSwCommands = [InjectionSwitchCmds].flat();","import { GetCommandPrefix, GetWolfGirlName } from \"../Control/WolfGirlCtrl\";\r\nimport { AppearanceUpdate } from \"bc-utilities\";\r\nimport { Commands, InjectionSwCommands, PointCommands } from \"./Commands\";\r\nimport { CommandArgs, CommandTemplate } from \"./ICmds\";\r\n\r\n\r\nfunction Strip(src: string) {\r\n    return src.replace(/^[\\s\\p{P}]*/u, \"\");\r\n}\r\n\r\nexport function RunCommands(player: PlayerCharacter, sender: number | Character, content: string, args: CommandArgs) {\r\n    content = Strip(content).toLowerCase();\r\n    const usepoints = \"use reward points\";\r\n    const switchInjector = \"injection gun mode switch\";\r\n    const testRegex = GetCommandPrefix(player);\r\n\r\n    let cmdSeries: CommandTemplate[] | undefined = undefined;\r\n\r\n    const match = testRegex.exec(content);\r\n\r\n    if (match) {\r\n        content = content.slice(match[0].length);\r\n        content = Strip(content);\r\n        cmdSeries = Commands;\r\n    } else if (content.startsWith(usepoints)) {\r\n        content = content.slice(usepoints.length);\r\n        content = Strip(content);\r\n        cmdSeries = PointCommands;\r\n    } else if (content.startsWith(switchInjector)) {\r\n        content = content.slice(switchInjector.length);\r\n        content = Strip(content);\r\n        cmdSeries = InjectionSwCommands;\r\n    }\r\n\r\n    if (!cmdSeries) return;\r\n\r\n    for (const cmd of cmdSeries) {\r\n        if (cmd.type && cmd.type !== args.type) continue;\r\n        if (!cmd.prerequisite(player, sender)) continue;\r\n        const result = cmd.match.exec(content);\r\n        if (result) {\r\n            cmd.run(player, sender, result, args);\r\n            AppearanceUpdate(player);\r\n            return;\r\n        }\r\n    }\r\n}","import { ActivityInfo, ChatRoomHandler } from \"bc-utilities\";\r\nimport { RunCommands } from \"./Run\";\r\nimport { TaskCtrl } from \"../Control/TaskCtrl/TaskCtrl\";\r\nimport { ModSDKModAPI } from \"bondage-club-mod-sdk\";\r\nimport { ActivityProvider } from \"./Activity\";\r\n\r\nexport function BeepRawHandler(player: PlayerCharacter, data: ServerAccountBeepResponse) {\r\n    if (!data.MemberName || !data.MemberNumber || typeof data.Message !== 'string') return;\r\n    if (player.GhostList && player.GhostList.indexOf(data.MemberNumber) >= 0) return;\r\n\r\n    const room = (() => {\r\n        if (data.ChatRoomName !== undefined && data.ChatRoomSpace !== undefined) return { name: data.ChatRoomName, space: data.ChatRoomSpace };\r\n        return undefined;\r\n    })();\r\n\r\n    RunCommands(player, data.MemberNumber, data.Message, { type: \"Beep\", BeepRoom: room });\r\n}\r\n\r\n\r\nfunction ChatRoomChat(player: PlayerCharacter, sender: Character, msg: string, type: string) {\r\n    if (type === \"Chat\" || type === \"Whisper\") RunCommands(player, sender, msg, { type });\r\n}\r\n\r\nfunction ChatRoomActivity(player: PlayerCharacter, sender: Character, data: ActivityInfo) {\r\n    ActivityProvider.run(player, sender, data);\r\n    TaskCtrl.instance.onActivity(player, sender, data);\r\n}\r\n\r\nexport function BeepHandler(mod: ModSDKModAPI) {\r\n    mod.hookFunction('ServerAccountBeep', 2, (args, next) => {\r\n        next(args);\r\n        if (Player) BeepRawHandler(Player, args[0]);\r\n    });\r\n}\r\n\r\nexport function ChatHandler(handler: ChatRoomHandler) {\r\n    handler.onReceiveActivity(ChatRoomActivity);\r\n    handler.onReceiveChatWhisperEmote(ChatRoomChat);\r\n}","import { OutfitItems } from \"../Control/OutfitCtrl\";\r\nimport { DefaultCheckItemOnTarget, DefaultCheckOutfitItem } from \"../Control/OutfitCtrl/Utils\";\r\nimport { ModName, ModVersion } from \"../Definition\";\r\nimport { EILNetwork } from \"../Network\";\r\nimport { GatherAppMap } from \"../utils/Apperance\";\r\nimport { ChatRoomAction } from \"bc-utilities\";\r\n\r\nconst CmdDetails: Map<string, (...args: string[]) => void> = new Map([[\"check\", ChatCmdOutfitCheck]])\r\n\r\nconst WolfGirlCmds: ICommand[] = [\r\n    {\r\n        Tag: \"wolfgirl\",\r\n        Description: `<${[...CmdDetails.keys()].join(\"|\")}> <Parameters> : WolfGirl Mod Commands`,\r\n        Action: ChatCmdRouter\r\n    }\r\n]\r\n\r\nfunction ChatCmdRouter(args: string, command: string) {\r\n    const [, ...parts] = command.split(\" \");\r\n    const cmd = parts?.shift();\r\n    if (!cmd || !CmdDetails.has(cmd)) {\r\n        ChatRoomAction.instance.LocalInfo(`Command error, you can use the command: wolfgirl<${[...CmdDetails.keys()].join(\"|\")}> <parameter>`);\r\n        return;\r\n    }\r\n    CmdDetails.get(cmd)?.(...parts);\r\n}\r\n\r\nfunction ChatCmdOutfitCheck(...args: string[]) { //TODO \r\n    const targetN = parseInt(args[0]);\r\n    if (isNaN(targetN)) {\r\n        ChatRoomAction.instance.LocalInfo(\"Command error: Usage: wolfgirl check <target ID>\");\r\n        return;\r\n    }\r\n    const target = ChatRoomCharacter.find(c => c.MemberNumber === targetN);\r\n    if (!target) {\r\n        ChatRoomAction.instance.LocalInfo(\"Command error: Target not found\");\r\n        return;\r\n    }\r\n\r\n    const app_map = GatherAppMap(target);\r\n    const craft = EILNetwork.Access.craft;\r\n\r\n    ChatRoomAction.instance.LocalInfo(`>> ${ModName} ${ModVersion} Debug Mode\\n`);\r\n\r\n    OutfitItems.forEach((i, idx) => {\r\n        const target_item = app_map.get(i.Asset.Group);\r\n        const msglist: string[] = []\r\n\r\n        msglist.push(`>> Check work sequence${idx + 1}`)\r\n        msglist.push(`  item: ${i.Asset.Name}`)\r\n        msglist.push(`  position: ${i.Asset.Group}`)\r\n        msglist.push(`  configuration：${i.Craft.Name}`)\r\n\r\n        if (!target_item) {\r\n            msglist.push(`  wearing: undefined`)\r\n            msglist.push(`  concluding: failed`)\r\n        } else {\r\n            msglist.push(`  wearing: ${target_item.Asset.Name}`)\r\n            msglist.push(`  color: ${target_item.Color}`)\r\n\r\n            const check = DefaultCheckItemOnTarget(target, i);\r\n            const checkRaw = DefaultCheckOutfitItem(target_item, i);\r\n\r\n            if (!check) {\r\n                msglist.push(`  CheckItemOnTarget: ${check}`)\r\n            } else {\r\n                msglist.push(`  CheckItemOnTarget: ${check}`)\r\n                msglist.push(`  CheckOutfitItem: ${checkRaw}`)\r\n                msglist.push(`  LockedBy: ${target_item.Property?.LockedBy}`)\r\n                msglist.push(`  TypeRecord: ${JSON.stringify(target_item.Property?.TypeRecord)}`)\r\n            }\r\n\r\n            msglist.push(`  concluding: ${check && checkRaw ? \"passed\" : \"failed\"}`)\r\n        }\r\n\r\n        ChatRoomAction.instance.LocalInfo(msglist.join(\"\\n\") + \"\\n\");\r\n    })\r\n}\r\n\r\nexport function InitChatCmds(lateHook: (callback: () => void) => void) {\r\n    lateHook(() => CommandCombine(WolfGirlCmds))\r\n}","import { TaskCtrl } from \"./TaskCtrl\";\r\nimport { DataManager } from \"../../Data\";\r\nimport { ResistTask } from \"./ResistTask\";\r\nimport { InteractTask } from \"./InteractTask\";\r\nimport { BegOrgasmTask } from \"./BegOrgasmTask\";\r\nimport { ParseMessage } from \"../Message\";\r\nimport { ITask } from \"./ITask\";\r\nimport { OrgasmMonitor } from \"bc-utilities\";\r\n\r\n\r\nexport function TaskCtrlInit(time_reso: number, om: OrgasmMonitor) {\r\n    TaskCtrl.init(time_reso, om);\r\n\r\n    const PushTask = (player: PlayerCharacter, t: ITask) => {\r\n        ParseMessage({ mode: \"action\", msg: `{player_wg} automatically accepts the task due to low reward points:\\n${t.summary()}` }, { player });\r\n        TaskCtrl.instance.push_task(t);\r\n    }\r\n\r\n    const RandomTaskList = [\r\n        (point: number) => new ResistTask(1, 5, point),\r\n        (point: number) => new ResistTask(2, 10, point),\r\n        (point: number) => new InteractTask(2, 10, point, undefined, ['ItemBreast', 'ItemNipplesPiercings', 'ItemNipples']),\r\n        (point: number) => new InteractTask(2, 10, point, undefined, ['ItemVulva', 'ItemPelvis', 'ItemVulvaPiercings']),\r\n        (point: number) => new InteractTask(2, 10, point, [\"Slap\", \"Spank\", \"Kick\", \"SpankItem\"], undefined),\r\n        (point: number) => new BegOrgasmTask(2, 5, point)\r\n    ]\r\n\r\n    let check_timer = Date.now();\r\n    setInterval(() => {\r\n        if (Player && Player.MemberNumber && DataManager.instance) {\r\n            const now = Date.now();\r\n            const ten_min_after = 10 * 60 * 1000 + check_timer;\r\n            if (TaskCtrl.instance.has_task() || CurrentScreen !== \"ChatRoom\") check_timer = now;\r\n            else if (now > ten_min_after) {\r\n                check_timer = now;\r\n                if (DataManager.points.points < -14) {\r\n                    const bonus = - 14 - DataManager.points.points;\r\n                    const task = RandomTaskList[Math.floor(Math.random() * RandomTaskList.length)](bonus);\r\n                    PushTask(Player, task);\r\n                }\r\n            }\r\n        }\r\n    }, time_reso);\r\n}","import { DataManager } from \"../Data\";\r\nimport { IsPlayerWolfGirl } from \"./WolfGirlCtrl\";\r\n\r\nexport class TimeStat {\r\n    private timer: number;\r\n\r\n    constructor(readonly resolution: number) {\r\n        this.timer = Date.now();\r\n        setInterval(() => {\r\n            if (Player && Player.MemberNumber && DataManager.instance) {\r\n                const time = Date.now();\r\n                const isWolfGirl = IsPlayerWolfGirl(Player);\r\n                const isStashed = DataManager.outfit.items.size > 0;\r\n                DataManager.statistics.add_time(isWolfGirl, isStashed, time - this.timer);\r\n                this.timer = time;\r\n            }\r\n        }, resolution);\r\n    }\r\n\r\n    private static _instance: TimeStat | undefined = undefined;\r\n    static init(resolution: number) {\r\n        if (TimeStat._instance) return;\r\n        TimeStat._instance = new TimeStat(resolution);\r\n    }\r\n    static get instance() {\r\n        return TimeStat._instance as TimeStat;\r\n    }\r\n}","import { AppearanceUpdate } from \"bc-utilities\";\r\nimport { CheckItemsWork, CommonWork } from \"./CommonWork\";\r\nimport { ParseMessage } from \"./Message\";\r\nimport { MessageWork } from \"./MessageWork\";\r\nimport { CheckItem, ToolsInjector, ToolsVisor } from \"./OutfitCtrl\";\r\nimport { TimedWork, TimedWorkState, TimedWorker } from \"./Worker\";\r\n\r\nexport function InitSafetyUndressSequence(player: PlayerCharacter): void {\r\n    const work_sequence: TimedWork[] = [\r\n        new CheckItemsWork([ToolsVisor, ToolsInjector], (player, result) => {\r\n            if (result.missing.length == 2) {\r\n                return TimedWorkState.interrupted;\r\n            } else {\r\n                ParseMessage({ mode: \"local\", msg: \"It is found that the registered installation props have not been used for a long time, and the automatic storage process begins.\" });\r\n            }\r\n        }, false),\r\n        new CommonWork((player) => {\r\n            if (CheckItem(player, ToolsInjector, false)) {\r\n                player.Appearance = player.Appearance.filter(i => i.Asset.Group.Name !== ToolsInjector.Asset.Group);\r\n                AppearanceUpdate(player, ToolsInjector.Asset.Group);\r\n                ParseMessage({ mode: \"local\", msg: `${ToolsInjector.Craft.Name}Completed storage` });\r\n            }\r\n        }),\r\n        new CommonWork((player) => {\r\n            if (CheckItem(player, ToolsVisor, false)) {\r\n                player.Appearance = player.Appearance.filter(i => i.Asset.Group.Name !== ToolsVisor.Asset.Group);\r\n                AppearanceUpdate(player, ToolsVisor.Asset.Group);\r\n                ParseMessage({ mode: \"local\", msg: `${ToolsVisor.Craft.Name}Completed storage` });\r\n            }\r\n        }),\r\n        new MessageWork({ mode: \"local\", msg: \"The system reminds you: Do not play with tools in your hands, as this is dangerous.\" }),\r\n    ]\r\n    TimedWorker.global.push({ description: \"InitSafetyUndressSequence\", works: work_sequence });\r\n}\r\n\r\nexport class ToolsSafety {\r\n    private holdStart: number = 0;\r\n    constructor(readonly resolution: number) {\r\n        setInterval(() => {\r\n            if (Player && Player.MemberNumber) {\r\n                if (TimedWorker.global.cur_description !== undefined) {\r\n                    this.holdStart = 0;\r\n                } else if (CheckItem(Player, ToolsVisor, false) && CheckItem(Player, ToolsInjector)) {\r\n                    if (this.holdStart === 0) this.holdStart = Date.now();\r\n                    else if (Date.now() - this.holdStart > 300000) {\r\n                        InitSafetyUndressSequence(Player);\r\n                        this.holdStart = 0;\r\n                    }\r\n                }\r\n            }\r\n        }, resolution);\r\n    }\r\n\r\n\r\n    private static _instance: ToolsSafety | undefined;\r\n    static get instance() { return this._instance as ToolsSafety; }\r\n    static init(resolution: number) {\r\n        if (this._instance) return;\r\n        this._instance = new ToolsSafety(resolution);\r\n    }\r\n\r\n}","import { AppearanceUpdate, OrgasmMonitor, buildItemsMap } from \"bc-utilities\"\r\nimport { IsPlayerWolfGirl } from \"./WolfGirlCtrl\";\r\nimport { DataManager } from \"../Data\";\r\nimport { OutfitItemsMap } from \"./OutfitCtrl\";\r\nimport { FuturisticBypass } from \"./WolfGirlCtrl/Ctrls/FuturisticBypass\";\r\nimport { ParseMessage } from \"./Message\";\r\nimport { DoShockPunish } from \"./PunishWork\";\r\nimport { DefaultCheckOutfitItem } from \"./OutfitCtrl/Utils\";\r\n\r\ntype ModeStashSpecialType = {\r\n    value: string\r\n}\r\n\r\ntype ModeStashDefaultType = {\r\n    value: TypeRecord\r\n}\r\n\r\ntype ModeStashType = ModeStashDefaultType | ModeStashSpecialType;\r\n\r\nconst ItemMode: {\r\n    [key in AssetGroupItemName]?: ModeStashType\r\n} = {\r\n    ItemHead: {\r\n        value: { typed: 3 }\r\n    },\r\n    ItemEars: {\r\n        value: { typed: 3 }\r\n    },\r\n    ItemMouth: {\r\n        value: { g: 2 }\r\n    },\r\n    ItemArms: {\r\n        value: { typed: 3 }\r\n    },\r\n    ItemHands: {\r\n        value: { typed: 0 }\r\n    },\r\n    ItemLegs: {\r\n        value: { typed: 1 }\r\n    },\r\n    ItemFeet: {\r\n        value: { typed: 1 }\r\n    },\r\n    ItemVulva: {\r\n        value: \"special\"\r\n    },\r\n}\r\n\r\nconst SavedItemMode: {\r\n    [key in AssetGroupItemName]?: ModeStashType & { time: number }\r\n} = {}\r\n\r\nfunction isSpecialMode(target: ModeStashType): target is ModeStashSpecialType {\r\n    return typeof target.value === \"string\";\r\n}\r\n\r\nfunction isDefaultMode(target: ModeStashType): target is ModeStashDefaultType {\r\n    return !isSpecialMode(target);\r\n}\r\n\r\nfunction stdCanSetPunishedMode(item: Item, target: ModeStashDefaultType): boolean {\r\n    const tr = item.Property?.TypeRecord;\r\n    if (tr === undefined) return false;\r\n    return Object.keys(target.value).some(key => {\r\n        return tr[key] !== target.value[key];\r\n    });\r\n}\r\n\r\nfunction stdCanRestorePunishedMode(item: Item, saved: ModeStashDefaultType | undefined): saved is ModeStashDefaultType {\r\n    const tr = item.Property?.TypeRecord;\r\n    if (tr === undefined) return false;\r\n    if (saved === undefined) return false;\r\n    return Object.keys(saved.value).some(key => tr[key]);\r\n}\r\n\r\nfunction stdSetPunishedMode(player: PlayerCharacter, item: Item, target: ModeStashDefaultType) {\r\n    const tr = item.Property?.TypeRecord;\r\n    if (tr === undefined) return;\r\n\r\n    const saved: TypeRecord = {};\r\n    Object.keys(target.value).forEach(key => saved[key] = tr[key]);\r\n    FuturisticBypass.instance.on = true;\r\n    ExtendedItemSetOptionByRecord(player, item, target.value);\r\n    FuturisticBypass.instance.on = false;\r\n    SavedItemMode[item.Asset.Group.Name as AssetGroupItemName] = { time: Date.now(), value: saved };\r\n}\r\n\r\nfunction stdRestorePunishedMode(player: PlayerCharacter, item: Item, saved: ModeStashDefaultType) {\r\n    const tr = item.Property?.TypeRecord;\r\n    if (tr === undefined) return;\r\n    FuturisticBypass.instance.on = true;\r\n    ExtendedItemSetOptionByRecord(player, item, saved.value, { push: true });\r\n    FuturisticBypass.instance.on = false;\r\n}\r\n\r\nfunction canPunish(item: Item, target: ModeStashType | undefined): boolean {\r\n    if (target === undefined) return false;\r\n    if (isDefaultMode(target)) {\r\n        return stdCanSetPunishedMode(item, target);\r\n    }\r\n    if (isSpecialMode(target)) {\r\n        if (item.Asset.Group.Name === \"ItemVulva\") {\r\n            const triggerValue = item.Property?.TriggerValues;\r\n            if (triggerValue === undefined) return false;\r\n            const lls = triggerValue.split(\",\")\r\n            return lls[lls.length - 1] !== \"*\";\r\n        } else return false;\r\n    }\r\n    return false;\r\n}\r\n\r\nfunction doPunish(player: PlayerCharacter, item: Item, target: ModeStashType) {\r\n    if (isDefaultMode(target)) {\r\n        stdSetPunishedMode(player, item, target);\r\n    }\r\n    if (isSpecialMode(target)) {\r\n        if (item.Asset.Group.Name === \"ItemVulva\") {\r\n            if (item.Property?.TriggerValues === undefined) return;\r\n            const lls = item.Property.TriggerValues.split(\",\");\r\n            const saved = lls[lls.length - 1];\r\n            lls[lls.length - 1] = \"*\";\r\n            item.Property.TriggerValues = lls.join(\",\");\r\n            AppearanceUpdate(player, item.Asset.Group.Name);\r\n            SavedItemMode[item.Asset.Group.Name as AssetGroupItemName] = { time: Date.now(), value: saved };\r\n        }\r\n    }\r\n}\r\n\r\nfunction canRestore(item: Item, saved: ModeStashType | undefined): boolean {\r\n    if (saved === undefined) return false;\r\n    if (isDefaultMode(saved)) {\r\n        return stdCanRestorePunishedMode(item, saved);\r\n    }\r\n    if (isSpecialMode(saved)) {\r\n        if (item.Asset.Group.Name === \"ItemVulva\") {\r\n            const triggerValue = item.Property?.TriggerValues;\r\n            if (triggerValue === undefined) return false;\r\n            const lls = triggerValue.split(\",\")\r\n            if (lls[lls.length - 1] !== saved.value) return true;\r\n            else {\r\n                SavedItemMode[item.Asset.Group.Name as AssetGroupItemName] = undefined;\r\n                return false;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    return false;\r\n}\r\n\r\nfunction doRestore(player: PlayerCharacter, item: Item, saved: ModeStashType) {\r\n    if (isDefaultMode(saved)) {\r\n        stdRestorePunishedMode(player, item, saved);\r\n    }\r\n    if (isSpecialMode(saved)) {\r\n        if (item.Asset.Group.Name === \"ItemVulva\") {\r\n            if (item.Property?.TriggerValues === undefined) return;\r\n            const lls = item.Property.TriggerValues.split(\",\");\r\n            lls[lls.length - 1] = saved.value;\r\n            item.Property.TriggerValues = lls.join(\",\");\r\n            AppearanceUpdate(player, item.Asset.Group.Name);\r\n            SavedItemMode[item.Asset.Group.Name as AssetGroupItemName] = undefined;\r\n        }\r\n    }\r\n}\r\n\r\nfunction randomPick<T>(src: T[]): T {\r\n    return src[Math.floor(Math.random() * src.length)];\r\n}\r\n\r\nexport class OrgasmPunishMode {\r\n    onOrgasm(player: PlayerCharacter) {\r\n        if (!IsPlayerWolfGirl(player)) return;\r\n        const pModeValue = DataManager.settings.query(\"orgasmPunishMode\");\r\n        if (pModeValue === 0) return;\r\n\r\n        const canShockList = player.Appearance.filter(item => item.Asset.Group.Category === \"Item\")\r\n            .filter(item => DefaultCheckOutfitItem(item, OutfitItemsMap.get(item.Asset.Group.Name)))\r\n\r\n        DoShockPunish(player, randomPick(canShockList));\r\n\r\n        const canPunishList = canShockList.filter(item => canPunish(item, ItemMode[item.Asset.Group.Name as AssetGroupItemName]));\r\n        if (canPunishList.length === 0) {\r\n            const v = 1;\r\n            DataManager.points.points -= v;\r\n            ParseMessage({ mode: \"action\", msg: \"{player_wg} has deducted {v} points, and the current points are {points}\" }, { player }, { v, points: DataManager.points.points });\r\n        } else {\r\n            const target = randomPick(canPunishList);\r\n            doPunish(player, target, ItemMode[target.Asset.Group.Name as AssetGroupItemName] as ModeStashType);\r\n            ParseMessage({ mode: \"chat-action\", msg: \"Oh, how does it feel? {player_wg}, do you know what this icon means now? Will you endure for the sake of freedom, or will you indulge yourself and sink into depravity and become a puppet?\" }, { player })\r\n        }\r\n    }\r\n\r\n    private resistCounter = 0;\r\n    onResist(player: PlayerCharacter) {\r\n        if (!IsPlayerWolfGirl(player)) return;\r\n\r\n        const pModeValue = DataManager.settings.query(\"orgasmPunishMode\");\r\n        if (pModeValue === 0) return;\r\n        this.resistCounter++;\r\n\r\n        if (pModeValue === 2 && this.resistCounter <= 4) return;\r\n        if (pModeValue === 1 && this.resistCounter <= 2) return;\r\n\r\n        this.resistCounter = 0;\r\n        const canRestoreList = player.Appearance.filter(item => item.Asset.Group.Category === \"Item\")\r\n            .filter(item => DefaultCheckOutfitItem(item, OutfitItemsMap.get(item.Asset.Group.Name)))\r\n            .filter(item => typeof SavedItemMode[item.Asset.Group.Name as AssetGroupItemName] === \"object\")\r\n            .filter(item => canRestore(item, ItemMode[item.Asset.Group.Name as AssetGroupItemName]))\r\n\r\n        if (canRestoreList.length === 0) return;\r\n        const pick = randomPick(canRestoreList);\r\n        doRestore(player, pick, SavedItemMode[pick.Asset.Group.Name as AssetGroupItemName] as ModeStashType);\r\n        ParseMessage({ mode: \"chat-action\", msg: \"Well done, {player_wg}. It looks like your hard work and perseverance paid off. So, good kids will naturally be rewarded. Keep up the hard work, ok?\" }, { player });\r\n\r\n    }\r\n\r\n    constructor(readonly org: OrgasmMonitor, readonly time_reso: number = 200) {\r\n        setInterval(() => {\r\n            if (!Player || !IsPlayerWolfGirl(Player)) {\r\n                Object.keys(SavedItemMode).forEach(key => SavedItemMode[key as AssetGroupItemName] = undefined);\r\n                return;\r\n            }\r\n\r\n            const pModeValue = DataManager.settings.query(\"orgasmPunishMode\");\r\n            if (pModeValue === 0 || pModeValue === 2) return;\r\n            const punish_time = DataManager.points.orgasm_punish_time;\r\n            const now = Date.now();\r\n            const itemsMap = buildItemsMap(Player);\r\n\r\n            for (const [key, value] of Object.entries(SavedItemMode)) {\r\n                if (value === undefined) continue;\r\n\r\n                const item = itemsMap.get(key as AssetGroupItemName);\r\n\r\n                if (item === undefined || !DefaultCheckOutfitItem(item, OutfitItemsMap.get(item.Asset.Group.Name))) {\r\n                    SavedItemMode[key as AssetGroupItemName] = undefined;\r\n                    continue;\r\n                }\r\n\r\n                if (now - value.time > punish_time) {\r\n                    doRestore(Player, item, value);\r\n                    SavedItemMode[key as AssetGroupItemName] = undefined;\r\n                }\r\n            }\r\n        }, time_reso);\r\n\r\n        org.onOrgasm(p => this.onOrgasm(p));\r\n        org.onResist(p => this.onResist(p));\r\n    }\r\n\r\n    static _instance: OrgasmPunishMode | undefined = undefined;\r\n    static init(org: OrgasmMonitor) {\r\n        if (this._instance) return;\r\n        this._instance = new OrgasmPunishMode(org);\r\n    }\r\n}","import { ModSDKModAPI } from \"bondage-club-mod-sdk\";\r\nimport { Tools } from \"./Definition\";\r\nimport { ItemFromOutfit } from \"./Utils\";\r\n\r\nfunction DialogInventoryBuildHandler(C: Character, lock: boolean) {\r\n    if (lock) return;\r\n\r\n    Tools.forEach(e => {\r\n        const focus = C.FocusGroup?.Name;\r\n        if (!focus || focus !== e.Asset.Group) return;\r\n\r\n        const item = ItemFromOutfit(C, C, e);\r\n\r\n        if (!item || !item.Craft) return;\r\n        if (DialogCanUseCraftedItem(C, item.Craft, item.Asset))\r\n            DialogInventoryAdd(C, { Asset: item.Asset, Craft: item.Craft }, false);\r\n    })\r\n\r\n    DialogInventorySort();\r\n}\r\n\r\nexport function AdditionalInventoryInit(mod: ModSDKModAPI) {\r\n    mod.hookFunction('DialogInventoryBuild', 1, (args, next) => {\r\n        next(args);\r\n        DialogInventoryBuildHandler(args[0] as Character, args[2] as boolean);\r\n    });\r\n}","import bcMod from 'bondage-club-mod-sdk'\r\nimport { CUSTOM_ACTION_TAG, GIT_REPO, ModName, ModVersion, SCRIPT_ID } from './Definition';\r\nimport { BeepHandler, ChatHandler } from './ChatRoom/Handler';\r\nimport { TimedWorker } from \"./Control/Worker\";\r\nimport { ChatRoomAction, ChatRoomHandler } from 'bc-utilities';\r\nimport { EILNetwork } from './Network';\r\nimport { WolfGirlCtrlInit, IsPlayerWolfGirl } from './Control/WolfGirlCtrl';\r\nimport { OrgasmMonitor } from 'bc-utilities';\r\nimport { DataManager } from \"./Data\";\r\nimport { ChatRoomWork } from './Control/RoomCtrl/Work';\r\nimport { InjectionManager } from './Control/Injection';\r\nimport { InitChatCmds } from './ChatRoom/OutfitCheckChatCmd';\r\nimport { TaskCtrlInit } from './Control/TaskCtrl';\r\nimport { TimeStat } from './Control/TimeStat';\r\nimport { ToolsSafety } from './Control/ToolsSafety';\r\nimport { OrgasmPunishMode } from './Control/OrgasmPunishMode';\r\nimport { AdditionalInventoryInit } from './Control/OutfitCtrl/Inventory';\r\nimport { ActivityProvider } from './ChatRoom/Activity';\r\n\r\n(function () {\r\n    if (window.__load_flag__) return;\r\n    window.__load_flag__ = false;\r\n\r\n    const this_script_src = document.getElementById(SCRIPT_ID)?.getAttribute('src');\r\n    if (!this_script_src) {\r\n        console.error('WolfGirlLoader not found.');\r\n        return;\r\n    }\r\n    const asset_url = this_script_src.substring(0, this_script_src.lastIndexOf('/') + 1) + 'assets/';\r\n\r\n\r\n    const mod = bcMod.registerMod({\r\n        name: ModName,\r\n        fullName: ModName,\r\n        version: ModVersion,\r\n        repository: GIT_REPO\r\n    });\r\n    const lateHooks: (() => void)[] = [];\r\n    const lateHook = (callback: () => void) => lateHooks.push(callback);\r\n\r\n    OrgasmMonitor.init(mod).then(orgasm =>\r\n        DataManager.init(mod, `${ModName} v${ModVersion} loaded.`).then(\r\n            _ => {\r\n                DataManager.arousal.setMonitor((pl) => IsPlayerWolfGirl(pl), orgasm);\r\n                TaskCtrlInit(1000, orgasm);\r\n                OrgasmPunishMode.init(orgasm);\r\n            }));\r\n\r\n    TimedWorker.init(1000);\r\n    TimeStat.init(1000);\r\n    ToolsSafety.init(10000);\r\n    EILNetwork.init(asset_url);\r\n    ChatRoomAction.init(CUSTOM_ACTION_TAG);\r\n\r\n    BeepHandler(mod);\r\n    ChatRoomHandler.init(mod).then(handler => ChatHandler(handler));\r\n    AdditionalInventoryInit(mod);\r\n\r\n    WolfGirlCtrlInit(mod, lateHook);\r\n\r\n    ActivityProvider.init(mod);\r\n\r\n    ChatRoomWork.init(mod, lateHook);\r\n    InjectionManager.init(mod, lateHook);\r\n\r\n    let initial_notify_not_shown = true;\r\n    mod.hookFunction('ChatRoomRun', 20, (args, next) => {\r\n        next(args);\r\n        if (initial_notify_not_shown) {\r\n            ChatRoomAction.instance.LocalAction(`EIL狼女训练套装智能化辅助系统 ${ModVersion} 已加载。`);\r\n            initial_notify_not_shown = false;\r\n        }\r\n    });\r\n\r\n    InitChatCmds(lateHook);\r\n\r\n    (async () => {\r\n        while (typeof (window as any).Player === 'undefined')\r\n            await new Promise(resolve => setTimeout(resolve, 500));\r\n        lateHooks.forEach(hook => hook());\r\n    })();\r\n\r\n    window.__load_flag__ = true;\r\n})()"],"names":["o","e","alert","Error","console","error","t","TextEncoder","n","Array","isArray","r","Set","filter","has","add","i","Map","a","c","warn","s","f","values","patching","get","name","push","hooks","patches","entries","set","sort","priority","size","toString","replaceAll","includes","eval","original","m","errorReporterHooks","hookChainExit","call","apply","this","length","hookEnter","mod","hook","arguments","patchesSources","enter","final","l","precomputed","window","split","slice","join","encode","padStart","toUpperCase","d","originalHash","Object","assign","router","context","contextProperty","p","sdkEntrypoint","currentEntrypoint","hookedByMods","map","patchedByMods","from","u","delete","loaded","g","fullName","version","repository","allowReplace","apiEndpointEnter","unload","hookFunction","indexOf","splice","patchFunction","removePatches","clear","callOriginal","globalThis","getOriginalHash","api","freeze","h","y","bcModSdk","apiVersion","registerMod","getModsInfo","getPatchingInfo","seal","defineProperty","exports","value","ModVersion","ModName","FrequentDataKeyName","DataKeyName","CUSTOM_ACTION_TAG","IController","lateHook","StandardItemTestRecords","items","target","oldrecords","CollectTypeRecords","cur","every","idx","keys","key","RecordsEqual","TReject","TAccept","reason","rejected","some","item","undefined","Property","TypeRecord","StandardItemSetRecords","player","forEach","ExtendedItemSetOptionByRecord","calcRecordValue","type","typed","GlobalKey","AquireGlobal","defaultValue","Promise","resolve","global","handlerGetter","handler","OrgasmMonitor","constructor","events","Orgasm","Resist","Ruined","args","next","C","Progress","IsPlayer","ActivityOrgasmRuined","_","onOrgasm","event","onResist","onRuined","on","callback","init","ActivityDeconstruct","dict","ret","reduce","pv","cv","TargetCharacter","v","SourceCharacter","isSourceCharacter","ActivityName","isActivityName","FocusGroupName","isFocusAssetGroup","Tag","isActivityAsset","Asset","AssetName","GroupName","CraftName","ActivityGroup","BCDictionary","x","ChatRoomAction","instance","_instance","tag","DictItem","Content","Text","SendAction","Player","MemberNumber","ServerSend","Type","Dictionary","SendChat","LocalAction","ChatRoomMessage","Sender","LocalInfo","SendWhisper","Target","SendBeep","Message","BeepType","IsSecret","Result","cal","Function","IsStringArray","buildAppMap","src","Appearance","Group","Name","buildItemsMap","Category","CheckOutfitItem","V","E","option","AllowLock","lock","LockedBy","group","craft","Craft","Description","MemberName","AppearanceUpdate","ChatRoomData","CharacterRefresh","G","ChatRoomCharacterItemUpdate","ChatRoomCharacterUpdate","IActivityCustom","adjustDict","mode","onBodyparts","activity","image","IActivityExtended","IActivityPrerequisite","ActivityFacility","prereqMap","customActMap","actHandlers","prereq","acting","acted","cusPrereq","test","act","splits","activity_name","text","myact","acc","run","sender","info","addPrerequisite","addActivity","ActivityFemale3DCG","ActivityFemale3DCGOrdering","acts","addActivityExtension","ChatRoomHandler","playerJoin","playerLeave","receiveChatOrWhisper","receiveActivity","LastChatRoom","pl","ChatRoomMsgHandler","onAfterPlayerJoin","onBeforePlayerLeave","onReceiveChatWhisperEmote","onReceiveActivity","Priority","Callback","data","msg","metadata","OutfitItems","Color","OverridePriority","OutfitItemsMap","ToolsCrate","ToolsVisor","ToolsInjector","Tools","GatherAppMap","TimedWorkState","TargetMode","TimedWork","TimedWorker","time_reso","work_suites","_state","_timer","setInterval","cur_suite","works","shift","state","finished","interrupted","skip_until","pred","pause","resume","push_front","work","unshift","insert_after_first","cur_description","description","_global","EILNetwork","Time","_data","Date","now","isEIL","uid","uids","room","Access","_Access","fetch","asset_url","then","res","ok","json","last_fetched","force_fetch","ExtractMemberNumber","ItemFromOutfit","num","CalculateLocks","ecraft","Wearer","AssetGet","AssetFamily","Item","ItemProperty","Lock","Private","ExtendedItemInit","Difficulty","difficulty","props","rProps","k","Effect","ExcludeEffect","InventoryLock","OutfitItemManifest","DefaultCheckOutfitItem","DefaultCheckItemOnTarget","find","DefaultCheckItemByGroup","oi","CheckMissingItems","app_map","missing","locking","locked","Ownership","Lovership","FuturisticBypass","startsWith","ItemWearWork","TARGET_ACTED","super","_items","target_num","ItemWearSingle","item_","oldIdx","findIndex","player_num","TARGET_ACTING","outfit","ChatRoomCharacter","ItemOptionWork","_target","_options","ItemOptionSingleI","ItemOptionSingleS","ItemRemoveWork","new_app","ClothRemoveWork","stash","_stash","Clothing","ClothRestoreWork","concat","ItemLockWork","_group","_lock","ItemPropertyWork","property","IsFullyDressed","items_map","IsGroupsDressed","groups","tItems","IsPlayerWolfGirl","ChatOrWhisperToWolfGirl","calcValue","open","OpenPermission","OpenPermissionChastity","OpenPermissionArm","OpenPermissionLeg","close","WolfGirlCtrls","target_item","available_ctrls","typedArgs","pelvis","oldLock","oldMember","LockMemberNumber","compare","DetailedItemTestRecords","Archetype","vibrating","mouth","oldg","AutoPunishUndoTime","collar","collar_props","target_props","WolfGirlCtrlMap","RunControls","ctrl","GetWolfGirlName","StdMissingMsgBase","StdMissingMsgN","StdMissingMsgNPart","StdMissingAction","StdMissing","notify","action","FormatMessage","replace","match","p1","CharacterNickname","ParseMessage","formated","MessageSimWrongCoding","weight","WrongCodingSrc","Math","random","floor","RouteIM","tnum","DelayWork","delay","first_run","_timeout","running","CheckWork","check","message","_check","checked","rmessage","passed","failed","Accepted","Continue","Rejected","Stop","CommonWork","_callback","result","CheckItemsWork","checkLock","TestControlWork","TestRunControls","StdResultBranch","on_missing","on_success","xMessage","StdCmdSequence","messages","work_sequence","missing_result","missing_formated","modes","do_work","ArousalCtrlSequence","off","edge","deny","HearingCtrlSequence","base","total","VisionCtrlSequence","MessageWork","config","WaitResponseWork","options","timeout","_last_query","_then","ChatRoomChatLog","L","SenderMemberNumber","accept","Original","reject","max","accept_msg","reject_msg","DoShockPunish","CurrentCharacter","FocusGroup","CurrentScreen","CommonSetScreen","InformationSheetPreviousModule","InformationSheetPreviousScreen","ElementValue","trim","IsSimpleChat","cur_msg","ChatRoomSendChat","ChatRoomInterceptMessage","ShockIntensity","intensity","Automatic","InventoryShockExpression","PunishWork","timer","punish_flag","InventoryGet","RandomSinglePunishWork","HandsCtrlSequence","missing_route_01","missing_route_02","missing_route_03","missing_route_04","missing_route_05","err_works","FeetCtrlSequence","VoiceCtrlSequence","PermissionUtilities","parent","moderators","permission","save","setLoverMode","arg","loverModerators","setModerator","id","isCommandAuthorized","moderatee","moderator","isEILNet","isOwner","isAdditionModerator","isLover","OutfitUtilities","asset","_color_store","color_store","lite_mode","Validate","defaultData","settings","orgasmPunishMode","stat","script_run_time","wolfgirl_time","stash_time","last_fix_time","task","counter","points","current","punish_time","task_time","orgasm_punish_time","arousal","orgasm","ruined","resist","edge_time","xd","dvalue","ii","color","IsNumberArray","PointsUtilities","use_points","ArousalUtilities","setMonitor","rfilter","cb","StatUtilities","add_time_counter","add_counter","taskKey","count","couter","task_finished","succeed","add_time","isWolfGirl","isStashed","time","set_last_fix_time","DataCategory","isFrequentDataKey","isDefaultDataKey","deserialize","str","prev","LZString","decompressFromBase64","decoded","JSON","parse","serialize","compressToBase64","stringify","SettingUtilities","query","update","WrongDataKeyName","WrongFrequentDataKeyName","ExtensionSettings","PickDefaultData","ServerPlayerExtensionSettingsSync","PickFrequenceData","DataManager","_permission","_outfit","_points","_arousal","_stat","_setting","statistics","load_then_message","wrongDefaultData","wrongFrequentData","load","log","IsSelf","IsModerator","And","prerequisites","Not","prerequisite","BasicPrerequisites","OutfitFixPrerequisites","SelfPrerequisites","ModOrSelfPrerequisites","Or","ItemCmds","content","toLowerCase","ToysCtrlSequence","FuturisticPublicCtrlSequence","IsWorkParamItem","OutfitFixWork","IsStringWorkItem","existed_i","blocked","canRepair","locked_items","do_message","saved_item","expected_i","saved","InitDressSequence","net","clothing_stash","w","Straps","Nose","Mask","IconLock","IconMute","IconX","DressSequence","catch","DressFixSequence","cannot_fix","cumm_counter","create_result_process","IsCollarOn","StashPopResult","PushMissingStopSequence","StartStashSequence","exclude","ti","StashOutfit","StartStashPopSequence","Locked","nitem","Success","StashPopOutfit","ColorSaveSequence","GatherColorStoreItem","OutfitCmds","CheckItem","ExitFixSequence","PermCmds","perm_report","parseInt","arr","ChatRoomWork","onfailed","onfinished","_first_run","ChatRoomPlayerCanJoin","once_after_ChatSearchResultResponse","chatRoomWorkSearchResultTasks","cj","once_before_ChatSearchQuery","ChatRoomSpace","space","ChatSearchResult","MemberCount","MemberLimit","once_after_ChatRoomSync","chatRoomWorkSearchQueryTasks","chatRoomWorkRoomSyncTasks","ChatRoomLeave","RoomCmds","cmd_src","RoomLeaveSequence","CurryRouteIM","dest","RoomForceLeaveSequence","sender_num","target_name","friend","FriendNames","RoomComeHereSequence","BeepRoom","StartPunish","lock_down","toFixed","record","TaskState","ITask","onChat","onActivity","TimedCounterTask","time_limit_rate","expected","bonus","time_out","Failed","Running","finalize","IncreaseAndMessage","BegOrgasmTask","summary","toLocaleTimeString","time_limit","last_interact_num","interact_list","InteractTask","time_report","group_report","_check_groups","AssetGroupGet","act_report","_check_act","ActivityDictionaryText","check_act","check_groups","_interact_list","ResistTask","TaskCtrl","om","_active_task","push_task","has_task","PushTask","TaskPointsCmds","positive","oper","SelfPointCmds","StatCmds","point","day_hour_minute_second","seconds","days","daystring","hours","Orgasmed","Resisted","BreastPlayed","VulvaPlayed","Spanked","toLocaleString","ArousalSettings","Active","ZoneData","AssetGroup","IsItem","PreferenceGetArousalZone","z","value3Zones","Factor","value4Zones","orgasmZones","IInjection","isWorking","onInject","injections","cumulate","duration","disperse","CharacterSetFacialExpression","input","rnd","substring","savedArousal","diff","InjectionManager","working","injection","doInject","remain","aphrodisiac","finish","f_action","inhibitor","anesthetic","pickmeup","EasterUniversalDispersal","DoInjection","instant","InstantInjection","StdInjectionSequence","strings","bodyParts","WolfGirlItemsSwitch","MaxProgress","Prerequisite","TargetSelf","keyword","CanSwitchWGItem","iV","CheckOutfitItemCE","InjectingExtend","oitem","DefaultCheckItems","InjectedExtend","DrinkExtend","RedbullDrinkTimeout","tItem","DrinkAphrodisiac","DrinkRedbull","ActivityOrgasmPrepare","Action","PrevItem","NextItem","ActivityProvider","injector","facility","switchInjectorMessages","chips","SwitchInjector","InjectionCmds","InjectionSwitchCmds","UniversalDispersalSwitchInjection","Commands","flat","PointCommands","InjectionSwCommands","Strip","RunCommands","usepoints","switchInjector","cmdSeries","RegExp","exec","cmd","ChatRoomChat","ChatRoomActivity","BeepHandler","GhostList","ChatRoomName","BeepRawHandler","CmdDetails","targetN","isNaN","msglist","checkRaw","WolfGirlCmds","command","parts","TaskCtrlInit","RandomTaskList","check_timer","ten_min_after","TimeStat","resolution","ToolsSafety","holdStart","InitSafetyUndressSequence","ItemMode","ItemHead","ItemEars","ItemMouth","ItemArms","ItemHands","ItemLegs","ItemFeet","ItemVulva","SavedItemMode","isSpecialMode","isDefaultMode","canPunish","tr","stdCanSetPunishedMode","triggerValue","TriggerValues","lls","doPunish","stdSetPunishedMode","canRestore","stdCanRestorePunishedMode","doRestore","stdRestorePunishedMode","randomPick","OrgasmPunishMode","canShockList","canPunishList","pModeValue","resistCounter","canRestoreList","pick","org","itemsMap","AdditionalInventoryInit","focus","DialogCanUseCraftedItem","DialogInventoryAdd","DialogInventorySort","BCWolfGirl_Loaded","this_script_src","document","getElementById","getAttribute","lastIndexOf","bcMod","lateHooks","ChatHandler","WolfGirlCtrlInit","initial_notify_not_shown","CommandCombine","InitChatCmds","setTimeout"],"mappings":"wCAGA,WAAqC,MAAMA,EAAE,QAAQ,SAASC,EAAED,GAAGE,MAAM,eAAeF,GAAG,MAAMC,EAAE,IAAIE,MAAMH,GAAG,MAAMI,QAAQC,MAAMJ,GAAGA,CAAC,CAAC,MAAMK,EAAE,IAAIC,YAAY,SAASC,EAAER,GAAG,QAAQA,GAAG,iBAAiBA,IAAIS,MAAMC,QAAQV,EAAE,CAAC,SAASW,EAAEX,GAAG,MAAMC,EAAE,IAAIW,IAAI,OAAOZ,EAAEa,QAAQb,IAAIC,EAAEa,IAAId,IAAIC,EAAEc,IAAIf,IAAI,CAAC,MAAMgB,EAAE,IAAIC,IAAIC,EAAE,IAAIN,IAAI,SAASO,EAAEnB,GAAGkB,EAAEJ,IAAId,KAAKkB,EAAEH,IAAIf,GAAGI,QAAQgB,KAAKpB,GAAG,CAAC,SAASqB,EAAErB,GAAG,MAAMC,EAAE,GAAGK,EAAE,IAAIW,IAAIT,EAAE,IAAII,IAAI,IAAI,MAAMD,KAAKW,EAAEC,SAAS,CAAC,MAAMP,EAAEL,EAAEa,SAASC,IAAIzB,EAAE0B,MAAM,GAAGV,EAAE,CAACf,EAAE0B,QAAQX,EAAEY,OAAO,IAAI,MAAM3B,EAAEiB,KAAKF,EAAEa,QAAQC,UAAUxB,EAAEQ,IAAIb,IAAIK,EAAEmB,IAAIxB,KAAKiB,GAAGC,EAAE,gBAAgBR,EAAEe,8BAA8B1B,EAAE0B,2GAA2GzB,eAAeK,EAAEmB,IAAIxB,IAAI,gBAAgBiB,KAAKZ,EAAEyB,IAAI9B,EAAEiB,GAAGV,EAAEO,IAAIJ,EAAEe,KAAK,CAAC,CAACzB,EAAE+B,MAAI,CAAGhC,EAAEC,IAAIA,EAAEgC,SAASjC,EAAEiC,WAAW,MAAMtB,EAAE,SAASX,EAAEC,GAAG,GAAG,IAAIA,EAAEiC,KAAK,OAAOlC,EAAE,IAAIM,EAAEN,EAAEmC,WAAWC,WAAW,OAAO,MAAM,IAAI,MAAM5B,EAAEG,KAAKV,EAAE6B,UAAUxB,EAAE+B,SAAS7B,IAAIW,EAAE,oBAAoBnB,EAAE0B,eAAelB,iBAAiBF,EAAEA,EAAE8B,WAAW5B,EAAEG,GAAG,OAAM,EAAG2B,MAAM,IAAIhC,KAAK,CAAhO,CAAkON,EAAEuC,SAASjC,GAAG,IAAIU,EAAE,SAASf,GAAG,IAAIK,EAAEU,EAAE,MAAME,EAAE,QAAQF,GAAGV,EAAEkC,EAAEC,oBAAoBC,qBAAgB,IAAS1B,OAAE,EAAOA,EAAE2B,KAAKrC,EAAEN,EAAE0B,KAAKlB,GAAGW,EAAER,EAAEiC,MAAMC,KAAK5C,GAAG,OAAO,MAAMiB,GAAGA,IAAIC,CAAC,EAAE,IAAI,IAAIb,EAAEL,EAAE6C,OAAO,EAAExC,GAAG,EAAEA,IAAI,CAAC,MAAME,EAAEP,EAAEK,GAAGK,EAAEK,EAAEA,EAAE,SAASf,GAAG,IAAIK,EAAEU,EAAE,MAAME,EAAE,QAAQF,GAAGV,EAAEkC,EAAEC,oBAAoBM,iBAAY,IAAS/B,OAAE,EAAOA,EAAE2B,KAAKrC,EAAEN,EAAE0B,KAAKlB,EAAEwC,KAAK7B,EAAEX,EAAEyC,KAAKL,MAAMC,KAAK,CAAC5C,EAAED,IAAI,GAAG,IAAIkD,UAAUJ,SAASrC,MAAMC,QAAQT,GAAG,MAAM,IAAIE,MAAM,OAAOK,EAAEwC,uEAAuEhD,KAAK,OAAOW,EAAEgC,KAAKE,KAAK7C,EAAC,IAAK,OAAO,MAAMkB,GAAGA,IAAIC,CAAC,CAAC,CAAC,MAAM,CAACS,MAAM3B,EAAE4B,QAAQvB,EAAE6C,eAAe3C,EAAE4C,MAAMpC,EAAEqC,MAAM1C,EAAE,CAAC,SAAS2C,EAAEtD,EAAEC,GAAE,GAAI,IAAIU,EAAEK,EAAES,IAAIzB,GAAG,GAAGW,EAAEV,IAAIU,EAAE4C,YAAYlC,EAAEV,QAAQ,CAAC,IAAIV,EAAEuD,OAAO,MAAMtC,EAAElB,EAAEyD,MAAM,KAAK,IAAI,IAAInD,EAAE,EAAEA,EAAEY,EAAE4B,OAAO,EAAExC,IAAI,GAAGL,EAAEA,EAAEiB,EAAEZ,KAAKE,EAAEP,GAAG,MAAM,IAAIE,MAAM,oBAAoBH,8BAA8BkB,EAAEwC,MAAM,EAAEpD,EAAE,GAAGqD,KAAK,sBAAsB,MAAMxC,EAAElB,EAAEiB,EAAEA,EAAE4B,OAAO,IAAI,GAAG,mBAAmB3B,EAAE,MAAM,IAAIhB,MAAM,oBAAoBH,6BAA6B,MAAMsD,EAAE,SAAStD,GAAG,IAAIC,GAAG,EAAE,IAAI,MAAMO,KAAKF,EAAEsD,OAAO5D,GAAG,CAAC,IAAIA,EAAE,KAAKC,EAAEO,GAAG,IAAI,IAAIP,EAAE,EAAEA,EAAE,EAAEA,IAAID,EAAE,EAAEA,GAAG,UAAUA,IAAI,EAAEA,IAAI,EAAEC,EAAEA,IAAI,EAAED,CAAC,CAAC,QAAWC,IAAK,GAAGkC,SAAS,IAAI0B,SAAS,EAAE,KAAKC,aAAa,CAAzL,CAA2L3C,EAAEgB,WAAWC,WAAW,OAAO,OAAO2B,EAAE,CAACrC,KAAK1B,EAAEuC,SAASpB,EAAE6C,aAAaV,GAAG3C,EAAEsD,OAAOC,OAAOD,OAAOC,OAAO,CAAE,EAACH,GAAG,CAACR,YAAYlC,EAAE0C,GAAGI,OAAO,OAAOC,QAAQnE,EAAEoE,gBAAgBnD,EAAEA,EAAE4B,OAAO,KAAKnC,EAAEwD,OAAO,SAASnE,GAAG,OAAO,YAAYC,GAAG,OAAOD,EAAEuD,YAAYH,MAAMR,MAAMC,KAAK,CAAC5C,GAAG,CAAC,CAA7E,CAA+EU,GAAGK,EAAEe,IAAI/B,EAAEW,GAAGV,EAAEU,EAAE0D,iBAAiB1D,EAAEwD,MAAM,CAAC,OAAOxD,CAAC,CAAC,SAASoD,IAAI,IAAI,MAAM/D,KAAKgB,EAAEO,SAASvB,EAAEuD,YAAYlC,EAAErB,EAAE,CAAC,SAASsE,IAAI,MAAMtE,EAAE,IAAIiB,IAAI,IAAI,MAAMhB,EAAEK,KAAKU,EAAEhB,EAAE+B,IAAI9B,EAAE,CAACyB,KAAKzB,EAAEsC,SAASjC,EAAEiC,SAASyB,aAAa1D,EAAE0D,aAAaO,cAAcjE,EAAE6D,OAAOK,kBAAkBlE,EAAE8D,QAAQ9D,EAAE+D,iBAAiBI,aAAa9D,EAAEL,EAAEiD,YAAY3B,MAAM8C,KAAK1E,GAAGA,EAAEgD,OAAO2B,cAAclE,MAAMmE,KAAKtE,EAAEiD,YAAYJ,kBAAkB,OAAOnD,CAAC,CAAC,MAAMsB,EAAE,IAAIL,IAAI,SAAS4D,EAAE7E,GAAGsB,EAAEG,IAAIzB,EAAE0B,QAAQ1B,GAAGC,EAAE,yBAAyBD,EAAE0B,yBAAyBJ,EAAEwD,OAAO9E,EAAE0B,MAAM1B,EAAE+E,QAAO,EAAGhB,GAAG,CAAC,SAASiB,EAAEhF,EAAEM,GAAGN,GAAG,iBAAiBA,GAAGC,EAAE,4DAA4DD,GAAG,iBAAiBA,EAAE0B,MAAM1B,EAAE0B,MAAMzB,EAAE,4EAA4ED,EAAE0B,MAAM,IAAIf,EAAE,IAAIX,EAAE0B,QAAQ,iBAAiB1B,EAAEiF,UAAUjF,EAAEiF,UAAUhF,EAAE,0BAA0BU,2DAA2DX,EAAEiF,YAAYtE,EAAE,IAAIX,EAAEiF,aAAajF,EAAE0B,SAAS,iBAAiB1B,EAAEkF,SAASjF,EAAE,0BAA0BU,gDAAgDX,EAAEkF,WAAWlF,EAAEmF,aAAanF,EAAEmF,gBAAW,QAAQ,IAASnF,EAAEmF,YAAY,iBAAiBnF,EAAEmF,YAAYlF,EAAE,0BAA0BU,gEAAgEX,EAAEkF,WAAW,MAAM5E,IAAIA,EAAE,CAAE,GAAEA,GAAG,iBAAiBA,GAAGL,EAAE,0BAA0BU,6DAA6DL,KAAK,MAAMU,GAAE,IAAKV,EAAE8E,aAAalE,EAAEI,EAAEG,IAAIzB,EAAE0B,MAAMR,IAAIA,EAAEkE,cAAcpE,GAAGf,EAAE,wBAAwBU,iGAAiGkE,EAAE3D,IAAI,MAAMC,EAAEnB,IAAI,IAAIC,EAAE+E,EAAExD,SAASC,IAAIzB,EAAE0B,MAAM,OAAOzB,IAAIA,EAAE,CAAC2B,MAAM,GAAGC,QAAQ,IAAIZ,KAAK+D,EAAExD,SAASO,IAAI/B,EAAE0B,KAAKzB,IAAIA,GAAGoB,EAAE,CAACrB,EAAEM,IAAI,IAAIE,KAAK,IAAIQ,EAAEE,EAAE,MAAMC,EAAE,QAAQD,GAAGF,EAAEwB,EAAEC,oBAAoB4C,wBAAmB,IAASnE,OAAE,EAAOA,EAAEyB,KAAK3B,EAAEhB,EAAEgF,EAAEtD,MAAMsD,EAAED,QAAQ9E,EAAE,OAAOU,yDAAyD,MAAMU,EAAEf,KAAKE,GAAG,OAAO,MAAMW,GAAGA,IAAIE,GAAGiD,EAAE,CAACgB,OAAOjE,EAAE,UAAU,IAAIwD,EAAEG,KAAKO,aAAalE,EAAE,gBAAgB,CAACrB,EAAEM,EAAEE,KAAK,iBAAiBR,GAAGA,GAAGC,EAAE,OAAOU,2EAA2EX,KAAK,MAAMgB,EAAEsC,EAAEtD,GAAGkB,EAAEC,EAAEH,GAAG,iBAAiBV,GAAGL,EAAE,OAAOU,8BAA8BX,4CAA4CM,KAAK,mBAAmBE,GAAGP,EAAE,OAAOU,8BAA8BX,0CAA0CQ,KAAK,MAAMa,EAAE,CAAC2B,IAAIgC,EAAEtD,KAAKO,SAAS3B,EAAE2C,KAAKzC,GAAG,OAAOU,EAAEU,MAAMD,KAAKN,GAAG0C,IAAI,KAAK,MAAM/D,EAAEkB,EAAEU,MAAM4D,QAAQnE,GAAGrB,GAAG,IAAIkB,EAAEU,MAAM6D,OAAOzF,EAAE,GAAG+D,IAAI,CAAE,IAAG2B,cAAcrE,EAAE,iBAAiB,CAACrB,EAAEM,KAAK,iBAAiBN,GAAGA,GAAGC,EAAE,OAAOU,2EAA2EX,KAAK,MAAMgB,EAAEsC,EAAEtD,GAAGkB,EAAEC,EAAEH,GAAGR,EAAEF,IAAIL,EAAE,OAAOU,+BAA+BX,2CAA2CM,KAAK,IAAI,MAAME,EAAEQ,KAAKiD,OAAOnC,QAAQxB,GAAG,iBAAiBU,EAAEE,EAAEW,QAAQE,IAAIvB,EAAEQ,GAAG,OAAOA,EAAEE,EAAEW,QAAQiD,OAAOtE,GAAGP,EAAE,OAAOU,+BAA+BX,gCAAgCQ,MAAMuD,GAAI,IAAG4B,cAActE,EAAE,iBAAiBrB,IAAI,iBAAiBA,GAAGA,GAAGC,EAAE,OAAOU,2EAA2EX,KAAK,MAAMM,EAAEgD,EAAEtD,GAAGmB,EAAEb,GAAGuB,QAAQ+D,QAAQ7B,GAAI,IAAG8B,aAAaxE,EAAE,gBAAc,CAAGrB,EAAEM,EAAEE,KAAK,iBAAiBR,GAAGA,GAAGC,EAAE,OAAOU,0EAA0EX,KAAK,MAAMgB,EAAEsC,EAAEtD,GAAG,OAAOS,MAAMC,QAAQJ,IAAIL,EAAE,OAAOU,gEAAgEL,KAAKU,EAAEuB,SAASK,MAAM,MAAMpC,EAAEA,EAAEsF,WAAWxF,EAAG,IAAGyF,gBAAgB1E,EAAE,mBAAmBrB,IAAI,iBAAiBA,GAAGA,GAAGC,EAAE,OAAOU,mEAAmEX,KAAYsD,EAAEtD,GAAGgE,iBAAiBgB,EAAE,CAACtD,KAAK1B,EAAE0B,KAAKuD,SAASjF,EAAEiF,SAASC,QAAQlF,EAAEkF,QAAQC,WAAWnF,EAAEmF,WAAWC,aAAapE,EAAEgF,IAAI1B,EAAES,QAAO,EAAGvD,SAAS,IAAIP,KAAK,OAAOK,EAAES,IAAI/B,EAAE0B,KAAKsD,GAAGf,OAAOgC,OAAO3B,EAAE,CAAC,SAAS4B,IAAI,MAAMlG,EAAE,GAAG,IAAI,MAAMC,KAAKqB,EAAEC,SAASvB,EAAE2B,KAAK,CAACD,KAAKzB,EAAEyB,KAAKuD,SAAShF,EAAEgF,SAASC,QAAQjF,EAAEiF,QAAQC,WAAWlF,EAAEkF,aAAa,OAAOnF,CAAC,CAAC,IAAIwC,EAAE,MAAM2D,OAAE,IAAS3C,OAAO4C,SAAS5C,OAAO4C,SAAS,WAAW,MAAMnG,EAAE,CAACiF,QAAQlF,EAAEqG,WAAW,EAAEC,YAAYtB,EAAEuB,YAAYL,EAAEM,gBAAgBlC,EAAE7B,mBAAmBwB,OAAOwC,KAAK,CAACpB,iBAAiB,KAAKtC,UAAU,KAAKL,cAAc,QAAQ,OAAOF,EAAEvC,EAAEgE,OAAOgC,OAAOhG,EAAE,CAA/M,IAAoNO,EAAEgD,OAAO4C,WAAWnG,EAAE,+CAA+C,IAAIuD,OAAO4C,SAASC,YAAYpG,EAAE,yEAAyEuD,OAAO4C,SAASlB,aAAa1B,OAAO4C,SAASlB,UAAUlF,GAAGE,MAAM,2EAA2EsD,OAAO4C,SAASlB,gIAAgI1B,OAAO4C,UAA8CnC,OAAOyC,eAAeC,EAAQ,aAAa,CAACC,OAAM,IAAKD,UAAgBR,EAA/pO,8FCHO,MAAMU,EAAa,SACbC,EAAU,eAQVC,EAAsB,yBACtBC,EAAc,iBAEdC,EAAoB,uBCFXC,EAMlB,IAAAjE,CAAKD,EAAmBmE,GAAmD,EAc/D,SAAAC,EAAwBC,EAAeC,GACnD,MAAMC,EAAaC,EAAmBH,GACtC,OAAKE,EASO,SAAaD,EAAsBG,GAC/C,QAAIH,EAAOxE,OAAS2E,EAAI3E,SACjBwE,EAAOI,OAAM,CAACzH,EAAG0H,IAAQ1D,OAAO2D,KAAK3H,GAAGyH,OAAMG,GAAO5H,EAAE4H,KAASJ,EAAIE,GAAKE,MACpF,CAXQC,CAAaR,EAAQC,GAAoBQ,EAAQ,aAC9CC,IAFiBD,EAAQ,WAGpC,CAEO,MAAMA,EAAWE,IAA4C,CAAQC,SAAUD,IAEzED,EAAU,KAAO,CAAE,GAO1B,SAAUR,EAAmBH,GAC/B,IAAIA,EAAMc,MAAKC,QAAsCC,IAA9BD,EAAKE,UAAUC,aACtC,OAAOlB,EAAM3C,KAAI0D,GAAQA,EAAKE,UAAUC,YAC5C,UAEgBC,EAAuBC,EAAyBpB,EAA6BC,GACzFD,EAAMqB,SAAQ,CAACN,EAAMT,IAAQL,EAAOK,IAAQS,GAAQO,8BAA8BF,EAAQL,EAAMd,EAAOK,KAC3G,CC9CA,SAASiB,EAAgBC,GACrB,MAAa,QAATA,EAAuB,CAAE7I,EAAG,GACd,SAAT6I,EAAwB,CAAE7I,EAAG,GACpB,SAAT6I,EAAwB,CAAE7I,EAAG,GAC1B,CAAEA,EAAG,EACrB,CCNA,SAAS4I,EAAgBC,GACrB,MAAa,QAATA,EAAuB,CAAC,CAAEC,MAAO,GAAK,CAAEA,MAAO,IACjC,SAATD,EAAwB,CAAC,CAAEC,MAAO,GAAK,CAAEA,MAAO,IACvC,UAATD,EAAyB,CAAC,CAAEC,MAAO,GAAK,CAAEA,MAAO,IAC9C,EAChB,CCDA,SAASF,EAAgBC,GACrB,MAAa,QAATA,EAAuB,CAAC,CAAEC,MAAO,GAAK,CAAEA,MAAO,IACjC,SAATD,EAAwB,CAAC,CAAEC,MAAO,GAAK,CAAEA,MAAO,IACvC,UAATD,EAAyB,CAAC,CAAEC,MAAO,GAAK,CAAEA,MAAO,IAC9C,CAAC,CAAEA,MAAO,GAAK,CAAEA,MAAO,GACxC,CCfA,MAAMC,EAAY,cACX,SAASC,EAAanB,EAAKoB,GAC9B,OAAO,IAAIC,SAASC,IACX3F,OAAOuF,KACRvF,OAAOuF,GAAa,IACxB,MAAMK,EAAS5F,OAAOuF,GAChBM,EAAgBD,EAAOvB,GAC7B,GAAIwB,GAA0C,mBAAlBA,EAA8B,CACtD,MAAMC,EAAUD,IAChB,GAAIC,EAEA,YADAH,EAAQG,EAGf,CACD,MAAMA,EAAUL,IAChBG,EAAOvB,GAAO,IAAMyB,EACpBH,EAAQG,EAAQ,GAExB,CCjBO,MAAMC,EACT,WAAAC,CAAYxG,GACRH,KAAK4G,OAAS,CACVC,OAAQ,GACRC,OAAQ,GACRC,OAAQ,IAEZ5G,EAAIuC,aAAa,qBAAsB,GAAG,CAACsE,EAAMC,KAC7C,MAAMC,EAAIF,EAAK,GACTG,EAAWH,EAAK,GAClBE,EAAEE,aACEC,qBACArH,KAAK4G,OAAOG,OAAOlB,SAAQyB,GAAKA,EAAEJ,KAC7BC,GAAY,IACjBnH,KAAK4G,OAAOE,OAAOjB,SAAQyB,GAAKA,EAAEJ,MAE1CD,EAAKD,EAAK,IAEd7G,EAAIuC,aAAa,sBAAuB,GAAG,CAACsE,EAAMC,KAC9C,MAAMC,EAAIF,EAAK,GACXE,EAAEE,aAAeC,sBACjBrH,KAAK4G,OAAOC,OAAOhB,SAAQyB,GAAKA,EAAEJ,KACtCD,EAAKD,EAAK,GAEjB,CACD,QAAAO,CAASC,GACLxH,KAAK4G,OAAOC,OAAO/H,KAAK0I,EAC3B,CACD,QAAAC,CAASD,GACLxH,KAAK4G,OAAOE,OAAOhI,KAAK0I,EAC3B,CACD,QAAAE,CAASF,GACLxH,KAAK4G,OAAOG,OAAOjI,KAAK0I,EAC3B,CACD,EAAAG,CAAGH,EAAOI,GACN5H,KAAK4G,OAAOY,IAAQ1I,KAAK8I,EAC5B,CACD,WAAOC,CAAK1H,GACR,OAAOgG,EAAa,iBAAiB,IAAM,IAAIO,EAAcvG,IAChE,ECzBE,SAAS2H,EAAoBC,GAChC,MAAMC,EAAMD,EAAKE,QAAO,CAACC,EAAIC,KAfO,iBAgBVA,EAhBVC,gBAiBRF,EAAGE,gBAAkBD,EAAGC,iBAfpC,SAA2BC,GACvB,MAAoC,iBAAtBA,EAAEC,eACpB,CAciBC,CAAkBJ,IAbnC,SAAwBE,GACpB,MAAiC,iBAAnBA,EAAEG,YACpB,CAaiBC,CAAeN,IAZhC,SAA2BE,GACvB,MAAmC,iBAArBA,EAAEK,cACpB,CAYiBC,CAAkBR,GAXnC,SAAyBE,GACrB,MAAiB,kBAAVA,EAAEO,GACb,CAWiBC,CAAgBV,KACrBD,EAAGY,MAAQ,CACPC,UAAWZ,EAAGY,UACdC,UAAWb,EAAGa,UACdC,UAAWd,EAAGc,WAAa,KAL/Bf,EAAGgB,cAAgBf,EAAGO,eAFtBR,EAAGM,aAAeL,EAAGK,aAFrBN,EAAGI,gBAAkBH,EAAGG,gBAYrBJ,IACR,CAAEiB,aAAcpB,IACnB,MAAO,CAACC,EAAII,gBAAiBJ,EAAIM,gBAAiBN,EAAIQ,aAAcR,EAAIkB,eAAe5D,MAAM8D,QAAY5D,IAAN4D,SAC7F5D,EACAwC,CACV,CACO,MAAMqB,EACT,mBAAWC,GACP,OAAOD,EAAeE,SACzB,CACD,WAAO1B,CAAK2B,GACJH,EAAeE,YAEnBF,EAAeE,UAAY,IAAIF,EAAeG,GACjD,CACD,WAAA7C,CAAYvC,GACRpE,KAAKoE,kBAAoBA,EACzB,MAAMqF,EAAYC,IAAqB,CAAEd,IAAK,oCAAoCxE,IAAqBuF,KAAMD,IAC7G1J,KAAK4J,WAAcF,IACVA,GAAYG,QAAWA,OAAOC,cAEnCC,WAAW,eAAgB,CACvBL,QAAStF,EACT4F,KAAM,SACNC,WAAY,CAACR,EAASC,KACxB,EAEN1J,KAAKkK,SAAYR,IACRA,GAAYG,QAAWA,OAAOC,cAEnCC,WAAW,eAAgB,CACvBL,QAASA,EACTM,KAAM,QACR,EAENhK,KAAKmK,YAAeT,IACXA,GAAYG,QAAWA,OAAOC,cAEnCM,gBAAgB,CACZC,OAAQR,OAAOC,aACfJ,QAAStF,EACT4F,KAAM,SACNC,WAAY,CAACR,EAASC,KACxB,EAEN1J,KAAKsK,UAAaZ,IACTA,GAAYG,QAAWA,OAAOC,cAEnCM,gBAAgB,CACZC,OAAQR,OAAOC,aACfJ,QAASA,EACTM,KAAM,gBACR,EAENhK,KAAKuK,YAAc,CAAC9F,EAAQiF,KACnBA,GAAYG,QAAWA,OAAOC,cAEnCC,WAAW,eAAgB,CACvBL,QAASA,EACTM,KAAM,UACNQ,OAAQ/F,GACV,EAENzE,KAAKyK,SAAW,CAAChG,EAAQiF,KAChBA,GAAYG,QAAWA,OAAOC,cAEnCC,WAAW,cAAe,CACtBD,aAAcrF,EACdiG,QAAShB,EACTiB,SAAU,GACVC,UAAU,GACZ,CAET,ECzGE,SAASC,EAAOC,GACnB,OAAOA,aAAeC,SAAWD,IAAQA,CAC7C,CACO,SAASE,EAAc3C,GAC1B,OAAOzK,MAAMC,QAAQwK,IAAMA,EAAExD,OAAM1G,GAAkB,iBAANA,GACnD,CCEO,SAAS8M,EAAYC,GACxB,OAAO,IAAI9M,IAAI8M,EAAIC,WAAWtJ,KAAIyF,GAAK,CAACA,EAAEwB,MAAMsC,MAAMC,KAAM/D,KAChE,CACO,SAASgE,EAAcJ,GAC1B,OAAO,IAAI9M,IAAI8M,EAAIC,WAAWnN,QAAOsJ,GAAgC,SAA3BA,EAAEwB,MAAMsC,MAAMG,WAAqB1J,KAAIyF,GAAK,CAACA,EAAEwB,MAAMsC,MAAMC,KAAM/D,KAC/G,CACO,SAASkE,EAAgBC,EAAGC,EAAGC,GAClC,IAAKF,IAAMC,EACP,OAAO,EACX,GAAID,EAAE3C,MAAMuC,OAASK,EAAE5C,MAAMuC,KACzB,OAAO,EACX,GAAII,EAAE3C,MAAM8C,UAAW,CACnB,IAAKH,EAAEhG,SACH,OAAO,EACX,IAAqB,IAAjBkG,GAAQE,OAAkBJ,EAAEhG,UAAUqG,SACtC,OAAO,EACX,GAA4B,iBAAjBH,GAAQE,MAAqBJ,EAAEhG,UAAUqG,WAAaH,EAAOE,KACpE,OAAO,CACd,CACD,GAAIF,GAAQI,OAASN,EAAE3C,MAAMsC,MAAMC,OAASK,EAAE5C,MAAMsC,MAChD,OAAO,EACX,GAAIO,GAAQK,MACR,GAA4B,kBAAjBL,EAAOK,OACd,IAAKP,EAAEQ,OAASR,EAAEQ,MAAMZ,OAASK,EAAEO,MAAMZ,MAAQI,EAAEQ,MAAMC,cAAgBR,EAAEO,MAAMC,YAC7E,OAAO,OAGX,IAAKT,EAAEQ,OAASR,EAAEQ,MAAMZ,OAASK,EAAEO,MAAMZ,MAAQI,EAAEQ,MAAMC,cAAgBR,EAAEO,MAAMC,aAC1ET,EAAEQ,MAAMnC,eAAiB6B,EAAOK,MAAMlC,cAAgB2B,EAAEQ,MAAME,aAAeR,EAAOK,MAAMG,WAC7F,OAAO,EAGnB,OAAO,CACX,CCxCO,SAASC,EAAiBlF,KAAMkE,GAC/BiB,cACAC,iBAAiBpF,GAAG,GAChBkE,EAAMnL,OAAS,EACfmL,EAAMvF,SAAQ0G,IAAOC,4BAA4BtF,EAAGqF,EAAE,IAEtDE,wBAAwBvF,IAG5BoF,iBAAiBpF,GAAG,EAE5B,CHgGAmC,EAAeE,eAAY/D,EI1GpB,MAAMkH,EACT,UAAAC,CAAWjD,EAAS3B,GAAQ,OAAOA,CAAO,CAE1C,IAAAF,CAAK1H,GAAQ,CAEb,WAAAwG,CAAYiG,EAAMC,EAAaC,EAAUC,GACrC/M,KAAK4M,KAAOA,EACZ5M,KAAK6M,YAAcA,EACnB7M,KAAK8M,SAAWA,EAChB9M,KAAK+M,MAAQA,CAChB,EAEE,MAAMC,EACT,UAAAL,CAAWjD,EAAS3B,GAAQ,OAAOA,CAAO,CAE1C,IAAAF,CAAK1H,GAAQ,CAEb,WAAAwG,CAAYiG,EAAMC,EAAaC,GAC3B9M,KAAK4M,KAAOA,EACZ5M,KAAK6M,YAAcA,EACnB7M,KAAK8M,SAAWA,CACnB,EAEE,MAAMG,GAEN,MAAMC,EACT,WAAAvG,CAAYxG,GACRH,KAAKG,IAAMA,EACXH,KAAKmN,UAAY,IAAI/O,IACrB4B,KAAKoN,aAAe,IAAIhP,IACxB4B,KAAKqN,YAAc,IAAIjP,IACvB+B,EAAIuC,aAAa,4BAA6B,GAAG,CAACsE,EAAMC,KACpD,MAAOqG,EAAQC,EAAQC,EAAOzB,GAAS/E,EACjCyG,EAAYzN,KAAKmN,UAAUvO,IAAI0O,GACrC,OAAIG,EACOA,EAAUC,KAAKH,EAAQC,EAAOzB,GAClC9E,EAAKD,EAAK,IAErB7G,EAAIuC,aAAa,eAAgB,GAAG,CAACsE,EAAMC,KACvC,MAAMvI,EAASsI,EAAK,GAAGpG,MAAM,KAC7B,GAAkB,aAAdlC,EAAO,GAAmB,CAC1B,MAAMiP,EAAM3N,KAAKoN,aAAaxO,IAAIF,EAAO,GAAGkC,MAAM,KAAK,IACvD,GAAI+M,EACA,OAAO1G,EAAK,CAAC0G,EAAIZ,OACxB,CACD,OAAO9F,EAAKD,EAAK,IAErB7G,EAAIuC,aAAa,yBAA0B,GAAG,CAACsE,EAAMC,KACjD,MAAM2G,EAAS5G,EAAK,GAAGpG,MAAM,KACvBiN,EAAgBD,EAAOA,EAAO3N,OAAS,GAC7C,OAAOD,KAAKoN,aAAaxO,IAAIiP,IAAgBC,KAAK9G,EAAK,KAAOC,EAAKD,EAAK,IAE5E7G,EAAIuC,aAAa,aAAc,GAAG,CAACsE,EAAMC,KACrC,GAAgB,iBAAZD,EAAK,IAA2C,aAAlBA,EAAK,IAAIgD,KACvC,OAAO/C,EAAKD,GAChB,MAAMe,EAAOf,EAAK,GAAGiD,WACrB,IAAKlC,EACD,OAAOd,EAAKD,GAChB,MAAM9F,EAAI4G,EAAoBC,GAC9B,IAAK7G,EACD,OAAO+F,EAAKD,GAChB,MAAM+G,EAAQ/N,KAAKqN,YAAYzO,IAAIsC,EAAEsH,cACrC,OAAKuF,GAEL/G,EAAK,GAAGiD,WAAa8D,EAAM9F,QAAO,CAAC+F,EAAKL,IAAQA,EAAIhB,WAAW3F,EAAK,GAAG0C,QAASsE,IAAMjG,GAC/Ed,EAAKD,IAFDC,EAAKD,EAEC,GAExB,CACD,GAAAiH,CAAIrI,EAAQsI,EAAQC,GAChBnO,KAAKqN,YAAYzO,IAAIuP,EAAK3F,eAAe3C,SAAQxC,UACvBmC,IAAlBnC,EAAEwJ,aAA8BxJ,EAAEwJ,YAAYrN,SAAS2O,EAAKjF,kBAEjD,WAAX7F,EAAEuJ,MAAqBuB,EAAK/F,kBAAoBxC,EAAOkE,eAE5C,gBAAXzG,EAAEuJ,MACEuB,EAAK/F,kBAAoBxC,EAAOkE,cAC7BqE,EAAK7F,kBAAoB1C,EAAOkE,eAE3CzG,EAAEsE,GAAG/B,EAAQsI,EAAQC,GAAK,GAEjC,CACD,eAAAC,CAAgBd,GACZtN,KAAKmN,UAAUjO,IAAIoO,EAAOzO,KAAMyO,EACnC,CACD,WAAAe,CAAYV,GACR3N,KAAKoN,aAAalO,IAAIyO,EAAIb,SAASzB,KAAMsC,GACzCW,oBAAoBxP,KAAK6O,EAAIb,UAC7ByB,4BAA4BzP,KAAK6O,EAAIb,SAASzB,MAC9C,MAAMmD,EAAOxO,KAAKqN,YAAYzO,IAAI+O,EAAIb,SAASzB,MAC3CmD,EACAA,EAAK1P,KAAK6O,GAEV3N,KAAKqN,YAAYnO,IAAIyO,EAAIb,SAASzB,KAAM,CAACsC,IAC7CA,EAAI9F,KAAK7H,KAAKG,IACjB,CACD,oBAAAsO,CAAqBd,GACjB,MAAMa,EAAOxO,KAAKqN,YAAYzO,IAAI+O,EAAIb,UAClC0B,EACAA,EAAK1P,KAAK6O,GAEV3N,KAAKqN,YAAYnO,IAAIyO,EAAIb,SAAU,CAACa,IACxCA,EAAI9F,KAAK7H,KAAKG,IACjB,ECrGE,MAAMuO,EACT,WAAA/H,CAAYxG,GACRH,KAAK2O,WAAa,GAClB3O,KAAK4O,YAAc,GACnB5O,KAAK6O,qBAAuB,GAC5B7O,KAAK8O,gBAAkB,GACvB3O,EAAIuC,aAAa,eAAgB,GAAG,CAACsE,EAAMC,KACvC,GAAI4C,UAAYwC,eAAiBxC,OAAOkF,cAAgB1C,aAAahB,OAASxB,OAAOkF,aAAa1D,MAAO,CACrG,MAAM2D,EAAKnF,OACX7J,KAAK2O,WAAW9I,SAAQpH,GAAKA,EAAEuQ,IAClC,CACD,OAAO/H,EAAKD,EAAK,IAErB7G,EAAIuC,aAAa,aAAc,GAAG,CAACsE,EAAMC,KACrC,GAAgB,kBAAZD,EAAK,IACD6C,OAAQ,CACR,MAAMmF,EAAKnF,OACX7J,KAAK4O,YAAY/I,SAAQpH,GAAKA,EAAEuQ,IACnC,CAEL,OAAO/H,EAAKD,EAAK,IAErB7G,EAAI6C,aAAa,iCAAkC,CAAChD,KAAKiP,mBAAmB9O,IAC/E,CACD,iBAAA+O,CAAkBzQ,GAAKuB,KAAK2O,WAAW7P,KAAKL,EAAK,CACjD,mBAAA0Q,CAAoB1Q,GAAKuB,KAAK4O,YAAY9P,KAAKL,EAAK,CACpD,yBAAA2Q,CAA0B3Q,GAAKuB,KAAK6O,qBAAqB/P,KAAKL,EAAK,CACnE,iBAAA4Q,CAAkB5Q,GAAKuB,KAAK8O,gBAAgBhQ,KAAKL,EAAK,CACtD,kBAAAwQ,CAAmB9O,GACf,MAAO,CACH+L,YAAa,4BACboD,SAAU,GACVC,SAAU,CAACC,EAAMtB,EAAQuB,EAAKC,KAC1B,GAAI7F,QAAUA,OAAOC,aAAc,CAC/B,MAAMkF,EAAKnF,OACX,GAAkB,SAAd2F,EAAKxF,MAAiC,YAAdwF,EAAKxF,MAAoC,UAAdwF,EAAKxF,KAAkB,CAC1E,MAAMhE,EAAOwJ,EAAKxF,MACd7J,EAAI6C,aAAa,gCAAiC,KAAO7C,EAAI6C,aAAa,qCAAsC,CAACkL,MACjHlO,KAAK6O,qBAAqBhJ,SAAQpH,GAAKA,EAAEuQ,EAAId,EAAQuB,EAAKzJ,IACjE,CACD,GAAkB,aAAdwJ,EAAKxF,MAAuBwF,EAAKvF,WAAY,CAC7C,MAAM/I,EAAI4G,EAAoB0H,EAAKvF,YAC/B/I,GACAlB,KAAK8O,gBAAgBjJ,SAAQpH,GAAKA,EAAEuQ,EAAId,EAAQhN,IACvD,CACJ,CACD,OAAO,CAAK,EAGvB,CACD,WAAO2G,CAAK1H,GACR,OAAOgG,EAAa,mBAAmB,IAAM,IAAIuI,EAAgBvO,IACpE,ECpDE,MAAMwP,EAAgC,CACzC,CACI7G,MAAO,CACHuC,KAAM,gBACND,MAAO,uBAEXwE,MAAO,CAAC,UAAW,UAAW,WAC9B3D,MAAO,CACHZ,KAAM,sBACNa,YACI,4uBACJzG,SAAU,SAEdA,SAAU,CAAEoK,iBAAkB,KAElC,CACI/G,MAAO,CACHuC,KAAM,qBACND,MAAO,wBAEXwE,MAAO,CAAC,UAAW,WACnB3D,MAAO,CACHZ,KAAM,yCACNa,YACI,yyBACJzG,SAAU,YAEdA,SAAU,CAAEoK,iBAAkB,KAElC,CACI/G,MAAO,CACHuC,KAAM,kBACND,MAAO,eAEXwE,MAAO,CAAC,WACR3D,MAAO,CACHZ,KAAM,+CACN5F,SAAU,WACVyG,YACI,owBAERzG,SAAU,CAAEoK,iBAAkB,KAElC,CACI/G,MAAO,CACHuC,KAAM,kBACND,MAAO,YAEXwE,MAAO,CAAC,WACR3D,MAAO,CACHZ,KAAM,sCACN5F,SAAU,WACVyG,YACI,k2BAGZ,CACIpD,MAAO,CACHuC,KAAM,wBACND,MAAO,sBAEXwE,MAAO,CAAC,UAAW,WACnB3D,MAAO,CACHZ,KAAM,2CACN5F,SAAU,WACVyG,YACI,80BAERzG,SAAU,CAAEoK,iBAAkB,KAElC,CACI/G,MAAO,CACHuC,KAAM,mBACND,MAAO,cAEXwE,MAAO,CAAC,UAAW,UAAW,UAAW,WACzC3D,MAAO,CACHZ,KAAM,uDACN5F,SAAU,QACVyG,YACI,20BAGZ,CACIpD,MAAO,CACHuC,KAAM,mBACND,MAAO,cAEXwE,MAAO,CAAC,WACR3D,MAAO,CACHZ,KAAM,yBACN5F,SAAU,QACVyG,YACI,o4BAGZ,CACIpD,MAAO,CACHuC,KAAM,2BACND,MAAO,aAEXwE,MAAO,CAAC,UAAW,UAAW,UAAW,UAAW,WACpD3D,MAAO,CACHZ,KAAM,gCACN5F,SAAU,QACVyG,YACI,s1BAERzG,SAAU,CAAEoK,iBAAkB,KAElC,CACI/G,MAAO,CACHuC,KAAM,oBACND,MAAO,aAEXwE,MAAO,CAAC,UAAW,UAAW,UAAW,WACzC3D,MAAO,CACHZ,KAAM,mCACN5F,SAAU,QACVyG,YACI,+0BAGZ,CACIpD,MAAO,CACHuC,KAAM,sBACND,MAAO,cAEXwE,MAAO,CAAC,UAAW,WACnB3D,MAAO,CACHZ,KAAM,sCACN5F,SAAU,QACVyG,YACI,81BAERzG,SAAU,CAAEoK,iBAAkB,IAElC,CACI/G,MAAO,CACHuC,KAAM,uBACND,MAAO,cAEXwE,MAAO,CAAC,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,WAC1E3D,MAAO,CACHZ,KAAM,qCACN5F,SAAU,WACVyG,YACI,i3BAERzG,SAAU,CAAEC,WAAY,CAAEpH,EAAG,EAAGH,EAAG,EAAGhB,EAAG,EAAGqB,EAAG,KAEnD,CACIsK,MAAO,CACHuC,KAAM,kBACND,MAAO,YAEXwE,MAAO,CAAC,UAAW,UAAW,WAC9B3D,MAAO,CACHZ,KAAM,2BACN5F,SAAU,QACVyG,YACI,s0BAGZ,CACIpD,MAAO,CACHuC,KAAM,oBACND,MAAO,aAEXwE,MAAO,CAAC,UAAW,UAAW,UAAW,WACzC3D,MAAO,CACHZ,KAAM,yBACN5F,SAAU,QACVyG,YACI,uyBAERzG,SAAU,CAAEC,WAAY,CAAEO,MAAO,KAErC,CACI6C,MAAO,CACHuC,KAAM,uBACND,MAAO,YAEXwE,MAAO,CAAC,UAAW,UAAW,UAAW,WACzC3D,MAAO,CACHZ,KAAM,iCACN5F,SAAU,QACVyG,YACI,ksBAGZ,CACIpD,MAAO,CACHuC,KAAM,mBACND,MAAO,aAEXwE,MAAO,CAAC,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,WAC1E3D,MAAO,CACHZ,KAAM,uCACN5F,SAAU,QACVyG,YACI,k6BAERzG,SAAU,CAAEC,WAAY,CAAEO,MAAO,KAErC,CACI6C,MAAO,CACHuC,KAAM,qBACND,MAAO,YAEXwE,MAAO,CAAC,UAAW,UAAW,UAAW,WACzC3D,MAAO,CACHZ,KAAM,yCACN5F,SAAU,QACVyG,YACI,ozBAGZ,CACIpD,MAAO,CACHuC,KAAM,qBACND,MAAO,aAEXwE,MAAO,CAAC,UAAW,UAAW,WAC9B3D,MAAO,CACHZ,KAAM,8CACN5F,SAAU,WACVyG,YACI,2yBAGZ,CACIpD,MAAO,CACHuC,KAAM,sBACND,MAAO,YAEXwE,MAAO,CAAC,UAAW,UAAW,WAC9B3D,MAAO,CACHZ,KAAM,oDACN5F,SAAU,QACVyG,YACI,8sBAGZ,CACIpD,MAAO,CACHuC,KAAM,mBACND,MAAO,YAEXwE,MAAO,CAAC,WACR3D,MAAO,CACHZ,KAAM,6CACN5F,SAAU,QACVyG,YACI,s2BAGZ,CACIpD,MAAO,CAAEuC,KAAM,gBAAiBD,MAAO,cACvCwE,MAAO,CAAC,UAAW,UAAW,UAAW,UAAW,WACpD3D,MAAO,CACHZ,KAAM,uCACN5F,SAAU,QACVyG,YACI,46BAERzG,SAAU,CAAEC,WAAY,CAAEO,MAAO,KAErC,CACI6C,MAAO,CAAEuC,KAAM,mBAAoBD,MAAO,YAC1CwE,MAAO,CAAC,UAAW,UAAW,UAAW,WACzC3D,MAAO,CACHZ,KAAM,2CACN5F,SAAU,QACVyG,YACI,4zBAKH4D,EJxRF,IAAI1R,IIwRkCuR,EJxR1B9N,KAAIyF,GAAK,CAACA,EAAEwB,MAAMsC,MAAO9D,MI0RzC,MAAMyI,EAA6B,CACtCjH,MAAO,CACHuC,KAAM,kBACND,MAAO,eAEXwE,MAAO,CACH,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEJ3D,MAAO,CACHZ,KAAM,sDACN5F,SAAU,QACVyG,YACI,o0BAIC8D,EAA6B,CACtClH,MAAO,CACHuC,KAAM,mBACND,MAAO,YAEXwE,MAAO,CAAC,WACR3D,MAAO,CACHZ,KAAM,2DACN5F,SAAU,OACVyG,YACI,wxBAIC+D,EAAgC,CACzCnH,MAAO,CACHuC,KAAM,kBACND,MAAO,gBAEXwE,MAAO,CAAC,WACR3D,MAAO,CACHZ,KAAM,sDACN5F,SAAU,QACVyG,YACI,gjBAICgE,EAA0B,CACnCH,EACAC,EACAC,EACA,CACInH,MAAO,CACHuC,KAAM,cACND,MAAO,gBAEXwE,MAAO,UACP3D,MAAO,CACHZ,KAAM,kBACNa,YAAa,2BACbzG,SAAU,WAGlB,CACIqD,MAAO,CACHuC,KAAM,cACND,MAAO,gBAEXwE,MAAO,UACP3D,MAAO,CACHZ,KAAM,kBACNa,YAAa,6FACbzG,SAAU,YC9WhB,SAAU0K,EAAajJ,GACzB,OAAO,IAAI9I,IAAkB8I,EAAEiE,WAAWtJ,KAAI1D,GAAK,CAACA,EAAE2K,MAAMsC,MAAMC,KAAMlN,KAC5E,CCFA,IAAYiS,ECSPC,GDTL,SAAYD,GACRA,EAAAA,EAAA,QAAA,GAAA,UAASA,EAAAA,EAAA,SAAA,GAAA,WAAUA,EAAAA,EAAA,YAAA,GAAA,aACtB,CAFD,CAAYA,IAAAA,EAEX,CAAA,UACqBE,SAWTC,EAKT,WAAA5J,CAAqB6J,GAAAxQ,KAASwQ,UAATA,EAJJxQ,KAAWyQ,YAAqB,GAGzCzQ,KAAM0Q,OAAe,UAEzB1Q,KAAK2Q,OAASC,aAAY,KACtB,OAAG,CACC,GAAI/G,QAAU7J,KAAKyQ,YAAYxQ,OAAS,GAAqB,YAAhBD,KAAK0Q,OAAsB,CACpE,MAAMG,EAAY7Q,KAAKyQ,YAAY,GACnC,GAA+B,IAA3BI,EAAUC,MAAM7Q,OAAc,CAC9BD,KAAKyQ,YAAYM,QACjB,QACH,CAED,MAAMC,EAAQH,EAAUC,MAAM,GAAG7C,IAAIpE,QACjCmH,IAAUZ,EAAea,SACzBJ,EAAUC,MAAMC,QACTC,IAAUZ,EAAec,aAChClR,KAAKyQ,YAAYM,OAExB,CACD,KACH,CAAc,GAChBP,EACN,CAED,UAAAW,CAAWC,GACP,OAAG,CACC,GAAgC,IAA5BpR,KAAKyQ,YAAYxQ,OAAc,OACnC,MAAM4Q,EAAY7Q,KAAKyQ,YAAY,GAGnC,GAF+B,IAA3BI,EAAUC,MAAM7Q,QAChBD,KAAKyQ,YAAYM,SACjBK,EAAKP,GAEJ,OADDA,EAAUC,MAAMC,OAEvB,CACJ,CAED,KAAAM,GACIrR,KAAK0Q,OAAS,QACjB,CAED,MAAAY,GACItR,KAAK0Q,OAAS,SACjB,CAED,UAAAa,CAAWC,GACPxR,KAAKyQ,YAAYgB,QAAQD,EAC5B,CAED,IAAA1S,CAAK0S,GACDxR,KAAKyQ,YAAY3R,KAAK0S,EACzB,CAED,kBAAAE,CAAmBF,GACiB,IAA5BxR,KAAKyQ,YAAYxQ,OAIjBD,KAAKyQ,YAAY7N,OAAO,EAAG,EAAG4O,GAH9BxR,KAAKyQ,YAAY3R,KAAK0S,EAK7B,CAED,mBAAIG,GACA,GAAgC,IAA5B3R,KAAKyQ,YAAYxQ,OACrB,OAAOD,KAAKyQ,YAAY,GAAGmB,WAC9B,CAID,WAAO/J,CAAK2I,GACJD,EAAYsB,UAChBtB,EAAYsB,QAAU,IAAItB,EAAYC,GACzC,CAED,iBAAWjK,GACP,OAAOgK,EAAYsB,OACtB,QEhFQC,EAKT,WAAAnL,CAAY6I,GAFJxP,KAAI+R,KAAW,EAGnB/R,KAAKgS,MAAQxC,EACbxP,KAAK+R,KAAOE,KAAKC,KACpB,CAED,KAAAC,CAAMC,GACF,OAAOpS,KAAKgS,MAAMK,KAAK7S,SAAS4S,EACnC,CAED,SAAIpG,GACA,OAAOhM,KAAKgS,MAAMhG,KACrB,CAED,QAAIsG,GACA,OAAOtS,KAAKgS,MAAMM,IACrB,CAED,iBAAWC,GACP,OAAOT,EAAWU,SACrB,CAQD,kBAAaC,CAAMC,GACf,OAAOD,MAAMC,EAAY,cAAcT,KAAKC,SAASS,MAAMC,IACvD,IAAKA,EAAIC,GAAM,MAAM,IAAIvV,MAAM,uBAC/B,OAAOsV,EAAIE,MAA0B,IACtCH,MAAKzR,GAAK4Q,EAAWiB,aAAe,IAAIjB,EAAW5Q,IACzD,CAID,WAAO2G,CAAK6K,GACR,OAAO1S,KAAKyS,MAAMC,GAAWC,MAAKzR,IAC9B4Q,EAAWU,QAAU,KACbV,EAAWiB,cACPd,KAAKC,MAAQJ,EAAWiB,aAAahB,KAAO,KAC5CD,EAAWW,MAAMC,GAElBZ,EAAWiB,cAEtBjB,EAAWkB,YAAc,IAAMlB,EAAWW,MAAMC,EAAU,GAEjE,EC/DC,SAAUO,EAAoBxO,GAChC,MAAyB,iBAAXA,EAAsBA,EAASA,EAAOqF,YACxD,UCEgBoJ,EAAe3F,EAA4BC,EAAkBnF,GACzE,MAAM8K,EAAMF,EAAoB1F,GAC1B1B,EAAOuH,EAAeD,EAAK3F,GAC3B6F,EAASvB,EAAWS,OAAOvG,MACjC,OVwDG,SAA4BsH,EAAQ5H,EAAGC,GAC1C,MAAM7C,EAAQyK,SAASD,EAAOE,YAAa9H,EAAE5C,MAAMsC,MAAOM,EAAE5C,MAAMuC,MAClE,IAAKvC,EACD,OACJ,MAAM8G,EAAQ/E,EAAOa,EAAEkE,OACjB3D,EAAQN,GAAQK,OAASN,EAAEO,OAAS,IACnCP,EAAEO,MACLnC,aAAc6B,EAAOK,MAAMlC,aAC3BqC,WAAYR,EAAOK,MAAMG,WACzBsH,KAAM/H,EAAE5C,MAAMuC,KACdqI,aAAc,KACd9D,MAAwB,iBAAVA,EAAqBA,EAAQA,EAAM9O,KAAK,KACtD6S,KAAMjI,EAAEO,OAAO0H,KAAOjI,EAAEO,MAAM0H,KAAO,GACrCC,SAAS,GAEb,IAAI5L,EAAM,CAAEc,QAAO8G,QAAO3D,SAC1B4H,iBAAiBP,EAAQtL,GAAK,GAAO,GACrCA,EAAI8L,WAAanI,GAAQoI,YAAcjL,EAAMgL,WAC7C,MAAME,EAAQtI,EAAEjG,UAAYoF,EAAOa,EAAEjG,UACrC,GAAIuO,EAAO,CACHA,EAAMtO,YACNI,8BAA8BwN,EAAQtL,EAAKgM,EAAMtO,WAAY,CAAE5G,MAAM,IACpEkJ,EAAIvC,WACLuC,EAAIvC,SAAW,IACnB,MAAMwO,EAASjM,EAAIvC,SACnB,IAAK,MAAMT,KAAOgP,EAAO,CACrB,MAAME,EAAIlP,EACE,eAARA,IAEa,WAARA,EACDgG,EAAcgJ,EAAMG,UAChBnJ,EAAciJ,EAAOE,QACrBH,EAAMG,OAAOtO,SAAQzI,IACb6W,EAAOE,SAAWF,EAAOE,OAAO3U,SAASpC,IACzC6W,EAAOE,OAAOrV,KAAK1B,EACtB,IAIL6W,EAAOE,OAASvW,MAAMmE,KAAKiS,EAAMG,SAI5B,kBAARnP,EACDgG,EAAcgJ,EAAMI,gBAAkBpJ,EAAciJ,EAAOE,UAC3DF,EAAOE,OAASF,EAAOE,OAAOnW,QAAOZ,IAAM4W,EAAMI,eAAe5U,SAASpC,WAG1DoI,IAAdyO,EAAOC,WAA2BD,EAAOC,WAAcF,EAAME,IAClE9S,OAAOC,OAAO4S,EAAQ,CAAEC,CAACA,GAAIF,EAAME,KAE1C,CACJ,CACD,GAAIvI,GAAQE,KAAM,CACd,MAAMA,EAAO0H,SAASD,EAAOE,YAAa,WAAY7H,EAAOE,KAAK8H,MAC9D9H,GACAwI,cAAcf,EAAQtL,EAAK,CAAEc,MAAO+C,GAAQF,EAAOE,KAAK/B,cAAc,EAC7E,MACI,GAAI4B,EAAEO,OAAO0H,KAAM,CACpB,MAAM9H,EAAO0H,SAASD,EAAOE,YAAa,WAAY9H,EAAEO,MAAM0H,MAC1D9H,GACAwI,cAAcf,EAAQtL,EAAK,CAAEc,MAAO+C,GAAQ,MAAM,EACzD,CACD,OAAO7D,CACX,CUxHWsM,CAAmB9G,EAAOnF,EAAG,CAChC2D,MAAO,CAAEG,WAAYkH,EAAOxU,KAAMiL,aAAcuJ,EAAOjB,KAAOvG,KAAM,CAChE8H,KAAM9H,EACN/B,aAAcqJ,GAElBY,WAAY,IAEpB,UASgBQ,EAAuBhP,EAAwB8C,EAA+BwD,GAC1F,MAAMwH,EAASvB,EAAWS,OAAOvG,MACjC,OAAOR,EAAgBjG,EAAM8C,EAAG,CAAE2D,MAAO,CAAEG,WAAYkH,EAAOxU,KAAMiL,aAAcuJ,EAAOjB,KAAOvG,KAAMA,IAAQ,GAClH,UAEgB2I,EAAyB/P,EAAmBc,EAAkCsG,GAC1F,IAAKtG,EAAM,OAAO,EAClB,MAAMpH,EAAIsG,EAAO0G,WAAWsJ,MAAKrX,GAAKA,EAAE0L,MAAMsC,MAAMC,OAAS9F,EAAKuD,MAAMsC,QACxE,QAAKjN,GACEoW,EAAuBpW,EAAGoH,EAAMsG,EAC3C,UAEgB6I,EAAwBjQ,EAAmBsH,EAA2BF,GAClF,MAAM8I,EAAK7E,EAAelR,IAAImN,GAC9B,QAAK4I,GACEH,EAAyB/P,EAAQkQ,EAAI9I,EAChD,CAiBgB,SAAA+I,EAAkBhP,EAAyBiG,GACvD,MAAMgJ,EAAU5J,EAAYrF,GACtByN,EAASvB,EAAWS,OAAOvG,MAC3BL,EAAS,CAAEK,MAAO,CAAEG,WAAYkH,EAAOxU,KAAMiL,aAAcuJ,EAAOjB,KAAOvG,QAEzEiJ,EAAU,IAAI/W,IAKpB,OAJA4R,EAAY9J,SAAQzI,IAChB,MAAMe,EAAI0W,EAAQjW,IAAIxB,EAAE0L,MAAMsC,OACzBjN,GAAMqN,EAAgBrN,EAAGf,EAAGuO,IAASmJ,EAAQ5W,IAAId,EAAE0L,MAAMsC,MAAM,IAEjE0J,CACX,CAEgB,SAAA1B,EAAe2B,EAA6BC,GACxD,MAAM7B,EAAMF,EAAoB8B,GAChC,OAAIC,EAAOC,WAAaD,EAAOC,UAAUnL,eAAiBqJ,EAAY,eAClE6B,EAAOE,WAAaF,EAAOE,UAAU5P,MAAKlI,GAAKA,EAAE0M,eAAiBqJ,IAC3D,gBACJ,kBACX,CFvCWrB,EAAOU,QAAqB,KAC/B,MAAM,IAAIlV,MAAM,2BAA2B,EAGhCwU,EAAYiB,kBAA2BvN,QGxC7C2P,EAGT,MAAIxN,GACA,OAAO3H,KAAK0Q,MACf,CAED,MAAI/I,CAAG5D,GACH/D,KAAK0Q,OAAS3M,CACjB,CAID,WAAO8D,CAAK1H,EAAmBmE,GAC3B6Q,EAAiB7L,SAAW,IAAI6L,EAAiBhV,EACpD,CAED,WAAAwG,CAAYxG,GAhBJH,KAAM0Q,QAAY,EAiBtBvQ,EAAIuC,aAAa,kCAAmC,GAAG,CAACsE,EAAMC,IACtDjH,KAAK0Q,OAAe,GACjBzJ,EAAKD,KAGhB7G,EAAIuC,aAAa,uBAAwB,GAAG,CAACsE,EAAMC,IAClCD,EAAK,GACT8B,MAAMuC,KAAK+J,WAAW,eAAiBpV,KAAK0Q,OAAe,GAC7DzJ,EAAKD,IAEnB,GJrBL,SAAKqJ,GACDA,EAAAA,EAAA,cAAA,GAAA,gBACAA,EAAAA,EAAA,aAAA,GAAA,cACH,CAHD,CAAKA,IAAAA,EAGJ,CAAA,IAEK,MAAOgF,WAAqB/E,EAM9B,WAAA3J,CAAqBnC,EAAiEC,EAA6CmI,EAAmByD,EAAWiF,cAC7JC,QADiBvV,KAAKwE,MAALA,EAAiExE,KAAMyE,OAANA,EAA6CzE,KAAI4M,KAAJA,EAE1G,IAAjBpI,EAAMvE,OAAcD,KAAKwV,OAAS,GACT,iBAAbhR,EAAM,GAAiBxE,KAAKwV,OAAUhR,EAA+B3C,KAAIzE,GAAK0S,EAAelR,IAAIxB,KAC5G4C,KAAKwV,OAAShR,EACnBxE,KAAKyV,WAAaxC,EAAoBxO,EACzC,CAED,qBAAOiR,CAAenQ,EAAsBgI,EAAgBC,GACxD,MAAMmI,EAAQzC,EAAe3F,EAAQC,EAAOjI,GAC5C,IAAKoQ,EAAO,OACZ,MAAMC,EAASpI,EAAMrC,WAAW0K,WAAUzY,GAAKA,EAAE0L,MAAMsC,QAAUuK,EAAM7M,MAAMsC,QACzEwK,GAAU,EAAGpI,EAAMrC,WAAWyK,GAAUD,EACvCnI,EAAMrC,WAAWrM,KAAK6W,EAC9B,CAED,GAAA1H,CAAIrI,GACA,MAAMkQ,EAAalQ,EAAOkE,aAC1B,IAAKgM,EAAY,OAAO1F,EAAec,YAEvC,GAAIlR,KAAK4M,OAASyD,EAAW0F,cACzB/V,KAAKwV,OAAO3P,SAAQmQ,GAAUX,GAAaK,eAAeM,EAAQhW,KAAKyV,WAAY7P,KACnFwG,EAAiBxG,OACd,CACH,MAAM4H,EAAQyI,kBAAkBxB,MAAKnW,GAAKA,EAAEwL,eAAiB9J,KAAKyV,aAClE,IAAKjI,EAAO,OAAO4C,EAAec,YAElClR,KAAKwV,OAAO3P,SAAQmQ,GAAUX,GAAaK,eAAeM,EAAQF,EAAYtI,KAC9EpB,EAAiBoB,EACpB,CAED,OAAO4C,EAAea,QACzB,EAlCeoE,GAAAU,cAAgB1F,EAAW0F,cAC3BV,GAAAC,aAAejF,EAAWiF,aAgDxC,MAAOY,WAAuB5F,EAIhC,WAAA3J,CAAYlC,EAA4BkH,GACpC4J,QACAvV,KAAKmW,QAAUlD,EAAoBxO,GACnCzE,KAAKoW,SAAWzK,CACnB,CAED,wBAAO0K,CAAkB5R,EAAmBkH,GACxC7F,8BAA8BrB,EAAQkH,EAAOlH,OAAQkH,EAAOA,OAC/D,CAED,wBAAO2K,CAAkB7R,EAAmBkH,GACxC,MAAMpG,EAAOd,EAAO0G,WAAWsJ,MAAKrX,GAAKA,EAAE0L,MAAMsC,MAAMC,OAASM,EAAOlH,SAClEc,GACLO,8BAA8BrB,EAAQc,EAAMoG,EAAOA,OACtD,CAED,GAAAsC,CAAIrI,GACA,MAAMnB,EAASwR,kBAAkBxB,MAAKnW,GAAKA,EAAEwL,eAAiB9J,KAAKmW,UACnE,IAAK1R,EAAQ,OAAO2L,EAAec,YAEnCiE,EAAiB7L,SAAS3B,IAAK,EAC/B,MAAMkN,EAAU1E,EAAa1L,GAM7B,OALCzE,KAAKoW,SAASvU,KAAI1D,IAAc,CAAEsG,OAA4B,iBAAbtG,EAAEsG,OAAsBoQ,EAAQjW,IAAIT,EAAEsG,QAAUtG,EAAEsG,OAAQkH,OAAQxN,EAAEwN,WACjH3N,QAAOG,GAAKA,EAAEsG,SACdoB,SAAQ8F,GAAUuK,GAAeG,kBAAkB5R,EAAQkH,KAC5D3L,KAAKoW,SAASnW,OAAS,GAAGmM,EAAiB3H,GAC/C0Q,EAAiB7L,SAAS3B,IAAK,EACxByI,EAAea,QACzB,EAGC,MAAOsF,WAAuBjG,EAGhC,WAAA3J,CAAYlC,EAAqCD,GAC7C+Q,QAD6CvV,KAAKwE,MAALA,EAE7CxE,KAAKwV,OAAShR,EACdxE,KAAKmW,QAAUlD,EAAoBxO,EACtC,CAED,GAAAwJ,CAAIrI,GACA,MAAMnB,EAASwR,kBAAkBxB,MAAKnW,GAAKA,EAAEwL,eAAiB9J,KAAKmW,UACnE,IAAK1R,EAAQ,OAAO2L,EAAec,YACnC,MAAMsF,EAAkB,GASxB,OARA/R,EAAO0G,WAAWtF,SAAQzI,IACjB4C,KAAKwV,OAAOlQ,MAAKC,GACE,iBAATA,EAA0BnI,EAAE0L,MAAMuC,OAAS9F,EAC/CnI,EAAE0L,MAAMsC,MAAMC,OAAS9F,EAAKuD,MAAMsC,OAAShO,EAAE0L,MAAMuC,OAAS9F,EAAKuD,MAAMuC,QAC9EmL,EAAQ1X,KAAK1B,EAAE,IAEvBqH,EAAO0G,WAAaqL,EACpBpK,EAAiB3H,GACV2L,EAAea,QACzB,EAGC,MAAOwF,WAAwBnG,EAGjC,WAAA3J,CAAYlC,EAAqCiS,GAC7CnB,QAD6CvV,KAAK0W,MAALA,EAE7C1W,KAAK2W,OAASD,EACd1W,KAAKmW,QAAUlD,EAAoBxO,EACtC,CAED,GAAAwJ,CAAIrI,GACA,MAAMnB,EAASwR,kBAAkBxB,MAAKnW,GAAKA,EAAEwL,eAAiB9J,KAAKmW,UACnE,IAAK1R,EAAQ,OAAO2L,EAAec,YACnC,MAAMsF,EAAkB,GAUxB,OATA/R,EAAO0G,WAAWtF,SAAQzI,IAClBA,EAAE0L,MAAMsC,MAAMwL,SACd5W,KAAK2W,OAAO7X,KAAK1B,GAEjBoZ,EAAQ1X,KAAK1B,EAChB,IAELqH,EAAO0G,WAAaqL,EACpBpK,EAAiB3H,GACV2L,EAAea,QACzB,EAGC,MAAO4F,WAAyBvG,EAGlC,WAAA3J,CAAYlC,EAAqCiS,GAC7CnB,QAD6CvV,KAAK0W,MAALA,EAE7C1W,KAAK2W,OAASD,EACd1W,KAAKmW,QAAUlD,EAAoBxO,EACtC,CAED,GAAAwJ,CAAIrI,GACA,MAAMnB,EAASwR,kBAAkBxB,MAAKnW,GAAKA,EAAEwL,eAAiB9J,KAAKmW,UACnE,OAAK1R,GACLA,EAAO0G,WAAa1G,EAAO0G,WAAW2L,OAAO9W,KAAK2W,QAClDvK,EAAiB3H,GACV2L,EAAea,UAHFb,EAAec,WAItC,EAGC,MAAO6F,WAAqBzG,EAI9B,WAAA3J,CAAqBoF,EAAiBtH,EAA4BoH,GAC9D0J,QADiBvV,KAAK+L,MAALA,EAEjB/L,KAAKgX,OAASjL,EACd/L,KAAKmW,QAAUlD,EAAoBxO,GACnCzE,KAAKiX,MAAQpL,CAChB,CAED,GAAAoC,CAAIrI,GACA,MAAMnB,EAASwR,kBAAkBxB,MAAKnW,GAAKA,EAAEwL,eAAiB9J,KAAKmW,UACnE,IAAK1R,EAAQ,OAAO2L,EAAec,YAEnC,MAAMrF,EAAOuH,EAAexN,EAAQnB,GAOpC,OALAzE,KAAKgX,OAAOnR,SAAQkG,IAChB,MAAMxG,EAAOd,EAAO0G,WAAWsJ,MAAKrX,GAAKA,EAAE0L,MAAMsC,MAAMC,OAASU,IAC5DxG,GAAM8O,cAAc5P,EAAQc,EAAMsG,EAAMjG,EAAOkE,cAAc,EAAM,IAE3EsC,EAAiB3H,GACV2L,EAAea,QACzB,EAQC,MAAOiG,WAAyB5G,EAGlC,WAAA3J,CAAYlC,EAA4BD,GACpC+Q,QACAvV,KAAKmW,QAAUlD,EAAoBxO,GACnCzE,KAAKwV,OAAShR,CACjB,CAED,GAAAyJ,CAAIrI,GACA,MAAMnB,EAASwR,kBAAkBxB,MAAKnW,GAAKA,EAAEwL,eAAiB9J,KAAKmW,UACnE,OAAK1R,GACLzE,KAAKwV,OAAO3P,SAAQN,IAChB,MAAMoQ,EAAQlR,EAAO0G,WAAWsJ,MAAKrX,GAAKA,EAAE0L,MAAMsC,MAAMC,OAAS9F,EAAKwG,QACjE4J,IACAA,EAAMlQ,WAAUkQ,EAAMlQ,SAAW,IACtCrE,OAAOC,OAAOsU,EAAMlQ,SAAUF,EAAK4R,UAAS,IAEhD/K,EAAiB3H,GACV2L,EAAea,UARFb,EAAec,WAStC,EK3NC,SAAUkG,GAAexR,GAC3B,MAAMyR,EAAY,IAAIjZ,IAClBwH,EAAOuF,WAAWtJ,KAAIzE,GAAK,CAACA,EAAE0L,MAAMsC,MAAMC,KAAMjO,MAEpD,OAAOuS,EAAY9K,OAAMzH,IACrB,MAAMmI,EAAO8R,EAAUzY,IAAIxB,EAAE0L,MAAMsC,OACnC,SAAK7F,IAASiG,EAAgBjG,EAAMnI,EAAG,CAAE4O,OAAO,EAAMH,MAAM,IACjD,GAEnB,CAWA,SAASyL,GAAgB1R,EAAyB2R,GAC9C,IAAIC,EAAS5R,EAAOuF,WAAWnN,QAAOZ,GAAKma,EAAO/X,SAASpC,EAAE0L,MAAMsC,MAAMC,QACzE,OAAImM,EAAOvX,SAAWsX,EAAOtX,QACtBuX,EAAO3S,OAAMzH,KAEXoO,EAAgBpO,EADN0S,EAAelR,IAAIxB,EAAE0L,MAAMsC,MAAMC,MAChB,CAAEW,OAAO,EAAMH,MAAM,KAG7D,CAEM,SAAU4L,GAAiB7R,GAC7B,OAAO0R,GAAgB1R,EAAQ,CAAC,cAAgB0R,GAAgB1R,EAAQ,CAAC,aAC7E,CC1BA,SAAS8R,GAAwBlI,EAA6BmD,GAC1D,GAAkB,SAAdnD,EAAKxF,MAAiC,YAAdwF,EAAKxF,KAAoB,CACjD,MAAMkE,EAAS+H,kBAAkBxB,MAAKnW,GAAKA,EAAEwL,eAAiB0F,EAAKnF,SACnE,GAAI6D,GAAUrE,QAAUA,OAAOC,cAAgB2N,GAAiB5N,QAAS,CACrE,MAAMtE,EAAOsE,OAAOsB,WAAWsJ,MAAKrX,GAA4B,aAAvBA,EAAE0L,MAAMsC,MAAMC,OACjDpF,EAAQV,GAAME,UAAUC,YAAYO,WAC5BT,IAAVS,GAAuBA,EAAQ,GAAG0M,EAAK9I,OAAQqE,EACtD,CACJ,CACL,CAEA,SAASnI,GAAgBC,GACrB,MAAa,QAATA,EAAuB,CAAC,CAAEC,MAAO,IACnB,SAATD,EAAwB,CAAC,CAAEC,MAAO,IACzB,UAATD,EAAyB,CAAC,CAAEC,MAAO,IAChC,CAAC,CAAEA,MAAO,GAC1B,CCnBA,SAAS0R,GAAU3R,GACf,MAAa,QAATA,EAAuB,EACT,SAATA,EAAwB,EACf,QAATA,EAAuB,EACd,WAATA,EAA0B,EACvB,CAChB,CCNA,SAASD,GAAgBC,GACrB,MAAa,QAATA,EAAuB,CAAC,CAAEC,MAAO,IACnB,SAATD,EAAwB,CAAC,CAAEC,MAAO,IACzB,UAATD,EAAyB,CAAC,CAAEC,MAAO,IAChC,EAChB,CCLA,SAASF,GAAgBC,GACrB,MAAa,QAATA,EAAuB,CAAC,CAAE7D,EAAG,EAAGV,EAAG,EAAGhE,EAAG,IAC3B,SAATuI,EAAwB,CAAC,CAAE7D,EAAG,EAAGV,EAAG,EAAGhE,EAAG,IACjC,UAATuI,EAAyB,CAAC,CAAE7D,EAAG,EAAGV,EAAG,EAAGhE,EAAG,IACxC,EAChB,CCLA,MAAMuW,GAAQ,CACV4D,KAAM,CACFC,gBAAkB,EAClBC,wBAA0B,EAC1BC,mBAAqB,EACrBC,mBAAqB,GAEzBC,MAAO,CACHJ,gBAAkB,EAClBC,wBAA0B,EAC1BC,mBAAqB,EACrBC,mBAAqB,ICI7B,MAAME,GAAgB,CLMhB,cAA2B7T,EAAjC,WAAAsC,uBACa3G,KAAIgG,KAAG,cACPhG,KAAAmY,YAAoC,CAAC,YACrCnY,KAAeoY,gBAAe,CAAC,MAAO,OAAQ,QA4B1D,CA1BG,GAAAlZ,CAAI0G,EAAyBL,EAA4BS,GACrDL,EAAuBC,EAAQL,EAAMQ,GAAgBC,GACxD,CAED,IAAA0H,CAAK9H,EAAyBL,EAAcS,GACxC,OAAOzB,EAAwBgB,EAAMQ,GAAgBC,GACxD,CAED,IAAA5F,CAAKD,EAAmBmE,GACpBnE,EAAIuC,aAAa,kBAAmB,GAAG,CAACsE,EAAMC,KAC1C,MAAOuI,GAAQxI,EAKf,OAJA0Q,GAAwBlI,GAAM,CAAC5J,EAAQsI,KAClCsB,EAAapL,GAAqBjE,EAAI6C,aAAa,eAAgB,CAACkL,EAAQsB,EAAK9F,SAAS,IAGxFzC,EAAKD,EAAK,IAGrB7G,EAAIuC,aAAa,yBAA0B,GAAG,CAACsE,EAAMC,KACjD,MAAMoR,EAAYrR,EAIlB,OAHA0Q,GAAwBW,EAAU,IAAI,KAClCA,EAAU,GAAMA,EAAU,GAAWjU,IAAsBiU,EAAU,EAAE,IAEpEpR,EAAKoR,EAAU,GAE7B,GpB3CC,cAA2BhU,EAAjC,WAAAsC,uBACa3G,KAAIgG,KAAG,cACPhG,KAAAmY,YAAoC,CAAC,cACrCnY,KAAeoY,gBAAe,CAAC,MAAO,OAAQ,OAwB1D,CAvBG,GAAAlZ,CAAI0G,EAAyBL,EAA4BS,GACrD,MAAOsS,GAAU/S,EACjB,IAAK+S,EAAQ,OAEb,MAAMC,EAAUD,EAAO7S,UAAUqG,SAC3B0M,EAAYF,EAAO7S,UAAUgT,iBACnC3S,8BAA8BF,EAAQ0S,EAAQvS,EAAgBC,IAG9D6N,iBAAiBjO,EAAQ0S,GACrBC,GAAWC,GAAWnE,cAAczO,EAAQ0S,EAAQC,EAASC,EACpE,CAED,IAAA9K,CAAK9H,EAAyBL,EAAcS,GACxC,ODRQ,SAAwBxB,EAAekU,GACnD,MAAMhU,EAAaC,EAAmBH,GACtC,OAAKE,EACEgU,EAAQhU,GADSQ,EAAQ,WAEpC,CCIeyT,CAAwBpT,GAAOb,IAClC,MAAO4T,GAAU5T,EACjB,YAAiBc,IAAb8S,EAAOnb,EACHmb,EAAOnb,IAAM4I,EAAgBC,GAAM7I,EAAU+H,EAAQ,aAClDC,IAEJD,EAAQ,WAAW,GAEjC,GC3BC,cAAwBb,EAA9B,WAAAsC,uBACa3G,KAAIgG,KAAG,WACPhG,KAAWmY,YAAyB,CAAC,WAAY,WAAY,aACtEnY,KAAeoY,gBAAe,CAAC,MAAO,OAAQ,QASjD,CAPG,GAAAlZ,CAAI0G,EAAyBL,EAA4BS,GACrDL,EAAuBC,EAAQL,EAAMQ,EAAgBC,GACxD,CAED,IAAA0H,CAAK9H,EAAyBL,EAAcS,GACxC,OAAOzB,EAAwBgB,EAAMQ,EAAgBC,GACxD,GCPC,cAAyB3B,EAA/B,WAAAsC,uBACa3G,KAAIgG,KAAG,YACPhG,KAAAmY,YAAoC,CAAC,YAAa,YAC3DnY,KAAeoY,gBAAe,CAAC,MAAO,OAAQ,QAQjD,CAPG,GAAAlZ,CAAI0G,EAAyBL,EAA4BS,GACrDL,EAAuBC,EAAQL,EAAMQ,EAAgBC,GACxD,CAED,IAAA0H,CAAK9H,EAAyBL,EAAcS,GACxC,OAAOzB,EAAwBgB,EAAMQ,EAAgBC,GACxD,GmBbC,cAAwB3B,EAA9B,WAAAsC,uBACa3G,KAAIgG,KAAG,WACPhG,KAAAmY,YAAoC,CAAC,YAAa,aAAc,qBAAsB,WAAY,cAAe,wBACjHnY,KAAeoY,gBAAe,CAAC,OAAQ,MAAO,MAAO,SA8BjE,CA5BG,GAAAlZ,CAAI0G,EAAyBL,EAA4BS,GACrD,MAAMvB,EAASkT,GAAU3R,GACzBT,EAAKM,SAAQ1H,IACT,GAAKA,EACL,GAA0B,cAAtBA,EAAE2K,MAAM8P,UACR9S,8BAA8BF,EAAQzH,EAAG,CAAE0a,UAAWpU,SACrD,GAA0B,YAAtBtG,EAAE2K,MAAM8P,UAAyB,CACtC,QAAkCpT,IAA9BrH,EAAEsH,UAAUC,YAAYvH,EAAiB,OAChC,WAAT6H,EAAmBF,8BAA8BF,EAAQzH,EAAG,CAAEA,EAAG,IAChE2H,8BAA8BF,EAAQzH,EAAG,CAAEA,EAAGsG,GACtD,IAER,CAED,IAAAiJ,CAAK9H,EAAyBL,EAAcS,GACxC,GAAa,WAATA,EAAmB,OAAOb,IAE9B,MAAMV,EAASkT,GAAU3R,GACzB,OAAIT,EAAKV,OAAM1G,IACX,GAA0B,cAAtBA,EAAE2K,MAAM8P,WACR,GAAIza,EAAEsH,UAAUC,YAAYmT,YAAcpU,EAAQ,OAAO,OACtD,GAA0B,YAAtBtG,EAAE2K,MAAM8P,WACXza,EAAEsH,UAAUC,YAAYvH,IAAMsG,EAAQ,OAAO,EAErD,OAAO,CAAK,IACLS,EAAQ,aACZC,GACV,GCjCC,cAA0Bd,EAAhC,WAAAsC,uBACa3G,KAAIgG,KAAG,aACPhG,KAAAmY,YAAoC,CAAC,YACrCnY,KAAeoY,gBAAe,CAAC,MAAO,OAAQ,QAS1D,CAPG,GAAAlZ,CAAI0G,EAAyBL,EAA4BS,GACrDL,EAAuBC,EAAQL,EAAMQ,GAAgBC,GACxD,CAED,IAAA0H,CAAK9H,EAAyBL,EAAcS,GACxC,OAAOzB,EAAwBgB,EAAMQ,GAAgBC,GACxD,GCXC,cAAyB3B,EAA/B,WAAAsC,uBACa3G,KAAIgG,KAAG,YACPhG,KAAAmY,YAAoC,CAAC,aACrCnY,KAAeoY,gBAAe,CAAC,MAAO,OAAQ,QAc1D,CAZG,GAAAlZ,CAAI0G,EAAyBL,EAA4BS,GACrD,MAAMvB,EAASsB,GAAgBC,IACxB8S,GAASvT,EACVwT,EAAOD,GAAOrT,UAAUC,YAAYvD,EAC1CwD,EAAuBC,EAAQL,EAAMd,GACjCA,EAAO,GAAGtC,IAAM4W,QAAgDvT,IAAxCsT,GAAOrT,UAAUuT,qBACzCF,EAAMrT,SAASuT,mBAAqB,EAC3C,CAED,IAAAtL,CAAK9H,EAAyBL,EAAcS,GACxC,OAAOzB,EAAwBgB,EAAMQ,GAAgBC,GACxD,GCRC,cAA6B3B,EAAnC,WAAAsC,uBACa3G,KAAIgG,KAAG,uBACPhG,KAAAmY,YAAoC,CAAC,YACrCnY,KAAAoY,gBAA8B,CAAC,OAAQ,QAwBnD,CAtBG,GAAAlZ,CAAI0G,EAAyBL,EAA4BS,GACrD,MAAOiT,GAAU1T,EACZ0T,IACAA,EAAOxT,WAAUwT,EAAOxT,SAAW,IAC3B,SAATO,EACA5E,OAAOC,OAAO4X,EAAOxT,SAAUuO,GAAM4D,MAEvB,UAAT5R,GACL5E,OAAOC,OAAO4X,EAAOxT,SAAUuO,GAAMiE,OAE5C,CAED,IAAAvK,CAAK9H,EAAyBL,EAAcS,GACxC,MAAOiT,GAAU1T,EACX2T,EAAeD,EAAOxT,SAC5B,IAAKyT,EAAc,OAAOhU,EAAQ,YAElC,MAAMiU,EAAwB,SAATnT,EAAkBgO,GAAM4D,KAAO5D,GAAMiE,MAE1D,OADiB7W,OAAO2D,KAAKoU,GAActX,KAAIqS,GAAKgF,EAAahF,KAAgCiF,EAAqBjF,KACzGrP,OAAM1G,GAAKA,IAAW+G,EAAQ,aACpCC,GACV,ICzB0DtD,KAAIvD,GAAK,IAAIA,IAE/D8a,GAAkB,IAAIhb,IAAI8Z,GAAcrW,KAAIvD,GAAK,CAACA,EAAE0H,KAAM1H,eAEvD+a,GAAYzT,EAAyBI,EAAsB4G,GACvE,MAAM0M,EAAOF,GAAgBxa,IAAIoH,GACjC,IAAKsT,EAAM,OAAO,EAClB,MAAMzE,EAAU,IAAIzW,IAAIwH,EAAOuF,WAAWtJ,KAAIzE,GAAK,CAACA,EAAE0L,MAAMsC,MAAMC,KAAMjO,MAIxE,OAHA+X,EAAiB7L,SAAS3B,IAAK,EAC/B2R,EAAKpa,IAAI0G,EAAQ0T,EAAKnB,YAAYtW,KAAIzE,GAAKyX,EAAQjW,IAAIxB,KAAKwP,GAC5DuI,EAAiB7L,SAAS3B,IAAK,GACxB,CACX,CAeM,SAAU4R,GAAgB9U,GAC5B,MAAO,aAAaA,EAAOqF,cAAgB,IAC/C,CCnCO,MAAM0P,GAA8B,CAAE5M,KAAM,cAAe6C,IAAK,6JAC1DgK,GAA2B,CAAE7M,KAAM,cAAe6C,IAAK,+LACvDiK,GAA+B,CAAE9M,KAAM,cAAe6C,IAAK,qMAC3DkK,GAA6B,CAAE/M,KAAM,SAAU6C,IAAK,oGAEpDmK,GAAqC,CAC9CC,OAAQL,GACRM,OAAQH,aCXII,GAActK,EAAavE,EAAkDlE,GAEzF,OADKkE,IAAKA,EAAM,CAAA,GACTuE,EAAIuK,QAAQ,iBAAiB,CAACC,EAAOC,KACxC,GAAIhP,GAAKzG,OAAQ,CACb,GAAW,WAAPyV,EAAiB,OAAOC,kBAAkBjP,EAAIzG,QAClD,GAAW,cAAPyV,EAAoB,OAAOhP,EAAIzG,OAAOqF,cAAcxK,YAAc,GACtE,GAAW,cAAP4a,EAAoB,OAAOX,GAAgBrO,EAAIzG,OACtD,CACD,GAAIyG,GAAKtF,OAAQ,CACb,GAAW,WAAPsU,EAAiB,OAAOC,kBAAkBjP,EAAItF,QAClD,GAAW,cAAPsU,EAAoB,OAAOhP,EAAItF,OAAOkE,cAAcxK,YAAc,GACtE,GAAW,cAAP4a,EAAoB,OAAOX,GAAgBrO,EAAItF,OACtD,CACD,OAAIoB,GAAQA,EAAKkT,GACNlT,EAAKkT,GAAI5a,WAEb2a,CAAK,GAEpB,UAEgBG,GAAazO,EAAkBT,EAAkDlE,GAC7F,MAAMqT,EAAWN,GAAcpO,EAAO8D,IAAKvE,EAAKlE,GAC5B,WAAhB2E,EAAOiB,KACPvD,EAAeC,SAASM,WAAWyQ,GACZ,gBAAhB1O,EAAOiB,KACdvD,EAAeC,SAASM,WAAW,IAAOyQ,EAAW,KAC9B,UAAhB1O,EAAOiB,KACdvD,EAAeC,SAASa,YAAYkQ,GACb,SAAhB1O,EAAOiB,KACdvD,EAAeC,SAASY,SAASmQ,GACV,iBAAhB1O,EAAOiB,MACdvD,EAAeC,SAASgB,UAAU+P,EAE1C,CAEgB,SAAAC,GAAsBpP,EAAaqP,GAC/C,MAAMC,EAA2B,CAC7B,IAAK,MAAO,MACZ,KAAM,OAAQ,SACd,KAAM,MAAO,OAAQ,QACrB,MAAO,OAAQ,OAAQ,UAW3B,OAAOtP,EAAItK,MAAM,IAAIiB,KARL,CAACvD,EAAWwG,KACxB,MAAMrD,EAAIqD,EAAMoG,EAAIjL,OAASsa,EAAS,GAAe,GAATA,EAC5C,OAAIE,KAAKC,SAAWjZ,EACT+Y,EAAeC,KAAKE,MAAMF,KAAKC,SAAWF,EAAeva,SAE7D3B,CAAC,IAGsBwC,KAAK,GAC3C,CAEM,SAAU8Z,GAAQ5U,EAAmBJ,EAAyBnB,EAA4BgL,EAAazI,GACzG,MAAMqT,EAAWN,GAActK,EAAK,CAAE7J,UAAUoB,GAC1C6T,EAAO5H,EAAoBxO,GACpB,SAATuB,EACAqD,EAAeC,SAASM,WAAWyQ,GACnB,YAATrU,EACPqD,EAAeC,SAASiB,YAAYsQ,EAAMR,GAC1B,SAATrU,GACPqD,EAAeC,SAASmB,SAASoQ,EAAMR,EAE/C,CCrEM,MAAOS,WAAkBxK,EAG3B,WAAA3J,CAAYoU,GACRxF,QAFJvV,KAASgb,WAAY,EAGjBhb,KAAKib,SAAWF,CACnB,CAED,GAAA9M,CAAIrI,GAMA,OALI5F,KAAKgb,YACLhb,KAAKgb,WAAY,EACjBhb,KAAKib,SAAWhJ,KAAKC,MAAQlS,KAAKib,UAGlChJ,KAAKC,MAAQlS,KAAKib,SAAiB7K,EAAe8K,QAC/C9K,EAAea,QACzB,EAcC,MAAOkK,WAAkB7K,EAG3B,WAAA3J,CAAYyU,EAAoDC,GAC5D9F,QACAvV,KAAKsb,OAASF,EACdpb,KAAKqb,QAAUA,CAClB,CAED,GAAApN,CAAIrI,GACA,MAAM2V,EAAUvb,KAAKsb,OAAO1V,GAE5B,GAAI5F,KAAKqb,QAAS,CACd,MAAMG,EAA4B,KACF,mBAAjBxb,KAAKqb,QAA+Brb,KAAKqb,QAAQzV,EAAQ2V,GAChEA,EAAQE,OAAe,CAAE7O,KAAM5M,KAAKqb,QAAQzO,KAAM6C,IAAKzP,KAAKqb,QAAQI,QACjE,CAAE7O,KAAM5M,KAAKqb,QAAQzO,KAAM6C,IAAKzP,KAAKqb,QAAQK,QAHtB,GAK9BF,GACApB,GAAaoB,EAAU,CAAE5V,UAEhC,CACD,OAAO2V,EAAQvK,KAClB,EAEemK,GAAAQ,SAA2B,CAAE3K,MAAOZ,EAAea,SAAUwK,QAAQ,GACrEN,GAAAS,SAA2B,CAAE5K,MAAOZ,EAAea,SAAUwK,QAAQ,GACrEN,GAAAU,SAA2B,CAAE7K,MAAOZ,EAAec,YAAauK,QAAQ,GACxEN,GAAAW,KAAuB,CAAE9K,MAAOZ,EAAec,YAAauK,QAAQ,SAG3EM,GAGT,WAAApV,CAAYiB,GACR5H,KAAKgc,UAAYpU,CACpB,CAED,GAAAqG,CAAIrI,GACA,MAAMqW,EAASjc,KAAKgc,UAAUpW,GAC9B,YAAeJ,IAAXyW,EAA6B7L,EAAea,SACzCgL,CACV,EAGC,MAAOC,WAAuB5L,EAEhC,WAAA3J,CAAYlC,EAA0DmD,EAA8GuU,GAChL5G,QADkEvV,KAAQ4H,SAARA,EAA8G5H,KAASmc,UAATA,EAEhLnc,KAAKmW,QAAU1R,EAAO5C,KAAIzE,GAAkB,iBAANA,EAAiB0S,EAAelR,IAAIxB,GAAKA,IAAGY,QAAOZ,QAAWoI,IAANpI,GACjG,CAED,GAAA6Q,CAAIrI,GACA,MAAMiP,EAAUvJ,EAAc1F,GACxBkP,EAAU9U,KAAKmW,QAAQnY,QAAOZ,IACxBmX,EAAuBM,EAAQjW,IAAIxB,EAAE0L,MAAMsC,OAAQhO,EAAG4C,KAAKmc,aAGjEF,EAASjc,KAAK4H,SAAShC,EAAQ,CAAEkP,YACvC,YAAetP,IAAXyW,EAA6B7L,EAAea,SACzCgL,CACV,EClFC,MAAOG,WAAwB9L,EACjC,WAAA3J,CAAqBX,EAA+B4G,EAAyB9M,GACzEyV,QADiBvV,KAAIgG,KAAJA,EAA+BhG,KAAI4M,KAAJA,EAAyB5M,KAAIF,KAAJA,CAE5E,CAED,GAAAmO,CAAIrI,GACA,MAAMqW,WJckBrW,EAAyBI,EAAsB4G,GAC3E,MAAM0M,EAAOF,GAAgBxa,IAAIoH,GAEjC,IAAKsT,EAAM,OAAOpU,EAAQ,QAC1B,IAAKoU,EAAKlB,gBAAgB5Y,SAASoN,GAAO,OAAO1H,EAAQ,QAEzD,MAAM2P,EAAUvJ,EAAc1F,GACxBkP,EAAUwE,EAAKnB,YAAYna,QAAOZ,IAAMmX,EAAuBM,EAAQjW,IAAIxB,GAAI0S,EAAelR,IAAIxB,MAExG,OAAI0X,EAAQ7U,OAAS,EAAU,CAAE6U,WAC1BwE,EAAK5L,KAAK9H,EAAQ0T,EAAKnB,YAAYtW,KAAIzE,GAAKyX,EAAQjW,IAAIxB,KAAawP,EAChF,CIzBuByP,CAAgBzW,EAAQ5F,KAAKgG,KAAMhG,KAAK4M,MACvD,OAAO5M,KAAKF,KAAKmc,IAAW7L,EAAea,QAC9C,ECDC,SAAUqL,GAAgB1W,EAAyB4J,EAAe+M,EAAgCC,GACpG,OAAQP,IAEIA,EAAOnH,QAAgByH,EAAWN,EAAiCzM,GAC1C,cAApByM,EAAO5W,SAIP4W,EAAO5W,UACZ+U,GAAa,CAAExN,KAAM,cAAe6C,IAAK,sCAAsCD,EAAKxJ,iBAAiBiW,EAAO5W,YAAc,CAAEO,WACrHwK,EAAec,aAEdsL,EAAWhN,IAPnB4K,GAAa,CAAExN,KAAM,cAAe6C,IAAK,+FAAiG,CAAE7J,gBAC5I4J,EAAKiN,SAAW7C,GAAWE,WAQb1J,EAAea,QAE7C,CAEM,SAAUyL,GAAe9W,EAAyBI,EAAsB4G,EAAgB+P,GAE1F,IAAInN,EAAgB,CAAExJ,OAAM4G,QAE5B,MAAMgQ,EAA6B,CAC/B,IAAIR,GAAgBpW,EAAMwJ,EAAK5C,KAAM0P,GAAgB1W,EAAQ4J,GAAM,CAACqN,EAAgBrN,KAChF,MAAMsN,EAAmBD,EAAe/H,QAAQjT,KAAIM,GAAK2N,EAAelR,IAAIuD,IAAI8J,MAAMZ,OAAMvK,KAAK,MACjGsZ,GAAauC,EAAS7H,QAAQ+E,OAAQ,CAAEjU,UAAU,CAAEkX,qBACpDtN,EAAKiN,SAAWE,EAAS7H,QAAQgF,MAAM,IACvCtK,IACA,MAAMC,EAAMkN,EAASI,MAAMvN,EAAK5C,MAChC,IAAI6C,EAMA,OADA2K,GAAa,CAAExN,KAAM,cAAe6C,IAAK,sCAAsCD,EAAKxJ,sBAAsBwJ,EAAK5C,QAAU,CAAEhH,WACpHwK,EAAec,YALtBkJ,GAAa3K,EAAIoK,OAAQ,CAAEjU,WAC3B4J,EAAKiN,SAAWhN,EAAIqK,OACpBtK,EAAKwN,SAAU,CAIlB,KAEL,IAAIjB,IAAW,KACPvM,EAAKwN,UACL3D,GAAYzT,EAAQI,EAAMwJ,EAAK5C,MAC/BR,EAAiBxG,GACpB,IAEL,IAAImW,IAAW,KAAYvM,EAAKiN,UAAUrC,GAAa5K,EAAKiN,SAAU,CAAE7W,UAAS,KAGrF2K,EAAYhK,OAAOzH,KAAK,CAAE8S,YAAa,kBAAkB5L,IAAQ8K,MAAO8L,GAC5E,CCjEgB,SAAAK,GAAoBrX,EAAyBgH,GAmBzD8P,GAAe9W,EAAQ,cAAegH,EAlBD,CACjCkI,QAAS8E,GACTmD,MAAO,CACHG,IAAO,CACHrD,OAAQ,CAAEjN,KAAM,cAAe6C,IAAK,+DACpCqK,OAAQ,CAAElN,KAAM,SAAU6C,IAAK,kPAEnC0N,KAAQ,CACJtD,OAAQ,CAAEjN,KAAM,cAAe6C,IAAK,uFACpCqK,OAAQ,CAAElN,KAAM,SAAU6C,IAAK,qWAEnC2N,KAAQ,CACJvD,OAAQ,CAAEjN,KAAM,cAAe6C,IAAK,+EACpCqK,OAAQ,CAAElN,KAAM,SAAU6C,IAAK,gZAM/C,CCpBgB,SAAA4N,GAAoBzX,EAAyBgH,GAkBzD8P,GAAe9W,EAAQ,cAAegH,EAjBD,CACjCkI,QAAS8E,GACTmD,MAAO,CACHG,IAAO,CACHrD,OAAQ,CAAEjN,KAAM,cAAe6C,IAAK,6DACpCqK,OAAQ,CAAElN,KAAM,SAAU6C,IAAK,iUAEnC6N,KAAQ,CACJzD,OAAQ,CAAEjN,KAAM,cAAe6C,IAAK,4DACpCqK,OAAQ,CAAElN,KAAM,SAAU6C,IAAK,+OAEnC8N,MAAS,CACL1D,OAAQ,CAAEjN,KAAM,cAAe6C,IAAK,wEACpCqK,OAAQ,CAAElN,KAAM,SAAU6C,IAAK,8VAK/C,CCnBgB,SAAA+N,GAAmB5X,EAAyBgH,GAkBxD8P,GAAe9W,EAAQ,aAAcgH,EAjBA,CACjCkI,QAAS8E,GACTmD,MAAO,CACHG,IAAO,CACHrD,OAAQ,CAAEjN,KAAM,cAAe6C,IAAK,0DACpCqK,OAAQ,CAAElN,KAAM,SAAU6C,IAAK,oXAEnC6N,KAAQ,CACJzD,OAAQ,CAAEjN,KAAM,cAAe6C,IAAK,mDACpCqK,OAAQ,CAAElN,KAAM,SAAU6C,IAAK,8LAEnC8N,MAAS,CACL1D,OAAQ,CAAEjN,KAAM,cAAe6C,IAAK,oEACpCqK,OAAQ,CAAElN,KAAM,SAAU6C,IAAK,gdAK/C,CCnBM,MAAOgO,WAAoBnN,EAC7B,WAAA3J,CAAqB0U,EAA4BqC,GAC7CnI,QADiBvV,KAAOqb,QAAPA,EAA4Brb,KAAM0d,OAANA,CAEhD,CAED,GAAAzP,CAAIrI,GACA,MAAMnB,EAAS,MACX,IAAKzE,KAAK0d,QAAQjZ,OAAQ,OAC1B,MAAMhH,EAAIuC,KAAK0d,OAAOjZ,OACtB,MAAiB,iBAANhH,EAAuBwY,kBAAkBxB,MAAKnW,GAAKA,EAAEwL,eAAiBrM,IAC1EA,CACV,EALc,GAOf,OADA2c,GAAapa,KAAKqb,QAAS,CAAEzV,SAAQnB,UAAUzE,KAAK0d,QAAQ1W,MACrDoJ,EAAea,QACzB,EAUC,MAAO0M,WAAyBrN,EAWlC,WAAA3J,CAAYlC,EAA4BmZ,EAAkCC,EAAiBlL,GACvF4C,QAHIvV,KAASgb,WAAY,EAIzBhb,KAAKmW,QAAUlD,EAAoBxO,GACnCzE,KAAKoW,SAAWwH,EAChB5d,KAAK8d,YAAc,EACnB9d,KAAKib,SAAW4C,EAChB7d,KAAK+d,MAAQpL,CAChB,CAED,GAAA1E,CAAIrI,GACI5F,KAAKgb,YACLhb,KAAKgb,WAAY,EACjBhb,KAAKib,SAAWhJ,KAAKC,MAAQlS,KAAKib,SAClCjb,KAAK8d,YAAc7L,KAAKC,OAG5B,MAAMzN,EAASwR,kBAAkBxB,MAAKnW,GAAKA,EAAEwL,eAAiB9J,KAAKmW,UACnE,IAAK1R,EAAQ,OAAO2L,EAAec,YACnC,GAAuB,MAAnB8M,gBAAyB,OAAO5N,EAAec,YAEnD,IAAI+K,EAAsD,UAC1D,IAAK,MAAMgC,KAAKD,gBAAgBhgB,QAAO2B,GAAKA,EAAEue,qBAAuBle,KAAKmW,SAAWxW,EAAEoS,KAAO/R,KAAK8d,cAAc,CAC7G,GAAI9d,KAAKoW,SAAS+H,OAAOzQ,KAAKuQ,EAAEG,UAAW,CACvCnC,EAAS,SACT,KACH,CAAM,GAAIjc,KAAKoW,SAASiI,OAAO3Q,KAAKuQ,EAAEG,UAAW,CAC9CnC,EAAS,SACT,KACH,CACDjc,KAAK8d,YAAcrD,KAAK6D,IAAIte,KAAK8d,YAAaG,EAAElM,KACnD,CAMD,MAJe,YAAXkK,GAAwBhK,KAAKC,MAAQlS,KAAKib,WAC1CgB,EAAS,WAGE,WAAXA,GAAuBjc,KAAKoW,SAASmI,YACrCnE,GAAapa,KAAKoW,SAASmI,YACpBnO,EAAea,UAGX,WAAXgL,GAAuBjc,KAAKoW,SAASoI,YACrCpE,GAAapa,KAAKoW,SAASoI,YACpBpO,EAAea,UAGX,YAAXgL,GACAjc,KAAK+d,MAAMnY,EAAQnB,GACZ2L,EAAea,UAEnBb,EAAe8K,OACzB,EC/EW,SAAAuD,GAAc7Y,EAAyBL,GAC1B,OAArBmZ,mBACAA,iBAAiBC,WAAa,MAClCD,iBAAmB,KACG,eAAlBE,eACAC,gBAAgB,YAAa,oBACX,cAAlBD,eACAC,gBAAgB,SAAU,YACR,qBAAlBD,eAAwCE,gCACxCD,gBAAgBC,+BAAgCC,gCACpD,IAAItP,EAAMuP,aAAa,cApB3B,SAAsBvP,GAClB,OAAOA,EAAIwP,OAAOhf,OAAS,IAAMwP,EAAI2F,WAAW,OAAS3F,EAAI2F,WAAW,OAAS3F,EAAI2F,WAAW,IACpG,EAmBQ8J,CAAazP,IAjBrB,SAAkC0P,EAAiB1P,GAC1C0P,IACLH,aAAa,YAAaG,EAAU,OAAS1P,GAC7C2P,mBACJ,CAcQC,CAAyB5P,EAAK,IAElC,MAAM3F,EAAelE,EAAOkE,aAE5B,IAAKA,EAAc,OAEnB,MAEMG,EAAa,CACf,CAAErB,IAAK,2BAA4Be,KAAMwQ,kBAAkBvU,GAASkE,aAAcA,GAClF,CAAElB,IAAK,YAAaG,UAAWxD,GAAMuD,MAAMuC,KAAMrC,UAAWzD,GAAMuD,MAAMsC,MAAMC,MAC9E,CAAEiU,eAAgBC,GAClB,CAAE7W,eAAgBnD,GAAMuD,MAAMsC,MAAMC,MACpC,CAAEmU,WAAW,IAGI,YAAjBZ,eACAxU,gBAAgB,CAAEV,QAAS,gBAA4BM,KAAM,SAAUK,OAAQP,EAAcG,WAAYA,IAE7GwV,yBAAyB7Z,EAC7B,CAEM,MAAO8Z,WAAmBpP,EAI5B,WAAA3J,CAAYgZ,GACRpK,QAIIvV,KAASgb,WAAG,EAHhBhb,KAAK2Q,OAASgP,CACjB,CAGD,GAAA1R,CAAIrI,GAMA,GALK5F,KAAKgb,YACNhb,KAAKgb,WAAY,EACjBhb,KAAK2Q,OAASsB,KAAKC,MAAQlS,KAAK2Q,SAG/B+O,GAAWE,YAAa,OAAOxP,EAAea,SAEnD,MAAMgI,EAAS4G,aAAaja,EAAQ,YACpC,OAAKqT,GAELwF,GAAc7Y,EAAQqT,GAElBhH,KAAKC,MAAQlS,KAAK2Q,OAAeP,EAAea,SAC7Cb,EAAe8K,SALF9K,EAAec,WAMtC,EAvBMwO,GAAWE,aAAG,EA0BnB,MAAOE,WAA+BxP,EACxC,GAAArC,CAAIrI,GACA,MAAMpB,EAAQoB,EAAOuF,WAAWnN,QAAOG,GAAKA,EAAE2K,MAAMsC,MAAMC,KAAK+J,WAAW,UACpE7P,EAAOf,EAAMiW,KAAKE,MAAMF,KAAKC,SAAWlW,EAAMvE,SAKpD,OAJW6P,EAAelR,IAAI2G,EAAKuD,MAAMsC,MAAMC,OAE3CoT,GAAc7Y,EAAQL,GAEnB6K,EAAea,QACzB,ECnEW,SAAA8O,GAAkBna,EAAyBgH,GAEvD,MAAM+P,EAAmC,CACrCI,MAAO,CACHG,IAAK,CACDrD,OAAQ,CAAEjN,KAAM,cAAe6C,IAAK,iDACpCqK,OAAQ,CAAElN,KAAM,SAAU6C,IAAK,2VAEnC6N,KAAM,CACFzD,OAAQ,CAAEjN,KAAM,cAAe6C,IAAK,sDACpCqK,OAAQ,CAAElN,KAAM,SAAU6C,IAAK,6XAEnC8N,MAAO,CACH1D,OAAQ,CAAEjN,KAAM,cAAe6C,IAAK,wEACpCqK,OAAQ,CAAElN,KAAM,SAAU6C,IAAK,0WAKrCzJ,EAAuB,YAE7B,IAAIwJ,EAAgB,CAAExJ,OAAM4G,QAE5B,MAAMoT,EAAoB/D,IACtB7B,GAAaZ,GAAmB,CAAE5T,UAAU,CAAEkX,iBAAkBb,EAAOnH,QAAQjT,KAAIM,GAAK2N,EAAelR,IAAIuD,IAAI8J,MAAMZ,OAAMvK,KAAK,QAChI0O,EAAKiN,SAAW7C,GAAWE,MAAM,EAG/BmG,EAAoBhE,IACtB7B,GAAaV,GAAoB,CAAE9T,UAC/B,CAAEkX,iBAAkBb,EAAOnH,QAAQjT,KAAIM,GAAK2N,EAAelR,IAAIuD,IAAI8J,MAAMZ,OAAMvK,KAAK,QACxF0O,EAAKiN,SAAW,CAAE7P,KAAM,SAAU6C,IAAK,gMACvCD,EAAK5C,KAAO,QACZ4C,EAAKwN,SAAU,CAAI,EAGjBkD,EAAoBjE,IACtB7B,GAAaV,GAAoB,CAAE9T,UAC/B,CAAEkX,iBAAkBb,EAAOnH,QAAQjT,KAAIM,GAAK2N,EAAelR,IAAIuD,IAAI8J,MAAMZ,OAAMvK,KAAK,QACxF0O,EAAKiN,SAAW,CAAE7P,KAAM,SAAU6C,IAAK,yKACvCD,EAAK5C,KAAO,QACZ4C,EAAKwN,SAAU,CAAI,EAGjBmD,EAAoBlE,IACtB7B,GAAaX,GAAgB,CAAE7T,UAC3B,CAAEkX,iBAAkBb,EAAOnH,QAAQjT,KAAIM,GAAK2N,EAAelR,IAAIuD,IAAI8J,MAAMZ,OAAMvK,KAAK,QACxF0O,EAAKiN,SAAW7C,GAAWE,MAAM,EAG/BsG,EAAoBnE,IACtB,MAAMa,EAAmBb,EAAOnH,QAAQjT,KAAIM,GAAK2N,EAAelR,IAAIuD,IAAI8J,MAAMZ,OAAMvK,KAAK,MAEzF,GAAI4T,EAAwB9O,EAAQ,aAGhC,OAFAwU,GAAaX,GAAgB,CAAE7T,UAAU,CAAEkX,0BAC3CtN,EAAKiN,SAAW7C,GAAWE,QAI/B,GAAIlF,EAAkBhP,GAAQvG,MAAQ,EAAG,CACrC,MAAMghB,EAAyB,CAC3B,IAAI5C,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,kDAC5C,IAAIsM,IAAW,IAAM3B,GAAaV,GAAoB,CAAE9T,UAAU,CAAEkX,uBACpE,IAAIW,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,kFAC5C,IAAIgO,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,gHACvC,IAAIgO,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK6K,GAAsBd,GAAkB/J,IAAK,MACpF,IAAIqQ,GACJ,IAAIrC,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK6K,GAAsBd,GAAkB/J,IAAK,MACpF,IAAIqQ,GACJ,IAAIhF,GAAU,KACd,IAAIgF,GACJ,IAAIhF,GAAU,KACd,IAAIgF,GACJ,IAAIrC,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,0GACvC,IAAIgO,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,4HAGhD,OADAc,EAAYhK,OAAOmL,mBAAmB,CAAEE,YAAa,kBAAkB5L,IAAQ8K,MAAOuP,IAC/EjQ,EAAec,WACzB,CAEDkJ,GAAa,CAAExN,KAAM,cAAe6C,IAAK,iDAAmD,CAAE7J,WAC9FgH,EAAO,MACP4C,EAAKwN,SAAU,CAAI,EAGjBJ,EAA6B,CAC/B,IAAIR,GAAgBpW,EAAM4G,EAAM0P,GAAgB1W,EAAQ4J,GAAM,CAACqN,EAAgBrN,IACrC,IAAlCqN,EAAe/H,QAAQ7U,OAAqB+f,EAAiBnD,GACpD,QAATjQ,EAAuBwT,EAAiBvD,GACxCpC,KAAKC,SAAW,GAAYyF,EAAiBtD,GAC7CA,EAAe/H,QAAQtV,SAAS,YAAoBygB,EAAiBpD,GACrEA,EAAe/H,QAAQtV,SAAS,aAAqB0gB,EAAiBrD,QAA1E,IACArN,IACA,MAAMC,EAAMkN,EAASI,MAAMnQ,GAC3B,IAAI6C,EAMA,OADA2K,GAAa,CAAExN,KAAM,cAAe6C,IAAK,sCAAsCD,EAAKxJ,sBAAsBwJ,EAAK5C,QAAU,CAAEhH,WACpHwK,EAAec,YALtBkJ,GAAa3K,EAAIoK,OAAQ,CAAEjU,WAC3B4J,EAAKiN,SAAWhN,EAAIqK,OACpBtK,EAAKwN,SAAU,CAIlB,KAEL,IAAIjB,IAAW,KACPvM,EAAKwN,UACL3D,GAAYzT,EAAQI,EAAMwJ,EAAK5C,MAC/BR,EAAiBxG,GACpB,IAEL,IAAImW,IAAW,KAAYvM,EAAKiN,UAAUrC,GAAa5K,EAAKiN,SAAU,CAAE7W,UAAS,KAGrF2K,EAAYhK,OAAOzH,KAAK,CAAE8S,YAAa,kBAAkB5L,IAAQ8K,MAAO8L,GAC5E,CClHgB,SAAA0D,GAAiB1a,EAAyBgH,GACtD,MAAM+P,EAAmC,CACrCI,MAAO,CACHG,IAAK,CACDrD,OAAQ,CAAEjN,KAAM,cAAe6C,IAAK,iEACpCqK,OAAQ,CAAElN,KAAM,SAAU6C,IAAK,gQAEnC6N,KAAM,CACFzD,OAAQ,CAAEjN,KAAM,cAAe6C,IAAK,8DACpCqK,OAAQ,CAAElN,KAAM,SAAU6C,IAAK,0WAEnC8N,MAAO,CACH1D,OAAQ,CAAEjN,KAAM,cAAe6C,IAAK,oGACpCqK,OAAQ,CAAElN,KAAM,SAAU6C,IAAK,wcAKrCzJ,EAAuB,WAE7B,IAAIwJ,EAAgB,CAAExJ,OAAM4G,QAE5B,MA6DMgQ,EAA6B,CAC/B,IAAIR,GAAgBpW,EAAM4G,EAAM0P,GAAgB1W,EAAQ4J,GAAM,CAACqN,EAAgBrN,IACrC,IAAlCqN,EAAe/H,QAAQ7U,OA/DV,EAACgc,EAA+BzM,KACrD,MAAMsN,EAAmBb,EAAOnH,QAAQjT,KAAIM,GAAK2N,EAAelR,IAAIuD,IAAI8J,MAAMZ,OAAMvK,KAAK,MACzFsZ,GAAaZ,GAAmB,CAAE5T,UAAU,CAAEkX,qBAC9CtN,EAAKiN,SAAW7C,GAAWE,MAAM,EA4DmBkG,CAAiBnD,EAAgBrN,GACpE,QAAT5C,EAtCa,EAACqP,EAA+BzM,KACrD,MAAMsN,EAAmBb,EAAOnH,QAAQjT,KAAIM,GAAK2N,EAAelR,IAAIuD,IAAI8J,MAAMZ,OAAMvK,KAAK,MAEzF,GAAI4T,EAAwB9O,EAAQ,aAGhC,OAFAwU,GAAaX,GAAgB,CAAE7T,UAAU,CAAEkX,0BAC3CtN,EAAKiN,SAAW7C,GAAWE,QAI/B,GAAIlF,EAAkBhP,GAAQvG,MAAQ,EAAG,CACrC,MAAMghB,EAAyB,CAC3B,IAAI5C,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,gEAC5C,IAAIsM,IAAW,IAAM3B,GAAaV,GAAoB,CAAE9T,UAAU,CAAEkX,uBACpE,IAAIW,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,2FAC5C,IAAIgO,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,gHACvC,IAAIgO,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK6K,GAAsBd,GAAkB/J,IAAK,MACpF,IAAIqQ,GACJ,IAAIrC,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK6K,GAAsBd,GAAkB/J,IAAK,MACpF,IAAIqQ,GACJ,IAAIhF,GAAU,KACd,IAAIgF,GACJ,IAAIhF,GAAU,KACd,IAAIgF,GACJ,IAAIrC,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,oGACvC,IAAIgO,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,4HAGhD,OADAc,EAAYhK,OAAOmL,mBAAmB,CAAEE,YAAa,kBAAkB5L,IAAQ8K,MAAOuP,IAC/EjQ,EAAec,WACzB,CAEDkJ,GAAa,CAAExN,KAAM,cAAe6C,IAAK,+DAAiE,CAAE7J,WAC5G4J,EAAK5C,KAAO,MACZ4C,EAAKwN,SAAU,CAAI,EAMYoD,CAAiBvD,EAAgBrN,GACxDiL,KAAKC,SAAW,GA7CH,EAACuB,EAA+BzM,KACrD,MAAMsN,EAAmBb,EAAOnH,QAAQjT,KAAIM,GAAK2N,EAAelR,IAAIuD,IAAI8J,MAAMZ,OAAMvK,KAAK,MACzFsZ,GAAaX,GAAgB,CAAE7T,UAAU,CAAEkX,qBAC3CtN,EAAKiN,SAAW7C,GAAWE,MAAM,EA0CGqG,CAAiBtD,EAAgBrN,GAC3B,IAAlCqN,EAAe/H,QAAQ7U,OA5DV,EAACgc,EAA+BzM,KACrD,MAAMsN,EAAmBb,EAAOnH,QAAQjT,KAAIM,GAAK2N,EAAelR,IAAIuD,IAAI8J,MAAMZ,OAAMvK,KAAK,MACzFsZ,GAAaV,GAAoB,CAAE9T,UAAU,CAAEkX,qBAC/CtN,EAAKiN,SAAW,CAAE7P,KAAM,SAAU6C,IAAK,2SACvCD,EAAK5C,KAAO,OACZ4C,EAAKwN,SAAU,CAAI,EAuDiCiD,CAAiBpD,EAAgBrN,GAC3C,IAAlCqN,EAAe/H,QAAQ7U,OArDV,EAACgc,EAA+BzM,KACrD,MAAMsN,EAAmBb,EAAOnH,QAAQjT,KAAIM,GAAK2N,EAAelR,IAAIuD,IAAI8J,MAAMZ,OAAMvK,KAAK,MACzFsZ,GAAaX,GAAgB,CAAE7T,UAAU,CAAEkX,qBAC3CtN,EAAKiN,SAAW,CAAE7P,KAAM,SAAU6C,IAAK,qJAAsJ,EAkDzIyQ,CAAiBrD,EAAgBrN,QAAjF,IACAA,IACA,MAAMC,EAAMkN,EAASI,MAAMnQ,GAC3B,IAAI6C,EAMA,OADA2K,GAAa,CAAExN,KAAM,cAAe6C,IAAK,sCAAsCD,EAAKxJ,sBAAsBwJ,EAAK5C,QAAU,CAAEhH,WACpHwK,EAAec,YALtBkJ,GAAa3K,EAAIoK,OAAQ,CAAEjU,WAC3B4J,EAAKiN,SAAWhN,EAAIqK,OACpBtK,EAAKwN,SAAU,CAIlB,KAEL,IAAIjB,IAAW,KACPvM,EAAKwN,UACL3D,GAAYzT,EAAQI,EAAMwJ,EAAK5C,MAC/BR,EAAiBxG,GACpB,IAEL,IAAImW,IAAW,KAAYvM,EAAKiN,UAAUrC,GAAa5K,EAAKiN,SAAU,CAAE7W,UAAS,KAGrF2K,EAAYhK,OAAOzH,KAAK,CAAE8S,YAAa,kBAAkB5L,IAAQ8K,MAAO8L,GAC5E,CC1HgB,SAAA2D,GAAkB3a,EAAyBgH,GA4BvD8P,GAAe9W,EAAQ,YAAagH,EA3BC,CACjCkI,QAAS8E,GACTmD,MAAO,CACHG,IAAK,CACDrD,OAAQ,CAAEjN,KAAM,cAAe6C,IAAK,gEACpCqK,OAAQ,CACJlN,KAAM,SACN6C,IAAK,wQAGb6N,KAAM,CACFzD,OAAQ,CAAEjN,KAAM,cAAe6C,IAAK,yDACpCqK,OAAQ,CACJlN,KAAM,SACN6C,IAAK,gPAGb8N,MAAO,CACH1D,OAAQ,CAAEjN,KAAM,cAAe6C,IAAK,6FACpCqK,OAAQ,CACJlN,KAAM,SACN6C,IAAK,ocAOzB,OC9Ba+Q,GAET,WAAA7Z,CAAqB8Z,GAAAzgB,KAAMygB,OAANA,EACjBzgB,KAAK0gB,WAAa,IAAI3iB,IAAYiC,KAAKygB,OAAOjR,KAAKmR,WAAWD,WACjE,CAEO,IAAAE,GACJ5gB,KAAKygB,OAAOG,KAAK,aACpB,CAED,YAAAC,CAAaC,GACT9gB,KAAKygB,OAAOjR,KAAKmR,WAAWI,gBAAkBD,EAC9C9gB,KAAK4gB,MACR,CAED,YAAAI,CAAaC,EAAY/iB,GACjBA,EACK8B,KAAK0gB,WAAWziB,IAAIgjB,KACrBjhB,KAAK0gB,WAAWxiB,IAAI+iB,GACpBjhB,KAAKygB,OAAOjR,KAAKmR,WAAWD,WAAW5hB,KAAKmiB,GAC5CjhB,KAAK4gB,QAGL5gB,KAAK0gB,WAAWziB,IAAIgjB,KACpBjhB,KAAK0gB,WAAWze,OAAOgf,GACvBjhB,KAAKygB,OAAOjR,KAAKmR,WAAWD,WAAa9iB,MAAMmE,KAAK/B,KAAK0gB,YACzD1gB,KAAK4gB,OAGhB,CAED,QAAIpR,GACA,OAAOxP,KAAKygB,OAAOjR,KAAKmR,UAC3B,CAED,mBAAAO,CAAoBC,EAAsBC,GACtC,MAAMjO,EAAMF,EAAoBmO,GAChC,QAAIphB,KAAKqhB,SAASD,OACdphB,KAAKshB,QAAQF,EAAWD,OACxBnhB,KAAKuhB,oBAAoBpO,OACzBnT,KAAKygB,OAAOjR,KAAKmR,WAAWI,kBACzB/gB,KAAKwhB,QAAQJ,EAAWD,KAElC,CAED,QAAAE,CAASD,GACL,MAAMjO,EAAMF,EAAoBmO,GAChC,OAAOtP,EAAWS,OAAOJ,MAAMgB,EAClC,CAED,OAAAqO,CAAQJ,EAA+BD,GACnC,MAAMhO,EAAMF,EAAoBmO,GAChC,SAAID,EAAUjM,YAAaiM,EAAUjM,UAAU5P,MAAKnH,GAAKA,EAAE2L,eAAiBqJ,IAE/E,CAED,OAAAmO,CAAQF,EAA+BD,GACnC,MAAMhO,EAAMF,EAAoBmO,GAChC,SAAID,EAAUlM,WAAakM,EAAUlM,UAAUnL,eAAiBqJ,EAEnE,CAED,mBAAAoO,CAAoBH,GAChB,MAAMjO,EAAMF,EAAoBmO,GAChC,OAAOphB,KAAK0gB,WAAWziB,IAAIkV,EAC9B,QClEQsO,GACT,WAAA9a,CAAqB8Z,GAAAzgB,KAAMygB,OAANA,EACjBzgB,KAAKwV,OAAS,IAAIpX,IAA4BqiB,EAAOjR,KAAKwG,OAAOxR,MAAM3C,KAAI1D,GAAK,CAACA,EAAEujB,MAAM3V,MAAO5N,MAChG6B,KAAK2hB,aAAe,IAAIvjB,IAA4BqiB,EAAOjR,KAAKwG,OAAO4L,YAAY/f,KAAI1D,GAAK,CAACA,EAAE4N,MAAO5N,KACzG,CAEO,IAAAyiB,GACJ5gB,KAAKygB,OAAOG,KAAK,SACpB,CAED,QAAYpR,GACR,OAAOxP,KAAKygB,OAAOjR,KAAKwG,MAC3B,CAED,aAAI6L,GACA,OAAO7hB,KAAKwP,KAAKqS,SACpB,CAED,aAAIA,CAAUf,GACV9gB,KAAKwP,KAAKqS,UAAYf,EACtB9gB,KAAK4gB,MACR,CAGD,GAAA1iB,CAAIqH,GACI3H,MAAMC,QAAQ0H,GACdA,EAAKM,SAAQ1H,GAAK6B,KAAKwV,OAAOtW,IAAIf,EAAEujB,MAAM3V,MAAO5N,KAEjD6B,KAAKwV,OAAOtW,IAAIqG,EAAKmc,MAAM3V,MAAOxG,GAEtCvF,KAAKwP,KAAKhL,MAAQ,IAAIxE,KAAKwV,OAAO9W,UAClCsB,KAAK4gB,MACR,CAED,SAAIpc,GACA,OAAOxE,KAAKwV,MACf,CAED,SAAIhR,CAAMsc,GACFljB,MAAMC,QAAQijB,IACd9gB,KAAKwP,KAAKhL,MAAQsc,EAClB9gB,KAAKwV,OAAS,IAAIpX,IAA4B0iB,EAAIjf,KAAI1D,GAAK,CAACA,EAAEujB,MAAM3V,MAAO5N,QAE3E6B,KAAKwP,KAAKhL,MAAQ,IAAIsc,EAAIpiB,UAC1BsB,KAAKwV,OAASsL,GAElB9gB,KAAK4gB,MACR,CAGD,eAAIgB,GACA,OAAO5hB,KAAK2hB,YACf,CAED,eAAIC,CAAYd,GACRljB,MAAMC,QAAQijB,IACd9gB,KAAKwP,KAAKoS,YAAcd,EACxB9gB,KAAK2hB,aAAe,IAAIvjB,IAA4B0iB,EAAIjf,KAAI1D,GAAK,CAACA,EAAE4N,MAAO5N,QAE3E6B,KAAKwP,KAAKoS,YAAc,IAAId,EAAIpiB,UAChCsB,KAAK2hB,aAAeb,GAExB9gB,KAAK4gB,MACR,EC1BL,SAAS5V,GAAcwE,GACnB,QAAK5R,MAAMC,QAAQ2R,IACZA,EAAK3K,OAAOU,GAAyB,iBAATA,GACvC,CAOM,SAAUuc,GAAStS,GACrB,MAAMuS,EAlDC,CACH/L,OAAQ,CACJ6L,WAAW,EACXrd,MAAO,GACPod,YAAa,IAEjBjB,WAAY,CACRD,WAAY,GACZK,iBAAiB,GAErBiB,SAAU,CACNC,iBAAkB,GAEtBC,KAAM,CACFC,gBAAiB,EACjBC,cAAe,EACfC,WAAY,EACZC,cAAe,EACfC,KAAM,CACFtR,SAAU,EACVyK,OAAQ,EACR8G,QAAS,CAAE,IAGnBC,OAAQ,CACJC,QAAS,EACTC,YAAa,IACbC,UAAW,IACXC,mBAAoB,KAExBC,QAAS,CACLC,OAAQ,EACRC,OAAQ,EACRC,OAAQ,EACRC,UAAW,IAiBbC,EAAK3T,EAELxH,EAA6B,CAAA,EA8FnC,OA5FAA,EAAIgO,OAAS,CAAExG,IACX,MAAM4T,EAASrB,EAAY/L,OAC3B,QAAaxQ,IAATgK,EAAoB,OAAO4T,EAG/B,GAD8B,kBAAnB5T,EAAKqS,YAAyBuB,EAAOvB,UAAYrS,EAAKqS,WAC7DjkB,MAAMC,QAAQ2R,EAAKhL,OAAQ,CAC3B,IAAIA,EAA0B,GAC9B,IAAK,MAAMe,KAAQiK,EAAKhL,MAAO,CAC3B,GAAoB,iBAATe,EAAmB,SAC9B,MAAM8d,EAAK9d,EACa,iBAAb8d,EAAG3B,QACe,iBAAlB2B,EAAG3B,MAAM7iB,MACU,iBAAnBwkB,EAAG3B,MAAM3V,QACI,iBAAbsX,EAAGC,OAAuBtY,GAAcqY,EAAGC,SAC3B,iBAAhBD,EAAGlM,UACd3S,EAAM1F,KAAKukB,GACd,CACDD,EAAO5e,MAAQA,CAClB,CAED,GAAI5G,MAAMC,QAAQ2R,EAAKoS,aAAc,CACjC,IAAIA,EAAgC,GACpC,IAAK,MAAMrc,KAAQiK,EAAKoS,YAAa,CACjC,GAAoB,iBAATrc,EAAmB,SAC9B,MAAM8d,EAAK9d,EACa,iBAAb8d,EAAG3B,QACU,iBAAb2B,EAAGtX,QACU,iBAAbsX,EAAGC,OAAuBtY,GAAcqY,EAAGC,SACtD1B,EAAY9iB,KAAKukB,GACpB,CACDD,EAAOxB,YAAcA,CACxB,CACD,OAAOwB,CACV,EAjCY,CAiCVD,EAAGnN,QAENhO,EAAI2Y,WAAa,CAAEnR,IACf,MAAM4T,EAASrB,EAAYpB,WAC3B,YAAanb,IAATgK,IAhDZ,SAAuBA,GACnB,QAAK5R,MAAMC,QAAQ2R,IACZA,EAAK3K,OAAOU,GAAyB,iBAATA,GACvC,CA8CYge,CAAc/T,EAAKkR,cAAa0C,EAAO1C,WAAalR,EAAKkR,YACzB,kBAAzBlR,EAAKuR,kBAA+BqC,EAAOrC,gBAAkBvR,EAAKuR,kBAF9CqC,CAIlC,EANgB,CAMdD,EAAGxC,YAEN3Y,EAAIga,SAAW,CAAExS,IACb,MAAM4T,EAASrB,EAAYC,SAC3B,YAAaxc,IAATgK,GACiC,iBAA1BA,EAAKyS,mBAA+BmB,EAAOnB,iBAAmBzS,EAAKyS,kBAD/CmB,CAGlC,EALc,CAKZD,EAAGnB,UAENha,EAAIka,KAAO,CAAE1S,IACT,MAAM4T,EAASrB,EAAYG,KAC3B,QAAa1c,IAATgK,EAAoB,OAAO4T,EAK/B,GAJoC,iBAAzB5T,EAAK2S,kBAA8BiB,EAAOjB,gBAAkB3S,EAAK2S,iBAC1C,iBAAvB3S,EAAK4S,gBAA4BgB,EAAOhB,cAAgB5S,EAAK4S,eACzC,iBAApB5S,EAAK6S,aAAyBe,EAAOf,WAAa7S,EAAK6S,YAChC,iBAAvB7S,EAAK8S,gBAA4Bc,EAAOd,cAAgB9S,EAAK8S,eAC/C,iBAAd9S,EAAK+S,KAAmB,CAC/B,MAAMa,EAASrB,EAAYG,KAAKK,KAGhC,GAFkC,iBAAvB/S,EAAK+S,KAAKtR,WAAuBmS,EAAOnS,SAAWzB,EAAK+S,KAAKtR,UACxC,iBAArBzB,EAAK+S,KAAK7G,SAAqB0H,EAAO1H,OAASlM,EAAK+S,KAAK7G,QACnC,iBAAtBlM,EAAK+S,KAAKC,QAAsB,CACvC,MAAMY,EAASrB,EAAYG,KAAKK,KAAKC,QACrC,IAAK,MAAMxd,KAAOwK,EAAK+S,KAAKC,QACiC,iBAA9ChT,EAAK+S,KAAKC,QAAQxd,KACzBoe,EAAOpe,GAA2BwK,EAAK+S,KAAKC,QAAQxd,GAE/D,CACJ,CACD,OAAOoe,CACV,EApBU,CAoBRD,EAAGjB,MAENla,EAAIya,OAAS,CAAEjT,IACX,MAAM4T,EAASrB,EAAYU,OAC3B,YAAajd,IAATgK,IACwB,iBAAjBA,EAAKkT,UAAsBU,EAAOV,QAAUlT,EAAKkT,SAC5B,iBAArBlT,EAAKmT,cAA0BS,EAAOT,YAAcnT,EAAKmT,aACtC,iBAAnBnT,EAAKoT,YAAwBQ,EAAOR,UAAYpT,EAAKoT,WACzB,iBAA5BpT,EAAKqT,qBAAiCO,EAAOP,mBAAqBrT,EAAKqT,qBAJnDO,CAMlC,EARY,CAQVD,EAAGV,QAENza,EAAI8a,QAAU,CAAEtT,IACZ,MAAM4T,EAASrB,EAAYe,QAC3B,YAAatd,IAATgK,IACuB,iBAAhBA,EAAKuT,SAAqBK,EAAOL,OAASvT,EAAKuT,QAC/B,iBAAhBvT,EAAKwT,SAAqBI,EAAOJ,OAASxT,EAAKwT,QAC/B,iBAAhBxT,EAAKyT,SAAqBG,EAAOH,OAASzT,EAAKyT,QAC5B,iBAAnBzT,EAAK0T,YAAwBE,EAAOF,UAAY1T,EAAK0T,YAJjCE,CAMlC,EARa,CAQXD,EAAGL,SAEC9a,CACX,OCjJawb,GACT,WAAA7c,CAAqB8Z,GAAAzgB,KAAMygB,OAANA,CAAwB,CAErC,IAAAG,GACJ5gB,KAAKygB,OAAOG,KAAK,SACpB,CAED,QAAIpR,GACA,OAAOxP,KAAKygB,OAAOjR,KAAKiT,MAC3B,CAED,UAAIA,GACA,OAAOziB,KAAKygB,OAAOjR,KAAKiT,OAAOC,OAClC,CAED,UAAID,CAAO3B,GACP9gB,KAAKygB,OAAOjR,KAAKiT,OAAOC,QAAU5B,EAClC9gB,KAAK4gB,MACR,CAED,eAAI+B,GACA,OAAO3iB,KAAKygB,OAAOjR,KAAKiT,OAAOE,WAClC,CAED,eAAIA,CAAY7B,GACZ9gB,KAAKygB,OAAOjR,KAAKiT,OAAOE,YAAc7B,EACtC9gB,KAAK4gB,MACR,CAED,sBAAIiC,GACA,OAAO7iB,KAAKygB,OAAOjR,KAAKiT,OAAOI,kBAClC,CAED,sBAAIA,CAAmB/B,GACnB9gB,KAAKygB,OAAOjR,KAAKiT,OAAOI,mBAAqB/B,EAC7C9gB,KAAK4gB,MACR,CAED,aAAIgC,GACA,OAAO5iB,KAAKygB,OAAOjR,KAAKiT,OAAOG,SAClC,CAED,aAAIA,CAAU9B,GACV9gB,KAAKygB,OAAOjR,KAAKiT,OAAOG,UAAY9B,EACpC9gB,KAAK4gB,MACR,CAED,UAAA6C,CAAW3C,GACP,MAAO,CACHnO,KAAM,CAACwL,EAAyBE,KACxBre,KAAKyiB,OAAS3B,EACVzC,GAAQA,EAAOre,KAAKyiB,SAExBziB,KAAKyiB,QAAU3B,EACf3C,EAAOne,KAAKyiB,QACf,EAGZ,QC3DQiB,GACT,WAAA/c,CAAqB8Z,GAAAzgB,KAAMygB,OAANA,CAAwB,CAErC,IAAAG,GACJ5gB,KAAKygB,OAAOG,KAAK,UACpB,CAED,QAAIpR,GACA,OAAOxP,KAAKygB,OAAOjR,KAAKsT,OAC3B,CAED,UAAIE,GACA,OAAOhjB,KAAKwP,KAAKwT,MACpB,CAED,UAAIA,CAAO7P,GACPnT,KAAKwP,KAAKwT,OAAS7P,EACnBnT,KAAK4gB,MACR,CAED,UAAImC,GACA,OAAO/iB,KAAKwP,KAAKuT,MACpB,CAED,UAAIA,CAAO5P,GACPnT,KAAKwP,KAAKuT,OAAS5P,EACnBnT,KAAK4gB,MACR,CAED,UAAIqC,GACA,OAAOjjB,KAAKwP,KAAKyT,MACpB,CAED,UAAIA,CAAO9P,GACPnT,KAAKwP,KAAKyT,OAAS9P,EACnBnT,KAAK4gB,MACR,CAED,UAAA+C,CAAW3lB,EAA8C+kB,GACrD,MAAMa,EAAU,CAAChe,EAAyBie,KAAyB7lB,EAAO4H,IAASie,GAAI,EACvFd,EAAOxb,UAAU3B,GAAWge,EAAQhe,GAAQ,IAAM5F,KAAK+iB,QAAU,MACjEA,EAAOtb,UAAU7B,GAAWge,EAAQhe,GAAQ,IAAM5F,KAAKijB,QAAU,MACjEF,EAAOrb,UAAU9B,GAAWge,EAAQhe,GAAQ,IAAM5F,KAAKgjB,QAAU,KACpE,QC5CQc,GACT,WAAAnd,CAAqB8Z,GAAAzgB,KAAMygB,OAANA,EAyBrBzgB,KAAgB+jB,iBAAW,CAzBkB,CAErC,IAAAnD,GACJ5gB,KAAKygB,OAAOG,KAAK,OACpB,CAED,WAAAoD,CAAYC,EAA0BC,GAClC,MAAMC,EAASnkB,KAAKygB,OAAOjR,KAAK0S,KAAKK,KAAKC,aAClBhd,IAApB2e,EAAOF,GACPE,EAAOF,GAAWC,EAEjBC,EAAOF,IAAuBC,EAEnClkB,KAAK4gB,MACR,CAED,aAAAwD,CAAcC,GACNA,EACArkB,KAAKygB,OAAOjR,KAAK0S,KAAKK,KAAKtR,WAE3BjR,KAAKygB,OAAOjR,KAAK0S,KAAKK,KAAK7G,SAE/B1b,KAAK4gB,MACR,CAGD,QAAA0D,CAASC,EAAqBC,EAAoBC,GAC9CzkB,KAAKygB,OAAOjR,KAAK0S,KAAKC,iBAAmBsC,EACrCF,IACAvkB,KAAKygB,OAAOjR,KAAK0S,KAAKE,eAAiBqC,GAEvCD,IACAxkB,KAAKygB,OAAOjR,KAAK0S,KAAKG,YAAcoC,GAEpCzkB,KAAK+jB,mBAAqB,KAC1B/jB,KAAK4gB,OACL5gB,KAAK+jB,iBAAmB,EAE/B,CAED,iBAAAW,CAAkBD,GACdzkB,KAAKygB,OAAOjR,KAAK0S,KAAKI,cAAgBmC,EACtCzkB,KAAK4gB,MACR,EC1CL,MAAM+D,GAAmD,CACrD3O,OAAQ,UACR2K,WAAY,UACZuB,KAAM,WACNF,SAAU,UACVS,OAAQ,UACRK,QAAS,YAMP,SAAU8B,GAAkB5f,GAC9B,MAAyC,aAAlC2f,GAAa3f,EACxB,CAEM,SAAU6f,GAAiB7f,GAC7B,MAAyC,YAAlC2f,GAAa3f,EACxB,CCXA,SAAS8f,GAAYC,GAYjB,OAAOjD,GAXMiD,EAAI9c,QAAO,CAAC+c,EAAMpgB,KAC3B,IAAKA,EAAK,OAAOogB,EACjB,IAAI9jB,EAAI+jB,SAASC,qBAAqBtgB,GACtC,IAAK1D,EAAG,OAAO8jB,EACf,IACI,IAAIG,EAAUC,KAAKC,MAAMnkB,GACzB,OAAOE,OAAOC,OAAO2jB,EAAMG,EAC9B,CAAC,MACE,OAAOH,CACV,IACF,CAA2B,GAElC,CAEA,SAASM,GAAU9V,GACf,OAAOyV,SAASM,iBAAiBH,KAAKI,UAAUhW,GACpD,CAEA,MAAMiW,GACF,WAAA9e,CAA6BqL,GAAAhS,KAAKgS,MAALA,CAAuB,CAEpD,KAAA0T,CAAM1gB,GACF,OAAOhF,KAAKgS,MAAMxC,KAAKwS,SAAShd,EACnC,CAED,MAAA2gB,CAAO3gB,EAAiCjB,GACpC/D,KAAKgS,MAAMxC,KAAKwS,SAAShd,GAAOjB,EAChC/D,KAAKgS,MAAM4O,KAAK,WACnB,EAGL,MAAMgF,GAAmB,iBACnBC,GAA2B,yBAqBjC,SAASjF,GAAKpR,EAAoBxK,GAC1B6E,QAAUA,OAAOic,0BACLtgB,IAARR,GAAqB6f,GAAiB7f,MACtC6E,OAAOic,kBAAkB3hB,GAAemhB,GDxC9C,SAA0B9V,GAC5B,OAAOpO,OAAO2D,KAAK4f,IAAc1c,QAAO,CAAC+c,EAAMpgB,KACvCigB,GAAiBjgB,IACjBxD,OAAOC,OAAO2jB,EAAM,CAAEpgB,CAACA,GAAM4K,EAAK5K,KAC/BogB,IACR,CAA0B,EACjC,CCkC8De,CAAgBvW,IAClEwW,kCAAkC7hB,UAE1BqB,IAARR,GAAqB4f,GAAkB5f,MACvC6E,OAAOic,kBAAkB5hB,GAAuBohB,GDpCtD,SAA4B9V,GAC9B,OAAOpO,OAAO2D,KAAK4f,IAAc1c,QAAO,CAAC+c,EAAMpgB,KACvCggB,GAAkBhgB,IAClBxD,OAAOC,OAAO2jB,EAAM,CAAEpgB,CAACA,GAAM4K,EAAK5K,KAC/BogB,IACR,CAA2B,EAClC,CC8BsEiB,CAAkBzW,IAC5EwW,kCAAkC9hB,IAG9C,OAEagiB,GAST,WAAAvf,CAAqB6I,GAAAxP,KAAIwP,KAAJA,EACjBxP,KAAKmmB,YAAc,IAAI3F,GAAoBxgB,MAC3CA,KAAKomB,QAAU,IAAI3E,GAAgBzhB,MACnCA,KAAKqmB,QAAU,IAAI7C,GAAgBxjB,MACnCA,KAAKsmB,SAAW,IAAI5C,GAAiB1jB,MACrCA,KAAKumB,MAAQ,IAAIzC,GAAc9jB,MAC/BA,KAAKwmB,SAAW,IAAIf,GAAiBzlB,KACxC,CAED,IAAA4gB,CAAK5b,GACD4b,GAAK5gB,KAAKwP,KAAMxK,EACnB,CAEM,mBAAWsE,GACd,OAAOtJ,KAAKuJ,SACf,CAEM,qBAAWoX,GACd,OAAO3gB,KAAKsJ,SAAS6c,WACxB,CAEM,iBAAWnQ,GACd,OAAOhW,KAAKsJ,SAAS8c,OACxB,CAEM,iBAAW3D,GACd,OAAOziB,KAAKsJ,SAAS+c,OACxB,CAEM,kBAAWvD,GACd,OAAO9iB,KAAKsJ,SAASgd,QACxB,CAEM,qBAAWG,GACd,OAAOzmB,KAAKsJ,SAASid,KACxB,CAEM,mBAAWvE,GACd,OAAOhiB,KAAKsJ,SAASkd,QACxB,CAEM,WAAO3e,CAAK1H,EAAmBsP,GAClC,OAAO,IAAIpJ,SAAsBC,IAC7B,MAAMogB,EAAqBxf,IACvB,IAAIlH,KAAKuJ,WACLrC,EAAG,CACH,MAAMsI,EAvF1B,SAActI,EAAoB/G,GAC9B,MAAMwmB,EAAmBzf,EAAE4e,kBAAkBF,IACvCgB,EAAoB1f,EAAE4e,kBAAkBD,IAC9C,GAAIc,GAAoBC,EAAmB,CACvC,MAAM5e,EAAM8c,GAAY,CAAC6B,EAAkBC,IAO3C,cANO1f,EAAE4e,kBAAkBF,WACpB1e,EAAE4e,kBAAkBD,IAC3B3e,EAAE4e,kBAAkB3hB,GAAewiB,EACnCzf,EAAE4e,kBAAkB5hB,GAAuB0iB,EAE3CzmB,EAAI6C,aAAa,aAAc,CAAC,gBAAiB,CAAE8iB,kBAAmB5e,EAAE4e,qBACjE9d,CACV,CAID,OAAO8c,GAAY,CAFC5d,EAAE4e,kBAAkB3hB,GACnB+C,EAAE4e,kBAAkB5hB,IAE7C,CAsEiC2iB,CAAK3f,EAAG/G,GACrBH,KAAKuJ,UAAY,IAAI2c,GAAY1W,GAC7BC,GAAKlS,QAAQupB,IAAIrX,GACrBnJ,EAAQtG,KAAKuJ,UAChB,GAGLpJ,EAAIuC,aAAa,gBAAiB,GAAG,CAACsE,EAAMC,KACxCA,EAAKD,GACL0f,EAAkB7c,OAAO,IAGzBA,QAAUA,OAAOC,cACjB4c,EAAkB7c,OACrB,GAER,EAtEcqc,GAAS3c,eAA4B/D,EC1EjD,MAAMuhB,GAAuB,CAACnhB,EAAyBsI,KACvC,iBAAXA,EAAsBA,EAAOpE,aAAeoE,KAAYtI,EAAOkE,aAE9Dkd,GAA4B,CAACphB,EAAyBwb,MAC3D8E,GAAYvF,WAAWO,oBAAoBtb,EAAQwb,GAU9C6F,GAAM,IAAIC,IACZ,CAACthB,EAAyBsI,IACtBgZ,EAAcriB,OAAMpD,GAAKA,EAAEmE,EAAQsI,KAIrCiZ,GAAOC,GACT,CAACxhB,EAAyBsI,KACrBkZ,EAAaxhB,EAAQsI,GAIxBmZ,GAAmCJ,GAAIE,GAAIJ,IAAStP,GAAkBuP,IACtEM,GAAuCL,GAAIE,GAAIJ,IAASC,IACxDO,GAAkCN,GAAIF,GAAQtP,IAC9C+P,GAAuCP,GArBlC,KAAIC,IACX,CAACthB,EAAyBsI,IACtBgZ,EAAc5hB,MAAK7D,GAAKA,EAAEmE,EAAQsI,KAmBOuZ,CAAGV,GAAQC,IAAcvP,IC9BpEiQ,GAA8B,CACvC,CACIzN,MAAO,2DACPmN,aAAcC,GACd,GAAApZ,CAAIrI,EAAQsI,EAAQyZ,GAChBtK,GAAoBzX,EACG,OAAf+hB,EAAQ,IAA4C,QAA7BA,EAAQ,GAAGC,cAAgC,MACnD,OAAfD,EAAQ,IAA4C,UAA7BA,EAAQ,GAAGC,cAAkC,QACrD,OAAfD,EAAQ,IAAeA,EAAQ,GAAGC,cAAiC,SAG9E,GAEL,CACI3N,MAAO,4DACPmN,aAAcC,GACd,GAAApZ,CAAIrI,EAAQsI,EAAQyZ,GAChBnK,GAAmB5X,EACI,OAAf+hB,EAAQ,IAA4C,QAA7BA,EAAQ,GAAGC,cAAgC,MACnD,OAAfD,EAAQ,IAA4C,UAA7BA,EAAQ,GAAGC,cAAkC,QACrD,OAAfD,EAAQ,IAAeA,EAAQ,GAAGC,cAAiC,SAG9E,GAEL,CACI3N,MAAO,8DACPmN,aAAcC,GACd,GAAApZ,CAAIrI,EAAQsI,EAAQyZ,GAChBpH,GAAkB3a,EACK,OAAf+hB,EAAQ,IAA4C,QAA7BA,EAAQ,GAAGC,cAAgC,MACnD,OAAfD,EAAQ,IAA4C,UAA7BA,EAAQ,GAAGC,cAAkC,QACrD,OAAfD,EAAQ,IAAeA,EAAQ,GAAGC,cAAiC,SAG9E,GAEL,CACI3N,MAAO,sDACPmN,aAAcC,GACd,GAAApZ,CAAIrI,EAAQsI,EAAQyZ,GAChB5H,GAAkBna,EACK,OAAf+hB,EAAQ,IAA4C,QAA7BA,EAAQ,GAAGC,cAAgC,MACnD,OAAfD,EAAQ,IAA4C,UAA7BA,EAAQ,GAAGC,cAAkC,QACrD,OAAfD,EAAQ,IAAeA,EAAQ,GAAGC,cAAiC,SAG9E,GAEL,CACI3N,MAAO,sDACPmN,aAAcC,GACd,GAAApZ,CAAIrI,EAAQsI,EAAQyZ,GAChBrH,GAAiB1a,EACM,OAAf+hB,EAAQ,IAA4C,QAA7BA,EAAQ,GAAGC,cAAgC,MACnD,OAAfD,EAAQ,IAA4C,UAA7BA,EAAQ,GAAGC,cAAkC,QACrD,OAAfD,EAAQ,IAAeA,EAAQ,GAAGC,cAAiC,SAG9E,GAEL,CACI3N,MAAO,kDACPmN,aAAcC,GACd,GAAApZ,CAAIrI,EAAQsI,EAAQyZ,GAChB1K,GAAoBrX,EACG,OAAf+hB,EAAQ,IAA4C,QAA7BA,EAAQ,GAAGC,cAAgC,MACnD,OAAfD,EAAQ,IAA4C,SAA7BA,EAAQ,GAAGC,cAAiC,OACpD,OAAfD,EAAQ,IAA4C,SAA7BA,EAAQ,GAAGC,cAAiC,OAChE,MAEd,GAEL,CACI3N,MAAO,4CACPmN,aAAcC,GACd,GAAApZ,CAAIrI,EAAQsI,EAAQyZ,IClEZ,SAAiB/hB,EAAyBgH,GACtD,MAAM+P,EAA+B,CACjC7H,QAAS8E,GACTmD,MAAO,CACHG,IAAK,CACDrD,OAAQ,CAAEjN,KAAM,cAAe6C,IAAK,yCACpCqK,OAAQ,CAAElN,KAAM,SAAU6C,IAAK,2NAEnCmI,KAAM,CACFiC,OAAQ,CAAEjN,KAAM,cAAe6C,IAAK,wCACpCqK,OAAQ,CAAElN,KAAM,SAAU6C,IAAK,0RAEnC6O,IAAK,CACDzE,OAAQ,CAAEjN,KAAM,cAAe6C,IAAK,qEACpCqK,OAAQ,CAAElN,KAAM,SAAU6C,IAAK,uWAKrCzJ,EAAuB,WAE7B,IAAIwJ,EAAgB,CAAExJ,OAAM4G,QAE5B,MAAMgQ,EAA6B,CAC/B,IAAIR,GAAgBpW,EAAM4G,EAAM0P,GAAgB1W,EAAQ4J,GAAM,CAACyM,EAAQzM,KACnE,MAAMsN,EAAmBb,EAAOnH,QAAQjT,KAAIM,GAAK2N,EAAelR,IAAIuD,IAAI8J,MAAMZ,OAAMvK,KAAK,MACpFmb,EAAOnH,QAAQtV,SAAS,cAMzB4a,GAAauC,EAAS7H,QAAQ+E,OAAQ,CAAEjU,UAAU,CAAEkX,qBACpDtN,EAAKiN,SAAWE,EAAS7H,QAAQgF,SANjCM,GAAauC,EAAS7H,QAAQ+E,OAAQ,CAAEjU,UAAU,CAAEkX,qBACpDtN,EAAKiN,SAAW,CAAE7P,KAAM,SAAU6C,IAAK,oUACvCD,EAAK5C,KAAO,SACZ4C,EAAKwN,SAAU,EAIlB,IACDxN,IACA,MAAMC,EAAMkN,EAASI,MAAMnQ,GAC3B,IAAI6C,EAMA,OADA2K,GAAa,CAAExN,KAAM,cAAe6C,IAAK,sCAAsCD,EAAKxJ,sBAAsBwJ,EAAK5C,QAAU,CAAEhH,WACpHwK,EAAec,YALtBkJ,GAAa3K,EAAIoK,OAAQ,CAAEjU,WAC3B4J,EAAKiN,SAAWhN,EAAIqK,OACpBtK,EAAKwN,SAAU,CAIlB,KAEL,IAAIjB,IAAW,KACPvM,EAAKwN,UACL3D,GAAYzT,EAAQI,EAAMwJ,EAAK5C,MAC/BR,EAAiBxG,GACpB,IAEL,IAAImW,IAAW,KAAYvM,EAAKiN,UAAUrC,GAAa5K,EAAKiN,SAAU,CAAE7W,UAAS,KAGrF2K,EAAYhK,OAAOzH,KAAK,CAAE8S,YAAa,kBAAkB5L,IAAQ8K,MAAO8L,GAC5E,CDWYiL,CAAiBjiB,EACM,OAAf+hB,EAAQ,IAA4C,QAA7BA,EAAQ,GAAGC,cAAgC,MACnD,OAAfD,EAAQ,IAA4C,OAA7BA,EAAQ,GAAGC,cAA+B,QAClD,OAAfD,EAAQ,IAAeA,EAAQ,GAAGC,cAAgC,OAG7E,GAEL,CACI3N,MAAO,gEACPmN,aAAcC,GACd,GAAApZ,CAAIrI,EAAQsI,EAAQyZ,IEtFZ,SAA6B/hB,EAAyBgH,GAelE8P,GAAe9W,EAAQ,uBAAwBgH,EAdV,CACjCkI,QAAS8E,GACTmD,MAAO,CACH9E,MAAS,CACL4B,OAAQ,CAAEjN,KAAM,cAAe6C,IAAK,uEACpCqK,OAAQ,CAAElN,KAAM,SAAU6C,IAAK,4NAEnCmI,KAAQ,CACJiC,OAAQ,CAAEjN,KAAM,cAAe6C,IAAK,yEACpCqK,OAAQ,CAAElN,KAAM,SAAU6C,IAAK,0RAM/C,CFuEYqY,CAA6BliB,EACN,OAAf+hB,EAAQ,IAA4C,UAA7BA,EAAQ,GAAGC,cAAkC,SACrD,OAAfD,EAAQ,IAAeA,EAAQ,GAAGC,cAAiC,QAG9E,IGzET,SAASG,GAAgBxiB,GACrB,YAAqDC,IAA7CD,EAAkCd,MAC9C,CAgBM,MAAOujB,WAAsB1X,EAG/B,WAAA3J,CAA6B4G,EAA4B9I,EAA6F4W,GAClJ9F,QADyBvV,KAAMuN,OAANA,EAAyHvN,KAAOqb,QAAPA,EAElJrb,KAAKmW,QAAU1R,EAAO5C,KAAI1D,IACtB,MAAiB,iBAANA,EAAuB,CAAEsG,OAAQqL,EAAelR,IAAIT,IAnBhE4pB,GADSxiB,EAqBYpH,IApByD,iBAA7CoH,EAAkCd,OAoBnCtG,EAjB3C,SAA0BoH,GACtB,OAAOwiB,GAAgBxiB,IAA8D,iBAA7CA,EAAkCd,MAC9E,CAgBqBwjB,CAAiB9pB,GAAW,IAAKA,EAAGsG,OAAQqL,EAAelR,IAAIT,EAAEsG,SAC9D,CAAEA,OAAQtG,GAvBlC,IAAoBoH,CAuBiB,GAEhC,CAED,GAAA0I,CAAIrI,GACA,MAAMiP,EAAU1E,EAAavK,GACfkM,EAAWS,OAAOvG,MAEhC,IAAIiQ,EAASjc,KAAKmW,QAAQlO,QAAO,CAAC+F,EAAK7P,KACnC,MAAM+pB,EAAYrT,EAAQjW,IAAIT,EAAEsG,OAAOqE,MAAMsC,OAK7C,OAJK8c,EACI3T,EAAuB2T,EAAW/pB,EAAEsG,UACpCyjB,EAAUziB,UAAYyiB,EAAUziB,SAAS0O,QAAQ3U,SAAS,QAASwO,EAAIma,QAAQrpB,KAAKX,GACxF6P,EAAIoa,UAAUtpB,KAAKX,IAHR6P,EAAIoa,UAAUtpB,KAAKX,GAI5B6P,CAAG,GACX,CAAEoa,UAAW,GAAID,QAAS,KAE7B,MAAME,EAAepM,EAAOkM,QAAQtmB,KAAI1D,GAAKA,EAAEsG,OAAOqE,MAAMsC,QAAOvJ,KAAI1D,GAAM0W,EAAQjW,IAAIT,GAAY2K,MAAMoD,cAAapL,KAAK,MAEvHwnB,EAAcrM,IACf,OAAExM,EAAgEzP,KAAKqb,UAAUY,GAAvExM,GAAO2K,GAAa3K,EAAK,CAAE7J,UAAU,CAAEyiB,iBAAjD,IAAE5Y,CAAwF,EAE/F,GAAIwM,EAAOkM,QAAQloB,OAAS,EAExB,OADAqoB,EAAW,CAAEtgB,IAAK,UAAWmgB,QAASlM,EAAOkM,QAAQtmB,KAAI1D,GAAKA,EAAEsG,OAAOqE,MAAMsC,UACtEgF,EAAec,YAG1B,GAAgC,IAA5B+K,EAAOmM,UAAUnoB,OAEjB,OADAqoB,EAAW,CAAEtgB,IAAK,WACXoI,EAAea,SAG1B,MAAMsX,EAAarC,GAAYlQ,OAAO4L,YAEhC/V,EAAOuH,EAAepT,KAAKuN,OAAQ3H,GAsBzC,OApBAuP,EAAiB7L,SAAS3B,IAAK,EAC/B/B,EAAOuF,WAAavF,EAAOuF,WAAW2L,OAAOmF,EAAOmM,UAAUvmB,KAAI1D,IAC9D,MAAM+pB,EAAYrT,EAAQjW,IAAIT,EAAEsG,OAAOqE,MAAMsC,OACvCod,EAAatV,EAAelT,KAAKuN,OAAQ3H,EAAQzH,EAAEsG,QACzD,IAAK+jB,EAAY,OAEjB,MAAMC,EAAQF,EAAW3pB,IAAIT,EAAEsG,OAAOqE,MAAMsC,OAQ5C,GANIqd,GAASA,EAAM/G,QAAU8G,EAAW1f,MAAMuC,OAAMmd,EAAW5Y,MAAQ6Y,EAAMnF,OACzEnlB,EAAEwN,QAAQ7F,8BAA8BF,EAAQ4iB,EAAYrqB,EAAEwN,aAC3BnG,IAAnCgjB,GAAY/iB,UAAUqG,UAAwBuI,cAAczO,EAAQ4iB,EAAY3c,EAAMjG,EAAOkE,cAC5F0e,EAAW/iB,WAAU+iB,EAAW/iB,SAAW,IAC5CtH,EAAEgZ,UAAU/V,OAAOC,OAAOmnB,EAAW/iB,SAAUtH,EAAEgZ,WAEhD+Q,EAAW,OAAOM,EAClBpnB,OAAOC,OAAO6mB,EAAWM,EAAW,IAC1CxqB,QAAOG,QAAWqH,IAANrH,KACfgX,EAAiB7L,SAAS3B,IAAK,EAC/ByE,EAAiBxG,GACjB0iB,EAAW,CAAEtgB,IAAK,SAAUwa,QAASvG,EAAOmM,UAAUnoB,SAC/CmQ,EAAea,QACzB,ECoCW,SAAAyX,GAAkB9iB,EAAyBnB,GACvD4E,EAAeC,SAASgB,UAAU,yCAClCwH,EAAWkB,cAAcL,MAAKgW,IAC1B,MAAM/L,EAA6B,CAC/B,IAAIa,GAAY,CAAE7Q,KAAM,eAAgB6C,IAAK,6CAC7C,IAAIgO,GAAY,CAAE7Q,KAAM,eAAgB6C,IAAK,+BAC7C,IAAIgO,GAAY,CAAE7Q,KAAM,eAAgB6C,IAAK,kCAAiCyW,GAAYvF,WAAWU,SAASzb,GAAU,SAAW,YACnI,IAAI6X,GAAY,CAAE7Q,KAAM,eAAgB6C,IAAK,0BAAyByW,GAAYvF,WAAWa,QAAQ5b,EAAQnB,GAAU,SAAW,YAClI,IAAIgZ,GAAY,CAAE7Q,KAAM,eAAgB6C,IAAK,0BAAyByW,GAAYvF,WAAWW,QAAQ1b,EAAQnB,GAAU,SAAW,YAClI,IAAI0W,IAAWvV,GACI,CACXsgB,GAAYvF,WAAWU,SAASzb,GAChCsgB,GAAYvF,WAAWa,QAAQ5b,EAAQnB,GACvCyhB,GAAYvF,WAAWW,QAAQ1b,EAAQnB,IACzCa,MAAKnH,GAAKA,IACOgd,GAAUQ,SACjBR,GAAUU,WACvB,CAACjW,EAAQqW,IACJA,EAAOR,OAAe,CAAE7O,KAAM,eAAgB6C,IAAK,sEAC3C,CAAE7C,KAAM,eAAgB6C,IAAK,yEAE7C,IAAIsM,IAAW,eAzJG4M,EAAiB/iB,EAAyBnB,GACpE,MAAMmkB,EAAyB,GACjBD,EAAI3c,MAClB,MAAM4Q,EAA6B,CAC/B,IAAIzB,IAAWvV,GACJwR,GAAe3S,GAAU0W,GAAUW,KAAOX,GAAUS,WAC5D,CAAC5M,EAAIiN,KACJ,GAAIA,EAAOR,OAAQ,OAAO9B,EAAgB,IAE9C,IAAI8D,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,wFAC5C,IAAIqL,GAAU,KACd,IAAI2C,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,gGAC5C,IAAIgO,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,gJAAkJ,CAAEhL,WAC3L,IAAIqW,GAAU,KACd,IAAI2C,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,8PAAgQ,CAAEhL,WACzS,IAAI4Q,GAAa,CAACtF,GAAatL,GAC/B,IAAIqW,GAAU,KACd,IAAI2C,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,2FAC5C,IAAIyG,GAAezR,EAAQ,CAAC,CAAEA,OAAQsL,EAAWjH,MAAMsC,MAAOO,OAAQ,CAAEkd,EAAK,EAAGpoB,EAAK,EAAGpC,EAAK,EAAG6C,EAAK,EAAGzD,EAAK,EAAG4F,EAAK,MACrH,IAAIyX,GAAU,KACd,IAAI2C,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,yFAA2F,CAAEhL,WACpI,IAAIgZ,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,oFAC5C,IAAIgO,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,4EAC5C,IAAIqL,GAAU,KACd,IAAI2C,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,uRAAyR,CAAEhL,WAClU,IAAIgS,GAAgBhS,EAAQmkB,GAC5B,IAAI9N,GAAU,KACd,IAAI2C,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,iDAC5C,IAAIgO,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,uLAAyL,CAAEhL,WAClO,IAAIyR,GAAezR,EAAQ,CAAC,CAAEA,OAAQsL,EAAWjH,MAAMsC,MAAOO,OAAQ,CAAEkd,EAAK,EAAGpoB,EAAK,EAAGpC,EAAK,EAAG6C,EAAK,EAAGzD,EAAK,EAAG4F,EAAK,MACrH,IAAIyX,GAAU,KACd,IAAI2C,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,2NAA6N,CAAEhL,WAC3Q,IAAIgZ,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,mGAC5C,IAAIkO,GAAiBlZ,EAAQ,CACzB0Z,OAAQ,eACRI,WAAY,CAAE3R,KAAM,cAAe6C,IAAK,0DACxC4O,OAAQ,MACRG,WAAY,CAAE5R,KAAM,SAAU6C,IAAK,uIACpC,MAAW,CAAC7J,EAAQnB,KACnB2V,GAAa,CAAExN,KAAM,SAAU6C,IAAK,sHAAwH,CAAE7J,SAAQnB,UAAS,IAEnL,IAAIqW,GAAU,KACd,IAAI2C,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,2JAA6J,CAAEhL,cAClM,CAAC,WAAY,WAAY,YAAqC5C,KAAIzE,GAAK,IAAIiY,GAAa,CAACjY,GAAIqH,KACjG,IAAIqW,GAAU,KACd,IAAI2C,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,8BAC5C,IAAIqL,GAAU,KACd,IAAI2C,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,4EAA8E,CAAEhL,WACvH,IAAIsS,GAAa,CAAC,WAAY,WAAY,YAAatS,GACvD,IAAIgZ,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,kDAC5C,IAAIqL,GAAU,KACd,IAAI2C,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,mGAAqG,CAAEhL,WAC9I,IAAIgZ,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,6JAA+J,CAAEhL,WACxM,IAAI4Q,GAAa,CAAC,uBAAwB,eAAgB5Q,GAC1D,IAAIgZ,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,yDAC5C,IAAIqL,GAAU,KACd,IAAI2C,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,qMAAuM,CAAEhL,WAChP,IAAIgZ,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,oSAAsS,CAAEhL,WAC/U,IAAI4Q,GAAa,CAAC,qBAAsB,YAAa,YAAa5Q,GAClE,IAAIgZ,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,8BAC5C,IAAIqL,GAAU,KACd,IAAI2C,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,gKAAkK,CAAEhL,WAC3M,IAAIsS,GAAa,CAAC,qBAAsB,YAAa,WAAY,wBAAyBtS,GAC1F,IAAIgZ,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,kDAC5C,IAAIgO,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,4PAA8P,CAAEhL,WACvS,IAAIgZ,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,sPAAwP,CAAEhL,WACjS,IAAI4Q,GAAa,CAAC,aAAc,aAAc,YAAa,cAAe5Q,GAC1E,IAAIqW,GAAU,KACd,IAAI2C,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,8BAC5C,IAAIqL,GAAU,KACd,IAAI2C,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,wIAA0I,CAAEhL,WACnL,IAAIsS,GAAa,CAAC,aAAc,aAAc,YAAa,cAAetS,GAC1E,IAAIgZ,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,kDAC5C,IAAIqL,GAAU,KACd,IAAI2C,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,qLAAuL,CAAEhL,WAChO,IAAI4Q,GAAa,CAAC,WAAY,YAAa5Q,GAC3C,IAAIgZ,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,wOAA0O,CAAEhL,WACnR,IAAIgZ,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,4JAA8J,CAAEhL,WACvM,IAAI4Q,GAAa,CAAC,YAAa,aAAc,cAAe5Q,GAC5D,IAAIqW,GAAU,KACd,IAAI5D,GAAiBzS,EAAQ,CAAC,CAAEsH,MAAO,aAAcoL,SAAU,CAAEtH,iBAAkB,IAAO,CAAE9D,MAAO,aAAcoL,SAAU,CAAEtH,iBAAkB,MAC/I,IAAI4N,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,oHAAsH,CAAEhL,WAC/J,IAAIqW,GAAU,KACd,IAAI2C,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,8BAC5C,IAAIqL,GAAU,KACd,IAAI/D,GAAa,CAAC,WAAY,WAAY,YAAa,aAAc,cAAetS,GACpF,IAAIgZ,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,mIAAqI,CAAEhL,WAC9K,IAAIyS,GAAiBzS,EAAQ,CAAC,CAAEsH,MAAO,aAAcoL,SAAU,CAAEtH,iBAAkB,CAAEiZ,OAAU,EAAGC,KAAQ,EAAGC,KAAQ,EAAGC,SAAY,GAAIC,SAAY,EAAGC,MAAS,OAChK,IAAIjT,GAAezR,EAAQ,CAAC,CAAEA,OAAQ,aAAckH,OAAQ,CAAEhO,EAAK,EAAG0F,EAAK,EAAG7E,EAAK,MACnF,IAAIif,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,kDAC5C,IAAIqL,GAAU,KACd,IAAI2C,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,yNAA2N,CAAEhL,WACpQ,IAAI4Q,GAAa,CAAC,YAAa,aAAc5Q,GAC7C,IAAIgZ,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,mLAAqL,CAAEhL,WAC9N,IAAIqW,GAAU,KACd,IAAI2C,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,8BAC5C,IAAIqL,GAAU,KACd,IAAI2C,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,2NAA6N,CAAEhL,WACtQ,IAAIsS,GAAa,CAAC,YAAa,aAActS,GAC7C,IAAIgZ,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,kDAC5C,IAAIqL,GAAU,KACd,IAAI2C,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,wHAA0H,CAAEhL,WACxK,IAAIqW,GAAU,KACd,IAAI2C,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,wPAA0P,CAAEhL,WACnS,IAAI4Q,GAAa,CAAC,YAAa5Q,GAC/B,IAAIqW,GAAU,KACd,IAAI2C,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,qMAAuM,CAAEhL,WAChP,IAAI4Q,GAAa,CAAC,uBAAwB5Q,GAC1C,IAAIyS,GAAiBzS,EAAQ,CAAC,CAAEsH,MAAO,sBAAuBoL,SAAU,CAAExN,KAAMlF,EAAOqF,cAAcxK,YAAc,OACnH,IAAIme,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,+BAC5C,IAAIqL,GAAU,KACd,IAAI/D,GAAa,CAAC,WAAY,uBAAwBtS,GACtD,IAAIgZ,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,8HAC5C,IAAIqL,GAAU,KACd,IAAI2C,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,2DAA6D,CAAEhL,WAC3G,IAAIoS,GAAiBpS,EAAQmkB,GAC7B,IAAI9N,GAAU,KACd,IAAI2C,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,2HAA6H,CAAEhL,WAC3K,IAAIyR,GAAezR,EAAQ,CAAC,CAAEA,OAAQsL,EAAWjH,MAAMsC,MAAOO,OAAQ,CAAEkd,EAAK,EAAGpoB,EAAK,EAAGpC,EAAK,EAAG6C,EAAK,EAAGzD,EAAK,EAAG4F,EAAK,MACrH,IAAI6S,GAAezR,EAAQ,CACvB,CAAEA,OAAQ,WAAYkH,OAAQ,CAAE1F,MAAO,IACvC,CAAExB,OAAQ,WAAYkH,OAAQ,CAAE1F,MAAO,IACvC,CAAExB,OAAQ,WAAYkH,OAAQ,CAAE1F,MAAO,IACvC,CAAExB,OAAQ,YAAakH,OAAQ,CAAE1F,MAAO,MAE5C,IAAI6U,GAAU,KACd,IAAI2C,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,ySAA2S,CAAEhL,WACpV,IAAI8R,GAAe9R,EAAQ,CAACsL,KAEhCQ,EAAYhK,OAAOzH,KAAK,CAAE8S,YAAa,iBAAkBd,MAAO8L,GACpE,CAwBgBwM,CAActX,EAAWS,OAAQ3M,EAAQnB,EAAO,KAGxD8L,EAAYhK,OAAOzH,KAAK,CAAE8S,YAAa,sBAAuBd,MAAO8L,GAAgB,IACtFyM,OAAMjsB,IACLiM,EAAeC,SAASgB,UAAU,uDAAuD,GAEjG,CAEgB,SAAAgf,GAAiBpb,EAA4BtI,GACzD,MAAM2jB,EAAuB,CACzB3c,KAAM,cACN6C,IAAK,qHAGKqC,EAAWS,OAAOvG,MAEhC,IAAIwd,EAAe,EAEnB,MAAMC,EAAyBha,GAAmBwM,GAC3B,WAAfA,EAAOjU,KAAoBiU,EAAOuG,SAAWgH,GAAgBvN,EAAOuG,QAAgB/S,GAChE,YAAfwM,EAAOjU,IAA0BuhB,OAArC,EAGH3M,EAA6B,CAC/B,IAAIzB,IAAU,IjClLhB,SAAqB1W,GACvB,MAAMsH,EAAQ,WACRxG,EAAOd,EAAO0G,WAAWsJ,MAAKrX,GAAKA,EAAE0L,MAAMsC,MAAMC,OAASU,IAC1DiK,EAASlG,EAAelR,IAAImN,GAClC,SAAKxG,IAASyQ,IACTxK,EAAgBjG,EAAMyQ,EAAQ,CAAEhK,OAAO,EAAMH,MAAM,IAE5D,CiC4KgB6d,CAAW9jB,GAAgBuV,GAAUQ,SAClCR,GAAUU,WAClB,CAAC7M,EAAIiN,KACJ,IAAKA,EAAOR,OAAQ,MAAO,CAAE7O,KAAM,cAAe6C,IAAK,iGAAkG,IAE7J,IAAIgO,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,oDAC5C,IAAIgO,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,gGAC5C,IAAIqL,GAAU,KACd,IAAI2C,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,kQAC5C,IAAI4F,GAAa,CAACtF,GAAa7B,EAAQmH,GAAaU,eACpD,IAAI+E,GAAU,KACd,IAAI2C,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,kEAC5C,IAAIyG,GAAetQ,EAAQ,CAAC,CAAEnB,OAAQsL,EAAWjH,MAAMsC,MAAOO,OAAQ,CAAEkd,EAAK,EAAGpoB,EAAK,EAAGpC,EAAK,EAAG6C,EAAK,EAAGzD,EAAK,EAAG4F,EAAK,MACrH,IAAI8X,IAAU,IACN/D,GAAexR,GAAgBuV,GAAUW,KACjCX,GAAUS,WACvB,CAAC5M,EAAIlR,IACAA,EAAE2d,OAAe,CAAE7O,KAAM,cAAe6C,IAAK,kJACrC,CAAE7C,KAAM,cAAe6C,IAAK,6FAE5C,IAAIgO,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,6LAC5C,IAAIuY,GAAc9Z,EAAQ,CACtB,CAAEzJ,OAAQ,YACV,CAAEA,OAAQ,YACV,CAAEA,OAAQ,aACV,CAAEA,OAAQ,aAAc0S,SAAU,CAAEtH,iBAAkB,IACtD,CACIpL,OAAQ,aACRkH,OAAQ,CAAEhO,EAAK,EAAG0F,EAAK,EAAG7E,EAAK,GAC/B2Y,SAAU,CAAEtH,iBAAkB,CAAEiZ,OAAU,EAAGC,KAAQ,EAAGC,KAAQ,EAAGC,SAAY,GAAIC,SAAY,EAAGC,MAAS,MAG/GM,EAAsB,CAClB7c,KAAM,cACN6C,IAAK,oYAEb,IAAIuY,GAAc9Z,EAAQ,CAAC,aAAc,uBAAwB,eAAgBub,EAAsB,CACnG7c,KAAM,SACN6C,IAAK,wRAET,IAAIuY,GAAc9Z,EAAQ,CAAC,YACvB,CAAEzJ,OAAQ,WAAYkH,OAAQ,CAAE1F,MAAO,KAAQwjB,EAAsB,CACjE7c,KAAM,SACN6C,IAAK,iWAEb,IAAIuY,GAAc9Z,EAAQ,CAAC,CAAEzJ,OAAQ,aAAe,CAAEA,OAAQ,cAAgB,CAAEA,OAAQ,sBAAuB0S,SAAU,CAAExN,KAAM/D,EAAOkE,cAAcxK,YAAc,MAASmqB,EAAsB,CAC/L7c,KAAM,cACN6C,IAAK,wQAET,IAAIuY,GAAc9Z,EAAQ,CAAC,YAAa,aAAc,WAAY,sBAAuBub,EAAsB,CAC3G7c,KAAM,cACN6C,IAAK,6UAET,IAAIuY,GAAc9Z,EAAQ,CAAC,YACvB,CAAEzJ,OAAQ,WAAYkH,OAAQ,CAAE1F,MAAO,IACvC,CAAExB,OAAQ,WAAYkH,OAAQ,CAAE1F,MAAO,KAAQwjB,EAAsB,CACjE7c,KAAM,SACN6C,IAAK,oaAEb,IAAIgO,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,gKAC5C,IAAIsM,IAAYnW,IACZsgB,GAAYzD,OAAOA,QAAU+G,EAC7BpP,GAAa,CAAExN,KAAM,QAAS6C,IAAK,GAAG+Z,mDAA8DtD,GAAYzD,OAAOA,UAAW,IAEtI,IAAI3H,GAAU,KACd,IAAIoB,GAAevM,GAAa,CAAC/J,EAAQqW,KAGrC,GAFAiK,GAAYO,WAAW/B,kBAAkBzS,KAAKC,OAC9CgU,GAAYlQ,OAAOxR,MAAQ,GACG,IAA1ByX,EAAOnH,QAAQ7U,OACfma,GAAa,CAAExN,KAAM,cAAe6C,IAAK,kJAAoJ,CAAE7J,eAC5L,CAEHwU,GAAa,CAAExN,KAAM,cAAe6C,IAAK,yFAA2F,CAAE7J,UAAU,CAAEkX,iBADzHb,EAAOnH,QAAQjT,KAAIM,GAAKA,EAAE8J,MAAMZ,OAAMvK,KAAK,OAEvE,MAITyP,EAAYhK,OAAOzH,KAAK,CAAE8S,YAAa,mBAAoBd,MAAO8L,GACtE,CC5MA,IAAY+M,GC/DN,SAAUC,GAAwB9M,GACpCvM,EAAYhK,OAAOmL,mBAAmB,CAClCE,YAAa,eAAgBd,MAAO,CAChC,IAAI2M,GAAYhE,GAAgB,CAAEzS,KAAM,CAAE8V,sBAC1C,IAAIW,GAAY9D,MAG5B,CCFM,SAAUkQ,GAAmBjkB,GAC/B,MAAMgX,EAA6B,CAC/B,IAAIV,GAAe,CAAC,WAAY,eAAe,CAACtW,EAAQqW,KACpD,GAAIA,EAAOnH,QAAQ7U,OAAS,EAExB,OADA2pB,GAAwB3N,EAAOnH,QAAQjT,KAAIM,GAAKA,EAAE8J,MAAMZ,OAAMvK,KAAK,OAC5DsP,EAAec,YAEtBkJ,GAAa,CAAExN,KAAM,cAAe6C,IAAK,+EAC5C,IAEL,IAAIqL,GAAU,KACd,IAAI2C,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,qYACvC,IAAIsM,IAAYnW,KFsBlB,SAAsBA,GACxB,MAAMkkB,EAAU,CAAC,WAAY,cAC7B,IAAIrB,EAA0B,GAC9B7iB,EAAOuF,WAAavF,EAAOuF,WAAWtJ,KAAI0D,IACtC,GAAIukB,EAAQtqB,SAAS+F,EAAKuD,MAAMsC,MAAMC,MAAO,OAAO9F,EACpD,MAAMwkB,EAAKja,EAAelR,IAAI2G,EAAKuD,MAAMsC,MAAMC,MAC/C,IAAI0e,IAAMxV,EAAuBhP,EAAMwkB,GAWvC,OAAOxkB,EAVHkjB,EAAM3pB,KAAK,CACP4iB,MAAO,CACH3V,MAAOxG,EAAKuD,MAAMsC,MAAMC,KACxBxM,KAAM0G,EAAKuD,MAAMuC,MAErBiY,MAAO/d,EAAKqK,OAAS,UACrBuH,SAAU5R,EAAKE,UAIZ,IACZzH,QAAOG,QAAWqH,IAANrH,IAEf+nB,GAAYlQ,OAAOxR,MAAQikB,EAC3Brc,EAAiBxG,EACrB,CE3CYokB,CAAYpkB,GACZsgB,GAAYlQ,OAAO6L,WAAY,EAC/BzH,GAAa,CAAExN,KAAM,cAAe6C,IAAK,sCAAuC,KAIxFc,EAAYhK,OAAOzH,KAAK,CAAE8S,YAAa,qBAAsBd,MAAO8L,GACxE,CAEM,SAAUqN,GAAsBrkB,GAClC,MAAMgX,EAA6B,CAC/B,IAAIV,GAAe,CAAC,WAAY,eAAe,CAACtW,EAAQqW,KACpD,GAAIA,EAAOnH,QAAQ7U,OAAS,EAExB,OADA2pB,GAAwB3N,EAAOnH,QAAQjT,KAAIM,GAAKA,EAAE8J,MAAMZ,OAAMvK,KAAK,OAC5DsP,EAAec,YAEtBkJ,GAAa,CAAExN,KAAM,cAAe6C,IAAK,wDAC5C,IAEL,IAAIqL,GAAU,KACd,IAAI2C,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,uSACvC,IAAIsM,IAAYnW,KF6BlB,SAAyBA,GAC3B,MAAM6iB,EAAQ,IAAIvC,GAAYlQ,OAAOxR,MAAM9F,UAErCmW,EAAU1E,EAAavK,GAI7B,OAFckM,EAAWS,OAAOvG,MAE5Byc,EAAMnjB,MAAKnH,IACX,MAAMoH,EAAOsP,EAAQjW,IAAIT,EAAEujB,MAAM3V,OACjC,QAAKxG,IACDgP,EAAuBhP,EAAMuK,EAAelR,IAAIT,EAAEujB,MAAM3V,YACxDxG,EAAKE,UAAU0O,QAAQ3U,SAAS,SAAW,EACnC,IACLmqB,GAAeO,QAE1BzB,EAAM5iB,SAAQ1H,IACV,MAAMoH,EAAOsP,EAAQjW,IAAIT,EAAEujB,MAAM3V,OAC3B4I,EAAK7E,EAAelR,IAAIT,EAAEujB,MAAM3V,OACtC,IAAK4I,EAAI,OACT,GAAIA,EAAG7L,MAAMuC,OAASlN,EAAEujB,MAAM7iB,KAAM,OACpC,MAAMsrB,EAAQjX,EAAetN,EAAQA,EAAQ+O,GACxCwV,IAEL/oB,OAAOC,OAAO8oB,EAAO,CAAEva,MAAOzR,EAAEmlB,MAAO7d,SAAUtH,EAAEgZ,WAE9C5R,EAGDnE,OAAOC,OAAOkE,EAAM4kB,GAFpBvkB,EAAOuF,WAAWrM,KAAKqrB,GAG1B,IAGLjE,GAAYlQ,OAAOxR,MAAQ,GAC3B4H,EAAiBxG,GACV+jB,GAAeS,QAC1B,EE/DgBC,CAAezkB,KAAY+jB,GAAeO,OAC1C9P,GAAa,CAAExN,KAAM,cAAe6C,IAAK,qDAEzCyW,GAAYlQ,OAAO6L,WAAY,EAC/BzH,GAAa,CAAExN,KAAM,cAAe6C,IAAK,gCAC5C,KAGTc,EAAYhK,OAAOzH,KAAK,CAAE8S,YAAa,wBAAyBd,MAAO8L,GAC3E,CAEgB,SAAA0N,GAAkB1kB,EAAyBsI,GACvD,MAAM0O,EAA6B,CAC/B,IAAIa,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,iEAC5C,IAAIgO,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,gPACvC,IAAIqL,GAAU,KACd,IAAIiB,IAAYnW,IACZsgB,GAAYlQ,OAAO4L,YFjCzB,SAA+Bhc,GACjC,IAAIqW,EAA2B,GAW/B,OAVArW,EAAOuF,WAAWtF,SAAQN,IACtB,MAAMwkB,EAAKja,EAAelR,IAAI2G,EAAKuD,MAAMsC,MAAMC,MAC3C0e,GAAMxV,EAAuBhP,EAAMwkB,IACnC9N,EAAOnd,KAAK,CACR4iB,MAAOnc,EAAKuD,MAAMuC,KAClBU,MAAOxG,EAAKuD,MAAMsC,MAAMC,KACxBiY,MAAO/d,EAAKqK,OAAS,WAE5B,IAEEqM,CACX,CEoB6CsO,CAAqB3kB,GACtD,MAAMqT,EAASrT,EAAOuF,WAAWsJ,MAAKpW,GAA4B,aAAvBA,EAAEyK,MAAMsC,MAAMC,OAEzD+O,GAAa,CAAExN,KAAM,cAAe6C,IAAK,qGAD1BwJ,GAAQrJ,OAAS,CAAC,YAAY,OAC2G,KAGhKW,EAAYhK,OAAOzH,KAAK,CAAE8S,YAAa,oBAAqBd,MAAO8L,GACvE,EFDA,SAAY+M,GACRA,EAAAA,EAAA,QAAA,GAAA,UACAA,EAAAA,EAAA,OAAA,GAAA,QACH,CAHD,CAAYA,KAAAA,GAGX,CAAA,IG/DM,MAAMa,GAAgC,CACzC,CACIvQ,MAAO,iCACPmN,aAAcC,GACd,GAAApZ,CAAIrI,GACA0kB,IACH,GAEL,CACIrQ,MAAO,mDACPmN,aAAcE,GACd,GAAArZ,CAAIrI,EAAQsI,EAAQyZ,GACG,OAAfA,EAAQ,IAA4C,UAA7BA,EAAQ,GAAGC,eAA2B0B,GAAiBpb,EAAQtI,GACvE,OAAf+hB,EAAQ,IAA4C,SAA7BA,EAAQ,GAAGC,eCb5C,SAA0BhiB,GAE5B,MAAMgX,EAA6B,CAC/B,IAAIzB,IAAU,IACNsP,EAAU7kB,EAAQmK,GAAoBoL,GAAUQ,SAC7CR,GAAUU,WAClB,CAAC7M,EAAIiN,KACJ,IAAKA,EAAOR,OAAQ,MAAO,CAAE7O,KAAM,cAAe6C,IAAK,kCAAmC,IAE9F,IAAIgO,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,kDAC5C,IAAIqL,GAAU,KACd,IAAI2C,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,kLACvC,IAAI8G,GAAe3Q,EAAQ,CAACmK,KAGhCQ,EAAYhK,OAAOzH,KAAK,CAAE8S,YAAa,kBAAmBd,MAAO8L,GACrE,CDH4E8N,CAAgB9kB,EACnF,GAEL,CACIqU,MAAO,4CACPmN,aAAcC,GACd,GAAApZ,CAAIrI,EAAQsI,GACJgY,GAAYlQ,OAAOxR,MAAMnF,KAAO,EAChC4qB,KAEAJ,IAEP,IEzBIc,GAA8B,CACvC,CACI1Q,MAAO,6DACPmN,aAAcC,GACd,GAAApZ,CAAIrI,EAAQsI,EAAQyZ,EAAS3gB,GACzBkf,GAAYvF,WAAWE,aAA4B,OAAf8G,EAAQ,IAA2C,QAA5BA,EAAQ,GAAGC,eAEtE,MACMgD,EAAc,0DADP1E,GAAYvF,WAAWnR,KAEOuR,gBAAkB,OAAS,UAEtEnG,GAAQ5T,EAAKhB,KAAMJ,EAAQsI,EAAQ0c,EACtC,GAEL,CACI3Q,MAAO,wEACPmN,aAAcC,GACd,GAAApZ,CAAIrI,EAAQsI,EAAQyZ,EAAS3gB,GACzB,MAAM9I,EAAsB,OAAfypB,EAAQ,IAA4C,QAA7BA,EAAQ,GAAGC,cACzC3G,EAAK4J,SAASlD,EAAQ,IAC5BzB,GAAYvF,WAAWK,aAAaC,EAAI/iB,GAExC,MACM0sB,EAAc,+DADP1E,GAAYvF,WAEuBY,oBAAoBN,GAAM,IAAM,KAAO,IAAMA,EAE7FrG,GAAQ5T,EAAKhB,KAAMJ,EAAQsI,EAAQ0c,EACtC,GAEL,CACI3Q,MAAO,oCACPmN,aAAcC,GACd,GAAApZ,CAAIrI,EAAQsI,EAAQyZ,EAAS3gB,GACbiM,EAAoB/E,GAChC,MAAMsB,EAAO0W,GAAYvF,WAAWnR,KAC9Bob,EAAc,0DACkBpb,EAAKuR,gBAAkB,OAAS,UADlD,qCAGdvR,EAAKkR,WAAW7e,KAAI,CAAC1D,EAAG2G,EAAKgmB,IAAQ,OAAO3sB,MAAK2C,KAAK,MAE5D8Z,GAAQ5T,EAAKhB,KAAMJ,EAAQsI,EAAQ0c,EACtC,IC7BH,MAAOG,WAAqBza,EAI9B,WAAA3J,CAAqB2L,EAAyE0Y,EAAsFC,GAChL1V,QADiBvV,KAAIsS,KAAJA,EAAyEtS,KAAQgrB,SAARA,EAAsFhrB,KAAUirB,WAAVA,EAHpLjrB,KAAA0Q,OAAyBN,EAAe8K,QACxClb,KAAUkrB,YAAY,CAIrB,CAED,GAAAjd,CAAIrI,GACA,IAAK5F,KAAKkrB,WACN,OAAOlrB,KAAK0Q,OAGhB,GADA1Q,KAAKkrB,YAAa,OACA1lB,IAAdxF,KAAKsS,KAAoB,CACzB6Y,uBAAwB,EACxB,MAAM3Z,EAAyB,CAC3B4Z,oCAAqC,KACjCprB,KAAKirB,aAAarlB,OAAQJ,GAC1BxF,KAAK0Q,OAASN,EAAea,QAAQ,GAG7C8Z,GAAaM,8BAA8BvsB,KAAK0S,GAChDqN,gBAAgB,SAAU,aAC7B,KAAM,CACH,MAAMyM,EAAKtrB,KAAKsS,KAChB6Y,uBAAwB,EACxB,MAAM3Z,EAAyB,CAC3B+Z,4BAA6B,KACzBC,cAAgBF,EAAGG,MACnBzM,aAAa,cAAesM,EAAGzsB,KAAK,EAExCusB,oCAAqC,KACjC,MAAM3mB,EAASinB,iBAAiBjX,MAAKrX,GAAKA,EAAEiO,OAASigB,EAAGzsB,OACxDmB,KAAK0Q,OAASN,EAAec,YACxBzM,EACIA,EAAOknB,aAAelnB,EAAOmnB,YAAa5rB,KAAKgrB,WAAWplB,EAAQ,SAEvEmE,WAAW,eAAgB,CAAEsB,KAAMigB,EAAGzsB,OACtCmB,KAAK0Q,OAASN,EAAe8K,SAJpBlb,KAAKgrB,WAAWplB,EAAQ,WAKpC,EAELimB,wBAAyB,KACjBxf,cAAgBA,aAAahB,OAASigB,EAAGzsB,MACzCmB,KAAKirB,aAAarlB,EAAQ0lB,EAAGzsB,MAC7BmB,KAAK0Q,OAASN,EAAea,WAE7BjR,KAAKgrB,WAAWplB,EAAQ,cACxB5F,KAAK0Q,OAASN,EAAec,YAChC,GAIT6Z,GAAae,6BAA6BhtB,KAAK0S,GAC/CuZ,GAAaM,8BAA8BvsB,KAAK0S,GAChDuZ,GAAagB,0BAA0BjtB,KAAK0S,EAC/C,CAGD,OAFAwa,gBACAnN,gBAAgB,SAAU,cACnB7e,KAAK0Q,MACf,CAMD,WAAO7I,CAAK1H,EAAmBmE,GAC3BnE,EAAIuC,aAAa,kBAAmB,GAAG,CAACsE,EAAMC,KAC1C,KAAOjH,KAAK8rB,6BAA6B7rB,OAAS,GAC9CD,KAAK8rB,6BAA6B/a,SAASwa,gCAE/CtkB,EAAKD,EAAK,IAGd7G,EAAIuC,aAAa,2BAA4B,GAAG,CAACsE,EAAMC,KAGnD,IAFAA,EAAKD,GACLmkB,uBAAwB,EACjBnrB,KAAKqrB,8BAA8BprB,OAAS,GAC/CD,KAAKqrB,8BAA8Bta,SAASqa,qCAC/C,IAGLjrB,EAAIuC,aAAa,eAAgB,GAAG,CAACsE,EAAMC,KAEvC,IADAA,EAAKD,GACEhH,KAAK+rB,0BAA0B9rB,OAAS,GAC3CD,KAAK+rB,0BAA0Bhb,SAAS8a,2BAC3C,GAER,EA1Bed,GAA4Be,6BAAuB,GACnDf,GAA6BM,8BAAuB,GACpDN,GAAyBgB,0BAAuB,GC7E7D,MAAME,GAA8B,CACvC,CACIhS,MAAO,iCACPmN,aAAcC,GACd,GAAApZ,CAAIrI,EAAQsI,EAAQyZ,EAAS3gB,ICGrB,SAAkBpB,EAAyBsmB,GACvD,MAAMtP,EAA6B,CAC/B,IAAIa,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,2EACvC,IAAIyM,GAAe,CAAC,WAAY,WAAY,cAAc,CAAClN,EAAIiN,KAC3D,MAAMa,EAAmBb,EAAOnH,QAAQjT,KAAIM,GAAKA,EAAE8J,MAAMZ,OAAMvK,KAAK,MACpE,GAA8B,IAA1Bmb,EAAOnH,QAAQ7U,OAGf,OAFA2a,GAAQsR,EAAQlmB,KAAMJ,EAAQsmB,EAAQhe,OAAQuL,GAAehK,IAAK,CAAEqN,qBACpE1C,GAAaT,GAAkB,CAAE/T,WAC1BwK,EAAec,YAE1B0J,GAAQsR,EAAQlmB,KAAMJ,EAAQsmB,EAAQhe,OAAQ,2DAA2D,IAE7G,IAAIiN,IAAWnM,GACPA,EAAG7D,WAAW7F,MAAKlI,IACf0S,EAAe7R,IAAIb,EAAE0L,MAAMsC,MAAMC,QACjCjO,EAAEqI,UAAYrI,EAAEqI,SAAS0O,OAClB/W,EAAEqI,SAAS0O,OAAO7O,MAAK7G,GAAK,CAAC,WAAY,UAAW,QAAS,UAAUe,SAASf,UAD3F,KAEO0c,GAAUU,SACdV,GAAUQ,WAClB,CAAC3M,EAAIiN,KACAA,EAAOR,OACPrB,GAAa,CAAExN,KAAM,SAAU6C,IAAK,oHAAsH,CAAE7J,YAE5JgV,GAAQsR,EAAQlmB,KAAMJ,EAAQsmB,EAAQhe,OAAQ,mFAC9CkM,GAAaT,GAAkB,CAAE/T,WACpC,IAEL,IAAIkV,GAAU,KACd,IAAIiQ,QAAavlB,IAErB+K,EAAYhK,OAAOzH,KAAK,CAAE8S,YAAa,sBAAuBd,MAAO8L,GACzE,CDjCYuP,CAAkBvmB,EAAQ,CAAEsI,OAAQA,EAAQlI,KAAMgB,EAAKhB,MAC1D,GAEL,CACIiU,MAAO,yCACPmN,aAAcC,GACd,GAAApZ,CAAIrI,EAAQsI,EAAQyZ,EAAS3gB,IC6BrB,SAAuBpB,EAAyBsmB,GAC5D,MAAME,EAAe,CAAC3c,EAAazI,IAAkC4T,GAAQsR,EAAQlmB,KAAMJ,EAAQsmB,EAAQhe,OAAQuB,EAAKzI,GAElH4V,EAA6B,CAC/B,IAAIV,GAAe,CAAC,qBAAsB,yBAAyB,CAAClN,EAAIiN,KACpE,GAA8B,IAA1BA,EAAOnH,QAAQ7U,OAAc,CAC7B,MAAM6c,EAAmBb,EAAOnH,QAAQjT,KAAIM,GAAKA,EAAE8J,MAAMZ,OAAMvK,KAAK,MAGpE,OAFAsrB,EAAa3S,GAAehK,IAAK,CAAEqN,qBACnC1C,GAAaT,GAAkB,CAAE/T,WAC1BwK,EAAec,WACzB,CACDkb,EAAa,iGAAiG,IAElH,IAAItR,GAAU,KACd,IAAI2C,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,8KACvC,IAAIsb,GAAajZ,EAAWS,OAAOD,MAAM,CAACtD,EAAI5J,KAC1CgnB,EAAa,wDAAwD,IACtE,CAACpd,EAAIqd,KACJjS,GAAa,CAAExN,KAAM,SAAU6C,IAAK,0IAA4I,CAAE7J,UAAS,IAE/L,IAAI6X,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,mKAEhDc,EAAYhK,OAAOzH,KAAK,CAAE8S,YAAa,4BAA6Bd,MAAO8L,GAC/E,CDnDY0P,CAAuB1mB,EAAQ,CAAEsI,OAAQA,EAAQlI,KAAMgB,EAAKhB,MAC/D,GAEL,CACIA,KAAM,OACNiU,MAAO,2BACPmN,aAAcC,GACd,GAAApZ,CAAIrI,EAAQsI,EAAQyZ,EAAS3gB,IC8CrB,SAAqBpB,EAAyBsmB,GAE1D,IAAI1c,EAA+C,CAAA,EAEnD,MAAM4c,EAAe,CAAC3c,EAAazI,IAAkC4T,GAAQsR,EAAQlmB,KAAMJ,EAAQsmB,EAAQhe,OAAQuB,EAAKzI,GAElH4V,EAA6B,CAC/B,IAAIV,GAAe,CAAC,WAAY,WAAY,cAAc,CAAClN,EAAIiN,KAC3D,GAA8B,IAA1BA,EAAOnH,QAAQ7U,OAAc,CAC7B,MAAM6c,EAAmBb,EAAOnH,QAAQjT,KAAIM,GAAKA,EAAE8J,MAAMZ,OAAMvK,KAAK,MAGpE,OAFAsrB,EAAa3S,GAAehK,IAAK,CAAEqN,qBACnC1C,GAAaT,GAAkB,CAAE/T,WAC1BwK,EAAec,WACzB,CACDkb,EAAa,4DACbhS,GAAa,CAAExN,KAAM,cAAe6C,IAAK,4DAA8D,CAAE7J,UAAS,IAEtH,IAAIuV,IAAWnM,GACPA,EAAG7D,WAAW7F,MAAKlI,IACnB,MAAMuX,EAAK7E,EAAelR,IAAIxB,EAAE0L,MAAMsC,MAAMC,MAC5C,QAAIsJ,IAAMJ,EAAuBnX,EAAGuX,OAChC/W,MAAMC,QAAQT,EAAEqI,UAAU0O,SACnB/W,EAAEqI,SAAS0O,OAAO7O,MAAK7G,GAAK,CAAC,WAAY,UAAW,UAAUe,SAASf,IACtE,IACL0c,GAAUU,SACdV,GAAUQ,WAClB,CAAC3M,EAAIiN,KACCA,EAAOR,SACR2Q,EAAa,oDACbhS,GAAaT,GAAkB,CAAE/T,WACpC,IAEL,IAAIsW,GAAe,CAAC,wBAAwB,CAAClN,EAAIiN,KACf,IAA1BA,EAAOnH,QAAQ7U,aAAiCuF,IAAjB0mB,EAAQ5Z,KACvC9C,EAAKgC,KAAO,cAEZhC,EAAKgC,KAAO,aACZ4a,EAAa,cAChB,IAEL,IAAI3O,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,gHACvC,IAAIsb,GAAamB,EAAQ5Z,MAAM,CAACtD,EAAI5J,KAChCgnB,EAAa,8GAA+G,CAAEG,WAAYL,EAAQhe,QAAS,IAC5J,CAACc,EAAIqd,UACS7mB,IAAT6mB,EACAD,EAAa,mGAAoG,CAAEG,WAAYL,EAAQhe,SAErH,eAAdsB,EAAKgC,MACL4a,EAAa,uJAAwJ,CAAEG,WAAYL,EAAQhe,QAElM,IAEL,IAAI6N,IAAY/M,IACZ,MAAMud,EAAatZ,EAAoBiZ,EAAQhe,QACzCzJ,EAAcwR,kBAAkBxB,MAAKnW,GAAKA,EAAEwL,eAAiByiB,IAC7DC,EAAc,MAChB,GAAI/nB,EAAQ,OAAO0V,kBAAkB1V,GAChC,CACD,MAAMgoB,EAASzd,EAAG0d,aAAa9tB,IAAI2tB,GACnC,YAAe/mB,IAAXinB,EAA6BF,EAAWjtB,WACrCmtB,CACV,CACJ,EAPmB,GAQpBrS,GAAa,CAAExN,KAAM,SAAU6C,IAAK,4JAA8J,CAAE7J,UAAU,CAAE4mB,eAAc,KAGtOjc,EAAYhK,OAAOzH,KAAK,CAAE8S,YAAa,0BAA2Bd,MAAO8L,GAC7E,CDhHY+P,CAAqB/mB,EAAQ,CACzBsI,OAAQA,EACRlI,KAAMgB,EAAKhB,KACXsM,KAAMtL,EAAK4lB,UAElB,IEnBH,SAAUC,GAAYjnB,GACxB,MAAM6e,EAAOyB,GAAYzD,OAAOE,YAE1BmK,EAAY,CACd,CAAEroB,OAAQ,WAAYkH,OAAQ,CAAE1F,MAAO,IACvC,CAAExB,OAAQ,WAAYkH,OAAQ,CAAE1F,MAAO,IACvC,CAAExB,OAAQ,WAAYkH,OAAQ,CAAE1F,MAAO,IACvC,CAAExB,OAAQ,YAAakH,OAAQ,CAAE1F,MAAO,IACxC,CAAExB,OAAQ,WAAYkH,OAAQ,CAAE1F,MAAO,IACvC,CAAExB,OAAQ,WAAYkH,OAAQ,CAAE1F,MAAO,KAGrCyQ,EAAQ,IAAItY,IAA+B0uB,EAAUjrB,KACvD1D,GAAK,CAACA,EAAEsG,OAAQ,SAGdqM,EAAQ,CACV,IAAI2M,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,kEAC5C,IAAIgO,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,ySACvC,IAAIsM,IAAYnW,IACZA,EAAOuF,WAAWtF,SAAQN,IAClBmR,EAAMzY,IAAIsH,EAAKuD,MAAMsC,MAAMC,OAAS9F,EAAKE,UAAUC,YACnDgR,EAAMxX,IAAIqG,EAAKuD,MAAMsC,MAAMC,KAAM,IAAK9F,EAAKE,SAASC,YAAa,IAEzEyP,EAAiB7L,SAAS3B,IAAK,EAC/BmlB,EAAUjnB,SAAQ1H,GAAK+X,GAAeI,kBAAkB1Q,EAAQzH,KAChEgX,EAAiB7L,SAAS3B,IAAK,EAC/B+X,GAAWE,aAAc,CAAI,IAEjC,IAAI1J,GAAetQ,EAAQknB,GAC3B,IAAIrP,GAAY,CAAE7Q,KAAM,eAAgB6C,IAAK,qDAAqDgV,EAAO,GAAK,KAAMsI,QAAQ,eAC5H,IAAIrN,GAAW+E,GACf,IAAIhH,GAAY,CAAE7Q,KAAM,eAAgB6C,IAAK,iCAC7C,IAAIsM,IAAYnW,IACZ8Z,GAAWE,aAAc,EACzBzK,EAAiB7L,SAAS3B,IAAK,EAC/B/B,EAAOuF,WAAWtF,SAAQN,IACtB,MAAMynB,EAAStW,EAAM9X,IAAI2G,EAAKuD,MAAMsC,MAAMC,MACtC2hB,GAAQlnB,8BAA8BF,EAAQL,EAAMynB,EAAO,IAEnE7X,EAAiB7L,SAAS3B,IAAK,EAC/ByE,EAAiBxG,EAAO,IAE5B,IAAI6X,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,mUAGhDc,EAAYhK,OAAOzH,KAAK,CAAE8S,YAAa,cAAed,MAAOA,GACjE,CCvDA,IAAYmc,IAAZ,SAAYA,GACRA,EAAAA,EAAA,QAAA,GAAA,UACAA,EAAAA,EAAA,QAAA,GAAA,UACAA,EAAAA,EAAA,OAAA,GAAA,QACH,CAJD,CAAYA,KAAAA,GAIX,CAAA,UAEqBC,GAGlB,MAAAC,CAAOvnB,EAAyBsI,EAAmBuB,EAAazJ,GAA4B,CAC5F,UAAAonB,CAAWxnB,EAAyBsI,EAAmBpB,GAAiC,CACxF,QAAAvF,CAAS3B,GAAkC,CAC3C,QAAA6B,CAAS7B,GAAkC,ECRzC,MAAgBynB,WAAyBH,GAI3C,WAAAvmB,CAAqB2mB,EAAkCC,EAA2BC,GAC9EjY,QADiBvV,KAAestB,gBAAfA,EAAkCttB,KAAQutB,SAARA,EAA2BvtB,KAAKwtB,MAALA,EAE9ExtB,KAAKytB,SAAWvH,GAAYzD,OAAOG,UAAY0K,EAAkBrb,KAAKC,MACtElS,KAAK4E,IAAM,CACd,CAED,GAAAqJ,CAAIrI,GACA,OAAIqM,KAAKC,MAAQlS,KAAKytB,SAAiBR,GAAUS,OAC7C1tB,KAAK4E,KAAO5E,KAAKutB,SAAiBN,GAAU7C,QACzC6C,GAAUU,OACpB,CAED,QAAAC,CAAShoB,EAAyBpH,GAC1BA,IAAMyuB,GAAU7C,QCrBZ,SAAmBxkB,EAAyB6c,GACxDyD,GAAYzD,OAAOA,QAAUA,EAC7BrI,GAAa,CAAExN,KAAM,cAAe6C,IAAK,2CAA2CgT,aAAoB,CAAE7c,UAC9G,CDkBqCioB,CAAmBjoB,EAAQ5F,KAAKwtB,OACxDX,GAAYjnB,GACjBsgB,GAAYO,WAAWrC,cAAc5lB,IAAMyuB,GAAU7C,QACxD,EEvBC,MAAO0D,WAAsBT,GAC/B,OAAAU,GACI,MAAO,UAAU,IAAI9b,KAAKjS,KAAKytB,UAAUO,yBAAyBhuB,KAAKstB,yCAAyCttB,KAAKutB,6DAA6DvtB,KAAKwtB,0BAC1L,CACD,WAAA7mB,CAAqBsnB,EAA6BzL,EAA0BgL,GACxEjY,MAAM0Y,EAAYzL,EAASgL,GADVxtB,KAAUiuB,WAAVA,EAA6BjuB,KAAOwiB,QAAPA,EAA0BxiB,KAAKwtB,MAALA,EAI5ExtB,KAAiBkuB,kBAAW,EAC5BluB,KAAAmuB,cAA6B,IAAIpwB,GAHhC,CAID,UAAAqvB,CAAWxnB,EAAyBsI,EAAmBpB,GAC/CA,EAASxE,kBAAoB1C,EAAOkE,cACpCgD,EAAS1E,kBAAoBxC,EAAOkE,eACxC9J,KAAKkuB,kBAAoBhgB,EAAOpE,eAAiB,EACpD,CAED,QAAAvC,CAAS3B,GACL5F,KAAKmuB,cAAcjwB,IAAI8B,KAAKkuB,mBAC5BluB,KAAK4E,IAAM5E,KAAKmuB,cAAc9uB,KAC9B6mB,GAAYO,WAAWzC,YAAY,WAAY,EAClD,ECpBC,MAAOoK,WAAqBf,GAC9B,OAAAU,GACI,MAAMM,EAAc,UAAU,IAAIpc,KAAKjS,KAAKytB,UAAUO,yBAAyBhuB,KAAKstB,kCAC9EgB,EAAetuB,KAAKuuB,cAAgB,MAAM,IAAIvuB,KAAKuuB,cAAc7vB,UAAUmD,KAAI1D,GAAKqwB,cAAc,aAAcrwB,IAAI+N,cAAalO,QAAOG,QAAWqH,IAANrH,IAAiB2C,KAAK,SAAW,GAC9K2tB,EAAazuB,KAAK0uB,WAAa,MAAM,IAAI1uB,KAAK0uB,WAAWhwB,UAAUmD,KAAI1D,GAAKwwB,uBAAuB,WAAWxwB,OAAM2C,KAAK,oBAAsB,cAErJ,MAAO,GAAGutB,aAAuBruB,KAAKutB,uBAAuBe,IAAeG,cAAuBzuB,KAAKwtB,mCAC3G,CAKD,WAAA7mB,CAAqB2mB,EAAkC9K,EAA0BgL,EAAeoB,EAAuCC,GACnItZ,MAAM+X,EAAiB9K,EAASgL,GADfxtB,KAAestB,gBAAfA,EAAkCttB,KAAOwiB,QAAPA,EAA0BxiB,KAAKwtB,MAALA,EAJzExtB,KAAA8uB,eAA8B,IAAI/wB,IAMtCiC,KAAK0uB,WAAaE,EAAY,IAAI7wB,IAAI6wB,QAAappB,EACnDxF,KAAKuuB,cAAgBM,EAAe,IAAI9wB,IAAI8wB,QAAgBrpB,CAC/D,CAED,UAAA4nB,CAAWxnB,EAAyBsI,EAAmBpB,GAC/CA,EAASxE,kBAAoB1C,EAAOkE,cACpCgD,EAAS1E,kBAAoBxC,EAAOkE,eACpC9J,KAAK0uB,aAAe1uB,KAAK0uB,WAAWzwB,IAAI6O,EAAStE,eACjDxI,KAAKuuB,gBAAkBvuB,KAAKuuB,cAActwB,IAAI6O,EAAS5D,iBAC3DlJ,KAAK8uB,eAAe5wB,IAAI4O,EAASxE,iBACjCtI,KAAK4E,IAAM5E,KAAK8uB,eAAezvB,KAC3BW,KAAKuuB,eAAetwB,IAAI,cACxBioB,GAAYO,WAAWzC,YAAY,eAAgB,GAC9ChkB,KAAKuuB,eAAetwB,IAAI,aAC7BioB,GAAYO,WAAWzC,YAAY,cAAe,GAC7ChkB,KAAK0uB,YAAYzwB,IAAI,SAC1BioB,GAAYO,WAAWzC,YAAY,UAAW,IACrD,EChCC,MAAO+K,WAAmB1B,GAC5B,OAAAU,GACI,MAAO,UAAU,IAAI9b,KAAKjS,KAAKytB,UAAUO,yBAAyBhuB,KAAKstB,4CAA4CttB,KAAKutB,8BAA8BvtB,KAAKwtB,sCAC9J,CACD,WAAA7mB,CAAqB2mB,EAAkC9K,EAA0BgL,GAC7EjY,MAAM+X,EAAiB9K,EAASgL,GADfxtB,KAAestB,gBAAfA,EAAkCttB,KAAOwiB,QAAPA,EAA0BxiB,KAAKwtB,MAALA,CAEhF,CACD,QAAA/lB,CAAS7B,GACL5F,KAAK4E,MACLshB,GAAYO,WAAWzC,YAAY,WAAY,EAClD,QCPQgL,GAGT,WAAAroB,CAAY6J,EAAmBye,GAC3Bre,aAAY,KACR,GAAI/G,QAAUA,OAAOC,cAAgB2N,GAAiB5N,SAClD,GAAI7J,KAAKkvB,aAAc,CACnB,MAAM1wB,EAAIwB,KAAKkvB,aAAajhB,IAAIpE,QAC5BrL,IAAMyuB,GAAUU,UAChB3tB,KAAKkvB,aAAatB,SAAS/jB,OAAQrL,GACnCwB,KAAKkvB,kBAAe1pB,EAE3B,OAEDxF,KAAKkvB,kBAAe1pB,CACvB,GACFgL,GAEHye,EAAG1nB,UAAS9F,GAAKzB,KAAKuH,SAAS9F,KAC/BwtB,EAAGxnB,UAAShG,GAAKzB,KAAKyH,SAAShG,IAClC,CAED,SAAA0tB,CAAU1xB,EAAU4gB,GACZre,KAAKkvB,aACD7Q,GAAQA,EAAOre,KAAKkvB,cAEvBlvB,KAAKkvB,aAAezxB,CAC5B,CAED,QAAA2xB,GACI,YAA6B5pB,IAAtBxF,KAAKkvB,YACf,CAED,MAAA/B,CAAOvnB,EAAyBsI,EAAmBuB,EAAazJ,GAC5DhG,KAAKkvB,cAAc/B,OAAOvnB,EAAQsI,EAAQuB,EAAKzJ,EAClD,CAED,UAAAonB,CAAWxnB,EAAyBsI,EAAmBpB,GACnD9M,KAAKkvB,cAAc9B,WAAWxnB,EAAQsI,EAAQpB,EACjD,CAED,QAAAvF,CAAS3B,GACL5F,KAAKkvB,cAAc3nB,SAAS3B,EAC/B,CAED,QAAA6B,CAAS7B,GACL5F,KAAKkvB,cAAcznB,SAAS7B,EAC/B,CAID,mBAAW0D,GACP,OAAO0lB,GAASzlB,SACnB,CAED,WAAO1B,CAAK2I,EAAmBye,GACvBjvB,KAAKuJ,YACTvJ,KAAKuJ,UAAY,IAAIylB,GAASxe,EAAWye,GAC5C,EATcD,GAASzlB,eAAyB/D,ECpCrD,MAAM6pB,GAAW,CAACzpB,EAAyBnI,KACvC2c,GAAa,CAAExN,KAAM,SAAU6C,IAAK,GAAG8J,GAAgB3T,uBAA4BnI,EAAEswB,cACrFiB,GAAS1lB,SAAS6lB,UAAU1xB,GAAG,KAC3B2c,GAAa,CAAExN,KAAM,SAAU6C,IAAK,mDAAoD,GAC1F,EAGO6f,GAAoC,CAC7C,CACIrV,MAAO,qDACPmN,aAAcC,GACd,GAAApZ,CAAIrI,EAAQsI,EAAQyZ,GAChBtO,GAAYzT,EAAQ,WAAY,OAChCyT,GAAYzT,EAAQ,cAAe,OACnCypB,GAASzpB,EAAQ,IAAImpB,GAAW,EAAGlE,SAASlD,EAAQ,IAAK,GAC5D,GAEL,CACI1N,MAAO,qEACPmN,aAAcC,GACd,GAAApZ,CAAIrI,EAAQsI,EAAQyZ,GAChBzR,GAAeI,kBAAkB1Q,EAAQ,CAAEnB,OAAQ,aAAckH,OAAQ,CAAErN,EAAG,KAC9E+a,GAAYzT,EAAQ,cAAe,OACnCypB,GAASzpB,EAAQ,IAAIkoB,GAAc,EAAGjD,SAASlD,EAAQ,IAAK,GAC/D,GAEL,CACI1N,MAAO,yEACPmN,aAAcC,GACd,GAAApZ,CAAIrI,EAAQsI,EAAQyZ,GAChB0H,GAASzpB,EAAQ,IAAIwoB,GAAa,EAAGvD,SAASlD,EAAQ,IAAK,OAAGniB,EAAW,CAAC,aAAc,uBAAwB,gBACnH,GAEL,CACIyU,MAAO,uEACPmN,aAAcC,GACd,GAAApZ,CAAIrI,EAAQsI,EAAQyZ,GAChBzR,GAAeI,kBAAkB1Q,EAAQ,CAAEnB,OAAQ,aAAckH,OAAQ,CAAErN,EAAG,KAC9E+a,GAAYzT,EAAQ,cAAe,OACnCypB,GAASzpB,EAAQ,IAAIwoB,GAAa,EAAGvD,SAASlD,EAAQ,IAAK,OAAGniB,EAAW,CAAC,YAAa,aAAc,uBACxG,GAEL,CACIyU,MAAO,kEACPmN,aAAcC,GACd,GAAApZ,CAAIrI,EAAQsI,EAAQyZ,GAChB0H,GAASzpB,EAAQ,IAAIwoB,GAAa,EAAGvD,SAASlD,EAAQ,IAAK,EAAG,CAAC,OAAQ,QAAS,OAAQ,kBAAcniB,GACzG,GAEL,CACIyU,MAAO,0EACPmN,aAAcC,GACd,GAAApZ,CAAIrI,EAAQsI,EAAQyZ,EAAS3gB,GACzB,MAAMqB,EAAIwiB,SAASlD,EAAQ,IAC3BzB,GAAYzD,OAAOE,YAAkB,GAAJta,EAAS,IAC1C+R,GAAa,CAAExN,KAAM,cAAe6C,IAAK,gEAAgEyW,GAAYzD,OAAOE,YAAc,GAAK,eAAkB,CAAE/c,WACnKwU,GAAa,CAAExN,KAAM,QAAS6C,IAAK,0LAA4L,CAAE7J,UACpO,GAEL,CACIqU,MAAO,uEACPmN,aAAcC,GACd,GAAApZ,CAAIrI,EAAQsI,EAAQyZ,EAAS3gB,GACzB,MAAMqB,EAAIwiB,SAASlD,EAAQ,IAC3BzB,GAAYzD,OAAOG,UAAgB,GAAJva,EAAS,IACxC+R,GAAa,CAAExN,KAAM,cAAe6C,IAAK,sEAAsEyW,GAAYzD,OAAOG,UAAY,GAAK,eAAkB,CAAEhd,WACvKwU,GAAa,CAAExN,KAAM,SAAU6C,IAAK,2LAA6L,CAAE7J,UACtO,GAEL,CACIqU,MAAO,iDACPmN,aAAcC,GACd,GAAApZ,CAAIrI,EAAQsI,EAAQyZ,GACG,OAAfA,EAAQ,IAA4C,UAA7BA,EAAQ,GAAGC,cAA2BiF,GAAYjnB,GnCHrF8Z,GAAWE,aAAc,CmCKpB,GACF,CACC3F,MAAO,4FACPmN,aAAcC,GACd,GAAApZ,CAAIrI,EAAQsI,EAAQyZ,GACZA,EAAQ,GAAGvS,WAAW,OAASuS,EAAQ,GAAGC,cAAcxS,WAAW,WACnE7E,EAAYhK,OAAOzH,KAAK,CACpB8S,YAAa,mBAAoBd,MAAO,CACpC,IAAI2M,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,4EACvC,IAAIsM,IAAW,IAAMmK,GAAYlE,SAAS2D,OAAO,mBAAoBgC,EAAQ,GAAK,EAAI,KACtF,IAAIlK,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,+NAIpDc,EAAYhK,OAAOzH,KAAK,CACpB8S,YAAa,mBAAoBd,MAAO,CACpC,IAAI2M,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,6EACvC,IAAIsM,IAAW,IAAMmK,GAAYlE,SAAS2D,OAAO,mBAAoB,KACrE,IAAIlI,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,uOAK3D,GACF,CACCwK,MAAO,4EACPmN,aAAcC,GACd,GAAApZ,CAAIrI,EAAQsI,EAAQyZ,EAAS3gB,GACzB,MAAMqB,EAAIwiB,SAASlD,EAAQ,IAC3BzB,GAAYzD,OAAOI,mBAAyB,GAAJxa,EAAS,IACjD+R,GAAa,CAAExN,KAAM,cAAe6C,IAAK,8DAA8DyW,GAAYzD,OAAOI,mBAAqB,GAAK,eAAkB,CAAEjd,WACxKwU,GAAa,CAAExN,KAAM,SAAU6C,IAAK,+NAAiO,CAAE7J,UAC1Q,GAEL,CACIqU,MAAO,uEACPmN,aAAcC,GACd,GAAApZ,CAAIrI,EAAQsI,EAAQyZ,EAAS3gB,GACzB,MAAMqB,EAAIwiB,SAASlD,EAAQ,IAC3BpqB,QAAQupB,IAAIa,GACZ,MAAM4H,EAA2B,OAAf5H,EAAQ,IAA4C,YAA7BA,EAAQ,GAAGC,cACpDrqB,QAAQupB,IAAiC,YAA7Ba,EAAQ,GAAGC,eACvBrqB,QAAQupB,IAAIyI,GACZ,MAAMC,EAAOD,EAAW,WAAa,WACrChyB,QAAQupB,IAAI0I,GACZtJ,GAAYzD,OAAOA,QAAU8M,EAAWlnB,GAAKA,EAC7C,MAAMoa,EAASyD,GAAYzD,OAAOA,OAClC7H,GAAQ5T,EAAKhB,KAAMJ,EAAQsI,EAAQ,6DAA8D,CAAEshB,OAAMnnB,IAAGoa,UAC/G,GAEL,CACIxI,MAAO,mCACPmN,aAAcC,GACd,GAAApZ,CAAIrI,EAAQsI,EAAQyZ,EAAS3gB,GACzB,MAAMyb,EAASyD,GAAYzD,OAAOA,OAClC7H,GAAQ5T,EAAKhB,KAAMJ,EAAQsI,EAAQ,8CAA+C,CAAEuU,WAChFyD,GAAYzD,OAAOA,OAAS,GAC5BrI,GAAa,CAAExN,KAAM,QAAS6C,IAAK,+LAAiM,CAAE7J,WACjOsgB,GAAYzD,OAAOA,OAAS,GACjCrI,GAAa,CAAExN,KAAM,QAAS6C,IAAK,mSAAqS,CAAE7J,UACjV,IAII6pB,GAAmC,CAC5C,CACIxV,MAAO,4BACPmN,aAAcG,GACd,GAAAtZ,CAAIrI,EAAQsI,EAAQyZ,GAChBzB,GAAYzD,OAAOgB,WAAW,GAAG9Q,MAAK,KAClCsK,GAAoBrX,EAAQ,MAAM,IAClCnE,IACA2Y,GAAa,CAAExN,KAAM,QAAS6C,IAAK,yDAAyDhO,KAAM,GAEzG,GAEL,CACIwY,MAAO,+CACPmN,aAAcG,GACd,GAAAtZ,CAAIrI,EAAQsI,EAAQyZ,GAChBzB,GAAYzD,OAAOgB,WAAW,GAAG9Q,MAAK,KAClC4N,GAAkB3a,EAAQ,MAAM,IAChCnE,IACA2Y,GAAa,CAAExN,KAAM,QAAS6C,IAAK,yDAAyDhO,KAAM,GAEzG,GAEL,CACIwY,MAAO,yCACPmN,aAAcG,GACd,GAAAtZ,CAAIrI,EAAQsI,EAAQyZ,GAChBzB,GAAYzD,OAAOgB,WAAW,GAAG9Q,MAAK,KAClCoN,GAAkBna,EAAQ,MAAM,IAChCnE,IACA2Y,GAAa,CAAExN,KAAM,QAAS6C,IAAK,yDAAyDhO,KAAM,GAEzG,GAEL,CACIwY,MAAO,yCACPmN,aAAcG,GACd,GAAAtZ,CAAIrI,EAAQsI,EAAQyZ,GAChBzB,GAAYzD,OAAOgB,WAAW,GAAG9Q,MAAK,KAClC2N,GAAiB1a,EAAQ,MAAM,IAC/BnE,IACA2Y,GAAa,CAAExN,KAAM,QAAS6C,IAAK,yDAAyDhO,KAAM,GAEzG,GAEL,CACIwY,MAAO,8CACPmN,aAAcG,GACd,GAAAtZ,CAAIrI,EAAQsI,EAAQyZ,GAChBzB,GAAYzD,OAAOgB,WAAW,GAAG9Q,MAAK,KAClC6K,GAAmB5X,EAAQ,MAAM,IACjCnE,IACA2Y,GAAa,CAAExN,KAAM,QAAS6C,IAAK,yDAAyDhO,KAAM,GAEzG,GAEL,CACIwY,MAAO,gDACPmN,aAAcG,GACd,GAAAtZ,CAAIrI,EAAQsI,EAAQyZ,GAChBzB,GAAYzD,OAAOgB,WAAW,GAAG9Q,MAAK,KAClC0K,GAAoBzX,EAAQ,MAAM,IAClCnE,IACA2Y,GAAa,CAAExN,KAAM,QAAS6C,IAAK,yDAAyDhO,KAAM,GAEzG,ICrNIiuB,GAA8B,CACvC,CACIzV,MAAO,uCACPmN,aAAcI,GACd,GAAAvZ,CAAIrI,EAAQsI,EAAQyZ,GAChB,MAAM5E,OAAEA,EAAME,OAAEA,EAAMD,OAAEA,GAAWkD,GAAYpD,QAM/C1I,GAAa,CAAExN,KAAM,cAAe6C,IALb8J,GAAgB3T,GAAU,2CAC7C,wBAAwBmd,MACxB,iCAAiCE,MACjC,+BAA+BD,MAC/B,mBAAmB,GAAYD,EAASE,EAASD,GAAU,KAAK+J,QAAQ,OAE/E,GAEL,CACI9S,MAAO,qDACPmN,aAAcC,GACd,GAAApZ,CAAIrI,EAAQsI,EAAQyZ,GAChB,MAAMxF,gBAAEA,EAAeC,cAAEA,EAAaC,WAAEA,EAAUC,cAAEA,EAAaC,KAAEA,GAAS2D,GAAY5c,SAASkG,KAAK0S,MAChGjR,SAAEA,EAAQyK,OAAEA,EAAM8G,QAAEA,GAAYD,EAChCoN,EAAQzJ,GAAY5c,SAASkG,KAAKiT,OAAOC,QAEzCkN,EAA0BnL,IAC5B,MAAMoL,EAAUpV,KAAKE,MAAM8J,EAAO,KAC5BqL,EAAOrV,KAAKE,MAAMkV,EAAO,OACzBE,EAAYD,EAAO,EAAI,GAAGA,QAAa,GACvCE,EAAQvV,KAAKE,MAAOkV,EAAO,MAAkB,MAInD,MAAO,GAAGE,IAHSD,EAAO,GAAKE,EAAQ,EAAI,GAAGA,SAAe,KAC7CvV,KAAKE,MAAOkV,EAAU,KAAQ,aAC/BA,EAAU,WAC0C,EAGpD,IAACpL,EAkBpBrK,GAAa,CAAExN,KAAM,cAAe6C,IAdhB8J,GAAgB3T,GAAU,6CAC1C,uDAAuDgqB,EAAuBzN,OAC9E,6CAA6CyN,EAAuBxN,OACpE,gCAAgCnR,MAChC,6BAA6ByK,MAC7B,0BAA0BiU,sBAE1B,eAAenN,EAAQyN,UAAY,MACnC,yBAAyBzN,EAAQ0N,UAAY,MAC7C,2BAA2B1N,EAAQ2N,cAAgB,MACnD,0BAA0B3N,EAAQ4N,aAAe,MACjD,gBAAgB5N,EAAQ6N,SAAW,MACnC,kCAAkC/N,EAAgB,GAhBlCmC,EAgBiDnC,EAf1D,IAAIrQ,KAAKwS,GAAM6L,kBAe4D,iBAClF,uCAAuCV,EAAuBvN,MAErE,GACF,CACCpI,MAAO,6CACPmN,aAAcC,GACd,GAAApZ,CAAIrI,EAAQsI,EAAQyZ,GAChBpX,EAAYhK,OAAOzH,KAAK,CACpB8S,YAAa,WAAYd,MAAO,CAC5B,IAAI2M,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,+CACvC,IAAIgO,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,0XACvC,IAAIqL,GAAU,KACd,IAAIiB,IAAYnW,IACZ,QAA+BJ,IAA3BI,EAAO2qB,iBAAmE,aAAlC3qB,EAAO2qB,gBAAgBC,OAE/D,OADApW,GAAa,CAAExN,KAAM,SAAU6C,IAAK,4IAA8I,CAAE7J,WAC7KwK,EAAec,YAE1B,MAAMuf,EAAWC,WAAW1yB,QAAOmE,GAAKA,EAAEwuB,WAAU9uB,KAAIM,GAAKA,EAAEkJ,OAAMxJ,KAAIM,GAAKyuB,yBAAyBhrB,EAAQzD,KAAInE,QAAO6yB,KAAOA,IAC3HC,EAAcL,EAASzyB,QAAO6yB,GAAkB,IAAbA,EAAEE,SAAclvB,KAAIgvB,GAAKrC,cAAc5oB,EAAO4N,YAAaqd,EAAExlB,OAAOa,cAAalO,QAAO6yB,KAAOA,IAAG/vB,KAAK,MAC1IkwB,EAAcP,EAASzyB,QAAO6yB,GAAkB,IAAbA,EAAEE,SAAclvB,KAAIgvB,GAAKrC,cAAc5oB,EAAO4N,YAAaqd,EAAExlB,OAAOa,cAAalO,QAAO6yB,KAAOA,IAAG/vB,KAAK,MAC1ImwB,EAAcR,EAASzyB,QAAO6yB,GAAKA,EAAEhqB,SAAQhF,KAAIgvB,GAAKrC,cAAc5oB,EAAO4N,YAAaqd,EAAExlB,OAAOa,cAAalO,QAAO6yB,KAAOA,IAAG/vB,KAAK,MAC1IsZ,GAAa,CAAExN,KAAM,SAAU6C,IAAK,uRAChC,CAAE7J,UAAU,CAAEkrB,cAAaE,cAAaC,eAAc,MAIzE,UC1EaC,GAAtB,WAAAvqB,GAKI3G,KAAAmxB,UAA2B,KAAM,CAIpC,CAHG,QAAAC,GAAoB,CACpB,IAAAhxB,CAAKD,EAAmBmE,GAAmD,CAC3E,MAAAqhB,CAAO/f,GAAkC,ECb7C,MAAMyrB,GAAa,CCHb,cAA0BH,GAAhC,WAAAvqB,uBACI3G,KAAQsxB,SAAiB,UACzBtxB,KAAInB,KAAkB,aACtBmB,KAAAuxB,SAAW,IACXvxB,KAAQwxB,cAAGhsB,CAqDd,CAnDG,QAAA4rB,QAC8C5rB,IAAtCqE,QAAQ0mB,iBAAiBppB,WACzB0C,OAAO0mB,gBAAgBppB,SAAW,EAClCsqB,6BAA6B5nB,OAAQ,OAAQ,WAG7C6U,mBACIA,iBAAiBC,aACjBD,iBAAiBC,WAAa,MAElCD,iBAAmB,KAE1B,CAED,MAAAiH,CAAO/f,GACH,MAAM8rB,EAAQ1S,aAAa,aACrB2S,EAAMlX,KAAKC,SACbiX,EAAM,GACN3S,aAAa,YAAa0S,EAAME,UAAU,IACnCD,EAAM,GACb3S,aAAa,YAAa0S,EAAM1X,QAAQ,aAAc,QAEtDgF,aAAa,YAAa0S,EAAM1X,QAAQ,aAAc,OAE7D,CAED,IAAA5Z,CAAKD,EAAmBmE,GACpBA,GAAS,KACLnE,EAAIuC,aAAa,iBAAkB,GAAG,CAACsE,EAAMC,KACrCjH,KAAKmxB,aACFlqB,EAAKD,KAGhB7G,EAAIuC,aAAa,sBAAuB,GAAG,CAACsE,EAAMC,KAC9C,MAAMgV,EAAShV,EAAKD,GACpB,OAAIhH,KAAKmxB,YAAoBlV,EAAS,EAC/BA,CAAM,GACf,IAGN9b,EAAIuC,aAAa,yBAA0B,GAAG,CAACsE,EAAMC,KACjD,IAAIjH,KAAKmxB,YACT,OAAOlqB,EAAKD,EAAK,IAGrB7G,EAAIuC,aAAa,oBAAqB,GAAG,CAACsE,EAAMC,KAC5C,MAAMgV,EAAShV,EAAKD,GACpB,OAAKA,EAAK,GAAiBI,YAAcpH,KAAKmxB,YAAoBlV,EAAS,EACpEA,CAAM,GAEpB,GCvDC,cAAwBiV,GAA9B,WAAAvqB,uBACI3G,KAAInB,KAAkB,WACtBmB,KAAQuxB,SAAG,EACXvxB,KAAQsxB,SAAiB,OACzBtxB,KAAAwxB,SAA4B,CACxB5kB,KAAM,aACNnI,OAAQ,CAAC,cAEhB,GCTK,cAA2BysB,GAAjC,WAAAvqB,uBACI3G,KAAAwxB,SAA4B,CACxB/sB,OAAQ,CAAC,aACTmI,KAAM,iBAEV5M,KAAQsxB,SAAiB,MACzBtxB,KAAInB,KAAkB,cACtBmB,KAAAuxB,SAAW,IAEXvxB,KAAY6xB,cAAY,CAuB3B,CArBG,QAAAT,GACQvnB,QACA4nB,6BAA6B5nB,OAAQ,OAAQ,YAEpD,CAED,MAAA8b,CAAO/f,GACH,QAA0CJ,IAAtCI,GAAQ2qB,iBAAiBppB,SAA7B,CACA,GAAInH,KAAKmxB,cAAsC,IAAvBnxB,KAAK6xB,aAAqB,CAC9C,MAAMC,EAAOlsB,EAAO2qB,gBAAgBppB,SAAWnH,KAAK6xB,aAChDC,EAAO,IAAGlsB,EAAO2qB,gBAAgBppB,UAAY2qB,EACpD,CACD9xB,KAAK6xB,aAAejsB,EAAO2qB,gBAAgBppB,QALiB,CAM/D,CAED,IAAA/G,CAAKD,GACDA,EAAIuC,aAAa,kCAAmC,GAAG,CAACsE,EAAMC,OACrDD,EAAK,IAAMA,EAAK,GAAK,MAAIA,EAAK,GAAK,IACjCC,EAAKD,KAEnB,GChCC,cAAyBkqB,GAA/B,WAAAvqB,uBACI3G,KAAQsxB,SAAiB,MACzBtxB,KAAInB,KAAkB,YACtBmB,KAAAuxB,SAAW,IACXvxB,KAAAwxB,SAA4B,CACxB5kB,KAAM,gBACNnI,OAAQ,CAAC,gBAQbzE,KAAY6xB,cAAY,CAW3B,CAhBG,QAAAT,GACQvnB,QAAQ0mB,iBAAiBppB,WACzB0C,OAAO0mB,gBAAgBppB,SAAW,EACzC,CAID,MAAAwe,CAAO/f,GACH,QAA0CJ,IAAtCI,GAAQ2qB,iBAAiBppB,SAA7B,CAEA,GAAInH,KAAKmxB,cAAsC,IAAvBnxB,KAAK6xB,aAAqB,CAC9C,MAAMC,EAAOlsB,EAAO2qB,gBAAgBppB,SAAWnH,KAAK6xB,aAChDC,EAAO,IAAGlsB,EAAO2qB,gBAAgBppB,UAAmB,GAAP2qB,EACpD,CACD9xB,KAAK6xB,aAAejsB,EAAO2qB,gBAAgBppB,QANiB,CAO/D,UJlBQ4qB,GAMT,WAAAprB,CAAYxG,EAAmBmE,GAF/BtE,KAAAgyB,QAAsC,IAAI5zB,IAGtC4B,KAAKqxB,WAAa,IAAIjzB,IAAIizB,GAAWxvB,KAAI1D,GAAK,IAAIA,IAAG0D,KAAIowB,GAAa,CAACA,EAAUpzB,KAAMozB,MACvFjyB,KAAKqxB,WAAWxrB,SAAQosB,GAAaA,EAAU7xB,KAAKD,EAAKmE,KACzDtE,KAAKqxB,WAAWxrB,SAAQ,CAAC1H,EAAGU,IAASV,EAAEgzB,UAAY,IAAMnxB,KAAKgyB,QAAQ/zB,IAAIY,KAE1E+R,aAAY,KACR,MAAMsB,EAAMD,KAAKC,MACjBlS,KAAKgyB,QAAQnsB,SAAQ,CAAC4e,EAAM5lB,KACpB4lB,EAAOvS,EAAKlS,KAAKgyB,QAAQ/vB,OAAOpD,GAC3BgL,QAAQC,cAAc9J,KAAKqxB,WAAWzyB,IAAIC,IAAO8mB,OAAO9b,OAAO,GAC1E,GACH,IACN,CAED,QAAAqoB,CAASrzB,GACL,MAAMozB,EAAYjyB,KAAKqxB,WAAWzyB,IAAIC,GACtC,IAAKozB,EAAW,OAEhB,MAAM/f,EAAMD,KAAKC,MACjB,IAAIqf,EAAWU,EAAUV,SAEzB,GAAIU,EAAUT,SAAU,CACpB,MAAMA,EAAWS,EAAUT,SACL,eAAlBA,EAAS5kB,KACT4kB,EAAS/sB,OAAOoB,SAAQpB,GAAUzE,KAAKgyB,QAAQ/vB,OAAOwC,KAC7B,kBAAlB+sB,EAAS5kB,MAChB4kB,EAAS/sB,OAAOoB,SAAQpB,IACpB,MAAMutB,EAAUhyB,KAAKgyB,QAAQpzB,IAAI6F,GACjC,QAAgBe,IAAZwsB,EAAuB,CACvB,MAAMG,EAASH,EAAUT,EACrBY,EAASjgB,EAAKlS,KAAKgyB,QAAQ9yB,IAAIuF,EAAQ0tB,IAEvCnyB,KAAKgyB,QAAQ/vB,OAAOwC,GACpB8sB,GAAaS,EAAU9f,EAE9B,IAGZ,CAED+f,EAAUb,WAEiB,YAAvBa,EAAUX,SACVtxB,KAAKgyB,QAAQ9yB,IAAIL,EAAMoT,KAAKC,MAAQqf,GACN,QAAvBU,EAAUX,UAAsBtxB,KAAKgyB,QAAQ/zB,IAAIY,IACxDmB,KAAKgyB,QAAQ9yB,IAAIL,EAAMmB,KAAKgyB,QAAQpzB,IAAIC,GAAS0yB,EAExD,CAKD,mBAAWjoB,GACP,OAAOyoB,GAAiBxoB,SAC3B,CAED,WAAO1B,CAAK1H,EAAmBmE,GACvBytB,GAAiBxoB,YACrBwoB,GAAiBxoB,UAAY,IAAIwoB,GAAiB5xB,EAAKmE,GAC1D,EATMytB,GAASxoB,eAAiC/D,EKlBrD,MAAMmX,GAEF,CACAyV,YAAe,CACXC,OAAQ,CAAEzlB,KAAM,cAAe6C,IAAK,mCACpC6iB,SAAU,CAAE1lB,KAAM,SAAU6C,IAAK,iLAErC8iB,UAAa,CACTF,OAAQ,CAAEzlB,KAAM,cAAe6C,IAAK,iCACpC6iB,SAAU,CAAE1lB,KAAM,SAAU6C,IAAK,oRAErC+iB,WAAc,CACVH,OAAQ,CAAEzlB,KAAM,cAAe6C,IAAK,kCACpC6iB,SAAU,CAAE1lB,KAAM,SAAU6C,IAAK,+KAErCgjB,SAAY,CACRJ,OAAQ,CAAEzlB,KAAM,cAAe6C,IAAK,gCACpC6iB,SAAU,CAAE1lB,KAAM,SAAU6C,IAAK,6IAErCijB,yBAA4B,CACxBL,OAAQ,CAAEzlB,KAAM,cAAe6C,IAAK,oDACpC6iB,SAAU,CAAE1lB,KAAM,SAAU6C,IAAK,yUAIzB,SAAAkjB,GAAY3sB,EAAqB4sB,GACzCA,EA7DR,SAA0B5sB,EAAqByJ,GAC3C,MAAMmN,EAA6B,CAC/B,IAAIb,IAAYnW,GAAWwU,GAAa3K,EAAI4iB,OAAQ,CAAEzsB,aACtD,IAAImW,IAAYnW,GAAWwU,GAAa3K,EAAI6iB,SAAU,CAAE1sB,aACxD,IAAImW,IAAW,IAAMgW,GAAiBzoB,SAAS4oB,SAASlsB,MAE5DuK,EAAYhK,OAAOgL,WAAW,CAAEK,YAAa,mBAAmB5L,IAAQ8K,MAAO8L,GACnF,CAuDQiW,CAAiB7sB,EAAM2W,GAAS3W,IArDxC,SAA8BA,EAAqByJ,GAC/C,IAAID,EAAO,CACPC,IAAKkK,IAGT,MAAMiD,EAA6B,CAC/B,IAAIV,GAAe,CAAC,eAAe,CAACtW,EAAQqW,KACxC,GAAIA,EAAOnH,QAAQ7U,OAAS,EAAG,CAC3B,MAAM6c,EAAmBb,EAAOnH,QAAQjT,KAAIM,GAAKA,EAAE8J,MAAMZ,OAAMvK,KAAK,MAEpE,OADAsZ,GAAaX,GAAgB,CAAE7T,UAAU,CAAEkX,qBACpC1M,EAAec,WACzB,CACG1B,EAAKC,IAAM,CAAE7C,KAAM,cAAe6C,IAAK,qDAC1C,IAEL,IAAIsM,IAAYnW,GAAWwU,GAAa5K,EAAKC,IAAK,CAAE7J,aACpD,IAAIkV,GAAU,KACd,IAAIiB,IAAYnW,IACZmsB,GAAiBzoB,SAAS4oB,SAASlsB,EAAK,IAE5C,IAAI+V,IAAYnW,GAAWwU,GAAa3K,EAAI4iB,OAAQ,CAAEzsB,aACtD,IAAImW,IAAYnW,GAAWwU,GAAa3K,EAAI6iB,SAAU,CAAE1sB,cAE5D2K,EAAYhK,OAAOzH,KAAK,CAAE8S,YAAa,oBAAoB5L,IAAQ8K,MAAO8L,GAC9E,CA+BQkW,CAAqB9sB,EAAM2W,GAAS3W,GAE5C,CCvEA,MAAM+sB,GAAuC,CACzC,+CAAgD,6BAChD,8CAA+C,6BAC/C,iDAAkD,6BAClD,gDAAiD,6BAEjD,yCAA0C,uFAC1C,wCAAyC,4EACzC,2CAA4C,mGAC5C,0CAA2C,0FAGzCC,GAAkC,CAAC,WAAY,cAE/C,MAAOC,WAA4BvmB,EACrC,WAAA/F,GACI4O,MACI,SACAyd,GACA,CACI3nB,KAAM,sBACN6nB,YAAa,EACbC,aAAc,CAAC,WAAY,mBAC3B3oB,OAAQwoB,GACRI,WAAYJ,IAEhB,0DAEP,CAED,EAAArrB,CAAG/B,EAAyBsI,EAAmBC,GACvCA,EAAK/F,kBAAoBxC,EAAOkE,cAC5B0d,GAAuB5hB,EAAQsI,KAC3BgY,GAAYlQ,OAAOxR,MAAMnF,KAAO,EAChC4qB,KAEAJ,KAIf,CAED,UAAAld,CAAWgb,EAAiB5f,GAKxB,OAJAA,EAAKjJ,KAAK,CACN8J,IAAK,4CAA4C+e,IACjDhe,KAAM3J,KAAK8N,KAAK6Z,KAEb5f,CACV,CAED,IAAA+F,CAAKulB,GACD,OAAON,GAAQM,IAAYA,CAC9B,EAGC,MAAOC,WAAwBrmB,EAArC,WAAAtG,uBACI3G,KAAInB,KAAwB,iBAQ/B,CAPG,IAAA6O,CAAKH,EAAmBC,EAAkBzB,GACtC,QxExBD,SAA2B7E,EAAGwE,EAAGC,GACpC,IAAKD,EACD,OAAO,EACX,MAAM6nB,EAAKrsB,EAAEiE,WAAWsJ,MAAKrX,GAAKA,EAAE0L,MAAMsC,MAAMC,OAASK,EAAE5C,MAAMsC,QACjE,QAAKmoB,GAEE/nB,EAAgB+nB,EAAI7nB,EAAGC,EAClC,CwEiBa6nB,CAAkBhmB,EAAOsC,EAAelR,IAAImN,EAAMV,MAAO,CAAEQ,MAAM,OAClE2B,EAAMpG,YACC8e,GAAYzD,OAAOA,OAAS,GAG1C,ECrDC,MAAOgR,WAAwBzmB,EACjC,WAAArG,GAAgB4O,MAAM,mBAAe/P,EAAW,UAUzCxF,KAAIgG,UAA8BR,CAVmB,CAE5D,EAAAmC,CAAG/B,EAAyBsI,EAAmBC,GAC3C,MAAM1J,EAASwR,kBAAkBxB,MAAKnW,GAAKA,EAAEwL,eAAiBqE,EAAK/F,kBAC9D3D,Y/DqBqBA,EAAmBc,EAA2CsG,GAC5F,MAAMwL,EAAYpM,EAAYxG,GACxB4O,EAASvB,EAAWS,OAAOvG,MAC3BL,EAAS,CAAEK,MAAO,CAAEG,WAAYkH,EAAOxU,KAAMiL,aAAcuJ,EAAOjB,KAAOvG,QAE/E,OAAOtG,EAAKV,OAAMzH,IACd,MAAM2O,EAAqB,iBAAN3O,EAAiBA,EAAIA,EAAE0L,MAAMsC,MAC5C7F,EAAO8R,EAAUzY,IAAImN,GACrB2nB,EAAqB,iBAANt2B,EAAiB0S,EAAelR,IAAImN,GAAS3O,EAClE,SAAKmI,IAASmuB,IAEPloB,EAAgBjG,EAAMmuB,EAAO/nB,EAAO,GAEnD,C+DjCagoB,CAAkB/tB,EAAQ,CAACoK,EAAYC,IAAgB,SAC1CzK,IAAdxF,KAAKgG,MACL0iB,GAAkB9iB,EAAQnB,EACjC,CAID,UAAAkI,CAAWjD,EAAiB3B,GAOxB,OANI/H,KAAKgG,MACL+B,EAAKjJ,KAAK,CACN8J,IAAK,qBACLe,KAAM3J,KAAKgG,OAGZ+B,CACV,EAGC,MAAO6rB,WAAuB5mB,EAChC,WAAArG,GAAgB4O,MAAM,cAAU/P,EAAW,SAAY,CAEvD,EAAAmC,CAAG/B,EAAyBsI,EAAmBC,GAC3C,MAAM9F,EAAI8F,EAAKhF,aAAasL,MAAKtW,GA/BkB,uBA+BKA,EA/BbyK,MAgCvCP,GAAKoP,GAAiB7R,IACtB+sB,GAAYtqB,EAAEsB,MAAuB,EAE5C,EC1CC,MAAOkqB,WAAoB7mB,EAC7B,WAAArG,GAAgB4O,MAAM,SAAU,CAAC,aAAc,WA2BvCvV,KAAmB8zB,oBAAG,CA3B8B,CAE5D,EAAAnsB,CAAG/B,EAAyBsI,EAAmBC,GAC3C,GAAIA,EAAKrF,OAASqF,EAAKjF,cAAckM,WAAW,aAAc,CAC1D,MAAM2e,EAAQ7lB,EAAO/C,WAAWsJ,MAAKpW,GAAKA,EAAEyK,MAAMsC,MAAMC,OAAS8C,EAAKrF,MAAOE,YAC7E,IAAK+qB,EAAO,OACZ,MAAMtvB,EAASyL,EAAMuE,MAAKtW,GAAKA,EAAE2K,MAAMsC,QAAU+C,EAAKrF,MAAOE,WACtD7K,EAAE2K,MAAMuC,OAAS8C,EAAKrF,MAAOC,WAAa5K,EAAE8N,MAAMZ,OAAS8C,EAAKrF,MAAOG,YAC9E,IAAKxE,EAAQ,OACb,IAAK8P,EAAuBwf,EAAOtvB,GAAS,OAElB,SAAtBA,EAAOwH,MAAMZ,MAAyC,oBAAtB5G,EAAOwH,MAAMZ,KACzCoM,GAAiB7R,IAAS5F,KAAKg0B,iBAAiBpuB,GACvB,SAAtBnB,EAAOwH,MAAMZ,MAAyC,oBAAtB5G,EAAOwH,MAAMZ,MACpDrL,KAAKi0B,aAAaruB,EAEzB,CACJ,CAEO,gBAAAouB,CAAiBpuB,GACrBwU,GAAa,CAAExN,KAAM,QAAS6C,IAAK,yDACOjK,IAAtCI,GAAQ2qB,iBAAiBppB,WACzBvB,EAAO2qB,gBAAgBppB,SAAW,IAClC+sB,sBAAsBtuB,GAAQ,GAErC,CAIO,YAAAquB,CAAaruB,GACjBwU,GAAa,CAAExN,KAAM,QAAS6C,IAAK,uGACnCzP,KAAK8zB,oBAAsB7hB,KAAKC,MAAQ,GAC3C,CAED,IAAArK,CAAK1H,GACDA,EAAIuC,aAAa,sBAAuB,GAAG,CAACsE,EAAMC,KAC9C,MAAOC,EAAGitB,EAAQC,EAAUC,GAAYrtB,EAKxC,OAJIE,EAAE4C,eAAiBD,QAAQC,cAAgB9J,KAAK8zB,oBAAsB7hB,KAAKC,OAAoB,mBAAXiiB,IACpFC,EAAStgB,YAAc,GACvB9T,KAAK8zB,oBAAsB,GAExB7sB,EAAKD,EAAK,GAExB,QC7CQstB,GAKT,WAAA3tB,CAAYxG,GACRH,KAAKu0B,SAAW,IAAId,GAEpBzzB,KAAKw0B,SAAW,IAAItnB,EAAiB/M,GACrCH,KAAKw0B,SAASpmB,gBAAgB,IAAIklB,IAClCtzB,KAAKw0B,SAASnmB,YAAY,IAAI4kB,IAC9BjzB,KAAKw0B,SAAS/lB,qBAAqBzO,KAAKu0B,UACxCv0B,KAAKw0B,SAAS/lB,qBAAqB,IAAImlB,IACvC5zB,KAAKw0B,SAAS/lB,qBAAqB,IAAIolB,GAC1C,CAED,WAAOhsB,CAAK1H,GACRH,KAAKuJ,UAAY,IAAI+qB,GAAiBn0B,EACzC,CAED,UAAO8N,CAAIrI,EAAyBsI,EAAmBC,GACnDnO,KAAKuJ,WAAWirB,SAASvmB,IAAIrI,EAAQsI,EAAQC,EAChD,CAGD,mBAAW7E,GACP,OAAOtJ,KAAKuJ,SACf,ECtBE,MAAMkrB,GAET,CACAjC,WAAc,CAAE5lB,KAAM,cAAe6C,IAAK,wEAC1CgjB,SAAY,CAAE7lB,KAAM,cAAe6C,IAAK,kKACxC2iB,YAAe,CAAExlB,KAAM,cAAe6C,IAAK,6IAC3C8iB,UAAa,CAAE3lB,KAAM,cAAe6C,IAAK,+NACzCilB,MAAS,CAAE9nB,KAAM,cAAe6C,IAAK,qKAGzB,SAAAklB,GAAe/nB,EAAc5G,GACzC,MAAM4W,EAA6B,CAC/B,IAAIV,GAAe,CAACjM,IAAgB,CAACrK,EAAQqW,KACzC,GAAIA,EAAOnH,QAAQ7U,OAAS,EAExB,OADAma,GAAaZ,GAAmB,CAAE5T,UAAU,CAAEkX,iBAAkB7M,EAAchE,MAAMZ,OAC7E+E,EAAec,YAE1BojB,GAAiBhrB,SAASirB,SAASvuB,KAAOA,CAAI,IAC/C,GACH,IAAIyX,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,+BAA+B7C,WAC3E,IAAI6Q,GAAY,CAAE7Q,KAAM,cAAe6C,IAAKglB,GAAuBzuB,GAAQ,SAASyJ,OAExFc,EAAYhK,OAAOzH,KAAK,CAAE8S,YAAa,iBAAiBhF,IAAQkE,MAAO8L,GAC3E,CC5BO,MAAMgY,GAAmC,CAC5C,CACI3a,MAAO,yBACPmN,aAAcC,GACd,GAAApZ,CAAIrI,EAAQsI,EAAQyZ,GAChBgL,GAAY,aACf,GAEL,CACI1Y,MAAO,6BACPmN,aAAcC,GACd,GAAApZ,CAAIrI,EAAQsI,EAAQyZ,GAChBgL,GAAY,WACf,GAEL,CACI1Y,MAAO,0BACPmN,aAAcC,GACd,GAAApZ,CAAIrI,EAAQsI,EAAQyZ,GAChBgL,GAAY,cACf,GAEL,CACI1Y,MAAO,wBACPmN,aAAcC,GACd,GAAApZ,CAAIrI,EAAQsI,EAAQyZ,GAChBgL,GAAY,YACf,GAEL,CACI1Y,MAAO,gCACPmN,aAAcC,GACd,GAAApZ,CAAIrI,EAAQsI,EAAQyZ,GAChBgL,GAAY,2BACf,IAIIkC,GAAyC,CAClD,CACI5a,MAAO,qBACPmN,aAAcL,GACd,GAAA9Y,CAAIrI,EAAQsI,EAAQyZ,GAChBgN,GAAe,eAAWnvB,EAC7B,GAEL,CACIyU,MAAO,wBACPmN,aAAcL,GACd,GAAA9Y,CAAIrI,EAAQsI,EAAQyZ,GAChBgN,GAAe,cAAe,cACjC,GAEL,CACI1a,MAAO,sBACPmN,aAAcL,GACd,GAAA9Y,CAAIrI,EAAQsI,EAAQyZ,GAChBgN,GAAe,YAAa,YAC/B,GAEL,CACI1a,MAAO,uBACPmN,aAAcL,GACd,GAAA9Y,CAAIrI,EAAQsI,EAAQyZ,GAChBgN,GAAe,aAAc,aAChC,GAEL,CACI1a,MAAO,qBACPmN,aAAcL,GACd,GAAA9Y,CAAIrI,EAAQsI,EAAQyZ,GAChBgN,GAAe,WAAY,WAC9B,GACF,CACC1a,MAAO,uCACPmN,aAAcL,GACd,GAAA9Y,CAAIrI,EAAQsI,EAAQyZ,eD7CxB,MAAM/K,EAA6B,CAC/B,IAAIV,GAAe,CAACjM,IAAgB,CAACrK,EAAQqW,KACzC,GAAIA,EAAOnH,QAAQ7U,OAAS,EAExB,OADAma,GAAaZ,GAAmB,CAAE5T,UAAU,CAAEkX,iBAAkB7M,EAAchE,MAAMZ,OAC7E+E,EAAec,WACzB,IAEL,IAAIuM,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,wEAC5C,IAAIgO,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,uIACvC,IAAIqL,GAAU,MACd,IAAI2C,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,wDACvC,IAAIqL,GAAU,MACd,IAAI2C,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,4FACvC,IAAIqL,GAAU,MACd,IAAI2C,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,kFACvC,IAAIqL,GAAU,MACd,IAAI2C,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,0DACvC,IAAIqL,GAAU,MACd,IAAI2C,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,0DACvC,IAAIqL,GAAU,MACd,IAAI2C,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,gHAC5C,IAAIqL,GAAU,KACd,IAAI2C,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,+BAC5C,IAAIgO,GAAY,CAAE7Q,KAAM,cAAe6C,IAAK,wEAC5C,IAAIgO,GAAY,CAAE7Q,KAAM,SAAU6C,IAAK,yUAE3Cc,EAAYhK,OAAOzH,KAAK,CAAE8S,YAAa,4CAA6Cd,MAAO8L,GAC/F,CCmBYkY,EACH,IC5EIC,GAAW,CAACrN,GAAUuE,GAAUtB,GAAUH,GAAYkF,GAAUJ,GAAgBsF,IAAeI,OAE/FC,GAAgB,CAACxF,IAAeuF,OAEhCE,GAAsB,CAACL,IAAqBG,OCNzD,SAASG,GAAMjqB,GACX,OAAOA,EAAI8O,QAAQ,eAAgB,GACvC,CAEM,SAAUob,GAAYxvB,EAAyBsI,EAA4ByZ,EAAiB3gB,GAC9F2gB,EAAUwN,GAAMxN,GAASC,cACzB,MAAMyN,EAAY,oBACZC,EAAiB,4BAGvB,IAAIC,EAEJ,MAAMtb,E7DoCC,IAAIub,OAAO,e6DxCiB5vB,E7DwCKkE,cAAgB,M6DpChC2rB,KAAK9N,GAgB7B,GAdI1N,GAEA0N,EAAUwN,GADVxN,EAAUA,EAAQ9mB,MAAMoZ,EAAM,GAAGha,SAEjCs1B,EAAYR,IACLpN,EAAQvS,WAAWigB,IAE1B1N,EAAUwN,GADVxN,EAAUA,EAAQ9mB,MAAMw0B,KAExBE,EAAYN,IACLtN,EAAQvS,WAAWkgB,KAE1B3N,EAAUwN,GADVxN,EAAUA,EAAQ9mB,MAAMy0B,KAExBC,EAAYL,IAGXK,EAEL,IAAK,MAAMG,KAAOH,EAAW,CACzB,GAAIG,EAAI1vB,MAAQ0vB,EAAI1vB,OAASgB,EAAKhB,KAAM,SACxC,IAAK0vB,EAAItO,aAAaxhB,EAAQsI,GAAS,SACvC,MAAM+N,EAASyZ,EAAIzb,MAAMwb,KAAK9N,GAC9B,GAAI1L,EAGA,OAFAyZ,EAAIznB,IAAIrI,EAAQsI,EAAQ+N,EAAQjV,QAChCoF,EAAiBxG,EAGxB,CACL,CC3BA,SAAS+vB,GAAa/vB,EAAyBsI,EAAmBuB,EAAazJ,GAC9D,SAATA,GAA4B,YAATA,GAAoBovB,GAAYxvB,EAAQsI,EAAQuB,EAAK,CAAEzJ,QAClF,CAEA,SAAS4vB,GAAiBhwB,EAAyBsI,EAAmBsB,GAClE8kB,GAAiBrmB,IAAIrI,EAAQsI,EAAQsB,GACrCwf,GAAS1lB,SAAS8jB,WAAWxnB,EAAQsI,EAAQsB,EACjD,CAEM,SAAUqmB,GAAY11B,GACxBA,EAAIuC,aAAa,oBAAqB,GAAG,CAACsE,EAAMC,KAC5CA,EAAKD,GACD6C,QAzBI,SAAejE,EAAyB4J,GACpD,IAAKA,EAAKrD,aAAeqD,EAAK1F,cAAwC,iBAAjB0F,EAAK9E,QAAsB,OAChF,GAAI9E,EAAOkwB,WAAalwB,EAAOkwB,UAAUnzB,QAAQ6M,EAAK1F,eAAiB,EAAG,OAE1E,MAAMwI,EAAO,MACT,QAA0B9M,IAAtBgK,EAAKumB,mBAAqDvwB,IAAvBgK,EAAKgc,cAA6B,MAAO,CAAE3sB,KAAM2Q,EAAKumB,aAActK,MAAOjc,EAAKgc,cAE1H,EAHY,GAKb4J,GAAYxvB,EAAQ4J,EAAK1F,aAAc0F,EAAK9E,QAAS,CAAE1E,KAAM,OAAQ4mB,SAAUta,GACnF,CAeoB0jB,CAAensB,OAAQ7C,EAAK,GAAG,GAEnD,CC1BA,MAAMivB,GAAuD,IAAI73B,IAAI,CAAC,CAAC,QAoBvE,YAA+B4I,GAC3B,MAAMkvB,EAAUrL,SAAS7jB,EAAK,IAC9B,GAAImvB,MAAMD,GAEN,YADA7sB,EAAeC,SAASgB,UAAU,oDAGtC,MAAM7F,EAASwR,kBAAkBxB,MAAKnW,GAAKA,EAAEwL,eAAiBosB,IAC9D,IAAKzxB,EAED,YADA4E,EAAeC,SAASgB,UAAU,mCAItC,MAAMuK,EAAU1E,EAAa1L,GACfqN,EAAWS,OAAOvG,MAEhC3C,EAAeC,SAASgB,UAAU,MAAMrG,KAAWD,kBAEnD2L,EAAY9J,SAAQ,CAAC1H,EAAG2G,KACpB,MAAMqT,EAActD,EAAQjW,IAAIT,EAAE2K,MAAMsC,OAClCgrB,EAAoB,GAO1B,GALAA,EAAQt3B,KAAK,yBAAyBgG,EAAM,KAC5CsxB,EAAQt3B,KAAK,WAAWX,EAAE2K,MAAMuC,QAChC+qB,EAAQt3B,KAAK,eAAeX,EAAE2K,MAAMsC,SACpCgrB,EAAQt3B,KAAK,mBAAmBX,EAAE8N,MAAMZ,QAEnC8M,EAGE,CACHie,EAAQt3B,KAAK,cAAcqZ,EAAYrP,MAAMuC,QAC7C+qB,EAAQt3B,KAAK,YAAYqZ,EAAYvI,SAErC,MAAMwL,EAAQ5G,EAAyB/P,EAAQtG,GACzCk4B,EAAW9hB,EAAuB4D,EAAaha,GAEhDid,GAGDgb,EAAQt3B,KAAK,wBAAwBsc,KACrCgb,EAAQt3B,KAAK,sBAAsBu3B,KACnCD,EAAQt3B,KAAK,eAAeqZ,EAAY1S,UAAUqG,YAClDsqB,EAAQt3B,KAAK,iBAAiBsmB,KAAKI,UAAUrN,EAAY1S,UAAUC,gBALnE0wB,EAAQt3B,KAAK,wBAAwBsc,KAQzCgb,EAAQt3B,KAAK,kBAAiBsc,GAASib,EAAW,SAAW,UAChE,MAnBGD,EAAQt3B,KAAK,wBACbs3B,EAAQt3B,KAAK,wBAoBjBuK,EAAeC,SAASgB,UAAU8rB,EAAQt1B,KAAK,MAAQ,KAAK,GAEpE,KApEMw1B,GAA2B,CAC7B,CACI1tB,IAAK,WACLsD,YAAa,IAAI,IAAI+pB,GAAWlxB,QAAQjE,KAAK,6CAC7CqzB,OAIR,SAAuBntB,EAAcuvB,GACjC,MAAM,IAAMC,GAASD,EAAQ31B,MAAM,KAC7B80B,EAAMc,GAAOzlB,QACnB,IAAK2kB,IAAQO,GAAWh4B,IAAIy3B,GAExB,YADArsB,EAAeC,SAASgB,UAAU,oDAAoD,IAAI2rB,GAAWlxB,QAAQjE,KAAK,qBAGtHm1B,GAAWr3B,IAAI82B,EAAfO,MAAyBO,EAC7B,ICfgB,SAAAC,GAAajmB,EAAmBye,GAC5CD,GAASnnB,KAAK2I,EAAWye,GAEzB,MAKMyH,EAAiB,CAClB/G,GAAkB,IAAIZ,GAAW,EAAG,EAAGY,GACvCA,GAAkB,IAAIZ,GAAW,EAAG,GAAIY,GACxCA,GAAkB,IAAIvB,GAAa,EAAG,GAAIuB,OAAOnqB,EAAW,CAAC,aAAc,uBAAwB,gBACnGmqB,GAAkB,IAAIvB,GAAa,EAAG,GAAIuB,OAAOnqB,EAAW,CAAC,YAAa,aAAc,uBACxFmqB,GAAkB,IAAIvB,GAAa,EAAG,GAAIuB,EAAO,CAAC,OAAQ,QAAS,OAAQ,kBAAcnqB,GACzFmqB,GAAkB,IAAI7B,GAAc,EAAG,EAAG6B,IAG/C,IAAIgH,EAAc1kB,KAAKC,MACvBtB,aAAY,KACR,GAAI/G,QAAUA,OAAOC,cAAgBoc,GAAY5c,SAAU,CACvD,MAAM4I,EAAMD,KAAKC,MACX0kB,EAAgB,IAAiBD,EACvC,GAAI3H,GAAS1lB,SAAS8lB,YAAgC,aAAlBxQ,cAA8B+X,EAAczkB,OAC3E,GAAIA,EAAM0kB,IACXD,EAAczkB,EACVgU,GAAYzD,OAAOA,QAAU,IAAI,CACjC,MAAM+K,GAAU,GAAKtH,GAAYzD,OAAOA,OAClCF,EAAOmU,EAAejc,KAAKE,MAAMF,KAAKC,SAAWgc,EAAez2B,SAASutB,GAxB7E5nB,EAyBOiE,OAxBrBuQ,GAAa,CAAExN,KAAM,SAAU6C,IAAK,0EADGhS,EAyBV8kB,GAxBkFwL,aAAe,CAAEnoB,WAChIopB,GAAS1lB,SAAS6lB,UAAU1xB,EAwBnB,CAER,CA5BY,IAACmI,EAAyBnI,CA4BtC,GACF+S,EACP,OCxCaqmB,GAGT,WAAAlwB,CAAqBmwB,GAAA92B,KAAU82B,WAAVA,EACjB92B,KAAK2f,MAAQ1N,KAAKC,MAClBtB,aAAY,KACR,GAAI/G,QAAUA,OAAOC,cAAgBoc,GAAY5c,SAAU,CACvD,MAAMmb,EAAOxS,KAAKC,MACZqS,EAAa9M,GAAiB5N,QAC9B2a,EAAY0B,GAAYlQ,OAAOxR,MAAMnF,KAAO,EAClD6mB,GAAYO,WAAWnC,SAASC,EAAYC,EAAWC,EAAOzkB,KAAK2f,OACnE3f,KAAK2f,MAAQ8E,CAChB,IACFqS,EACN,CAGD,WAAOjvB,CAAKivB,GACJD,GAASttB,YACbstB,GAASttB,UAAY,IAAIstB,GAASC,GACrC,CACD,mBAAWxtB,GACP,OAAOutB,GAASttB,SACnB,EAPcstB,GAASttB,eAAyB/D,QCgBxCuxB,GAET,WAAApwB,CAAqBmwB,GAAA92B,KAAU82B,WAAVA,EADb92B,KAASg3B,UAAW,EAExBpmB,aAAY,KACJ/G,QAAUA,OAAOC,oBAC0BtE,IAAvC+K,EAAYhK,OAAOoL,gBACnB3R,KAAKg3B,UAAY,EACVvM,EAAU5gB,OAAQmG,GAAY,IAAUya,EAAU5gB,OAAQoG,KAC1C,IAAnBjQ,KAAKg3B,UAAiBh3B,KAAKg3B,UAAY/kB,KAAKC,MACvCD,KAAKC,MAAQlS,KAAKg3B,UAAY,OArCrD,WACF,MAAMpa,EAA6B,CAC/B,IAAIV,GAAe,CAAClM,EAAYC,IAAgB,CAACrK,EAAQqW,KACrD,GAA6B,GAAzBA,EAAOnH,QAAQ7U,OACf,OAAOmQ,EAAec,YAEtBkJ,GAAa,CAAExN,KAAM,QAAS6C,IAAK,oIACtC,IACF,GACH,IAAIsM,IAAYnW,IACR6kB,EAAU7kB,EAAQqK,GAAe,KACjCrK,EAAOuF,WAAavF,EAAOuF,WAAWnN,QAAOG,GAAKA,EAAE2K,MAAMsC,MAAMC,OAAS4E,EAAcnH,MAAMsC,QAC7FgB,EAAiBxG,EAAQqK,EAAcnH,MAAMsC,OAC7CgP,GAAa,CAAExN,KAAM,QAAS6C,IAAK,GAAGQ,EAAchE,MAAMZ,0BAC7D,IAEL,IAAI0Q,IAAYnW,IACR6kB,EAAU7kB,EAAQoK,GAAY,KAC9BpK,EAAOuF,WAAavF,EAAOuF,WAAWnN,QAAOG,GAAKA,EAAE2K,MAAMsC,MAAMC,OAAS2E,EAAWlH,MAAMsC,QAC1FgB,EAAiBxG,EAAQoK,EAAWlH,MAAMsC,OAC1CgP,GAAa,CAAExN,KAAM,QAAS6C,IAAK,GAAGO,EAAW/D,MAAMZ,0BAC1D,IAEL,IAAIoS,GAAY,CAAE7Q,KAAM,QAAS6C,IAAK,yFAE1Cc,EAAYhK,OAAOzH,KAAK,CAAE8S,YAAa,4BAA6Bd,MAAO8L,GAC/E,CAYwBqa,CAA0BptB,QAC1B7J,KAAKg3B,UAAY,IAG5B,GACFF,EACN,CAID,mBAAWxtB,GAAa,OAAOtJ,KAAKuJ,SAA2B,CAC/D,WAAO1B,CAAKivB,GACJ92B,KAAKuJ,YACTvJ,KAAKuJ,UAAY,IAAIwtB,GAAYD,GACpC,ECxCL,MAAMI,GAEF,CACAC,SAAU,CACNpzB,MAAO,CAAEkC,MAAO,IAEpBmxB,SAAU,CACNrzB,MAAO,CAAEkC,MAAO,IAEpBoxB,UAAW,CACPtzB,MAAO,CAAE5B,EAAG,IAEhBm1B,SAAU,CACNvzB,MAAO,CAAEkC,MAAO,IAEpBsxB,UAAW,CACPxzB,MAAO,CAAEkC,MAAO,IAEpBuxB,SAAU,CACNzzB,MAAO,CAAEkC,MAAO,IAEpBwxB,SAAU,CACN1zB,MAAO,CAAEkC,MAAO,IAEpByxB,UAAW,CACP3zB,MAAO,YAIT4zB,GAEF,CAAA,EAEJ,SAASC,GAAcnzB,GACnB,MAA+B,iBAAjBA,EAAOV,KACzB,CAEA,SAAS8zB,GAAcpzB,GACnB,OAAQmzB,GAAcnzB,EAC1B,CAqCA,SAASqzB,GAAUvyB,EAAYd,GAC3B,QAAee,IAAXf,EAAsB,OAAO,EACjC,GAAIozB,GAAcpzB,GACd,OAtCR,SAA+Bc,EAAYd,GACvC,MAAMszB,EAAKxyB,EAAKE,UAAUC,WAC1B,YAAWF,IAAPuyB,GACG32B,OAAO2D,KAAKN,EAAOV,OAAOuB,MAAKN,GAC3B+yB,EAAG/yB,KAASP,EAAOV,MAAMiB,IAExC,CAgCegzB,CAAsBzyB,EAAMd,GAEvC,GAAImzB,GAAcnzB,GAAS,CACvB,GAA8B,cAA1Bc,EAAKuD,MAAMsC,MAAMC,KAAsB,CACvC,MAAM4sB,EAAe1yB,EAAKE,UAAUyyB,cACpC,QAAqB1yB,IAAjByyB,EAA4B,OAAO,EACvC,MAAME,EAAMF,EAAar3B,MAAM,KAC/B,MAA+B,MAAxBu3B,EAAIA,EAAIl4B,OAAS,EAC3B,CAAM,OAAO,CACjB,CACD,OAAO,CACX,CAEA,SAASm4B,GAASxyB,EAAyBL,EAAYd,GAInD,GAHIozB,GAAcpzB,IArCtB,SAA4BmB,EAAyBL,EAAYd,GAC7D,MAAMszB,EAAKxyB,EAAKE,UAAUC,WAC1B,QAAWF,IAAPuyB,EAAkB,OAEtB,MAAMtP,EAAoB,CAAA,EAC1BrnB,OAAO2D,KAAKN,EAAOV,OAAO8B,SAAQb,GAAOyjB,EAAMzjB,GAAO+yB,EAAG/yB,KACzDmQ,EAAiB7L,SAAS3B,IAAK,EAC/B7B,8BAA8BF,EAAQL,EAAMd,EAAOV,OACnDoR,EAAiB7L,SAAS3B,IAAK,EAC/BgwB,GAAcpyB,EAAKuD,MAAMsC,MAAMC,MAA8B,CAAEoZ,KAAMxS,KAAKC,MAAOnO,MAAO0kB,EAC5F,CA4BQ4P,CAAmBzyB,EAAQL,EAAMd,GAEjCmzB,GAAcnzB,IACgB,cAA1Bc,EAAKuD,MAAMsC,MAAMC,KAAsB,CACvC,QAAqC7F,IAAjCD,EAAKE,UAAUyyB,cAA6B,OAChD,MAAMC,EAAM5yB,EAAKE,SAASyyB,cAAct3B,MAAM,KACxC6nB,EAAQ0P,EAAIA,EAAIl4B,OAAS,GAC/Bk4B,EAAIA,EAAIl4B,OAAS,GAAK,IACtBsF,EAAKE,SAASyyB,cAAgBC,EAAIr3B,KAAK,KACvCsL,EAAiBxG,EAAQL,EAAKuD,MAAMsC,MAAMC,MAC1CssB,GAAcpyB,EAAKuD,MAAMsC,MAAMC,MAA8B,CAAEoZ,KAAMxS,KAAKC,MAAOnO,MAAO0kB,EAC3F,CAET,CAEA,SAAS6P,GAAW/yB,EAAYkjB,GAC5B,QAAcjjB,IAAVijB,EAAqB,OAAO,EAChC,GAAIoP,GAAcpP,GACd,OA/DR,SAAmCljB,EAAYkjB,GAC3C,MAAMsP,EAAKxyB,EAAKE,UAAUC,WAC1B,YAAWF,IAAPuyB,QACUvyB,IAAVijB,GACGrnB,OAAO2D,KAAK0jB,EAAM1kB,OAAOuB,MAAKN,GAAO+yB,EAAG/yB,IACnD,CA0DeuzB,CAA0BhzB,EAAMkjB,GAE3C,GAAImP,GAAcnP,GAAQ,CACtB,GAA8B,cAA1BljB,EAAKuD,MAAMsC,MAAMC,KAAsB,CACvC,MAAM4sB,EAAe1yB,EAAKE,UAAUyyB,cACpC,QAAqB1yB,IAAjByyB,EAA4B,OAAO,EACvC,MAAME,EAAMF,EAAar3B,MAAM,KAC/B,OAAIu3B,EAAIA,EAAIl4B,OAAS,KAAOwoB,EAAM1kB,QAE9B4zB,GAAcpyB,EAAKuD,MAAMsC,MAAMC,WAA8B7F,GACtD,EAEd,CACD,OAAO,CACV,CACD,OAAO,CACX,CAEA,SAASgzB,GAAU5yB,EAAyBL,EAAYkjB,GAIpD,GAHIoP,GAAcpP,IA/DtB,SAAgC7iB,EAAyBL,EAAYkjB,GACjE,MAAMsP,EAAKxyB,EAAKE,UAAUC,gBACfF,IAAPuyB,IACJ5iB,EAAiB7L,SAAS3B,IAAK,EAC/B7B,8BAA8BF,EAAQL,EAAMkjB,EAAM1kB,MAAO,CAAEjF,MAAM,IACjEqW,EAAiB7L,SAAS3B,IAAK,EACnC,CA0DQ8wB,CAAuB7yB,EAAQL,EAAMkjB,GAErCmP,GAAcnP,IACgB,cAA1BljB,EAAKuD,MAAMsC,MAAMC,KAAsB,CACvC,QAAqC7F,IAAjCD,EAAKE,UAAUyyB,cAA6B,OAChD,MAAMC,EAAM5yB,EAAKE,SAASyyB,cAAct3B,MAAM,KAC9Cu3B,EAAIA,EAAIl4B,OAAS,GAAKwoB,EAAM1kB,MAC5BwB,EAAKE,SAASyyB,cAAgBC,EAAIr3B,KAAK,KACvCsL,EAAiBxG,EAAQL,EAAKuD,MAAMsC,MAAMC,MAC1CssB,GAAcpyB,EAAKuD,MAAMsC,MAAMC,WAA8B7F,CAChE,CAET,CAEA,SAASkzB,GAAcxtB,GACnB,OAAOA,EAAIuP,KAAKE,MAAMF,KAAKC,SAAWxP,EAAIjL,QAC9C,OAEa04B,GACT,QAAApxB,CAAS3B,GACL,IAAK6R,GAAiB7R,GAAS,OAE/B,GAAmB,IADAsgB,GAAYlE,SAAS0D,MAAM,oBACxB,OAEtB,MAAMkT,EAAehzB,EAAOuF,WAAWnN,QAAOuH,GAAsC,SAA9BA,EAAKuD,MAAMsC,MAAMG,WAClEvN,QAAOuH,GAAQgP,EAAuBhP,EAAMuK,EAAelR,IAAI2G,EAAKuD,MAAMsC,MAAMC,SAErFoT,GAAc7Y,EAAQ8yB,GAAWE,IAEjC,MAAMC,EAAgBD,EAAa56B,QAAOuH,GAAQuyB,GAAUvyB,EAAM2xB,GAAS3xB,EAAKuD,MAAMsC,MAAMC,SAC5F,GAA6B,IAAzBwtB,EAAc54B,OAAc,CAC5B,MAAMoI,EAAI,EACV6d,GAAYzD,OAAOA,QAAUpa,EAC7B+R,GAAa,CAAExN,KAAM,SAAU6C,IAAK,4EAA8E,CAAE7J,UAAU,CAAEyC,IAAGoa,OAAQyD,GAAYzD,OAAOA,QACjK,KAAM,CACH,MAAMhe,EAASi0B,GAAWG,GAC1BT,GAASxyB,EAAQnB,EAAQyyB,GAASzyB,EAAOqE,MAAMsC,MAAMC,OACrD+O,GAAa,CAAExN,KAAM,cAAe6C,IAAK,+LAAiM,CAAE7J,UAC/O,CACJ,CAGD,QAAA6B,CAAS7B,GACL,IAAK6R,GAAiB7R,GAAS,OAE/B,MAAMkzB,EAAa5S,GAAYlE,SAAS0D,MAAM,oBAC9C,GAAmB,IAAfoT,EAAkB,OAGtB,GAFA94B,KAAK+4B,gBAEc,IAAfD,GAAoB94B,KAAK+4B,eAAiB,EAAG,OACjD,GAAmB,IAAfD,GAAoB94B,KAAK+4B,eAAiB,EAAG,OAEjD/4B,KAAK+4B,cAAgB,EACrB,MAAMC,EAAiBpzB,EAAOuF,WAAWnN,QAAOuH,GAAsC,SAA9BA,EAAKuD,MAAMsC,MAAMG,WACpEvN,QAAOuH,GAAQgP,EAAuBhP,EAAMuK,EAAelR,IAAI2G,EAAKuD,MAAMsC,MAAMC,SAChFrN,QAAOuH,GAA8E,iBAA/DoyB,GAAcpyB,EAAKuD,MAAMsC,MAAMC,QACrDrN,QAAOuH,GAAQ+yB,GAAW/yB,EAAM2xB,GAAS3xB,EAAKuD,MAAMsC,MAAMC,SAE/D,GAA8B,IAA1B2tB,EAAe/4B,OAAc,OACjC,MAAMg5B,EAAOP,GAAWM,GACxBR,GAAU5yB,EAAQqzB,EAAMtB,GAAcsB,EAAKnwB,MAAMsC,MAAMC,OACvD+O,GAAa,CAAExN,KAAM,cAAe6C,IAAK,wJAA0J,CAAE7J,UAExM,CAED,WAAAe,CAAqBuyB,EAA6B1oB,EAAoB,KAAjDxQ,KAAGk5B,IAAHA,EAA6Bl5B,KAASwQ,UAATA,EAxB1CxQ,KAAa+4B,cAAG,EAyBpBnoB,aAAY,KACR,IAAK/G,SAAW4N,GAAiB5N,QAE7B,YADAzI,OAAO2D,KAAK4yB,IAAe9xB,SAAQb,GAAO2yB,GAAc3yB,QAA6BQ,IAIzF,MAAMszB,EAAa5S,GAAYlE,SAAS0D,MAAM,oBAC9C,GAAmB,IAAfoT,GAAmC,IAAfA,EAAkB,OAC1C,MAAMnW,EAAcuD,GAAYzD,OAAOI,mBACjC3Q,EAAMD,KAAKC,MACXinB,EAAW7tB,EAAczB,QAE/B,IAAK,MAAO7E,EAAKjB,KAAU3C,OAAOnC,QAAQ04B,IAAgB,CACtD,QAAcnyB,IAAVzB,EAAqB,SAEzB,MAAMwB,EAAO4zB,EAASv6B,IAAIoG,QAEbQ,IAATD,GAAuBgP,EAAuBhP,EAAMuK,EAAelR,IAAI2G,EAAKuD,MAAMsC,MAAMC,OAKxF6G,EAAMnO,EAAM0gB,KAAO9B,IACnB6V,GAAU3uB,OAAQtE,EAAMxB,GACxB4zB,GAAc3yB,QAA6BQ,GAN3CmyB,GAAc3yB,QAA6BQ,CAQlD,IACFgL,GAEH0oB,EAAI3xB,UAAS9F,GAAKzB,KAAKuH,SAAS9F,KAChCy3B,EAAIzxB,UAAShG,GAAKzB,KAAKyH,SAAShG,IACnC,CAGD,WAAOoG,CAAKqxB,GACJl5B,KAAKuJ,YACTvJ,KAAKuJ,UAAY,IAAIovB,GAAiBO,GACzC,ECzOC,SAAUE,GAAwBj5B,GACpCA,EAAIuC,aAAa,uBAAwB,GAAG,CAACsE,EAAMC,KAlBvD,IAAqCC,EAmB7BD,EAAKD,GAnBwBE,EAoBDF,EAAK,GAAiBA,EAAK,KAjB3DkJ,EAAMrK,SAAQzI,IACV,MAAMi8B,EAAQnyB,EAAEyX,YAAYtT,KAC5B,IAAKguB,GAASA,IAAUj8B,EAAE0L,MAAMsC,MAAO,OAEvC,MAAM7F,EAAO2N,EAAehM,EAAGA,EAAG9J,GAE7BmI,GAASA,EAAK0G,OACfqtB,wBAAwBpyB,EAAG3B,EAAK0G,MAAO1G,EAAKuD,QAC5CywB,mBAAmBryB,EAAG,CAAE4B,MAAOvD,EAAKuD,MAAOmD,MAAO1G,EAAK0G,QAAS,EAAM,IAG9EutB,sBAMyE,GAE7E,CDgOWb,GAASpvB,eAAiC/D,EEvOrD,WACI,GAAI7E,OAAO84B,kBAAe,OAC1B94B,OAAO84B,mBAAgB,EAEvB,MAAMC,EAAkBC,SAASC,ehGpBZ,mBgGoBuCC,aAAa,OACzE,IAAKH,EAED,YADAn8B,QAAQC,MAAM,6BAGlB,MAAMkV,EAAYgnB,EAAgB9H,UAAU,EAAG8H,EAAgBI,YAAY,KAAO,GAAK,UAGjF35B,EAAM45B,EAAMt2B,YAAY,CAC1B5E,KAAMoF,EACN7B,SAAU6B,EACV5B,QAAS2B,EACT1B,WhGjCgB,2CgGmCd03B,EAA4B,GAC5B11B,EAAYsD,GAAyBoyB,EAAUl7B,KAAK8I,GAE1DlB,EAAcmB,KAAK1H,GAAKwS,MAAKoQ,GACzBmD,GAAYre,KAAK1H,EAAK,GAAG8D,MAAYD,aAAsB2O,MACvDrL,IACI4e,GAAYpD,QAAQa,YAAY3U,GAAOyI,GAAiBzI,IAAK+T,GAC7D0T,GAAa,IAAM1T,GACnB4V,GAAiB9wB,KAAKkb,EAAO,MAGzCxS,EAAY1I,KAAK,KACjBgvB,GAAShvB,KAAK,KACdkvB,GAAYlvB,KAAK,KACjBiK,EAAWjK,KAAK6K,GAChBrJ,EAAexB,KAAKzD,GAEpByxB,GAAY11B,GACZuO,EAAgB7G,KAAK1H,GAAKwS,MAAKlM,GPpB7B,SAAsBA,GACxBA,EAAQ4I,kBAAkBumB,IAC1BnvB,EAAQ2I,0BAA0BumB,GACtC,COiB8CsE,CAAYxzB,KACtD2yB,GAAwBj5B,GrECZ,SAAiBA,EAAmBmE,GAChD4T,GAAcrS,SAAQN,GAAQA,EAAKnF,KAAKD,EAAKmE,KAC7C6Q,EAAiBtN,KAAK1H,EAAKmE,EAC/B,CqEFI41B,CAAiB/5B,EAAKmE,GAEtBgwB,GAAiBzsB,KAAK1H,GAEtB4qB,GAAaljB,KAAK1H,EAAKmE,GACvBytB,GAAiBlqB,KAAK1H,EAAKmE,GAE3B,IAAI61B,GAA2B,EAC/Bh6B,EAAIuC,aAAa,cAAe,IAAI,CAACsE,EAAMC,KACvCA,EAAKD,GACDmzB,IACA9wB,EAAeC,SAASa,YAAY,oBAAoBnG,UACxDm2B,GAA2B,EAC/B,INQF,SAAuB71B,GACzBA,GAAS,IAAM81B,eAAe9D,KAClC,CMPI+D,CAAa/1B,GAEb,WACI,UAAyC,IAA1B3D,OAAekJ,cACpB,IAAIxD,SAAQC,GAAWg0B,WAAWh0B,EAAS,OACrD0zB,EAAUn0B,SAAQzF,GAAQA,KAC7B,EAJD,GAMAO,OAAO84B,mBAAgB,CAC1B,CAhED","x_google_ignoreList":[0]}